/*! For license information please see AgoraRtcWrapper.bundle.custom.js.LICENSE.txt */
var IrisRtcEngine;(()=>{var e={424:function(e,t,n){e.exports=function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},t=function(e){return e&&e.Math==Math&&e},r=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof e&&e)||function(){return this}()||Function("return this")(),i={},o=function(e){try{return!!e()}catch(e){return!0}},s=!o((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),a=!o((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),c=a,u=Function.prototype.call,l=c?u.bind(u):function(){return u.apply(u,arguments)},d={},h={}.propertyIsEnumerable,p=Object.getOwnPropertyDescriptor,f=p&&!h.call({1:2},1);d.f=f?function(e){var t=p(this,e);return!!t&&t.enumerable}:h;var A,E,g=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},_=a,m=Function.prototype,I=m.bind,T=m.call,R=_&&I.bind(T,T),v=_?function(e){return e&&R(e)}:function(e){return e&&function(){return T.apply(e,arguments)}},y=v,S=y({}.toString),C=y("".slice),O=function(e){return C(S(e),8,-1)},b=v,w=o,N=O,D=r.Object,L=b("".split),P=w((function(){return!D("z").propertyIsEnumerable(0)}))?function(e){return"String"==N(e)?L(e,""):D(e)}:D,k=r.TypeError,x=function(e){if(null==e)throw k("Can't call method on "+e);return e},M=P,U=x,B=function(e){return M(U(e))},F=function(e){return"function"==typeof e},V=F,G=function(e){return"object"==typeof e?null!==e:V(e)},Q=r,j=F,H=function(e){return j(e)?e:void 0},W=function(e,t){return arguments.length<2?H(Q[e]):Q[e]&&Q[e][t]},Y=v({}.isPrototypeOf),K=W("navigator","userAgent")||"",$=r,z=K,q=$.process,J=$.Deno,X=q&&q.versions||J&&J.version,Z=X&&X.v8;Z&&(E=(A=Z.split("."))[0]>0&&A[0]<4?1:+(A[0]+A[1])),!E&&z&&(!(A=z.match(/Edge\/(\d+)/))||A[1]>=74)&&(A=z.match(/Chrome\/(\d+)/))&&(E=+A[1]);var ee=E,te=ee,ne=o,re=!!Object.getOwnPropertySymbols&&!ne((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&te&&te<41})),ie=re&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,oe=W,se=F,ae=Y,ce=ie,ue=r.Object,le=ce?function(e){return"symbol"==typeof e}:function(e){var t=oe("Symbol");return se(t)&&ae(t.prototype,ue(e))},de=r.String,he=function(e){try{return de(e)}catch(e){return"Object"}},pe=F,fe=he,Ae=r.TypeError,Ee=function(e){if(pe(e))return e;throw Ae(fe(e)+" is not a function")},ge=Ee,_e=function(e,t){var n=e[t];return null==n?void 0:ge(n)},me=l,Ie=F,Te=G,Re=r.TypeError,ve={exports:{}},ye=r,Se=Object.defineProperty,Ce=function(e,t){try{Se(ye,e,{value:t,configurable:!0,writable:!0})}catch(n){ye[e]=t}return t},Oe=Ce,be="__core-js_shared__",we=r[be]||Oe(be,{}),Ne=we;(ve.exports=function(e,t){return Ne[e]||(Ne[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.3",mode:"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var De=x,Le=r.Object,Pe=function(e){return Le(De(e))},ke=Pe,xe=v({}.hasOwnProperty),Me=Object.hasOwn||function(e,t){return xe(ke(e),t)},Ue=v,Be=0,Fe=Math.random(),Ve=Ue(1..toString),Ge=function(e){return"Symbol("+(void 0===e?"":e)+")_"+Ve(++Be+Fe,36)},Qe=r,je=ve.exports,He=Me,We=Ge,Ye=re,Ke=ie,$e=je("wks"),ze=Qe.Symbol,qe=ze&&ze.for,Je=Ke?ze:ze&&ze.withoutSetter||We,Xe=function(e){if(!He($e,e)||!Ye&&"string"!=typeof $e[e]){var t="Symbol."+e;Ye&&He(ze,e)?$e[e]=ze[e]:$e[e]=Ke&&qe?qe(t):Je(t)}return $e[e]},Ze=l,et=G,tt=le,nt=_e,rt=Xe,it=r.TypeError,ot=rt("toPrimitive"),st=function(e,t){if(!et(e)||tt(e))return e;var n,r=nt(e,ot);if(r){if(void 0===t&&(t="default"),n=Ze(r,e,t),!et(n)||tt(n))return n;throw it("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var n,r;if("string"===t&&Ie(n=e.toString)&&!Te(r=me(n,e)))return r;if(Ie(n=e.valueOf)&&!Te(r=me(n,e)))return r;if("string"!==t&&Ie(n=e.toString)&&!Te(r=me(n,e)))return r;throw Re("Can't convert object to primitive value")}(e,t)},at=le,ct=function(e){var t=st(e,"string");return at(t)?t:t+""},ut=G,lt=r.document,dt=ut(lt)&&ut(lt.createElement),ht=function(e){return dt?lt.createElement(e):{}},pt=ht,ft=!s&&!o((function(){return 7!=Object.defineProperty(pt("div"),"a",{get:function(){return 7}}).a})),At=s,Et=l,gt=d,_t=g,mt=B,It=ct,Tt=Me,Rt=ft,vt=Object.getOwnPropertyDescriptor;i.f=At?vt:function(e,t){if(e=mt(e),t=It(t),Rt)try{return vt(e,t)}catch(e){}if(Tt(e,t))return _t(!Et(gt.f,e,t),e[t])};var yt={},St=s&&o((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Ct=r,Ot=G,bt=Ct.String,wt=Ct.TypeError,Nt=function(e){if(Ot(e))return e;throw wt(bt(e)+" is not an object")},Dt=s,Lt=ft,Pt=St,kt=Nt,xt=ct,Mt=r.TypeError,Ut=Object.defineProperty,Bt=Object.getOwnPropertyDescriptor;yt.f=Dt?Pt?function(e,t,n){if(kt(e),t=xt(t),kt(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=Bt(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return Ut(e,t,n)}:Ut:function(e,t,n){if(kt(e),t=xt(t),kt(n),Lt)try{return Ut(e,t,n)}catch(e){}if("get"in n||"set"in n)throw Mt("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var Ft=yt,Vt=g,Gt=s?function(e,t,n){return Ft.f(e,t,Vt(1,n))}:function(e,t,n){return e[t]=n,e},Qt={exports:{}},jt=F,Ht=we,Wt=v(Function.toString);jt(Ht.inspectSource)||(Ht.inspectSource=function(e){return Wt(e)});var Yt,Kt,$t,zt=Ht.inspectSource,qt=F,Jt=zt,Xt=r.WeakMap,Zt=qt(Xt)&&/native code/.test(Jt(Xt)),en=ve.exports,tn=Ge,nn=en("keys"),rn=function(e){return nn[e]||(nn[e]=tn(e))},on={},sn=Zt,an=r,cn=v,un=G,ln=Gt,dn=Me,hn=we,pn=rn,fn=on,An="Object already initialized",En=an.TypeError,gn=an.WeakMap;if(sn||hn.state){var _n=hn.state||(hn.state=new gn),mn=cn(_n.get),In=cn(_n.has),Tn=cn(_n.set);Yt=function(e,t){if(In(_n,e))throw new En(An);return t.facade=e,Tn(_n,e,t),t},Kt=function(e){return mn(_n,e)||{}},$t=function(e){return In(_n,e)}}else{var Rn=pn("state");fn[Rn]=!0,Yt=function(e,t){if(dn(e,Rn))throw new En(An);return t.facade=e,ln(e,Rn,t),t},Kt=function(e){return dn(e,Rn)?e[Rn]:{}},$t=function(e){return dn(e,Rn)}}var vn={set:Yt,get:Kt,has:$t,enforce:function(e){return $t(e)?Kt(e):Yt(e,{})},getterFor:function(e){return function(t){var n;if(!un(t)||(n=Kt(t)).type!==e)throw En("Incompatible receiver, "+e+" required");return n}}},yn=s,Sn=Me,Cn=Function.prototype,On=yn&&Object.getOwnPropertyDescriptor,bn=Sn(Cn,"name"),wn={EXISTS:bn,PROPER:bn&&"something"===function(){}.name,CONFIGURABLE:bn&&(!yn||yn&&On(Cn,"name").configurable)},Nn=r,Dn=F,Ln=Me,Pn=Gt,kn=Ce,xn=zt,Mn=wn.CONFIGURABLE,Un=vn.get,Bn=vn.enforce,Fn=String(String).split("String");(Qt.exports=function(e,t,n,r){var i,o=!!r&&!!r.unsafe,s=!!r&&!!r.enumerable,a=!!r&&!!r.noTargetGet,c=r&&void 0!==r.name?r.name:t;Dn(n)&&("Symbol("===String(c).slice(0,7)&&(c="["+String(c).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!Ln(n,"name")||Mn&&n.name!==c)&&Pn(n,"name",c),(i=Bn(n)).source||(i.source=Fn.join("string"==typeof c?c:""))),e!==Nn?(o?!a&&e[t]&&(s=!0):delete e[t],s?e[t]=n:Pn(e,t,n)):s?e[t]=n:kn(t,n)})(Function.prototype,"toString",(function(){return Dn(this)&&Un(this).source||xn(this)}));var Vn={},Gn=Math.ceil,Qn=Math.floor,jn=function(e){var t=+e;return t!=t||0===t?0:(t>0?Qn:Gn)(t)},Hn=jn,Wn=Math.max,Yn=Math.min,Kn=function(e,t){var n=Hn(e);return n<0?Wn(n+t,0):Yn(n,t)},$n=jn,zn=Math.min,qn=function(e){return e>0?zn($n(e),9007199254740991):0},Jn=qn,Xn=function(e){return Jn(e.length)},Zn=B,er=Kn,tr=Xn,nr=function(e){return function(t,n,r){var i,o=Zn(t),s=tr(o),a=er(r,s);if(e&&n!=n){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((e||a in o)&&o[a]===n)return e||a||0;return!e&&-1}},rr={includes:nr(!0),indexOf:nr(!1)},ir=Me,or=B,sr=rr.indexOf,ar=on,cr=v([].push),ur=function(e,t){var n,r=or(e),i=0,o=[];for(n in r)!ir(ar,n)&&ir(r,n)&&cr(o,n);for(;t.length>i;)ir(r,n=t[i++])&&(~sr(o,n)||cr(o,n));return o},lr=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],dr=ur,hr=lr.concat("length","prototype");Vn.f=Object.getOwnPropertyNames||function(e){return dr(e,hr)};var pr={};pr.f=Object.getOwnPropertySymbols;var fr=W,Ar=Vn,Er=pr,gr=Nt,_r=v([].concat),mr=fr("Reflect","ownKeys")||function(e){var t=Ar.f(gr(e)),n=Er.f;return n?_r(t,n(e)):t},Ir=Me,Tr=mr,Rr=i,vr=yt,yr=function(e,t,n){for(var r=Tr(t),i=vr.f,o=Rr.f,s=0;s<r.length;s++){var a=r[s];Ir(e,a)||n&&Ir(n,a)||i(e,a,o(t,a))}},Sr=o,Cr=F,Or=/#|\.prototype\./,br=function(e,t){var n=Nr[wr(e)];return n==Lr||n!=Dr&&(Cr(t)?Sr(t):!!t)},wr=br.normalize=function(e){return String(e).replace(Or,".").toLowerCase()},Nr=br.data={},Dr=br.NATIVE="N",Lr=br.POLYFILL="P",Pr=br,kr=r,xr=i.f,Mr=Gt,Ur=Qt.exports,Br=Ce,Fr=yr,Vr=Pr,Gr=function(e,t){var n,r,i,o,s,a=e.target,c=e.global,u=e.stat;if(n=c?kr:u?kr[a]||Br(a,{}):(kr[a]||{}).prototype)for(r in t){if(o=t[r],i=e.noTargetGet?(s=xr(n,r))&&s.value:n[r],!Vr(c?r:a+(u?".":"#")+r,e.forced)&&void 0!==i){if(typeof o==typeof i)continue;Fr(o,i)}(e.sham||i&&i.sham)&&Mr(o,"sham",!0),Ur(n,r,o,e)}},Qr=r.Promise,jr=Qt.exports,Hr=function(e,t,n){for(var r in t)jr(e,r,t[r],n);return e},Wr=r,Yr=F,Kr=Wr.String,$r=Wr.TypeError,zr=v,qr=Nt,Jr=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=zr(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return qr(n),function(e){if("object"==typeof e||Yr(e))return e;throw $r("Can't set "+Kr(e)+" as a prototype")}(r),t?e(n,r):n.__proto__=r,n}}():void 0),Xr=yt.f,Zr=Me,ei=Xe("toStringTag"),ti=function(e,t,n){e&&!n&&(e=e.prototype),e&&!Zr(e,ei)&&Xr(e,ei,{configurable:!0,value:t})},ni=W,ri=yt,ii=s,oi=Xe("species"),si=function(e){var t=ni(e),n=ri.f;ii&&t&&!t[oi]&&n(t,oi,{configurable:!0,get:function(){return this}})},ai=Y,ci=r.TypeError,ui=function(e,t){if(ai(t,e))return e;throw ci("Incorrect invocation")},li=Ee,di=a,hi=v(v.bind),pi=function(e,t){return li(e),void 0===t?e:di?hi(e,t):function(){return e.apply(t,arguments)}},fi={},Ai=fi,Ei=Xe("iterator"),gi=Array.prototype,_i=function(e){return void 0!==e&&(Ai.Array===e||gi[Ei]===e)},mi={};mi[Xe("toStringTag")]="z";var Ii=r,Ti="[object z]"===String(mi),Ri=F,vi=O,yi=Xe("toStringTag"),Si=Ii.Object,Ci="Arguments"==vi(function(){return arguments}()),Oi=Ti?vi:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Si(e),yi))?n:Ci?vi(t):"Object"==(r=vi(t))&&Ri(t.callee)?"Arguments":r},bi=Oi,wi=_e,Ni=fi,Di=Xe("iterator"),Li=function(e){if(null!=e)return wi(e,Di)||wi(e,"@@iterator")||Ni[bi(e)]},Pi=l,ki=Ee,xi=Nt,Mi=he,Ui=Li,Bi=r.TypeError,Fi=function(e,t){var n=arguments.length<2?Ui(e):t;if(ki(n))return xi(Pi(n,e));throw Bi(Mi(e)+" is not iterable")},Vi=l,Gi=Nt,Qi=_e,ji=pi,Hi=l,Wi=Nt,Yi=he,Ki=_i,$i=Xn,zi=Y,qi=Fi,Ji=Li,Xi=function(e,t,n){var r,i;Gi(e);try{if(!(r=Qi(e,"return"))){if("throw"===t)throw n;return n}r=Vi(r,e)}catch(e){i=!0,r=e}if("throw"===t)throw n;if(i)throw r;return Gi(r),n},Zi=r.TypeError,eo=function(e,t){this.stopped=e,this.result=t},to=eo.prototype,no=Xe("iterator"),ro=!1;try{var io=0,oo={next:function(){return{done:!!io++}},return:function(){ro=!0}};oo[no]=function(){return this},Array.from(oo,(function(){throw 2}))}catch(e){}var so=function(e,t){if(!t&&!ro)return!1;var n=!1;try{var r={};r[no]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n},ao=v,co=o,uo=F,lo=Oi,ho=zt,po=function(){},fo=[],Ao=W("Reflect","construct"),Eo=/^\s*(?:class|function)\b/,go=ao(Eo.exec),_o=!Eo.exec(po),mo=function(e){if(!uo(e))return!1;try{return Ao(po,fo,e),!0}catch(e){return!1}},Io=function(e){if(!uo(e))return!1;switch(lo(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return _o||!!go(Eo,ho(e))}catch(e){return!0}};Io.sham=!0;var To,Ro,vo,yo,So=!Ao||co((function(){var e;return mo(mo.call)||!mo(Object)||!mo((function(){e=!0}))||e}))?Io:mo,Co=So,Oo=he,bo=r.TypeError,wo=function(e){if(Co(e))return e;throw bo(Oo(e)+" is not a constructor")},No=Nt,Do=wo,Lo=Xe("species"),Po=function(e,t){var n,r=No(e).constructor;return void 0===r||null==(n=No(r)[Lo])?t:Do(n)},ko=a,xo=Function.prototype,Mo=xo.apply,Uo=xo.call,Bo="object"==typeof Reflect&&Reflect.apply||(ko?Uo.bind(Mo):function(){return Uo.apply(Mo,arguments)}),Fo=W("document","documentElement"),Vo=v([].slice),Go=/(?:ipad|iphone|ipod).*applewebkit/i.test(K),Qo="process"==O(r.process),jo=r,Ho=Bo,Wo=pi,Yo=F,Ko=Me,$o=o,zo=Fo,qo=Vo,Jo=ht,Xo=Go,Zo=Qo,es=jo.setImmediate,ts=jo.clearImmediate,ns=jo.process,rs=jo.Dispatch,is=jo.Function,os=jo.MessageChannel,ss=jo.String,as=0,cs={};try{To=jo.location}catch(e){}var us=function(e){if(Ko(cs,e)){var t=cs[e];delete cs[e],t()}},ls=function(e){return function(){us(e)}},ds=function(e){us(e.data)},hs=function(e){jo.postMessage(ss(e),To.protocol+"//"+To.host)};es&&ts||(es=function(e){var t=qo(arguments,1);return cs[++as]=function(){Ho(Yo(e)?e:is(e),void 0,t)},Ro(as),as},ts=function(e){delete cs[e]},Zo?Ro=function(e){ns.nextTick(ls(e))}:rs&&rs.now?Ro=function(e){rs.now(ls(e))}:os&&!Xo?(yo=(vo=new os).port2,vo.port1.onmessage=ds,Ro=Wo(yo.postMessage,yo)):jo.addEventListener&&Yo(jo.postMessage)&&!jo.importScripts&&To&&"file:"!==To.protocol&&!$o(hs)?(Ro=hs,jo.addEventListener("message",ds,!1)):Ro="onreadystatechange"in Jo("script")?function(e){zo.appendChild(Jo("script")).onreadystatechange=function(){zo.removeChild(this),us(e)}}:function(e){setTimeout(ls(e),0)});var ps,fs,As,Es,gs,_s,ms,Is,Ts={set:es,clear:ts},Rs=r,vs=/ipad|iphone|ipod/i.test(K)&&void 0!==Rs.Pebble,ys=/web0s(?!.*chrome)/i.test(K),Ss=r,Cs=pi,Os=i.f,bs=Ts.set,ws=Go,Ns=vs,Ds=ys,Ls=Qo,Ps=Ss.MutationObserver||Ss.WebKitMutationObserver,ks=Ss.document,xs=Ss.process,Ms=Ss.Promise,Us=Os(Ss,"queueMicrotask"),Bs=Us&&Us.value;Bs||(ps=function(){var e,t;for(Ls&&(e=xs.domain)&&e.exit();fs;){t=fs.fn,fs=fs.next;try{t()}catch(e){throw fs?Es():As=void 0,e}}As=void 0,e&&e.enter()},ws||Ls||Ds||!Ps||!ks?!Ns&&Ms&&Ms.resolve?((ms=Ms.resolve(void 0)).constructor=Ms,Is=Cs(ms.then,ms),Es=function(){Is(ps)}):Ls?Es=function(){xs.nextTick(ps)}:(bs=Cs(bs,Ss),Es=function(){bs(ps)}):(gs=!0,_s=ks.createTextNode(""),new Ps(ps).observe(_s,{characterData:!0}),Es=function(){_s.data=gs=!gs}));var Fs=Bs||function(e){var t={fn:e,next:void 0};As&&(As.next=t),fs||(fs=t,Es()),As=t},Vs={},Gs=Ee,Qs=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=Gs(t),this.reject=Gs(n)};Vs.f=function(e){return new Qs(e)};var js=Nt,Hs=G,Ws=Vs,Ys=function(e,t){if(js(e),Hs(t)&&t.constructor===e)return t;var n=Ws.f(e);return(0,n.resolve)(t),n.promise},Ks=r,$s=function(){this.head=null,this.tail=null};$s.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var zs,qs,Js,Xs,Zs=$s,ea="object"==typeof window,ta=Gr,na=r,ra=W,ia=l,oa=Qr,sa=Qt.exports,aa=Hr,ca=Jr,ua=ti,la=si,da=Ee,ha=F,pa=G,fa=ui,Aa=zt,Ea=function(e,t,n){var r,i,o,s,a,c,u,l=n&&n.that,d=!(!n||!n.AS_ENTRIES),h=!(!n||!n.IS_ITERATOR),p=!(!n||!n.INTERRUPTED),f=ji(t,l),A=function(e){return r&&Xi(r,"normal",e),new eo(!0,e)},E=function(e){return d?(Wi(e),p?f(e[0],e[1],A):f(e[0],e[1])):p?f(e,A):f(e)};if(h)r=e;else{if(!(i=Ji(e)))throw Zi(Yi(e)+" is not iterable");if(Ki(i)){for(o=0,s=$i(e);s>o;o++)if((a=E(e[o]))&&zi(to,a))return a;return new eo(!1)}r=qi(e,i)}for(c=r.next;!(u=Hi(c,r)).done;){try{a=E(u.value)}catch(e){Xi(r,"throw",e)}if("object"==typeof a&&a&&zi(to,a))return a}return new eo(!1)},ga=so,_a=Po,ma=Ts.set,Ia=Fs,Ta=Ys,Ra=Vs,va=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},ya=Zs,Sa=vn,Ca=Pr,Oa=ea,ba=Qo,wa=ee,Na=Xe("species"),Da="Promise",La=Sa.getterFor(Da),Pa=Sa.set,ka=Sa.getterFor(Da),xa=oa&&oa.prototype,Ma=oa,Ua=xa,Ba=na.TypeError,Fa=na.document,Va=na.process,Ga=Ra.f,Qa=Ga,ja=!!(Fa&&Fa.createEvent&&na.dispatchEvent),Ha=ha(na.PromiseRejectionEvent),Wa="unhandledrejection",Ya=!1,Ka=Ca(Da,(function(){var e=Aa(Ma),t=e!==String(Ma);if(!t&&66===wa)return!0;if(wa>=51&&/native code/.test(e))return!1;var n=new Ma((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[Na]=r,!(Ya=n.then((function(){}))instanceof r)||!t&&Oa&&!Ha})),$a=Ka||!ga((function(e){Ma.all(e).catch((function(){}))})),za=function(e){var t;return!(!pa(e)||!ha(t=e.then))&&t},qa=function(e,t){var n,r,i,o=t.value,s=1==t.state,a=s?e.ok:e.fail,c=e.resolve,u=e.reject,l=e.domain;try{a?(s||(2===t.rejection&&tc(t),t.rejection=1),!0===a?n=o:(l&&l.enter(),n=a(o),l&&(l.exit(),i=!0)),n===e.promise?u(Ba("Promise-chain cycle")):(r=za(n))?ia(r,n,c,u):c(n)):u(o)}catch(e){l&&!i&&l.exit(),u(e)}},Ja=function(e,t){e.notified||(e.notified=!0,Ia((function(){for(var n,r=e.reactions;n=r.get();)qa(n,e);e.notified=!1,t&&!e.rejection&&Za(e)})))},Xa=function(e,t,n){var r,i;ja?((r=Fa.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),na.dispatchEvent(r)):r={promise:t,reason:n},!Ha&&(i=na["on"+e])?i(r):e===Wa&&function(e,t){var n=Ks.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},Za=function(e){ia(ma,na,(function(){var t,n=e.facade,r=e.value;if(ec(e)&&(t=va((function(){ba?Va.emit("unhandledRejection",r,n):Xa(Wa,n,r)})),e.rejection=ba||ec(e)?2:1,t.error))throw t.value}))},ec=function(e){return 1!==e.rejection&&!e.parent},tc=function(e){ia(ma,na,(function(){var t=e.facade;ba?Va.emit("rejectionHandled",t):Xa("rejectionhandled",t,e.value)}))},nc=function(e,t,n){return function(r){e(t,r,n)}},rc=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Ja(e,!0))},ic=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw Ba("Promise can't be resolved itself");var r=za(t);r?Ia((function(){var n={done:!1};try{ia(r,t,nc(ic,n,e),nc(rc,n,e))}catch(t){rc(n,t,e)}})):(e.value=t,e.state=1,Ja(e,!1))}catch(t){rc({done:!1},t,e)}}};if(Ka&&(Ua=(Ma=function(e){fa(this,Ua),da(e),ia(zs,this);var t=La(this);try{e(nc(ic,t),nc(rc,t))}catch(e){rc(t,e)}}).prototype,(zs=function(e){Pa(this,{type:Da,done:!1,notified:!1,parent:!1,reactions:new ya,rejection:!1,state:0,value:void 0})}).prototype=aa(Ua,{then:function(e,t){var n=ka(this),r=Ga(_a(this,Ma));return n.parent=!0,r.ok=!ha(e)||e,r.fail=ha(t)&&t,r.domain=ba?Va.domain:void 0,0==n.state?n.reactions.add(r):Ia((function(){qa(r,n)})),r.promise},catch:function(e){return this.then(void 0,e)}}),qs=function(){var e=new zs,t=La(e);this.promise=e,this.resolve=nc(ic,t),this.reject=nc(rc,t)},Ra.f=Ga=function(e){return e===Ma||e===Js?new qs(e):Qa(e)},ha(oa)&&xa!==Object.prototype)){Xs=xa.then,Ya||(sa(xa,"then",(function(e,t){var n=this;return new Ma((function(e,t){ia(Xs,n,e,t)})).then(e,t)}),{unsafe:!0}),sa(xa,"catch",Ua.catch,{unsafe:!0}));try{delete xa.constructor}catch(e){}ca&&ca(xa,Ua)}ta({global:!0,wrap:!0,forced:Ka},{Promise:Ma}),ua(Ma,Da,!1),la(Da),Js=ra(Da),ta({target:Da,stat:!0,forced:Ka},{reject:function(e){var t=Ga(this);return ia(t.reject,void 0,e),t.promise}}),ta({target:Da,stat:!0,forced:Ka},{resolve:function(e){return Ta(this,e)}}),ta({target:Da,stat:!0,forced:$a},{all:function(e){var t=this,n=Ga(t),r=n.resolve,i=n.reject,o=va((function(){var n=da(t.resolve),o=[],s=0,a=1;Ea(e,(function(e){var c=s++,u=!1;a++,ia(n,t,e).then((function(e){u||(u=!0,o[c]=e,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=Ga(t),r=n.reject,i=va((function(){var i=da(t.resolve);Ea(e,(function(e){ia(i,t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});var oc=Gr,sc=W,ac=Bo,cc=v,uc=o,lc=r.Array,dc=sc("JSON","stringify"),hc=cc(/./.exec),pc=cc("".charAt),fc=cc("".charCodeAt),Ac=cc("".replace),Ec=cc(1..toString),gc=/[\uD800-\uDFFF]/g,_c=/^[\uD800-\uDBFF]$/,mc=/^[\uDC00-\uDFFF]$/,Ic=function(e,t,n){var r=pc(n,t-1),i=pc(n,t+1);return hc(_c,e)&&!hc(mc,i)||hc(mc,e)&&!hc(_c,r)?"\\u"+Ec(fc(e,0),16):e},Tc=uc((function(){return'"\\udf06\\ud834"'!==dc("\udf06\ud834")||'"\\udead"'!==dc("\udead")}));dc&&oc({target:"JSON",stat:!0,forced:Tc},{stringify:function(e,t,n){for(var r=0,i=arguments.length,o=lc(i);r<i;r++)o[r]=arguments[r];var s=ac(dc,null,o);return"string"==typeof s?Ac(s,gc,Ic):s}});var Rc=function(e){try{return!!e()}catch(e){return!0}},vc=!Rc((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),yc=vc,Sc=Function.prototype,Cc=Sc.bind,Oc=Sc.call,bc=yc&&Cc.bind(Oc,Oc),wc=yc?function(e){return e&&bc(e)}:function(e){return e&&function(){return Oc.apply(e,arguments)}},Nc=wc({}.isPrototypeOf),Dc=function(e){return e&&e.Math==Math&&e},Lc=Dc("object"==typeof globalThis&&globalThis)||Dc("object"==typeof window&&window)||Dc("object"==typeof self&&self)||Dc("object"==typeof e&&e)||function(){return this}()||Function("return this")(),Pc=vc,kc=Function.prototype,xc=kc.apply,Mc=kc.call,Uc="object"==typeof Reflect&&Reflect.apply||(Pc?Mc.bind(xc):function(){return Mc.apply(xc,arguments)}),Bc=function(e){return"function"==typeof e},Fc={},Vc=!Rc((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),Gc=vc,Qc=Function.prototype.call,jc=Gc?Qc.bind(Qc):function(){return Qc.apply(Qc,arguments)},Hc={},Wc={}.propertyIsEnumerable,Yc=Object.getOwnPropertyDescriptor,Kc=Yc&&!Wc.call({1:2},1);Hc.f=Kc?function(e){var t=Yc(this,e);return!!t&&t.enumerable}:Wc;var $c,zc,qc=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Jc=wc,Xc=Jc({}.toString),Zc=Jc("".slice),eu=function(e){return Zc(Xc(e),8,-1)},tu=wc,nu=Rc,ru=eu,iu=Lc.Object,ou=tu("".split),su=nu((function(){return!iu("z").propertyIsEnumerable(0)}))?function(e){return"String"==ru(e)?ou(e,""):iu(e)}:iu,au=Lc.TypeError,cu=function(e){if(null==e)throw au("Can't call method on "+e);return e},uu=su,lu=cu,du=function(e){return uu(lu(e))},hu=Bc,pu=function(e){return"object"==typeof e?null!==e:hu(e)},fu={},Au=fu,Eu=Lc,gu=Bc,_u=function(e){return gu(e)?e:void 0},mu=function(e,t){return arguments.length<2?_u(Au[e])||_u(Eu[e]):Au[e]&&Au[e][t]||Eu[e]&&Eu[e][t]},Iu=mu("navigator","userAgent")||"",Tu=Lc,Ru=Iu,vu=Tu.process,yu=Tu.Deno,Su=vu&&vu.versions||yu&&yu.version,Cu=Su&&Su.v8;Cu&&(zc=($c=Cu.split("."))[0]>0&&$c[0]<4?1:+($c[0]+$c[1])),!zc&&Ru&&(!($c=Ru.match(/Edge\/(\d+)/))||$c[1]>=74)&&($c=Ru.match(/Chrome\/(\d+)/))&&(zc=+$c[1]);var Ou=zc,bu=Ou,wu=Rc,Nu=!!Object.getOwnPropertySymbols&&!wu((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&bu&&bu<41})),Du=Nu&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Lu=mu,Pu=Bc,ku=Nc,xu=Du,Mu=Lc.Object,Uu=xu?function(e){return"symbol"==typeof e}:function(e){var t=Lu("Symbol");return Pu(t)&&ku(t.prototype,Mu(e))},Bu=Lc.String,Fu=function(e){try{return Bu(e)}catch(e){return"Object"}},Vu=Bc,Gu=Fu,Qu=Lc.TypeError,ju=function(e){if(Vu(e))return e;throw Qu(Gu(e)+" is not a function")},Hu=ju,Wu=function(e,t){var n=e[t];return null==n?void 0:Hu(n)},Yu=jc,Ku=Bc,$u=pu,zu=Lc.TypeError,qu={exports:{}},Ju=Lc,Xu=Object.defineProperty,Zu="__core-js_shared__",el=Lc[Zu]||function(e,t){try{Xu(Ju,e,{value:t,configurable:!0,writable:!0})}catch(n){Ju[e]=t}return t}(Zu,{}),tl=el;(qu.exports=function(e,t){return tl[e]||(tl[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.3",mode:"pure",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"});var nl=cu,rl=Lc.Object,il=function(e){return rl(nl(e))},ol=il,sl=wc({}.hasOwnProperty),al=Object.hasOwn||function(e,t){return sl(ol(e),t)},cl=wc,ul=0,ll=Math.random(),dl=cl(1..toString),hl=function(e){return"Symbol("+(void 0===e?"":e)+")_"+dl(++ul+ll,36)},pl=Lc,fl=qu.exports,Al=al,El=hl,gl=Nu,_l=Du,ml=fl("wks"),Il=pl.Symbol,Tl=Il&&Il.for,Rl=_l?Il:Il&&Il.withoutSetter||El,vl=function(e){if(!Al(ml,e)||!gl&&"string"!=typeof ml[e]){var t="Symbol."+e;gl&&Al(Il,e)?ml[e]=Il[e]:ml[e]=_l&&Tl?Tl(t):Rl(t)}return ml[e]},yl=jc,Sl=pu,Cl=Uu,Ol=Wu,bl=vl,wl=Lc.TypeError,Nl=bl("toPrimitive"),Dl=function(e,t){if(!Sl(e)||Cl(e))return e;var n,r=Ol(e,Nl);if(r){if(void 0===t&&(t="default"),n=yl(r,e,t),!Sl(n)||Cl(n))return n;throw wl("Can't convert object to primitive value")}return void 0===t&&(t="number"),function(e,t){var n,r;if("string"===t&&Ku(n=e.toString)&&!$u(r=Yu(n,e)))return r;if(Ku(n=e.valueOf)&&!$u(r=Yu(n,e)))return r;if("string"!==t&&Ku(n=e.toString)&&!$u(r=Yu(n,e)))return r;throw zu("Can't convert object to primitive value")}(e,t)},Ll=Uu,Pl=function(e){var t=Dl(e,"string");return Ll(t)?t:t+""},kl=pu,xl=Lc.document,Ml=kl(xl)&&kl(xl.createElement),Ul=function(e){return Ml?xl.createElement(e):{}},Bl=Ul,Fl=!Vc&&!Rc((function(){return 7!=Object.defineProperty(Bl("div"),"a",{get:function(){return 7}}).a})),Vl=Vc,Gl=jc,Ql=Hc,jl=qc,Hl=du,Wl=Pl,Yl=al,Kl=Fl,$l=Object.getOwnPropertyDescriptor;Fc.f=Vl?$l:function(e,t){if(e=Hl(e),t=Wl(t),Kl)try{return $l(e,t)}catch(e){}if(Yl(e,t))return jl(!Gl(Ql.f,e,t),e[t])};var zl=Rc,ql=Bc,Jl=/#|\.prototype\./,Xl=function(e,t){var n=ed[Zl(e)];return n==nd||n!=td&&(ql(t)?zl(t):!!t)},Zl=Xl.normalize=function(e){return String(e).replace(Jl,".").toLowerCase()},ed=Xl.data={},td=Xl.NATIVE="N",nd=Xl.POLYFILL="P",rd=Xl,id=ju,od=vc,sd=wc(wc.bind),ad=function(e,t){return id(e),void 0===t?e:od?sd(e,t):function(){return e.apply(t,arguments)}},cd={},ud=Vc&&Rc((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),ld=Lc,dd=pu,hd=ld.String,pd=ld.TypeError,fd=function(e){if(dd(e))return e;throw pd(hd(e)+" is not an object")},Ad=Vc,Ed=Fl,gd=ud,_d=fd,md=Pl,Id=Lc.TypeError,Td=Object.defineProperty,Rd=Object.getOwnPropertyDescriptor;cd.f=Ad?gd?function(e,t,n){if(_d(e),t=md(t),_d(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=Rd(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return Td(e,t,n)}:Td:function(e,t,n){if(_d(e),t=md(t),_d(n),Ed)try{return Td(e,t,n)}catch(e){}if("get"in n||"set"in n)throw Id("Accessors not supported");return"value"in n&&(e[t]=n.value),e};var vd=cd,yd=qc,Sd=Vc?function(e,t,n){return vd.f(e,t,yd(1,n))}:function(e,t,n){return e[t]=n,e},Cd=Lc,Od=Uc,bd=wc,wd=Bc,Nd=Fc.f,Dd=rd,Ld=fu,Pd=ad,kd=Sd,xd=al,Md=function(e){var t=function(n,r,i){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,r)}return new e(n,r,i)}return Od(e,this,arguments)};return t.prototype=e.prototype,t},Ud=function(e,t){var n,r,i,o,s,a,c,u,l=e.target,d=e.global,h=e.stat,p=e.proto,f=d?Cd:h?Cd[l]:(Cd[l]||{}).prototype,A=d?Ld:Ld[l]||kd(Ld,l,{})[l],E=A.prototype;for(i in t)n=!Dd(d?i:l+(h?".":"#")+i,e.forced)&&f&&xd(f,i),s=A[i],n&&(a=e.noTargetGet?(u=Nd(f,i))&&u.value:f[i]),o=n&&a?a:t[i],n&&typeof s==typeof o||(c=e.bind&&n?Pd(o,Cd):e.wrap&&n?Md(o):p&&wd(o)?bd(o):o,(e.sham||o&&o.sham||s&&s.sham)&&kd(c,"sham",!0),kd(A,i,c),p&&(xd(Ld,r=l+"Prototype")||kd(Ld,r,{}),kd(Ld[r],i,o),e.real&&E&&!E[i]&&kd(E,i,o)))},Bd=Math.ceil,Fd=Math.floor,Vd=function(e){var t=+e;return t!=t||0===t?0:(t>0?Fd:Bd)(t)},Gd=Vd,Qd=Math.min,jd=function(e){return function(e){return e>0?Qd(Gd(e),9007199254740991):0}(e.length)},Hd=ju,Wd=il,Yd=su,Kd=jd,$d=Lc.TypeError,zd=function(e){return function(t,n,r,i){Hd(n);var o=Wd(t),s=Yd(o),a=Kd(o),c=e?a-1:0,u=e?-1:1;if(r<2)for(;;){if(c in s){i=s[c],c+=u;break}if(c+=u,e?c<0:a<=c)throw $d("Reduce of empty array with no initial value")}for(;e?c>=0:a>c;c+=u)c in s&&(i=n(i,s[c],c,o));return i}},qd={left:zd(!1),right:zd(!0)},Jd=Rc,Xd=function(e,t){var n=[][e];return!!n&&Jd((function(){n.call(null,t||function(){throw 1},1)}))},Zd="process"==eu(Lc.process),eh=qd.left,th=Ou,nh=Zd;Ud({target:"Array",proto:!0,forced:!Xd("reduce")||!nh&&th>79&&th<83},{reduce:function(e){var t=arguments.length;return eh(this,e,t,t>1?arguments[1]:void 0)}});var rh=fu,ih=function(e){return rh[e+"Prototype"]},oh=ih("Array").reduce,sh=Nc,ah=oh,ch=Array.prototype,uh=function(e){var t=e.reduce;return e===ch||sh(ch,e)&&t===ch.reduce?ah:t},lh=uh,dh=Oi,hh=r.String,ph=function(e){if("Symbol"===dh(e))throw TypeError("Cannot convert a Symbol value to a string");return hh(e)},fh=Nt,Ah=function(){var e=fh(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t},Eh=o,gh=r.RegExp,_h=Eh((function(){var e=gh("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),mh=_h||Eh((function(){return!gh("a","y").sticky})),Ih={BROKEN_CARET:_h||Eh((function(){var e=gh("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:mh,UNSUPPORTED_Y:_h},Th={},Rh=ur,vh=lr,yh=Object.keys||function(e){return Rh(e,vh)},Sh=s,Ch=St,Oh=yt,bh=Nt,wh=B,Nh=yh;Th.f=Sh&&!Ch?Object.defineProperties:function(e,t){bh(e);for(var n,r=wh(t),i=Nh(t),o=i.length,s=0;o>s;)Oh.f(e,n=i[s++],r[n]);return e};var Dh,Lh=Nt,Ph=Th,kh=lr,xh=on,Mh=Fo,Uh=ht,Bh=rn("IE_PROTO"),Fh=function(){},Vh=function(e){return"<script>"+e+"<\/script>"},Gh=function(e){e.write(Vh("")),e.close();var t=e.parentWindow.Object;return e=null,t},Qh=function(){try{Dh=new ActiveXObject("htmlfile")}catch(e){}var e,t;Qh="undefined"!=typeof document?document.domain&&Dh?Gh(Dh):((t=Uh("iframe")).style.display="none",Mh.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(Vh("document.F=Object")),e.close(),e.F):Gh(Dh);for(var n=kh.length;n--;)delete Qh.prototype[kh[n]];return Qh()};xh[Bh]=!0;var jh=Object.create||function(e,t){var n;return null!==e?(Fh.prototype=Lh(e),n=new Fh,Fh.prototype=null,n[Bh]=e):n=Qh(),void 0===t?n:Ph.f(n,t)},Hh=o,Wh=r.RegExp,Yh=Hh((function(){var e=Wh(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),Kh=o,$h=r.RegExp,zh=Kh((function(){var e=$h("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),qh=l,Jh=v,Xh=ph,Zh=Ah,ep=Ih,tp=ve.exports,np=jh,rp=vn.get,ip=Yh,op=zh,sp=tp("native-string-replace",String.prototype.replace),ap=RegExp.prototype.exec,cp=ap,up=Jh("".charAt),lp=Jh("".indexOf),dp=Jh("".replace),hp=Jh("".slice),pp=function(){var e=/a/,t=/b*/g;return qh(ap,e,"a"),qh(ap,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),fp=ep.BROKEN_CARET,Ap=void 0!==/()??/.exec("")[1];(pp||Ap||fp||ip||op)&&(cp=function(e){var t,n,r,i,o,s,a,c=this,u=rp(c),l=Xh(e),d=u.raw;if(d)return d.lastIndex=c.lastIndex,t=qh(cp,d,l),c.lastIndex=d.lastIndex,t;var h=u.groups,p=fp&&c.sticky,f=qh(Zh,c),A=c.source,E=0,g=l;if(p&&(f=dp(f,"y",""),-1===lp(f,"g")&&(f+="g"),g=hp(l,c.lastIndex),c.lastIndex>0&&(!c.multiline||c.multiline&&"\n"!==up(l,c.lastIndex-1))&&(A="(?: "+A+")",g=" "+g,E++),n=new RegExp("^(?:"+A+")",f)),Ap&&(n=new RegExp("^"+A+"$(?!\\s)",f)),pp&&(r=c.lastIndex),i=qh(ap,p?n:c,g),p?i?(i.input=hp(i.input,E),i[0]=hp(i[0],E),i.index=c.lastIndex,c.lastIndex+=i[0].length):c.lastIndex=0:pp&&i&&(c.lastIndex=c.global?i.index+i[0].length:r),Ap&&i&&i.length>1&&qh(sp,i[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(i[o]=void 0)})),i&&h)for(i.groups=s=np(null),o=0;o<h.length;o++)s[(a=h[o])[0]]=i[a[1]];return i});var Ep=cp;Gr({target:"RegExp",proto:!0,forced:/./.exec!==Ep},{exec:Ep});var gp=jh,_p=yt,mp=Xe("unscopables"),Ip=Array.prototype;null==Ip[mp]&&_p.f(Ip,mp,{configurable:!0,value:gp(null)});var Tp,Rp,vp,yp=!o((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Sp=r,Cp=Me,Op=F,bp=Pe,wp=yp,Np=rn("IE_PROTO"),Dp=Sp.Object,Lp=Dp.prototype,Pp=wp?Dp.getPrototypeOf:function(e){var t=bp(e);if(Cp(t,Np))return t[Np];var n=t.constructor;return Op(n)&&t instanceof n?n.prototype:t instanceof Dp?Lp:null},kp=o,xp=F,Mp=Pp,Up=Qt.exports,Bp=Xe("iterator"),Fp=!1;[].keys&&("next"in(vp=[].keys())?(Rp=Mp(Mp(vp)))!==Object.prototype&&(Tp=Rp):Fp=!0),(null==Tp||kp((function(){var e={};return Tp[Bp].call(e)!==e})))&&(Tp={}),xp(Tp[Bp])||Up(Tp,Bp,(function(){return this}));var Vp={IteratorPrototype:Tp,BUGGY_SAFARI_ITERATORS:Fp},Gp=Vp.IteratorPrototype,Qp=jh,jp=g,Hp=ti,Wp=fi,Yp=function(){return this},Kp=Gr,$p=l,zp=wn,qp=F,Jp=Pp,Xp=Jr,Zp=ti,ef=Gt,tf=Qt.exports,nf=fi,rf=zp.PROPER,of=zp.CONFIGURABLE,sf=Vp.IteratorPrototype,af=Vp.BUGGY_SAFARI_ITERATORS,cf=Xe("iterator"),uf="keys",lf="values",df="entries",hf=function(){return this},pf=B,ff=function(e){Ip[mp][e]=!0},Af=fi,Ef=vn,gf=yt.f,_f=s,mf="Array Iterator",If=Ef.set,Tf=Ef.getterFor(mf),Rf=function(e,t,n,r,i,o,s){!function(e,t,n,r){var i=t+" Iterator";e.prototype=Qp(Gp,{next:jp(+!r,n)}),Hp(e,i,!1),Wp[i]=Yp}(n,t,r);var a,c,u,l=function(e){if(e===i&&A)return A;if(!af&&e in p)return p[e];switch(e){case uf:case lf:case df:return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",h=!1,p=e.prototype,f=p[cf]||p["@@iterator"]||i&&p[i],A=!af&&f||l(i),E="Array"==t&&p.entries||f;if(E&&(a=Jp(E.call(new e)))!==Object.prototype&&a.next&&(Jp(a)!==sf&&(Xp?Xp(a,sf):qp(a[cf])||tf(a,cf,hf)),Zp(a,d,!0)),rf&&i==lf&&f&&f.name!==lf&&(of?ef(p,"name",lf):(h=!0,A=function(){return $p(f,this)})),i)if(c={values:l(lf),keys:o?A:l(uf),entries:l(df)},s)for(u in c)(af||h||!(u in p))&&tf(p,u,c[u]);else Kp({target:t,proto:!0,forced:af||h},c);return p[cf]!==A&&tf(p,cf,A,{name:i}),nf[t]=A,c}(Array,"Array",(function(e,t){If(this,{type:mf,target:pf(e),index:0,kind:t})}),(function(){var e=Tf(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),vf=Af.Arguments=Af.Array;if(ff("keys"),ff("values"),ff("entries"),_f&&"values"!==vf.name)try{gf(vf,"name",{value:"values"})}catch(e){}var yf=ht("span").classList,Sf=yf&&yf.constructor&&yf.constructor.prototype,Cf=Sf===Object.prototype?void 0:Sf,Of=r,bf={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},wf=Cf,Nf=Rf,Df=Gt,Lf=Xe,Pf=Lf("iterator"),kf=Lf("toStringTag"),xf=Nf.values,Mf=function(e,t){if(e){if(e[Pf]!==xf)try{Df(e,Pf,xf)}catch(t){e[Pf]=xf}if(e[kf]||Df(e,kf,t),bf[t])for(var n in Nf)if(e[n]!==Nf[n])try{Df(e,n,Nf[n])}catch(t){e[n]=Nf[n]}}};for(var Uf in bf)Mf(Of[Uf]&&Of[Uf].prototype,Uf);Mf(wf,"DOMTokenList");var Bf=F,Ff=G,Vf=Jr,Gf=function(e,t,n){var r,i;return Vf&&Bf(r=t.constructor)&&r!==n&&Ff(i=r.prototype)&&i!==n.prototype&&Vf(e,i),e},Qf=ph,jf=function(e,t){return void 0===e?arguments.length<2?"":t:Qf(e)},Hf=G,Wf=Gt,Yf=v("".replace),Kf=String(Error("zxcasd").stack),$f=/\n\s*at [^:]*:[^\n]*/,zf=$f.test(Kf),qf=function(e,t){if(zf&&"string"==typeof e)for(;t--;)e=Yf(e,$f,"");return e},Jf=g,Xf=!o((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Jf(1,7)),7!==e.stack)})),Zf=W,eA=Me,tA=Gt,nA=Y,rA=Jr,iA=yr,oA=Gf,sA=jf,aA=function(e,t){Hf(t)&&"cause"in t&&Wf(e,"cause",t.cause)},cA=qf,uA=Xf,lA=Gr,dA=Bo,hA=function(e,t,n,r){var i=r?2:1,o=e.split("."),s=o[o.length-1],a=Zf.apply(null,o);if(a){var c=a.prototype;if(eA(c,"cause")&&delete c.cause,!n)return a;var u=Zf("Error"),l=t((function(e,t){var n=sA(r?t:e,void 0),o=r?new a(e):new a;return void 0!==n&&tA(o,"message",n),uA&&tA(o,"stack",cA(o.stack,2)),this&&nA(c,this)&&oA(o,this,l),arguments.length>i&&aA(o,arguments[i]),o}));l.prototype=c,"Error"!==s&&(rA?rA(l,u):iA(l,u,{name:!0})),iA(l,a);try{c.name!==s&&tA(c,"name",s),c.constructor=l}catch(e){}return l}},pA=r.WebAssembly,fA=7!==Error("e",{cause:7}).cause,AA=function(e,t){var n={};n[e]=hA(e,t,fA),lA({global:!0,forced:fA},n)},EA=function(e,t){if(pA&&pA[e]){var n={};n[e]=hA("WebAssembly."+e,t,fA),lA({target:"WebAssembly",stat:!0,forced:fA},n)}};AA("Error",(function(e){return function(t){return dA(e,this,arguments)}})),AA("EvalError",(function(e){return function(t){return dA(e,this,arguments)}})),AA("RangeError",(function(e){return function(t){return dA(e,this,arguments)}})),AA("ReferenceError",(function(e){return function(t){return dA(e,this,arguments)}})),AA("SyntaxError",(function(e){return function(t){return dA(e,this,arguments)}})),AA("TypeError",(function(e){return function(t){return dA(e,this,arguments)}})),AA("URIError",(function(e){return function(t){return dA(e,this,arguments)}})),EA("CompileError",(function(e){return function(t){return dA(e,this,arguments)}})),EA("LinkError",(function(e){return function(t){return dA(e,this,arguments)}})),EA("RuntimeError",(function(e){return function(t){return dA(e,this,arguments)}}));let gA=!0,_A=!0;function mA(e,t,n){const r=e.match(t);return r&&r.length>=n&&parseInt(r[n],10)}function IA(e,t,n){if(!e.RTCPeerConnection)return;const r=e.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(e,r){if(e!==t)return i.apply(this,arguments);const o=e=>{const t=n(e);t&&(r.handleEvent?r.handleEvent(t):r(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(r,o),i.apply(this,[e,o])};const o=r.removeEventListener;r.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const r=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,r])},Object.defineProperty(r,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function TA(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(gA=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function RA(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(_A=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function vA(){if("object"==typeof window){if(gA)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function yA(e,t){_A&&console.warn(e+" is deprecated, please use "+t+" instead.")}function SA(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.mozGetUserMedia)t.browser="firefox",t.version=mA(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=mA(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=mA(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=mA(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}function CA(e){return"[object Object]"===Object.prototype.toString.call(e)}function OA(e){var t;return CA(e)?lh(t=Object.keys(e)).call(t,(function(t,n){const r=CA(e[n]),i=r?OA(e[n]):e[n],o=r&&!Object.keys(i).length;return void 0===i||o?t:Object.assign(t,{[n]:i})}),{}):e}function bA(e,t,n){const r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((n=>{n.type===r&&n.trackId===t.id&&function e(t,n,r){n&&!r.has(n.id)&&(r.set(n.id,n),Object.keys(n).forEach((i=>{i.endsWith("Id")?e(t,t.get(n[i]),r):i.endsWith("Ids")&&n[i].forEach((n=>{e(t,t.get(n),r)}))})))}(e,n,i)}))})),i}var wA=qu.exports,NA=hl,DA=wA("keys"),LA=function(e){return DA[e]||(DA[e]=NA(e))},PA=!Rc((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),kA=Lc,xA=al,MA=Bc,UA=il,BA=PA,FA=LA("IE_PROTO"),VA=kA.Object,GA=VA.prototype,QA=BA?VA.getPrototypeOf:function(e){var t=UA(e);if(xA(t,FA))return t[FA];var n=t.constructor;return MA(n)&&t instanceof n?n.prototype:t instanceof VA?GA:null},jA=Lc,HA=Bc,WA=jA.String,YA=jA.TypeError,KA=wc,$A=fd,zA=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=KA(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return $A(n),function(e){if("object"==typeof e||HA(e))return e;throw YA("Can't set "+WA(e)+" as a prototype")}(r),t?e(n,r):n.__proto__=r,n}}():void 0),qA={},JA=Vd,XA=Math.max,ZA=Math.min,eE=function(e,t){var n=JA(e);return n<0?XA(n+t,0):ZA(n,t)},tE=du,nE=eE,rE=jd,iE=function(e){return function(t,n,r){var i,o=tE(t),s=rE(o),a=nE(r,s);if(e&&n!=n){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((e||a in o)&&o[a]===n)return e||a||0;return!e&&-1}},oE={includes:iE(!0),indexOf:iE(!1)},sE={},aE=al,cE=du,uE=oE.indexOf,lE=sE,dE=wc([].push),hE=function(e,t){var n,r=cE(e),i=0,o=[];for(n in r)!aE(lE,n)&&aE(r,n)&&dE(o,n);for(;t.length>i;)aE(r,n=t[i++])&&(~uE(o,n)||dE(o,n));return o},pE=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],fE=hE,AE=pE.concat("length","prototype");qA.f=Object.getOwnPropertyNames||function(e){return fE(e,AE)};var EE={};EE.f=Object.getOwnPropertySymbols;var gE=mu,_E=qA,mE=EE,IE=fd,TE=wc([].concat),RE=gE("Reflect","ownKeys")||function(e){var t=_E.f(IE(e)),n=mE.f;return n?TE(t,n(e)):t},vE=al,yE=RE,SE=Fc,CE=cd,OE={},bE=hE,wE=pE,NE=Object.keys||function(e){return bE(e,wE)},DE=Vc,LE=ud,PE=cd,kE=fd,xE=du,ME=NE;OE.f=DE&&!LE?Object.defineProperties:function(e,t){kE(e);for(var n,r=xE(t),i=ME(t),o=i.length,s=0;o>s;)PE.f(e,n=i[s++],r[n]);return e};var UE,BE=mu("document","documentElement"),FE=fd,VE=OE,GE=pE,QE=sE,jE=BE,HE=Ul,WE=LA("IE_PROTO"),YE=function(){},KE=function(e){return"<script>"+e+"<\/script>"},$E=function(e){e.write(KE("")),e.close();var t=e.parentWindow.Object;return e=null,t},zE=function(){try{UE=new ActiveXObject("htmlfile")}catch(e){}var e,t;zE="undefined"!=typeof document?document.domain&&UE?$E(UE):((t=HE("iframe")).style.display="none",jE.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(KE("document.F=Object")),e.close(),e.F):$E(UE);for(var n=GE.length;n--;)delete zE.prototype[GE[n]];return zE()};QE[WE]=!0;var qE=Object.create||function(e,t){var n;return null!==e?(YE.prototype=FE(e),n=new YE,YE.prototype=null,n[WE]=e):n=zE(),void 0===t?n:VE.f(n,t)},JE=wc("".replace),XE=String(Error("zxcasd").stack),ZE=/\n\s*at [^:]*:[^\n]*/,eg=ZE.test(XE),tg=pu,ng=Sd,rg={},ig=rg,og=vl("iterator"),sg=Array.prototype,ag=function(e){return void 0!==e&&(ig.Array===e||sg[og]===e)},cg={};cg[vl("toStringTag")]="z";var ug="[object z]"===String(cg),lg=Lc,dg=ug,hg=Bc,pg=eu,fg=vl("toStringTag"),Ag=lg.Object,Eg="Arguments"==pg(function(){return arguments}()),gg=dg?pg:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Ag(e),fg))?n:Eg?pg(t):"Object"==(r=pg(t))&&hg(t.callee)?"Arguments":r},_g=gg,mg=Wu,Ig=rg,Tg=vl("iterator"),Rg=function(e){if(null!=e)return mg(e,Tg)||mg(e,"@@iterator")||Ig[_g(e)]},vg=jc,yg=ju,Sg=fd,Cg=Fu,Og=Rg,bg=Lc.TypeError,wg=function(e,t){var n=arguments.length<2?Og(e):t;if(yg(n))return Sg(vg(n,e));throw bg(Cg(e)+" is not iterable")},Ng=jc,Dg=fd,Lg=Wu,Pg=function(e,t,n){var r,i;Dg(e);try{if(!(r=Lg(e,"return"))){if("throw"===t)throw n;return n}r=Ng(r,e)}catch(e){i=!0,r=e}if("throw"===t)throw n;if(i)throw r;return Dg(r),n},kg=ad,xg=jc,Mg=fd,Ug=Fu,Bg=ag,Fg=jd,Vg=Nc,Gg=wg,Qg=Rg,jg=Pg,Hg=Lc.TypeError,Wg=function(e,t){this.stopped=e,this.result=t},Yg=Wg.prototype,Kg=function(e,t,n){var r,i,o,s,a,c,u,l=n&&n.that,d=!(!n||!n.AS_ENTRIES),h=!(!n||!n.IS_ITERATOR),p=!(!n||!n.INTERRUPTED),f=kg(t,l),A=function(e){return r&&jg(r,"normal",e),new Wg(!0,e)},E=function(e){return d?(Mg(e),p?f(e[0],e[1],A):f(e[0],e[1])):p?f(e,A):f(e)};if(h)r=e;else{if(!(i=Qg(e)))throw Hg(Ug(e)+" is not iterable");if(Bg(i)){for(o=0,s=Fg(e);s>o;o++)if((a=E(e[o]))&&Vg(Yg,a))return a;return new Wg(!1)}r=Gg(e,i)}for(c=r.next;!(u=xg(c,r)).done;){try{a=E(u.value)}catch(e){jg(r,"throw",e)}if("object"==typeof a&&a&&Vg(Yg,a))return a}return new Wg(!1)},$g=gg,zg=Lc.String,qg=function(e){if("Symbol"===$g(e))throw TypeError("Cannot convert a Symbol value to a string");return zg(e)},Jg=qg,Xg=qc,Zg=!Rc((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Xg(1,7)),7!==e.stack)})),e_=Ud,t_=Lc,n_=Nc,r_=QA,i_=zA,o_=qE,s_=Sd,a_=qc,c_=function(e,t){if(eg&&"string"==typeof e)for(;t--;)e=JE(e,ZE,"");return e},u_=function(e,t){tg(t)&&"cause"in t&&ng(e,"cause",t.cause)},l_=Kg,d_=function(e,t){return void 0===e?arguments.length<2?"":t:Jg(e)},h_=Zg,p_=vl("toStringTag"),f_=t_.Error,A_=[].push,E_=function(e,t){var n,r=arguments.length>2?arguments[2]:void 0,i=n_(g_,this);i_?n=i_(new f_,i?r_(this):g_):(n=i?this:o_(g_),s_(n,p_,"Error")),void 0!==t&&s_(n,"message",d_(t)),h_&&s_(n,"stack",c_(n.stack,1)),u_(n,r);var o=[];return l_(e,A_,{that:o}),s_(n,"errors",o),n};i_?i_(E_,f_):function(e,t,n){for(var r=yE(t),i=CE.f,o=SE.f,s=0;s<r.length;s++){var a=r[s];vE(e,a)||n&&vE(n,a)||i(e,a,o(t,a))}}(E_,f_,{name:!0});var g_=E_.prototype=o_(f_.prototype,{constructor:a_(1,E_),message:a_(1,""),name:a_(1,"AggregateError")});e_({global:!0},{AggregateError:E_});var __=Bc,m_=el,I_=wc(Function.toString);__(m_.inspectSource)||(m_.inspectSource=function(e){return I_(e)});var T_,R_,v_,y_=m_.inspectSource,S_=Bc,C_=y_,O_=Lc.WeakMap,b_=S_(O_)&&/native code/.test(C_(O_)),w_=Lc,N_=wc,D_=pu,L_=Sd,P_=al,k_=el,x_=LA,M_=sE,U_="Object already initialized",B_=w_.TypeError,F_=w_.WeakMap;if(b_||k_.state){var V_=k_.state||(k_.state=new F_),G_=N_(V_.get),Q_=N_(V_.has),j_=N_(V_.set);T_=function(e,t){if(Q_(V_,e))throw new B_(U_);return t.facade=e,j_(V_,e,t),t},R_=function(e){return G_(V_,e)||{}},v_=function(e){return Q_(V_,e)}}else{var H_=x_("state");M_[H_]=!0,T_=function(e,t){if(P_(e,H_))throw new B_(U_);return t.facade=e,L_(e,H_,t),t},R_=function(e){return P_(e,H_)?e[H_]:{}},v_=function(e){return P_(e,H_)}}var W_,Y_,K_,$_={set:T_,get:R_,has:v_,enforce:function(e){return v_(e)?R_(e):T_(e,{})},getterFor:function(e){return function(t){var n;if(!D_(t)||(n=R_(t)).type!==e)throw B_("Incompatible receiver, "+e+" required");return n}}},z_=Vc,q_=al,J_=Function.prototype,X_=z_&&Object.getOwnPropertyDescriptor,Z_=q_(J_,"name"),em={EXISTS:Z_,PROPER:Z_&&"something"===function(){}.name,CONFIGURABLE:Z_&&(!z_||z_&&X_(J_,"name").configurable)},tm=Sd,nm=function(e,t,n,r){r&&r.enumerable?e[t]=n:tm(e,t,n)},rm=Rc,im=Bc,om=qE,sm=QA,am=nm,cm=vl("iterator"),um=!1;[].keys&&("next"in(K_=[].keys())?(Y_=sm(sm(K_)))!==Object.prototype&&(W_=Y_):um=!0);var lm=null==W_||rm((function(){var e={};return W_[cm].call(e)!==e}));im((W_=lm?{}:om(W_))[cm])||am(W_,cm,(function(){return this}));var dm={IteratorPrototype:W_,BUGGY_SAFARI_ITERATORS:um},hm=gg,pm=ug?{}.toString:function(){return"[object "+hm(this)+"]"},fm=ug,Am=cd.f,Em=Sd,gm=al,_m=pm,mm=vl("toStringTag"),Im=function(e,t,n,r){if(e){var i=n?e:e.prototype;gm(i,mm)||Am(i,mm,{configurable:!0,value:t}),r&&!fm&&Em(i,"toString",_m)}},Tm=dm.IteratorPrototype,Rm=qE,vm=qc,ym=Im,Sm=rg,Cm=function(){return this},Om=function(e,t,n,r){var i=t+" Iterator";return e.prototype=Rm(Tm,{next:vm(+!r,n)}),ym(e,i,!1,!0),Sm[i]=Cm,e},bm=Ud,wm=jc,Nm=Om,Dm=QA,Lm=Im,Pm=nm,km=rg,xm=em.PROPER,Mm=dm.BUGGY_SAFARI_ITERATORS,Um=vl("iterator"),Bm="keys",Fm="values",Vm="entries",Gm=function(){return this},Qm=function(e,t,n,r,i,o,s){Nm(n,t,r);var a,c,u,l=function(e){if(e===i&&A)return A;if(!Mm&&e in p)return p[e];switch(e){case Bm:case Fm:case Vm:return function(){return new n(this,e)}}return function(){return new n(this)}},d=t+" Iterator",h=!1,p=e.prototype,f=p[Um]||p["@@iterator"]||i&&p[i],A=!Mm&&f||l(i),E="Array"==t&&p.entries||f;if(E&&(a=Dm(E.call(new e)))!==Object.prototype&&a.next&&(Lm(a,d,!0,!0),km[d]=Gm),xm&&i==Fm&&f&&f.name!==Fm&&(h=!0,A=function(){return wm(f,this)}),i)if(c={values:l(Fm),keys:o?A:l(Bm),entries:l(Vm)},s)for(u in c)(Mm||h||!(u in p))&&Pm(p,u,c[u]);else bm({target:t,proto:!0,forced:Mm||h},c);return s&&p[Um]!==A&&Pm(p,Um,A,{name:i}),km[t]=A,c},jm=du,Hm=rg,Wm=$_;cd.f;var Ym=Qm,Km="Array Iterator",$m=Wm.set,zm=Wm.getterFor(Km);Ym(Array,"Array",(function(e,t){$m(this,{type:Km,target:jm(e),index:0,kind:t})}),(function(){var e=zm(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),Hm.Arguments=Hm.Array;var qm=Lc.Promise,Jm=nm,Xm=function(e,t,n){for(var r in t)n&&n.unsafe&&e[r]?e[r]=t[r]:Jm(e,r,t[r],n);return e},Zm=mu,eI=cd,tI=Vc,nI=vl("species"),rI=Nc,iI=Lc.TypeError,oI=function(e,t){if(rI(t,e))return e;throw iI("Incorrect invocation")},sI=vl("iterator"),aI=!1;try{var cI=0,uI={next:function(){return{done:!!cI++}},return:function(){aI=!0}};uI[sI]=function(){return this},Array.from(uI,(function(){throw 2}))}catch(e){}var lI=wc,dI=Rc,hI=Bc,pI=gg,fI=y_,AI=function(){},EI=[],gI=mu("Reflect","construct"),_I=/^\s*(?:class|function)\b/,mI=lI(_I.exec),II=!_I.exec(AI),TI=function(e){if(!hI(e))return!1;try{return gI(AI,EI,e),!0}catch(e){return!1}},RI=function(e){if(!hI(e))return!1;switch(pI(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return II||!!mI(_I,fI(e))}catch(e){return!0}};RI.sham=!0;var vI,yI,SI,CI,OI=!gI||dI((function(){var e;return TI(TI.call)||!TI(Object)||!TI((function(){e=!0}))||e}))?RI:TI,bI=OI,wI=Fu,NI=Lc.TypeError,DI=fd,LI=vl("species"),PI=function(e,t){var n,r=DI(e).constructor;return void 0===r||null==(n=DI(r)[LI])?t:function(e){if(bI(e))return e;throw NI(wI(e)+" is not a constructor")}(n)},kI=wc([].slice),xI=/(?:ipad|iphone|ipod).*applewebkit/i.test(Iu),MI=Lc,UI=Uc,BI=ad,FI=Bc,VI=al,GI=Rc,QI=BE,jI=kI,HI=Ul,WI=xI,YI=Zd,KI=MI.setImmediate,$I=MI.clearImmediate,zI=MI.process,qI=MI.Dispatch,JI=MI.Function,XI=MI.MessageChannel,ZI=MI.String,eT=0,tT={};try{vI=MI.location}catch(e){}var nT=function(e){if(VI(tT,e)){var t=tT[e];delete tT[e],t()}},rT=function(e){return function(){nT(e)}},iT=function(e){nT(e.data)},oT=function(e){MI.postMessage(ZI(e),vI.protocol+"//"+vI.host)};KI&&$I||(KI=function(e){var t=jI(arguments,1);return tT[++eT]=function(){UI(FI(e)?e:JI(e),void 0,t)},yI(eT),eT},$I=function(e){delete tT[e]},YI?yI=function(e){zI.nextTick(rT(e))}:qI&&qI.now?yI=function(e){qI.now(rT(e))}:XI&&!WI?(CI=(SI=new XI).port2,SI.port1.onmessage=iT,yI=BI(CI.postMessage,CI)):MI.addEventListener&&FI(MI.postMessage)&&!MI.importScripts&&vI&&"file:"!==vI.protocol&&!GI(oT)?(yI=oT,MI.addEventListener("message",iT,!1)):yI="onreadystatechange"in HI("script")?function(e){QI.appendChild(HI("script")).onreadystatechange=function(){QI.removeChild(this),nT(e)}}:function(e){setTimeout(rT(e),0)});var sT,aT,cT,uT,lT,dT,hT,pT,fT={set:KI,clear:$I},AT=Lc,ET=/ipad|iphone|ipod/i.test(Iu)&&void 0!==AT.Pebble,gT=/web0s(?!.*chrome)/i.test(Iu),_T=Lc,mT=ad,IT=Fc.f,TT=fT.set,RT=xI,vT=ET,yT=gT,ST=Zd,CT=_T.MutationObserver||_T.WebKitMutationObserver,OT=_T.document,bT=_T.process,wT=_T.Promise,NT=IT(_T,"queueMicrotask"),DT=NT&&NT.value;DT||(sT=function(){var e,t;for(ST&&(e=bT.domain)&&e.exit();aT;){t=aT.fn,aT=aT.next;try{t()}catch(e){throw aT?uT():cT=void 0,e}}cT=void 0,e&&e.enter()},RT||ST||yT||!CT||!OT?!vT&&wT&&wT.resolve?((hT=wT.resolve(void 0)).constructor=wT,pT=mT(hT.then,hT),uT=function(){pT(sT)}):ST?uT=function(){bT.nextTick(sT)}:(TT=mT(TT,_T),uT=function(){TT(sT)}):(lT=!0,dT=OT.createTextNode(""),new CT(sT).observe(dT,{characterData:!0}),uT=function(){dT.data=lT=!lT}));var LT=DT||function(e){var t={fn:e,next:void 0};cT&&(cT.next=t),aT||(aT=t,uT()),cT=t},PT={},kT=ju,xT=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=kT(t),this.reject=kT(n)};PT.f=function(e){return new xT(e)};var MT=fd,UT=pu,BT=PT,FT=function(e,t){if(MT(e),UT(t)&&t.constructor===e)return t;var n=BT.f(e);return(0,n.resolve)(t),n.promise},VT=Lc,GT=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},QT=function(){this.head=null,this.tail=null};QT.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var jT,HT,WT,YT="object"==typeof window,KT=Ud,$T=Lc,zT=mu,qT=jc,JT=qm,XT=Xm,ZT=Im,eR=ju,tR=Bc,nR=pu,rR=oI,iR=y_,oR=Kg,sR=PI,aR=fT.set,cR=LT,uR=FT,lR=PT,dR=GT,hR=QT,pR=$_,fR=rd,AR=YT,ER=Zd,gR=Ou,_R=vl("species"),mR="Promise",IR=pR.getterFor(mR),TR=pR.set,RR=pR.getterFor(mR),vR=JT&&JT.prototype,yR=JT,SR=vR,CR=$T.TypeError,OR=$T.document,bR=$T.process,wR=lR.f,NR=wR,DR=!!(OR&&OR.createEvent&&$T.dispatchEvent),LR=tR($T.PromiseRejectionEvent),PR="unhandledrejection",kR=fR(mR,(function(){var e=iR(yR),t=e!==String(yR);if(!t&&66===gR)return!0;if(!SR.finally)return!0;if(gR>=51&&/native code/.test(e))return!1;var n=new yR((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[_R]=r,!(n.then((function(){}))instanceof r)||!t&&AR&&!LR})),xR=kR||!function(e,t){if(!t&&!aI)return!1;var n=!1;try{var r={};r[sI]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}((function(e){yR.all(e).catch((function(){}))})),MR=function(e){var t;return!(!nR(e)||!tR(t=e.then))&&t},UR=function(e,t){var n,r,i,o=t.value,s=1==t.state,a=s?e.ok:e.fail,c=e.resolve,u=e.reject,l=e.domain;try{a?(s||(2===t.rejection&&QR(t),t.rejection=1),!0===a?n=o:(l&&l.enter(),n=a(o),l&&(l.exit(),i=!0)),n===e.promise?u(CR("Promise-chain cycle")):(r=MR(n))?qT(r,n,c,u):c(n)):u(o)}catch(e){l&&!i&&l.exit(),u(e)}},BR=function(e,t){e.notified||(e.notified=!0,cR((function(){for(var n,r=e.reactions;n=r.get();)UR(n,e);e.notified=!1,t&&!e.rejection&&VR(e)})))},FR=function(e,t,n){var r,i;DR?((r=OR.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),$T.dispatchEvent(r)):r={promise:t,reason:n},!LR&&(i=$T["on"+e])?i(r):e===PR&&function(e,t){var n=VT.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},VR=function(e){qT(aR,$T,(function(){var t,n=e.facade,r=e.value;if(GR(e)&&(t=dR((function(){ER?bR.emit("unhandledRejection",r,n):FR(PR,n,r)})),e.rejection=ER||GR(e)?2:1,t.error))throw t.value}))},GR=function(e){return 1!==e.rejection&&!e.parent},QR=function(e){qT(aR,$T,(function(){var t=e.facade;ER?bR.emit("rejectionHandled",t):FR("rejectionhandled",t,e.value)}))},jR=function(e,t,n){return function(r){e(t,r,n)}},HR=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,BR(e,!0))},WR=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw CR("Promise can't be resolved itself");var r=MR(t);r?cR((function(){var n={done:!1};try{qT(r,t,jR(WR,n,e),jR(HR,n,e))}catch(t){HR(n,t,e)}})):(e.value=t,e.state=1,BR(e,!1))}catch(t){HR({done:!1},t,e)}}};kR&&(SR=(yR=function(e){rR(this,SR),eR(e),qT(jT,this);var t=IR(this);try{e(jR(WR,t),jR(HR,t))}catch(e){HR(t,e)}}).prototype,(jT=function(e){TR(this,{type:mR,done:!1,notified:!1,parent:!1,reactions:new hR,rejection:!1,state:0,value:void 0})}).prototype=XT(SR,{then:function(e,t){var n=RR(this),r=wR(sR(this,yR));return n.parent=!0,r.ok=!tR(e)||e,r.fail=tR(t)&&t,r.domain=ER?bR.domain:void 0,0==n.state?n.reactions.add(r):cR((function(){UR(r,n)})),r.promise},catch:function(e){return this.then(void 0,e)}}),HT=function(){var e=new jT,t=IR(e);this.promise=e,this.resolve=jR(WR,t),this.reject=jR(HR,t)},lR.f=wR=function(e){return e===yR||e===WT?new HT(e):NR(e)}),KT({global:!0,wrap:!0,forced:kR},{Promise:yR}),ZT(yR,mR,!1,!0),function(e){var t=Zm(e),n=eI.f;tI&&t&&!t[nI]&&n(t,nI,{configurable:!0,get:function(){return this}})}(mR),WT=zT(mR),KT({target:mR,stat:!0,forced:kR},{reject:function(e){var t=wR(this);return qT(t.reject,void 0,e),t.promise}}),KT({target:mR,stat:!0,forced:!0},{resolve:function(e){return uR(this===WT?yR:this,e)}}),KT({target:mR,stat:!0,forced:xR},{all:function(e){var t=this,n=wR(t),r=n.resolve,i=n.reject,o=dR((function(){var n=eR(t.resolve),o=[],s=0,a=1;oR(e,(function(e){var c=s++,u=!1;a++,qT(n,t,e).then((function(e){u||(u=!0,o[c]=e,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=wR(t),r=n.reject,i=dR((function(){var i=eR(t.resolve);oR(e,(function(e){qT(i,t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}});var YR=jc,KR=ju,$R=PT,zR=GT,qR=Kg;Ud({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=$R.f(t),r=n.resolve,i=n.reject,o=zR((function(){var n=KR(t.resolve),i=[],o=0,s=1;qR(e,(function(e){var a=o++,c=!1;s++,YR(n,t,e).then((function(e){c||(c=!0,i[a]={status:"fulfilled",value:e},--s||r(i))}),(function(e){c||(c=!0,i[a]={status:"rejected",reason:e},--s||r(i))}))})),--s||r(i)}));return o.error&&i(o.value),n.promise}});var JR=ju,XR=mu,ZR=jc,ev=PT,tv=GT,nv=Kg,rv="No one promise resolved";Ud({target:"Promise",stat:!0},{any:function(e){var t=this,n=XR("AggregateError"),r=ev.f(t),i=r.resolve,o=r.reject,s=tv((function(){var r=JR(t.resolve),s=[],a=0,c=1,u=!1;nv(e,(function(e){var l=a++,d=!1;c++,ZR(r,t,e).then((function(e){d||u||(u=!0,i(e))}),(function(e){d||u||(d=!0,s[l]=e,--c||o(new n(s,rv)))}))})),--c||o(new n(s,rv))}));return s.error&&o(s.value),r.promise}});var iv=qm,ov=mu,sv=Bc,av=PI,cv=FT;Ud({target:"Promise",proto:!0,real:!0,forced:!!iv&&Rc((function(){iv.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=av(this,ov("Promise")),n=sv(e);return this.then(n?function(n){return cv(t,e()).then((function(){return n}))}:e,n?function(n){return cv(t,e()).then((function(){throw n}))}:e)}});var uv=wc,lv=Vd,dv=qg,hv=cu,pv=uv("".charAt),fv=uv("".charCodeAt),Av=uv("".slice),Ev=function(e){return function(t,n){var r,i,o=dv(hv(t)),s=lv(n),a=o.length;return s<0||s>=a?e?"":void 0:(r=fv(o,s))<55296||r>56319||s+1===a||(i=fv(o,s+1))<56320||i>57343?e?pv(o,s):r:e?Av(o,s,s+2):i-56320+(r-55296<<10)+65536}},gv={codeAt:Ev(!1),charAt:Ev(!0)},_v=gv.charAt,mv=qg,Iv=$_,Tv=Qm,Rv="String Iterator",vv=Iv.set,yv=Iv.getterFor(Rv);Tv(String,"String",(function(e){vv(this,{type:Rv,string:mv(e),index:0})}),(function(){var e,t=yv(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=_v(n,r),t.index+=e.length,{value:e,done:!1})}));var Sv=fu.Promise,Cv=Lc,Ov=gg,bv=Sd,wv=rg,Nv=vl("toStringTag");for(var Dv in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var Lv=Cv[Dv],Pv=Lv&&Lv.prototype;Pv&&Ov(Pv)!==Nv&&bv(Pv,Nv,Dv),wv[Dv]=wv.Array}var kv=Sv,xv=kv,Mv=Qo,Uv=s,Bv=o,Fv=Nt,Vv=jh,Gv=jf,Qv=Error.prototype.toString,jv=Bv((function(){if(Uv){var e=Vv(Object.defineProperty({},"name",{get:function(){return this===e}}));if("true"!==Qv.call(e))return!0}return"2: 1"!==Qv.call({message:1,name:2})||"Error"!==Qv.call({})}))?function(){var e=Fv(this),t=Gv(e.name,"Error"),n=Gv(e.message);return t?n?t+": "+n:t:n}:Qv,Hv={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},Wv=Gr,Yv=W,Kv=o,$v=jh,zv=g,qv=yt.f,Jv=Th.f,Xv=Qt.exports,Zv=Me,ey=ui,ty=Nt,ny=jv,ry=jf,iy=Hv,oy=qf,sy=vn,ay=s,cy="DOMException",uy=Yv("Error"),ly=Yv(cy)||function(){try{(new(Yv("MessageChannel")||function(e){try{if(Mv)return Function('return require("'+e+'")')()}catch(e){}}("worker_threads").MessageChannel)).port1.postMessage(new WeakMap)}catch(e){if("DATA_CLONE_ERR"==e.name&&25==e.code)return e.constructor}}(),dy=ly&&ly.prototype,hy=uy.prototype,py=sy.set,fy=sy.getterFor(cy),Ay="stack"in uy(cy),Ey=function(e){return Zv(iy,e)&&iy[e].m?iy[e].c:0},gy=function(){ey(this,_y);var e=arguments.length,t=ry(e<1?void 0:arguments[0]),n=ry(e<2?void 0:arguments[1],"Error"),r=Ey(n);if(py(this,{type:cy,name:n,message:t,code:r}),ay||(this.name=n,this.message=t,this.code=r),Ay){var i=uy(t);i.name=cy,qv(this,"stack",zv(1,oy(i.stack,1)))}},_y=gy.prototype=$v(hy),my=function(e){return{enumerable:!0,configurable:!0,get:e}},Iy=function(e){return my((function(){return fy(this)[e]}))};ay&&Jv(_y,{name:Iy("name"),message:Iy("message"),code:Iy("code")}),qv(_y,"constructor",zv(1,gy));var Ty=Kv((function(){return!(new ly instanceof uy)})),Ry=Ty||Kv((function(){return hy.toString!==ny||"2: 1"!==String(new ly(1,2))})),vy=Ty||Kv((function(){return 25!==new ly(1,"DataCloneError").code}));Ty||25!==ly.DATA_CLONE_ERR||dy.DATA_CLONE_ERR,Wv({global:!0,forced:Ty},{DOMException:Ty?gy:ly});var yy=Yv(cy),Sy=yy.prototype;for(var Cy in Ry&&ly===yy&&Xv(Sy,"toString",ny),vy&&ay&&ly===yy&&qv(Sy,"code",my((function(){return Ey(ty(this).name)}))),iy)if(Zv(iy,Cy)){var Oy=iy[Cy],by=Oy.s,wy=zv(6,Oy.c);Zv(yy,by)||qv(yy,by,wy),Zv(Sy,by)||qv(Sy,by,wy)}var Ny=Gr,Dy=W,Ly=g,Py=yt.f,ky=Me,xy=ui,My=Gf,Uy=jf,By=Hv,Fy=qf,Vy="DOMException",Gy=Dy("Error"),Qy=Dy(Vy),jy=function(){xy(this,Hy);var e=arguments.length,t=Uy(e<1?void 0:arguments[0]),n=Uy(e<2?void 0:arguments[1],"Error"),r=new Qy(t,n),i=Gy(t);return i.name=Vy,Py(r,"stack",Ly(1,Fy(i.stack,1))),My(r,this,jy),r},Hy=jy.prototype=Qy.prototype,Wy="stack"in Gy(Vy),Yy="stack"in new Qy(1,2),Ky=Wy&&!Yy;Ny({global:!0,forced:Ky},{DOMException:Ky?jy:Qy});var $y=Dy(Vy),zy=$y.prototype;if(zy.constructor!==$y)for(var qy in Py(zy,"constructor",Ly(1,$y)),By)if(ky(By,qy)){var Jy=By[qy],Xy=Jy.s;ky($y,Xy)||Py($y,Xy,Ly(6,Jy.c))}var Zy="DOMException";ti(W(Zy),Zy);var eS=v,tS=Qt.exports,nS=Ep,rS=o,iS=Xe,oS=Gt,sS=iS("species"),aS=RegExp.prototype,cS=v,uS=jn,lS=ph,dS=x,hS=cS("".charAt),pS=cS("".charCodeAt),fS=cS("".slice),AS=function(e){return function(t,n){var r,i,o=lS(dS(t)),s=uS(n),a=o.length;return s<0||s>=a?e?"":void 0:(r=pS(o,s))<55296||r>56319||s+1===a||(i=pS(o,s+1))<56320||i>57343?e?hS(o,s):r:e?fS(o,s,s+2):i-56320+(r-55296<<10)+65536}},ES=(AS(!1),AS(!0)),gS=v,_S=Pe,mS=Math.floor,IS=gS("".charAt),TS=gS("".replace),RS=gS("".slice),vS=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,yS=/\$([$&'`]|\d{1,2})/g,SS=l,CS=Nt,OS=F,bS=O,wS=Ep,NS=r.TypeError,DS=Bo,LS=l,PS=v,kS=o,xS=Nt,MS=F,US=jn,BS=qn,FS=ph,VS=x,GS=function(e,t,n){return t+(n?ES(e,t).length:1)},QS=_e,jS=function(e,t,n,r,i,o){var s=n+e.length,a=r.length,c=yS;return void 0!==i&&(i=_S(i),c=vS),TS(o,c,(function(o,c){var u;switch(IS(c,0)){case"$":return"$";case"&":return e;case"`":return RS(t,0,n);case"'":return RS(t,s);case"<":u=i[RS(c,1,-1)];break;default:var l=+c;if(0===l)return o;if(l>a){var d=mS(l/10);return 0===d?o:d<=a?void 0===r[d-1]?IS(c,1):r[d-1]+IS(c,1):o}u=r[l-1]}return void 0===u?"":u}))},HS=function(e,t){var n=e.exec;if(OS(n)){var r=SS(n,e,t);return null!==r&&CS(r),r}if("RegExp"===bS(e))return SS(wS,e,t);throw NS("RegExp#exec called on incompatible receiver")},WS=Xe("replace"),YS=Math.max,KS=Math.min,$S=PS([].concat),zS=PS([].push),qS=PS("".indexOf),JS=PS("".slice),XS="$0"==="a".replace(/./,"$0"),ZS=!!/./[WS]&&""===/./[WS]("a","$0");!function(e,t,n,r){var i=iS(e),o=!rS((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),s=o&&!rS((function(){var t=!1,n=/a/;return"split"===e&&((n={}).constructor={},n.constructor[sS]=function(){return n},n.flags="",n[i]=/./[i]),n.exec=function(){return t=!0,null},n[i](""),!t}));if(!o||!s||n){var a=eS(/./[i]),c=t(i,""[e],(function(e,t,n,r,i){var s=eS(e),c=t.exec;return c===nS||c===aS.exec?o&&!i?{done:!0,value:a(t,n,r)}:{done:!0,value:s(n,t,r)}:{done:!1}}));tS(String.prototype,e,c[0]),tS(aS,i,c[1])}r&&oS(aS[i],"sham",!0)}("replace",(function(e,t,n){var r=ZS?"$":"$0";return[function(e,n){var r=VS(this),i=null==e?void 0:QS(e,WS);return i?LS(i,e,r,n):LS(t,FS(r),e,n)},function(e,i){var o=xS(this),s=FS(e);if("string"==typeof i&&-1===qS(i,r)&&-1===qS(i,"$<")){var a=n(t,o,s,i);if(a.done)return a.value}var c=MS(i);c||(i=FS(i));var u=o.global;if(u){var l=o.unicode;o.lastIndex=0}for(var d=[];;){var h=HS(o,s);if(null===h)break;if(zS(d,h),!u)break;""===FS(h[0])&&(o.lastIndex=GS(s,BS(o.lastIndex),l))}for(var p,f="",A=0,E=0;E<d.length;E++){for(var g=FS((h=d[E])[0]),_=YS(KS(US(h.index),s.length),0),m=[],I=1;I<h.length;I++)zS(m,void 0===(p=h[I])?p:String(p));var T=h.groups;if(c){var R=$S([g],m,_,s);void 0!==T&&zS(R,T);var v=FS(DS(i,void 0,R))}else v=jS(g,s,_,m,T,i);_>=A&&(f+=JS(s,A,_)+v,A=_+g.length)}return f+JS(s,A)}]}),!!kS((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!XS||ZS);var eC=G,tC=O,nC=Xe("match"),rC=s,iC=r,oC=v,sC=Pr,aC=Gf,cC=Gt,uC=yt.f,lC=Vn.f,dC=Y,hC=ph,pC=Ah,fC=Ih,AC=Qt.exports,EC=o,gC=Me,_C=vn.enforce,mC=si,IC=Yh,TC=zh,RC=Xe("match"),vC=iC.RegExp,yC=vC.prototype,SC=iC.SyntaxError,CC=oC(pC),OC=oC(yC.exec),bC=oC("".charAt),wC=oC("".replace),NC=oC("".indexOf),DC=oC("".slice),LC=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,PC=/a/g,kC=/a/g,xC=new vC(PC)!==PC,MC=fC.MISSED_STICKY,UC=fC.UNSUPPORTED_Y;if(sC("RegExp",rC&&(!xC||MC||IC||TC||EC((function(){return kC[RC]=!1,vC(PC)!=PC||vC(kC)==kC||"/a/i"!=vC(PC,"i")}))))){for(var BC=function(e,t){var n,r,i,o,s,a,c=dC(yC,this),u=function(e){var t;return eC(e)&&(void 0!==(t=e[nC])?!!t:"RegExp"==tC(e))}(e),l=void 0===t,d=[],h=e;if(!c&&u&&l&&e.constructor===BC)return e;if((u||dC(yC,e))&&(e=e.source,l&&(t="flags"in h?h.flags:CC(h))),e=void 0===e?"":hC(e),t=void 0===t?"":hC(t),h=e,IC&&"dotAll"in PC&&(r=!!t&&NC(t,"s")>-1)&&(t=wC(t,/s/g,"")),n=t,MC&&"sticky"in PC&&(i=!!t&&NC(t,"y")>-1)&&UC&&(t=wC(t,/y/g,"")),TC&&(e=(o=function(e){for(var t,n=e.length,r=0,i="",o=[],s={},a=!1,c=!1,u=0,l="";r<=n;r++){if("\\"===(t=bC(e,r)))t+=bC(e,++r);else if("]"===t)a=!1;else if(!a)switch(!0){case"["===t:a=!0;break;case"("===t:OC(LC,DC(e,r+1))&&(r+=2,c=!0),i+=t,u++;continue;case">"===t&&c:if(""===l||gC(s,l))throw new SC("Invalid capture group name");s[l]=!0,o[o.length]=[l,u],c=!1,l="";continue}c?l+=t:i+=t}return[i,o]}(e))[0],d=o[1]),s=aC(vC(e,t),c?this:yC,BC),(r||i||d.length)&&(a=_C(s),r&&(a.dotAll=!0,a.raw=BC(function(e){for(var t,n=e.length,r=0,i="",o=!1;r<=n;r++)"\\"!==(t=bC(e,r))?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),i+=t):i+="[\\s\\S]":i+=t+bC(e,++r);return i}(e),n)),i&&(a.sticky=!0),d.length&&(a.groups=d)),e!==h)try{cC(s,"source",""===h?"(?:)":h)}catch(e){}return s},FC=function(e){e in BC||uC(BC,e,{configurable:!0,get:function(){return vC[e]},set:function(t){vC[e]=t}})},VC=lC(vC),GC=0;VC.length>GC;)FC(VC[GC++]);yC.constructor=BC,BC.prototype=yC,AC(iC,"RegExp",BC)}mC("RegExp");var QC=r,jC=s,HC=Yh,WC=O,YC=yt.f,KC=vn.get,$C=RegExp.prototype,zC=QC.TypeError;jC&&HC&&YC($C,"dotAll",{configurable:!0,get:function(){if(this!==$C){if("RegExp"===WC(this))return!!KC(this).dotAll;throw zC("Incompatible receiver, RegExp required")}}});const qC=vA;function JC(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const r=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const r="object"==typeof e[n]?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);const i=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];let e={};"number"==typeof r.ideal?(e[i("min",n)]=r.ideal,t.optional.push(e),e={},e[i("max",n)]=r.ideal,t.optional.push(e)):(e[i("",n)]=r.ideal,t.optional.push(e))}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[i("",n)]=r.exact):["min","max"].forEach((e=>{void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[i(e,n)]=r[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},i=function(e,i){if(t.version>=61)return i(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then((n=>{let s=(n=n.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!s&&n.length&&t.includes("back")&&(s=n[n.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=r(e.video),qC("chrome: "+JSON.stringify(e)),i(e)}))}e.video=r(e.video)}return qC("chrome: "+JSON.stringify(e)),i(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,r){i(e,(e=>{n.webkitGetUserMedia(e,t,(e=>{r&&r(o(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return i(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>xv.reject(o(e))))))}}}function XC(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function ZC(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.track.id)):{track:n.track};const i=new Event("track");i.track=n.track,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)})),t.stream.getTracks().forEach((n=>{let r;r=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===n.id)):{track:n};const i=new Event("track");i.track=n,i.receiver=r,i.transceiver={receiver:r},i.streams=[t.stream],this.dispatchEvent(i)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else IA(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function eO(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){let i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],r.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function tO(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,n,r]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const i=function(e){const t={};return e.result().forEach((e=>{const n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{n[t]=e.stat(t)})),t[n.id]=n})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const r=function(e){n(o(i(e)))};return t.apply(this,[r,e])}return new xv(((e,n)=>{t.apply(this,[function(t){e(o(i(t)))},n])})).then(n,r)}}function nO(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>bA(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),IA(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>bA(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,r;return this.getSenders().forEach((n=>{n.track===e&&(t?r=!0:t=n)})),this.getReceivers().forEach((t=>(t.track===e&&(n?r=!0:n=t),t.track===e))),r||t&&n?xv.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():xv.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function rO(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();n.apply(this,arguments);const r=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(r)};const r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),i.apply(this,arguments)}}function iO(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return rO(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}r.apply(this,[t])};const i=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(i.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function s(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const r=e._reverseStreams[t],i=e._streams[r.id];n=n.replace(new RegExp(r.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const r=[].slice.call(arguments,1);if(1!==r.length||!r[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");const i=this.getSenders().find((e=>e.track===t));if(i)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const o=this._streams[n.id];if(o)o.addTrack(t),xv.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const r=new e.MediaStream([t]);this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=r[t]}));const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=s(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=c.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((n=>{this._streams[n].getTracks().find((t=>e.track===t))&&(t=this._streams[n])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function oO(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}))}function sO(e,t){IA(e,"negotiationneeded",(e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))}var aO=Object.freeze({__proto__:null,shimMediaStream:XC,shimOnTrack:ZC,shimGetSendersWithDtmf:eO,shimGetStats:tO,shimSenderReceiverGetStats:nO,shimAddTrackRemoveTrackWithNative:rO,shimAddTrackRemoveTrack:iO,shimPeerConnection:oO,fixNegotiationNeeded:sO,shimGetUserMedia:JC,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((t=>{const r=n.video&&n.video.width,i=n.video&&n.video.height,o=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),cO={exports:{}};!function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++)n[(t=r[i].trim().split("="))[0].trim()]=t[1];return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.getIceParameters=function(e,n){var r=t.splitLines(e);return{usernameFragment:(r=r.concat(t.splitLines(n))).filter((function(e){return 0===e.indexOf("a=ice-ufrag:")}))[0].substr(12),password:r.filter((function(e){return 0===e.indexOf("a=ice-pwd:")}))[0].substr(10)}},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var o=r[i],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));var i=0;return n.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),r+="a=rtcp-mux\r\n",n.headerExtensions&&n.headerExtensions.forEach((function(e){r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){var n,r=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,u=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(n=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),r.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&c&&r.push({ssrc:c});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=l}))),r},t.parseRtcpParameters=function(e){var n={},r=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.parseMsid=function(e){var n,r=t.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(n=r[0].substr(7).split(" "))[0],track:n[1]};var i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(n=i[0].value.split(" "))[0],track:n[1]}:void 0},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){var i=void 0!==n?n:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,n,r,i){var o=t.writeRtpDescription(e.kind,n);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,n){for(var r=t.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),r=0;r<n.length;r++)if(n[r].length<2||"="!==n[r].charAt(1))return!1;return!0},e.exports=t}(cO);var uO=cO.exports;function lO(e,t,n,r,i){var o=uO.writeRtpDescription(e.kind,t);if(o+=uO.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=uO.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":i||"active"),o+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=s;var a="msid:"+(r?r.id:"-")+" "+s+"\r\n";o+="a="+a,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+a,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+a,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+uO.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+uO.localCName+"\r\n"),o}function dO(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){var o=r(e.parameters.apt,n),s=r(t.parameters.apt,i);return o&&s&&o.name.toLowerCase()===s.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var s=t.codecs[o];if(r.name.toLowerCase()===s.name.toLowerCase()&&r.clockRate===s.clockRate){if("rtx"===r.name.toLowerCase()&&r.parameters&&s.parameters.apt&&!i(r,s,e.codecs,t.codecs))continue;(s=JSON.parse(JSON.stringify(s))).numChannels=Math.min(r.numChannels,s.numChannels),n.codecs.push(s),s.rtcpFeedback=s.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function hO(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function pO(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function fO(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}function AO(e){const t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((e=>xv.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString(){return this.name}}}(e))))}}function EO(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)))}function gO(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),t.version<15025)){const t=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set(e){t.set.call(this,e);const n=new Event("enabled");n.enabled=e,this.dispatchEvent(n)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);const n=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function r(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var i=function(n){var r=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){r[e]=i[e].bind(i)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw fO("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var o=n.iceCandidatePoolSize;o>0;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=uO.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},i.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,r={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)r.iceTransport=this.transceivers[0].iceTransport,r.dtlsTransport=this.transceivers[0].dtlsTransport;else{var i=this._createIceAndDtlsTransports();r.iceTransport=i.iceTransport,r.dtlsTransport=i.dtlsTransport}return t||this.transceivers.push(r),r},i.prototype.addTrack=function(t,n){if(this._isClosed)throw fO("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw fO("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},i.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},i.prototype.removeTrack=function(t){if(this._isClosed)throw fO("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw fO("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&this.localStreams.indexOf(r)>-1&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},i.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},i.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},i.prototype._createIceGatherer=function(t,n){var r=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},i.prototype._gather=function(t,n){var r=this,i=this.transceivers[n].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),i.onlocalcandidate=function(e){if(!(r.usingBundle&&n>0)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:n};var s=e.candidate,a=!s||0===Object.keys(s).length;if(a)"new"!==i.state&&"gathering"!==i.state||(i.state="completed");else{"new"===i.state&&(i.state="gathering"),s.component=1,s.ufrag=i.getLocalParameters().usernameFragment;var c=uO.writeCandidate(s);o.candidate=Object.assign(o.candidate,uO.parseCandidate(c)),o.candidate.candidate=c,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}}var u=uO.getMediaSections(r._localDescription.sdp);u[o.candidate.sdpMLineIndex]+=a?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",r._localDescription.sdp=uO.getDescription(r._localDescription.sdp)+u.join("");var l=r.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==r.iceGatheringState&&(r.iceGatheringState="gathering",r._emitGatheringStateChange()),a||r._dispatchEvent("icecandidate",o),l&&(r._dispatchEvent("icecandidate",new Event("icecandidate")),r.iceGatheringState="complete",r._emitGatheringStateChange())}},e.setTimeout((function(){o.forEach((function(e){i.onlocalcandidate(e)}))}),0)}},i.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},i.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var r=this.transceivers[e].dtlsTransport;r&&(delete r.ondtlsstatechange,delete r.onerror,delete this.transceivers[e].dtlsTransport)},i.prototype._transceive=function(e,n,r){var i=dO(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:uO.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),r&&e.rtpReceiver&&i.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?i.encodings=e.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},i.prototype.setLocalDescription=function(e){var t,n,r=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(fO("TypeError",'Unsupported type "'+e.type+'"'));if(!hO("setLocalDescription",e.type,r.signalingState)||r._isClosed)return Promise.reject(fO("InvalidStateError","Can not set local "+e.type+" in state "+r.signalingState));if("offer"===e.type)t=uO.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=uO.parseRtpParameters(e);r.transceivers[t].localCapabilities=n})),r.transceivers.forEach((function(e,t){r._gather(e.mid,t)}));else if("answer"===e.type){t=uO.splitSections(r._remoteDescription.sdp),n=t.shift();var i=uO.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var o=r.transceivers[t],s=o.iceGatherer,a=o.iceTransport,c=o.dtlsTransport,u=o.localCapabilities,l=o.remoteCapabilities;if(!(uO.isRejected(e)&&0===uO.matchPrefix(e,"a=bundle-only").length||o.rejected)){var d=uO.getIceParameters(e,n),h=uO.getDtlsParameters(e,n);i&&(h.role="server"),r.usingBundle&&0!==t||(r._gather(o.mid,t),"new"===a.state&&a.start(s,d,i?"controlling":"controlled"),"new"===c.state&&c.start(h));var p=dO(u,l);r._transceive(o,p.codecs.length>0,!1)}}))}return r._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?r._updateSignalingState("have-local-offer"):r._updateSignalingState("stable"),Promise.resolve()},i.prototype.setRemoteDescription=function(i){var o=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(fO("TypeError",'Unsupported type "'+i.type+'"'));if(!hO("setRemoteDescription",i.type,o.signalingState)||o._isClosed)return Promise.reject(fO("InvalidStateError","Can not set remote "+i.type+" in state "+o.signalingState));var s={};o.remoteStreams.forEach((function(e){s[e.id]=e}));var a=[],c=uO.splitSections(i.sdp),u=c.shift(),l=uO.matchPrefix(u,"a=ice-lite").length>0,d=uO.matchPrefix(u,"a=group:BUNDLE ").length>0;o.usingBundle=d;var h=uO.matchPrefix(u,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!h&&h.substr(14).split(" ").indexOf("trickle")>=0,c.forEach((function(r,c){var h=uO.splitLines(r),p=uO.getKind(r),f=uO.isRejected(r)&&0===uO.matchPrefix(r,"a=bundle-only").length,A=h[0].substr(2).split(" ")[2],E=uO.getDirection(r,u),g=uO.parseMsid(r),_=uO.getMid(r)||uO.generateIdentifier();if(f||"application"===p&&("DTLS/SCTP"===A||"UDP/DTLS/SCTP"===A))o.transceivers[c]={mid:_,kind:p,protocol:A,rejected:!0};else{var m,I,T,R,v,y,S,C,O;!f&&o.transceivers[c]&&o.transceivers[c].rejected&&(o.transceivers[c]=o._createTransceiver(p,!0));var b,w,N=uO.parseRtpParameters(r);f||(b=uO.getIceParameters(r,u),(w=uO.getDtlsParameters(r,u)).role="client"),S=uO.parseRtpEncodingParameters(r);var D=uO.parseRtcpParameters(r),L=uO.matchPrefix(r,"a=end-of-candidates",u).length>0,P=uO.matchPrefix(r,"a=candidate:").map((function(e){return uO.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===i.type||"answer"===i.type)&&!f&&d&&c>0&&o.transceivers[c]&&(o._disposeIceAndDtlsTransports(c),o.transceivers[c].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[c].iceTransport=o.transceivers[0].iceTransport,o.transceivers[c].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[c].rtpSender&&o.transceivers[c].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[c].rtpReceiver&&o.transceivers[c].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==i.type||f)"answer"!==i.type||f||(I=(m=o.transceivers[c]).iceGatherer,T=m.iceTransport,R=m.dtlsTransport,v=m.rtpReceiver,y=m.sendEncodingParameters,C=m.localCapabilities,o.transceivers[c].recvEncodingParameters=S,o.transceivers[c].remoteCapabilities=N,o.transceivers[c].rtcpParameters=D,P.length&&"new"===T.state&&(!l&&!L||d&&0!==c?P.forEach((function(e){pO(m.iceTransport,e)})):T.setRemoteCandidates(P)),d&&0!==c||("new"===T.state&&T.start(I,b,"controlling"),"new"===R.state&&R.start(w)),!dO(m.localCapabilities,m.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&m.sendEncodingParameters[0].rtx&&delete m.sendEncodingParameters[0].rtx,o._transceive(m,"sendrecv"===E||"recvonly"===E,"sendrecv"===E||"sendonly"===E),!v||"sendrecv"!==E&&"sendonly"!==E?delete m.rtpReceiver:(O=v.track,g?(s[g.stream]||(s[g.stream]=new e.MediaStream),n(O,s[g.stream]),a.push([O,v,s[g.stream]])):(s.default||(s.default=new e.MediaStream),n(O,s.default),a.push([O,v,s.default]))));else{(m=o.transceivers[c]||o._createTransceiver(p)).mid=_,m.iceGatherer||(m.iceGatherer=o._createIceGatherer(c,d)),P.length&&"new"===m.iceTransport.state&&(!L||d&&0!==c?P.forEach((function(e){pO(m.iceTransport,e)})):m.iceTransport.setRemoteCandidates(P)),C=e.RTCRtpReceiver.getCapabilities(p),t<15019&&(C.codecs=C.codecs.filter((function(e){return"rtx"!==e.name}))),y=m.sendEncodingParameters||[{ssrc:1001*(2*c+2)}];var k,x=!1;"sendrecv"===E||"sendonly"===E?(x=!m.rtpReceiver,v=m.rtpReceiver||new e.RTCRtpReceiver(m.dtlsTransport,p),x&&(O=v.track,g&&"-"===g.stream||(g?(s[g.stream]||(s[g.stream]=new e.MediaStream,Object.defineProperty(s[g.stream],"id",{get:function(){return g.stream}})),Object.defineProperty(O,"id",{get:function(){return g.track}}),k=s[g.stream]):(s.default||(s.default=new e.MediaStream),k=s.default)),k&&(n(O,k),m.associatedRemoteMediaStreams.push(k)),a.push([O,v,k]))):m.rtpReceiver&&m.rtpReceiver.track&&(m.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===m.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),m.associatedRemoteMediaStreams=[]),m.localCapabilities=C,m.remoteCapabilities=N,m.rtpReceiver=v,m.rtcpParameters=D,m.sendEncodingParameters=y,m.recvEncodingParameters=S,o._transceive(o.transceivers[c],!1,x)}}})),void 0===o._dtlsRole&&(o._dtlsRole="offer"===i.type?"active":"passive"),o._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(s).forEach((function(t){var n=s[t];if(n.getTracks().length){if(-1===o.remoteStreams.indexOf(n)){o.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout((function(){o._dispatchEvent("addstream",i)}))}a.forEach((function(e){var t=e[0],i=e[1];n.id===e[2].id&&r(o,t,i,[n])}))}})),a.forEach((function(e){e[2]||r(o,e[0],e[1],[])})),e.setTimeout((function(){o&&o.transceivers&&o.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},i.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},i.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},i.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},i.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(fO("InvalidStateError","Can not call createOffer after close"));var r=n.transceivers.filter((function(e){return"audio"===e.kind})).length,i=n.transceivers.filter((function(e){return"video"===e.kind})).length,o=arguments[0];if(o){if(o.mandatory||o.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==o.offerToReceiveAudio&&(r=!0===o.offerToReceiveAudio?1:!1===o.offerToReceiveAudio?0:o.offerToReceiveAudio),void 0!==o.offerToReceiveVideo&&(i=!0===o.offerToReceiveVideo?1:!1===o.offerToReceiveVideo?0:o.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--r<0&&(e.wantReceive=!1):"video"===e.kind&&--i<0&&(e.wantReceive=!1)}));r>0||i>0;)r>0&&(n._createTransceiver("audio"),r--),i>0&&(n._createTransceiver("video"),i--);var s=uO.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(r,i){var o=r.track,s=r.kind,a=r.mid||uO.generateIdentifier();r.mid=a,r.iceGatherer||(r.iceGatherer=n._createIceGatherer(i,n.usingBundle));var c=e.RTCRtpSender.getCapabilities(s);t<15019&&(c.codecs=c.codecs.filter((function(e){return"rtx"!==e.name}))),c.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),r.remoteCapabilities&&r.remoteCapabilities.codecs&&r.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),c.headerExtensions.forEach((function(e){(r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var u=r.sendEncodingParameters||[{ssrc:1001*(2*i+1)}];o&&t>=15019&&"video"===s&&!u[0].rtx&&(u[0].rtx={ssrc:u[0].ssrc+1}),r.wantReceive&&(r.rtpReceiver=new e.RTCRtpReceiver(r.dtlsTransport,s)),r.localCapabilities=c,r.sendEncodingParameters=u})),"max-compat"!==n._config.bundlePolicy&&(s+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){s+=lO(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),s+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,s+="a="+uO.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(s+="a=end-of-candidates\r\n"))}));var a=new e.RTCSessionDescription({type:"offer",sdp:s});return Promise.resolve(a)},i.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(fO("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(fO("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var r=uO.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(r+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n";var i=uO.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,o){if(!(o+1>i)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?r+="m=application 0 DTLS/SCTP 5000\r\n":r+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?r+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(r+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(r+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var s;e.stream&&("audio"===e.kind?s=e.stream.getAudioTracks()[0]:"video"===e.kind&&(s=e.stream.getVideoTracks()[0]),s&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}));var a=dO(e.localCapabilities,e.remoteCapabilities);!a.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,r+=lO(e,a,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(r+="a=rtcp-rsize\r\n")}}));var o=new e.RTCSessionDescription({type:"answer",sdp:r});return Promise.resolve(o)},i.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(r,i){if(!n._remoteDescription)return i(fO("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var s=0;s<n.transceivers.length;s++)if(n.transceivers[s].mid===e.sdpMid){o=s;break}var a=n.transceivers[o];if(!a)return i(fO("OperationError","Can not add ICE candidate"));if(a.rejected)return r();var c=Object.keys(e.candidate).length>0?uO.parseCandidate(e.candidate):{};if("tcp"===c.protocol&&(0===c.port||9===c.port))return r();if(c.component&&1!==c.component)return r();if((0===o||o>0&&a.iceTransport!==n.transceivers[0].iceTransport)&&!pO(a.iceTransport,c))return i(fO("OperationError","Can not add ICE candidate"));var u=e.candidate.trim();0===u.indexOf("a=")&&(u=u.substr(2)),(t=uO.getMediaSections(n._remoteDescription.sdp))[o]+="a="+(c.type?u:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=uO.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var l=0;l<n.transceivers.length&&(n.transceivers[l].rejected||(n.transceivers[l].iceTransport.addRemoteCandidate({}),(t=uO.getMediaSections(n._remoteDescription.sdp))[l]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=uO.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));l++);r()}))},i.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw fO("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var r=n.prototype.getStats;n.prototype.getStats=function(){return r.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=e[n]).type]||r.type,t.set(n,e[n])})),t}))}}}));var o=["createOffer","createAnswer"];return o.forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),i}(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){let n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((e=>{if(e&&(e.urls||e.url)){let t=e.urls||e.url;e.url&&!e.urls&&yA("RTCIceServer.url","RTCIceServer.urls");const r="string"==typeof t;return r&&(t=[t]),t=t.filter((e=>{if(0===e.indexOf("stun:"))return!1;const t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=r?t[0]:t,!!t.length}}))}(e.iceServers,t.version),vA("ICE servers after filtering:",e.iceServers)),new n(e)},e.RTCPeerConnection.prototype=n.prototype}function _O(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}var mO=Object.freeze({__proto__:null,shimPeerConnection:gO,shimReplaceTrack:_O,shimGetUserMedia:AO,shimGetDisplayMedia:EO}),IO=Gr,TO=Qr,RO=o,vO=W,yO=F,SO=Po,CO=Ys,OO=Qt.exports;if(IO({target:"Promise",proto:!0,real:!0,forced:!!TO&&RO((function(){TO.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=SO(this,vO("Promise")),n=yO(e);return this.then(n?function(n){return CO(t,e()).then((function(){return n}))}:e,n?function(n){return CO(t,e()).then((function(){throw n}))}:e)}}),yO(TO)){var bO=vO("Promise").prototype.finally;TO.prototype.finally!==bO&&OO(TO.prototype,"finally",bO,{unsafe:!0})}function wO(e,t){const n=e&&e.navigator,r=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,r){yA("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"==typeof n&&"object"==typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},r&&r.prototype.getSettings){const t=r.prototype.getSettings;r.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(r&&r.prototype.applyConstraints){const t=r.prototype.applyConstraints;r.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"==typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function NO(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function DO(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const n=e.RTCPeerConnection.prototype[t],r={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=r[t]}));const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,o]=arguments;return r.apply(this,[e||null]).then((e=>{if(t.version<53&&!i)try{e.forEach((e=>{e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,r)=>{e.set(r,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(i,o)}}function LO(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):xv.resolve(new Map)}}function PO(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),IA(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function kO(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){yA("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function xO(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function MO(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];const e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const r=t.apply(this,arguments);if(n){const{sender:t}=r,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e.sendEncodings,t.sendEncodings=e.sendEncodings,this.setParametersPromises.push(t.setParameters(n).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return r})}function UO(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function BO(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?xv.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function FO(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?xv.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}var VO=Object.freeze({__proto__:null,shimOnTrack:NO,shimPeerConnection:DO,shimSenderGetStats:LO,shimReceiverGetStats:PO,shimRemoveStream:kO,shimRTCDataChannel:xO,shimAddTransceiver:MO,shimGetParameters:UO,shimCreateOffer:BO,shimCreateAnswer:FO,shimGetUserMedia:wO,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,xv.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})}});function GO(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((n=>t.call(this,n,e))),e.getVideoTracks().forEach((n=>t.call(this,n,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r&&r.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach((e=>{n.includes(e.track)&&this.removeTrack(e)}))})}}function QO(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}))}),t.apply(e,arguments)}}}function jO(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,r=t.createAnswer,i=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const r=arguments.length>=2?arguments[2]:arguments[0],i=n.apply(this,[r]);return t?(i.then(e,t),xv.resolve()):i},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],i=r.apply(this,[n]);return t?(i.then(e,t),xv.resolve()):i};let a=function(e,t,n){const r=i.apply(this,[e]);return n?(r.then(t,n),xv.resolve()):r};t.setLocalDescription=a,a=function(e,t,n){const r=o.apply(this,[e]);return n?(r.then(t,n),xv.resolve()):r},t.setRemoteDescription=a,a=function(e,t,n){const r=s.apply(this,[e]);return n?(r.then(t,n),xv.resolve()):r},t.addIceCandidate=a}function HO(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(WO(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))}function WO(e){return e&&void 0!==e.video?Object.assign({},e,{video:OA(e.video)}):e}function YO(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let r=e.iceServers[n];!r.hasOwnProperty("urls")&&r.hasOwnProperty("url")?(yA("RTCIceServer.url","RTCIceServer.urls"),r=JSON.parse(JSON.stringify(r)),r.urls=r.url,delete r.url,t.push(r)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function KO(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function $O(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}function zO(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var qO=Object.freeze({__proto__:null,shimLocalStreamsAPI:GO,shimRemoteStreamsAPI:QO,shimCallbacksAPI:jO,shimGetUserMedia:HO,shimConstraints:WO,shimRTCIceServerUrls:YO,shimTrackEventTransceiver:KO,shimCreateOfferLegacy:$O,shimAudioContext:zO}),JO=cu,XO=qg,ZO=wc("".replace),eb="[\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff]",tb=RegExp("^"+eb+eb+"*"),nb=RegExp(eb+eb+"*$"),rb=function(e){return function(t){var n=XO(JO(t));return 1&e&&(n=ZO(n,tb,"")),2&e&&(n=ZO(n,nb,"")),n}},ib={start:rb(1),end:rb(2),trim:rb(3)},ob=em.PROPER,sb=Rc,ab="\t\n\v\f\r Â áââââââââââââ¯âã\u2028\u2029\ufeff",cb=ib.trim;Ud({target:"String",proto:!0,forced:function(e){return sb((function(){return!!ab[e]()||"âÂá "!=="âÂá "[e]()||ob&&ab[e].name!==e}))}("trim")},{trim:function(){return cb(this)}});var ub=ih("String").trim,lb=Nc,db=ub,hb=String.prototype,pb=function(e){var t=e.trim;return"string"==typeof e||e===hb||lb(hb,e)&&t===hb.trim?db:t},fb=l;Gr({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return fb(URL.prototype.toString,this)}});var Ab={exports:{}};!function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return pb(e).call(e).split("\n").map((function(e){return pb(e).call(e)}))},t.splitSections=function(e){return e.split("\nm=").map((function(e,t){var n;return pb(n=t>0?"m="+e:e).call(n)+"\r\n"}))},t.getDescription=function(e){var n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){var n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter((function(e){return 0===e.indexOf(n)}))},t.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},r=8;r<t.length;r+=2)switch(t[r]){case"raddr":n.relatedAddress=t[r+1];break;case"rport":n.relatedPort=parseInt(t[r+1],10);break;case"tcptype":n.tcpType=t[r+1];break;case"ufrag":n.ufrag=t[r+1],n.usernameFragment=t[r+1];break;default:n[t[r]]=t[r+1]}return n},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t,n={},r=e.substr(e.indexOf(" ")+1).split(";"),i=0;i<r.length;i++){var o,s;t=pb(o=r[i]).call(o).split("="),n[pb(s=t[0]).call(s)]=t[1]}return n},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)})),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return r>-1?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},t.getMid=function(e){var n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substr(6)},t.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},t.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){var r=t.matchPrefix(e+n,"a=ice-ufrag:")[0],i=t.matchPrefix(e+n,"a=ice-pwd:")[0];return r&&i?{usernameFragment:r.substr(12),password:i.substr(10)}:null},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},r=t.splitLines(e)[0].split(" "),i=3;i<r.length;i++){var o=r[i],s=t.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(s){var a=t.parseRtpMap(s),c=t.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=c.length?t.parseFmtp(c[0]):{},a.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(t.parseRtcpFb),n.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(a.name.toUpperCase())}}}return t.matchPrefix(e,"a=extmap:").forEach((function(e){n.headerExtensions.push(t.parseExtmap(e))})),n},t.writeRtpDescription=function(e,n){var r="";r+="m="+e+" ",r+=n.codecs.length>0?"9":"0",r+=" UDP/TLS/RTP/SAVPF ",r+=n.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",r+="c=IN IP4 0.0.0.0\r\n",r+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach((function(e){r+=t.writeRtpMap(e),r+=t.writeFmtp(e),r+=t.writeRtcpFb(e)}));var i=0;return n.codecs.forEach((function(e){e.maxptime>i&&(i=e.maxptime)})),i>0&&(r+="a=maxptime:"+i+"\r\n"),r+="a=rtcp-mux\r\n",n.headerExtensions&&n.headerExtensions.forEach((function(e){r+=t.writeExtmap(e)})),r},t.parseRtpEncodingParameters=function(e){var n,r=[],i=t.parseRtpParameters(e),o=-1!==i.fecMechanisms.indexOf("RED"),s=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),c=a.length>0&&a[0].ssrc,u=t.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));u.length>0&&u[0].length>1&&u[0][0]===c&&(n=u[0][1]),i.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var t={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)};c&&n&&(t.rtx={ssrc:n}),r.push(t),o&&((t=JSON.parse(JSON.stringify(t))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},r.push(t))}})),0===r.length&&c&&r.push({ssrc:c});var l=t.matchPrefix(e,"b=");return l.length&&(l=0===l[0].indexOf("b=TIAS:")?parseInt(l[0].substr(7),10):0===l[0].indexOf("b=AS:")?1e3*parseInt(l[0].substr(5),10)*.95-16e3:void 0,r.forEach((function(e){e.maxBitrate=l}))),r},t.parseRtcpParameters=function(e){var n={},r=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];r&&(n.cname=r.value,n.ssrc=r.ssrc);var i=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=i.length>0,n.compound=0===i.length;var o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.parseMsid=function(e){var n,r=t.matchPrefix(e,"a=msid:");if(1===r.length)return{stream:(n=r[0].substr(7).split(" "))[0],track:n[1]};var i=t.matchPrefix(e,"a=ssrc:").map((function(e){return t.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return i.length>0?{stream:(n=i[0].value.split(" "))[0],track:n[1]}:void 0},t.parseSctpDescription=function(e){var n,r=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");i.length>0&&(n=parseInt(i[0].substr(19),10)),isNaN(n)&&(n=65536);var o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substr(12),10),protocol:r.fmt,maxMessageSize:n};if(t.matchPrefix(e,"a=sctpmap:").length>0){var s=t.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(s[0],10),protocol:s[1],maxMessageSize:n}}},t.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){var i=void 0!==n?n:2;return"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+i+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,n,r,i){var o=t.writeRtpDescription(e.kind,n);if(o+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),o+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),o+="a=mid:"+e.mid+"\r\n",e.direction?o+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?o+="a=sendrecv\r\n":e.rtpSender?o+="a=sendonly\r\n":e.rtpReceiver?o+="a=recvonly\r\n":o+="a=inactive\r\n",e.rtpSender){var s="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n";o+="a="+s,o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s,e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s,o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),o},t.getDirection=function(e,n){for(var r=t.splitLines(e),i=0;i<r.length;i++)switch(r[i]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[i].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){var n=t.splitLines(e)[0].substr(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){var n=t.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var n=t.splitLines(e),r=0;r<n.length;r++)if(n[r].length<2||"="!==n[r].charAt(1))return!1;return!0},e.exports=t}(Ab);var Eb=Ab.exports;function gb(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const n=new t(e),r=Eb.parseCandidate(e.candidate),i=Object.assign(n,r);return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,IA(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function _b(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const n=function(e){if(!e||!e.sdp)return!1;const t=Eb.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=Eb.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},r=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!=n?-1:n},i=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},o=function(e,n){let r=65536;"firefox"===t.browser&&57===t.version&&(r=65535);const i=Eb.matchPrefix(e.sdp,"a=max-message-size:");return i.length>0?r=parseInt(i[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const e=r(arguments[0]),t=i(e),n=o(arguments[0],e);let s;s=0===t&&0===n?Number.POSITIVE_INFINITY:0===t||0===n?Math.max(t,n):Math.min(t,n);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>s}),this._sctp=a}return s.apply(this,arguments)}}function mb(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const r=arguments[0],i=r.length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&i>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},IA(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function Ib(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))}function Tb(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==pb(e).call(e))).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function Rb(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?xv.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),xv.resolve())})}var vb=Object.freeze({__proto__:null,shimRTCIceCandidate:gb,shimMaxMessageSize:_b,shimSendThrowTypeError:mb,shimConnectionState:Ib,removeExtmapAllowMixed:Tb,shimAddIceCandidateNullOrEmpty:Rb});let yb,Sb;!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};const n=vA,r=SA(e),i={browserDetails:r,commonShim:vb,extractVersion:mA,disableLog:TA,disableWarnings:RA};switch(r.browser){case"chrome":if(!aO||!oO||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),i;if(null===r.version)return n("Chrome shim can not determine version, not shimming."),i;n("adapter.js shimming chrome."),i.browserShim=aO,Rb(e,r),JC(e,r),XC(e),oO(e,r),ZC(e),iO(e,r),eO(e),tO(e),nO(e),sO(e,r),gb(e),Ib(e),_b(e,r),mb(e),Tb(e,r);break;case"firefox":if(!VO||!DO||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),i;n("adapter.js shimming firefox."),i.browserShim=VO,Rb(e,r),wO(e,r),DO(e,r),NO(e),kO(e),LO(e),PO(e),xO(e),MO(e),UO(e),BO(e),FO(e),gb(e),Ib(e),_b(e,r),mb(e);break;case"edge":if(!mO||!gO||!t.shimEdge)return n("MS edge shim is not included in this adapter release."),i;n("adapter.js shimming edge."),i.browserShim=mO,AO(e),EO(e),gO(e,r),_O(e),_b(e,r),mb(e);break;case"safari":if(!qO||!t.shimSafari)return n("Safari shim is not included in this adapter release."),i;n("adapter.js shimming safari."),i.browserShim=qO,Rb(e,r),YO(e),$O(e),jO(e),GO(e),QO(e),KO(e),HO(e),zO(e),gb(e),_b(e,r),mb(e),Tb(e,r);break;default:n("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window}),function(e){e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot"}(yb||(yb={})),function(e){e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger"}(Sb||(Sb={}));var Cb={exports:{}};!function(t,n){!function(e,r){var i="function",o="object",s="string",a="model",c="name",u="type",l="vendor",d="version",h="architecture",p="console",f="mobile",A="tablet",E="smarttv",g="wearable",_="embedded",m={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return typeof e===s&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===s?e.replace(/[^\d\.]/g,"").split(".")[0]:r},trim:function(e,t){return e=e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),void 0===t?e:e.substring(0,255)}},I={rgx:function(e,t){for(var n,s,a,c,u,l,d=0;d<t.length&&!u;){var h=t[d],p=t[d+1];for(n=s=0;n<h.length&&!u;)if(u=h[n++].exec(e))for(a=0;a<p.length;a++)l=u[++s],typeof(c=p[a])===o&&c.length>0?2==c.length?typeof c[1]==i?this[c[0]]=c[1].call(this,l):this[c[0]]=c[1]:3==c.length?typeof c[1]!==i||c[1].exec&&c[1].test?this[c[0]]=l?l.replace(c[1],c[2]):r:this[c[0]]=l?c[1].call(this,l,c[2]):r:4==c.length&&(this[c[0]]=l?c[3].call(this,l.replace(c[1],c[2])):r):this[c]=l||r;d+=2}},str:function(e,t){for(var n in t)if(typeof t[n]===o&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(m.has(t[n][i],e))return"?"===n?r:n}else if(m.has(t[n],e))return"?"===n?r:n;return e}},T={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},R={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[d,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[d,[c,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[c,d],[/opios[\/\s]+([\w\.]+)/i],[d,[c,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[d,[c,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[c,d],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[d,[c,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[d,[c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[d,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[d,[c,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[d,[c,"IE"]],[/yabrowser\/([\w\.]+)/i],[d,[c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure Browser"],d],[/focus\/([\w\.]+)/i],[d,[c,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[d,[c,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[d,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[d,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[d,[c,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[d,[c,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[d,[c,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[c,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 Browser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],d],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[c,d],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[c],[/;fbav\/([\w\.]+);/i],[d,[c,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[c,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[c,d],[/\bgsa\/([\w\.]+)\s.*safari\//i],[d,[c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[d,[c,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[c,"Chrome WebView"],d],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[d,[c,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[c,d],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[d,[c,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[d,c],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[c,[d,I.str,T.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[c,d],[/(navigator|netscape)\/([\w\.-]+)/i],[[c,"Netscape"],d],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[d,[c,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[c,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[h,"amd64"]],[/(ia32(?=;))/i],[[h,m.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[h,"ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[[h,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[h,"armhf"]],[/windows\s(ce|mobile);\sppc;/i],[[h,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[h,/ower/,"",m.lowerize]],[/(sun4\w)[;\)]/i],[[h,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[h,m.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[a,[l,"Samsung"],[u,A]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[a,[l,"Samsung"],[u,f]],[/\((ip(?:hone|od)[\s\w]*);/i],[a,[l,"Apple"],[u,f]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[a,[l,"Apple"],[u,A]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[a,[l,"Huawei"],[u,A]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[a,[l,"Huawei"],[u,f]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[a,/_/g," "],[l,"Xiaomi"],[u,f]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[a,/_/g," "],[l,"Xiaomi"],[u,A]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[a,[l,"OPPO"],[u,f]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[a,[l,"Vivo"],[u,f]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[a,[l,"Realme"],[u,f]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[a,[l,"Motorola"],[u,f]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[a,[l,"Motorola"],[u,A]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[a,[l,"LG"],[u,A]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[a,[l,"LG"],[u,f]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[a,[l,"Lenovo"],[u,A]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[a,/_/g," "],[l,"Nokia"],[u,f]],[/droid.+;\s(pixel\sc)[\s)]/i],[a,[l,"Google"],[u,A]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[a,[l,"Google"],[u,f]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[a,[l,"Sony"],[u,f]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[a,"Xperia Tablet"],[l,"Sony"],[u,A]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[a,[l,"OnePlus"],[u,f]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[a,[l,"Amazon"],[u,A]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[a,"Fire Phone"],[l,"Amazon"],[u,f]],[/\((playbook);[\w\s\),;-]+(rim)/i],[a,l,[u,A]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[a,[l,"BlackBerry"],[u,f]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[a,[l,"ASUS"],[u,A]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[a,[l,"ASUS"],[u,f]],[/(nexus\s9)/i],[a,[l,"HTC"],[u,A]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[a,/_/g," "],[u,f]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[a,[l,"Acer"],[u,A]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[a,[l,"Meizu"],[u,f]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,a,[u,f]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[l,a,[u,A]],[/\s(surface\sduo)\s/i],[a,[l,"Microsoft"],[u,A]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[a,[l,"Fairphone"],[u,f]],[/\s(u304aa)\sbuild/i],[a,[l,"AT&T"],[u,f]],[/sie-(\w*)/i],[a,[l,"Siemens"],[u,f]],[/[;\/]\s?(rct\w+)\sbuild/i],[a,[l,"RCA"],[u,A]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[a,[l,"Dell"],[u,A]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[a,[l,"Verizon"],[u,A]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[a,[l,"Barnes & Noble"],[u,A]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[a,[l,"NuVision"],[u,A]],[/;\s(k88)\sbuild/i],[a,[l,"ZTE"],[u,A]],[/;\s(nx\d{3}j)\sbuild/i],[a,[l,"ZTE"],[u,f]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[a,[l,"Swiss"],[u,f]],[/[;\/]\s?(zur\d{3})\sbuild/i],[a,[l,"Swiss"],[u,A]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[a,[l,"Zeki"],[u,A]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[l,"Dragon Touch"],a,[u,A]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[a,[l,"Insignia"],[u,A]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[a,[l,"NextBook"],[u,A]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[l,"Voice"],a,[u,f]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[l,"LvTel"],a,[u,f]],[/;\s(ph-1)\s/i],[a,[l,"Essential"],[u,f]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[a,[l,"Envizen"],[u,A]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[a,[l,"MachSpeed"],[u,A]],[/[;\/]\s?tu_(1491)\sbuild/i],[a,[l,"Rotor"],[u,A]],[/(shield[\w\s]+)\sbuild/i],[a,[l,"Nvidia"],[u,A]],[/(sprint)\s(\w+)/i],[l,a,[u,f]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[l,"Microsoft"],[u,f]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[a,[l,"Zebra"],[u,A]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[a,[l,"Zebra"],[u,f]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[l,a,[u,p]],[/droid.+;\s(shield)\sbuild/i],[a,[l,"Nvidia"],[u,p]],[/(playstation\s[345portablevi]+)/i],[a,[l,"Sony"],[u,p]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[a,[l,"Microsoft"],[u,p]],[/smart-tv.+(samsung)/i],[l,[u,E]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[l,"Samsung"],[u,E]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[l,"LG"],[u,E]],[/(apple)\s?tv/i],[l,[a,"Apple TV"],[u,E]],[/crkey/i],[[a,"Chromecast"],[l,"Google"],[u,E]],[/droid.+aft([\w])(\sbuild\/|\))/i],[a,[l,"Amazon"],[u,E]],[/\(dtv[\);].+(aquos)/i],[a,[l,"Sharp"],[u,E]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,m.trim],[a,m.trim],[u,E]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[u,E]],[/((pebble))app\/[\d\.]+\s/i],[l,a,[u,g]],[/droid.+;\s(glass)\s\d/i],[a,[l,"Google"],[u,g]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[a,[l,"Zebra"],[u,g]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[l,[u,_]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[a,[u,f]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[a,[u,A]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,m.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[a,[l,"Generic"]],[/(phone)/i],[[u,f]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[d,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,d],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[d,c]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[c,d],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[c,[d,I.str,T.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[d,I.str,T.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[d,/_/g,"."],[c,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[c,"Mac OS"],[d,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[c,d],[/\(bb(10);/i],[d,[c,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[d,[c,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[d,[c,"webOS"]],[/crkey\/([\d\.]+)/i],[d,[c,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],d],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[c,d],[/(sunos)\s?([\w\.\d]*)/i],[[c,"Solaris"],d],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[c,d]]},v=function(t,n){if("object"==typeof t&&(n=t,t=r),!(this instanceof v))return new v(t,n).getResult();var i=t||(void 0!==e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),o=n?m.extend(R,n):R;return this.getBrowser=function(){var e={name:r,version:r};return I.rgx.call(e,i,o.browser),e.major=m.major(e.version),e},this.getCPU=function(){var e={architecture:r};return I.rgx.call(e,i,o.cpu),e},this.getDevice=function(){var e={vendor:r,model:r,type:r};return I.rgx.call(e,i,o.device),e},this.getEngine=function(){var e={name:r,version:r};return I.rgx.call(e,i,o.engine),e},this.getOS=function(){var e={name:r,version:r};return I.rgx.call(e,i,o.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===s&&e.length>255?m.trim(e,255):e,this},this.setUA(i),this};v.VERSION="0.7.28",v.BROWSER={NAME:c,MAJOR:"major",VERSION:d},v.CPU={ARCHITECTURE:h},v.DEVICE={MODEL:a,VENDOR:l,TYPE:u,CONSOLE:p,MOBILE:f,SMARTTV:E,TABLET:A,WEARABLE:g,EMBEDDED:_},v.ENGINE={NAME:c,VERSION:d},v.OS={NAME:c,VERSION:d},t.exports&&(n=t.exports=v),n.UAParser=v;var y=void 0!==e&&(e.jQuery||e.Zepto);if(y&&!y.ua){var S=new v;y.ua=S.getResult(),y.ua.get=function(){return S.getUA()},y.ua.set=function(e){S.setUA(e);var t=S.getResult();for(var n in t)y.ua[n]=t[n]}}}("object"==typeof window?window:e)}(Cb,Cb.exports);const Ob=new(0,Cb.exports);let bb=Ob.getResult();function wb(e){return e&&Ob.setUA(e),bb=Ob.getResult(),{name:Nb(bb),version:Db(bb),os:Lb(bb),osVersion:bb.os.version}}function Nb(e){if("Blink"===e.engine.name&&"WeChat"!==e.browser.name)return Sb.CHROME;switch(e.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return Sb.CHROME;case"Safari":case"Mobile Safari":return Sb.SAFARI;case"Edge":return Sb.EDGE;case"Firefox":return Sb.FIREFOX;case"QQBrowser":return Sb.QQ;case"Opera":return Sb.OPERA;case"WeChat":return Sb.WECHAT;default:return e.browser.name||""}}function Db(e){let t;return t="Blink"===e.engine.name?e.engine.version||"":e.browser.version||"",t.split(".")[0]}function Lb(e){return"Windows"===e.os.name?e.os.version?e.os.name+" "+e.os.version:e.os.name:e.os.name||""}function Pb(){return wb().os}function kb(){const e=wb();return!!("WebKit"===bb.engine.name&&e.os===yb.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==Sb.SAFARI||Bb()&&e.name!==Sb.SAFARI)}function xb(){return wb().name===Sb.CHROME}function Mb(){return wb().name===Sb.SAFARI}function Ub(){return wb().name===Sb.FIREFOX}function Bb(){return wb().os===yb.IOS}function Fb(){const e=wb();return!(e.name!==Sb.CHROME||!e.osVersion)&&Number(e.version)<=90}function Vb(){const e=wb();if(e.os!==yb.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])<=14&&Number(t[1])<=6}function Gb(){const e=wb();if(e.os!==yb.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])}function Qb(){const e=wb();if(e.os!==yb.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&0===Number(t[1])}function jb(){const e=wb();if(e.os!==yb.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=1}function Hb(){const e=wb();if(e.os!==yb.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=2}function Wb(){return Mb()&&navigator.maxTouchPoints>0}function Yb(){return wb().name===Sb.WECHAT}function Kb(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function $b(){const e=wb();return e.name!==Sb.EDGE&&e.name!==Sb.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function zb(){return wb().os===yb.ANDROID}function qb(){const e=wb();return"Android"===e.os&&("Chrome"===e.name||e.name===Sb.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}var Jb={exports:{}},Xb=Ud,Zb=Vc,ew=cd.f;Xb({target:"Object",stat:!0,forced:Object.defineProperty!==ew,sham:!Zb},{defineProperty:ew});var tw=fu.Object,nw=Jb.exports=function(e,t,n){return tw.defineProperty(e,t,n)};tw.defineProperty.sham&&(nw.sham=!0);var rw=Jb.exports;function iw(e,t,n){return t in e?rw(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ow,sw={exports:{}},aw=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}},cw=aw,uw=Object.prototype.toString,lw=(ow=Object.create(null),function(e){var t=uw.call(e);return ow[t]||(ow[t]=t.slice(8,-1).toLowerCase())});function dw(e){return e=e.toLowerCase(),function(t){return lw(t)===e}}function hw(e){return Array.isArray(e)}function pw(e){return void 0===e}var fw=dw("ArrayBuffer");function Aw(e){return null!==e&&"object"==typeof e}function Ew(e){if("object"!==lw(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}var gw=dw("Date"),_w=dw("File"),mw=dw("Blob"),Iw=dw("FileList");function Tw(e){return"[object Function]"===uw.call(e)}var Rw=dw("URLSearchParams");function vw(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),hw(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}var yw=function(e){return function(t){return e&&t instanceof e}}("undefined"!=typeof Uint8Array&&Object.getPrototypeOf(Uint8Array)),Sw={isArray:hw,isArrayBuffer:fw,isBuffer:function(e){return null!==e&&!pw(e)&&null!==e.constructor&&!pw(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){var t="[object FormData]";return e&&("function"==typeof FormData&&e instanceof FormData||uw.call(e)===t||Tw(e.toString)&&e.toString()===t)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&fw(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:Aw,isPlainObject:Ew,isUndefined:pw,isDate:gw,isFile:_w,isBlob:mw,isFunction:Tw,isStream:function(e){return Aw(e)&&Tw(e.pipe)},isURLSearchParams:Rw,isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:vw,merge:function e(){var t={};function n(n,r){Ew(t[r])&&Ew(n)?t[r]=e(t[r],n):Ew(n)?t[r]=e({},n):hw(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)vw(arguments[r],n);return t},extend:function(e,t,n){return vw(t,(function(t,r){e[r]=n&&"function"==typeof t?cw(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e},inherits:function(e,t,n,r){e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,n&&Object.assign(e.prototype,n)},toFlatObject:function(e,t,n){var r,i,o,s={};t=t||{};do{for(i=(r=Object.getOwnPropertyNames(e)).length;i-- >0;)s[o=r[i]]||(t[o]=e[o],s[o]=!0);e=Object.getPrototypeOf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:lw,kindOfTest:dw,endsWith:function(e,t,n){e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;var r=e.indexOf(t,n);return-1!==r&&r===n},toArray:function(e){if(!e)return null;var t=e.length;if(pw(t))return null;for(var n=new Array(t);t-- >0;)n[t]=e[t];return n},isTypedArray:yw,isFileList:Iw},Cw=Sw;function Ow(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var bw=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(Cw.isURLSearchParams(t))r=t.toString();else{var i=[];Cw.forEach(t,(function(e,t){null!=e&&(Cw.isArray(e)?t+="[]":e=[e],Cw.forEach(e,(function(e){Cw.isDate(e)?e=e.toISOString():Cw.isObject(e)&&(e=JSON.stringify(e)),i.push(Ow(t)+"="+Ow(e))})))})),r=i.join("&")}if(r){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e},ww=Sw;function Nw(){this.handlers=[]}Nw.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},Nw.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},Nw.prototype.forEach=function(e){ww.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var Dw=Nw,Lw=Sw,Pw=Sw;function kw(e,t,n,r,i){Error.call(this),this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i)}Pw.inherits(kw,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var xw=kw.prototype,Mw={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(e){Mw[e]={value:e}})),Object.defineProperties(kw,Mw),Object.defineProperty(xw,"isAxiosError",{value:!0}),kw.from=function(e,t,n,r,i,o){var s=Object.create(xw);return Pw.toFlatObject(e,s,(function(e){return e!==Error.prototype})),kw.call(s,e.message,t,n,r,i),s.name=e.name,o&&Object.assign(s,o),s};var Uw=kw,Bw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Fw=Sw,Vw=function(e,t){t=t||new FormData;var n=[];function r(e){return null===e?"":Fw.isDate(e)?e.toISOString():Fw.isArrayBuffer(e)||Fw.isTypedArray(e)?"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}return function e(i,o){if(Fw.isPlainObject(i)||Fw.isArray(i)){if(-1!==n.indexOf(i))throw Error("Circular reference detected in "+o);n.push(i),Fw.forEach(i,(function(n,i){if(!Fw.isUndefined(n)){var s,a=o?o+"."+i:i;if(n&&!o&&"object"==typeof n)if(Fw.endsWith(i,"{}"))n=JSON.stringify(n);else if(Fw.endsWith(i,"[]")&&(s=Fw.toArray(n)))return void s.forEach((function(e){!Fw.isUndefined(e)&&t.append(a,r(e))}));e(n,a)}})),n.pop()}else t.append(o,r(i))}(e),t},Gw=Uw,Qw=Sw,jw=Qw.isStandardBrowserEnv()?{write:function(e,t,n,r,i,o){var s=[];s.push(e+"="+encodeURIComponent(t)),Qw.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),Qw.isString(r)&&s.push("path="+r),Qw.isString(i)&&s.push("domain="+i),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},Hw=function(e,t){return e&&!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t},Ww=Sw,Yw=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],Kw=Sw,$w=Kw.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=Kw.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0},zw=Uw;function qw(e){zw.call(this,null==e?"canceled":e,zw.ERR_CANCELED),this.name="CanceledError"}Sw.inherits(qw,zw,{__CANCEL__:!0});var Jw=qw,Xw=Sw,Zw=jw,eN=bw,tN=Hw,nN=$w,rN=Bw,iN=Uw,oN=Jw,sN=Sw,aN=function(e,t){Lw.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))},cN=Uw,uN=Vw,lN={"Content-Type":"application/x-www-form-urlencoded"};function dN(e,t){!sN.isUndefined(e)&&sN.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var hN,pN={transitional:Bw,adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(hN=function(e){return new Promise((function(t,n){var r,i=e.data,o=e.headers,s=e.responseType;function a(){e.cancelToken&&e.cancelToken.unsubscribe(r),e.signal&&e.signal.removeEventListener("abort",r)}Xw.isFormData(i)&&Xw.isStandardBrowserEnv()&&delete o["Content-Type"];var c=new XMLHttpRequest;if(e.auth){var u=e.auth.username||"",l=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";o.Authorization="Basic "+btoa(u+":"+l)}var d=tN(e.baseURL,e.url);function h(){if(c){var r="getAllResponseHeaders"in c?function(e){var t,n,r,i={};return e?(Ww.forEach(e.split("\n"),(function(e){if(r=e.indexOf(":"),t=Ww.trim(e.substr(0,r)).toLowerCase(),n=Ww.trim(e.substr(r+1)),t){if(i[t]&&Yw.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([n]):i[t]?i[t]+", "+n:n}})),i):i}(c.getAllResponseHeaders()):null;(function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new Gw("Request failed with status code "+n.status,[Gw.ERR_BAD_REQUEST,Gw.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)})((function(e){t(e),a()}),(function(e){n(e),a()}),{data:s&&"text"!==s&&"json"!==s?c.response:c.responseText,status:c.status,statusText:c.statusText,headers:r,config:e,request:c}),c=null}}if(c.open(e.method.toUpperCase(),eN(d,e.params,e.paramsSerializer),!0),c.timeout=e.timeout,"onloadend"in c?c.onloadend=h:c.onreadystatechange=function(){c&&4===c.readyState&&(0!==c.status||c.responseURL&&0===c.responseURL.indexOf("file:"))&&setTimeout(h)},c.onabort=function(){c&&(n(new iN("Request aborted",iN.ECONNABORTED,e,c)),c=null)},c.onerror=function(){n(new iN("Network Error",iN.ERR_NETWORK,e,c,c)),c=null},c.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||rN;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new iN(t,r.clarifyTimeoutError?iN.ETIMEDOUT:iN.ECONNABORTED,e,c)),c=null},Xw.isStandardBrowserEnv()){var p=(e.withCredentials||nN(d))&&e.xsrfCookieName?Zw.read(e.xsrfCookieName):void 0;p&&(o[e.xsrfHeaderName]=p)}"setRequestHeader"in c&&Xw.forEach(o,(function(e,t){void 0===i&&"content-type"===t.toLowerCase()?delete o[t]:c.setRequestHeader(t,e)})),Xw.isUndefined(e.withCredentials)||(c.withCredentials=!!e.withCredentials),s&&"json"!==s&&(c.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&c.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&c.upload&&c.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(r=function(e){c&&(n(!e||e&&e.type?new oN:e),c.abort(),c=null)},e.cancelToken&&e.cancelToken.subscribe(r),e.signal&&(e.signal.aborted?r():e.signal.addEventListener("abort",r))),i||(i=null);var f=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(d);f&&-1===["http","https","file"].indexOf(f)?n(new iN("Unsupported protocol "+f+":",iN.ERR_BAD_REQUEST,e)):c.send(i)}))}),hN),transformRequest:[function(e,t){if(aN(t,"Accept"),aN(t,"Content-Type"),sN.isFormData(e)||sN.isArrayBuffer(e)||sN.isBuffer(e)||sN.isStream(e)||sN.isFile(e)||sN.isBlob(e))return e;if(sN.isArrayBufferView(e))return e.buffer;if(sN.isURLSearchParams(e))return dN(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var n,r=sN.isObject(e),i=t&&t["Content-Type"];if((n=sN.isFileList(e))||r&&"multipart/form-data"===i){var o=this.env&&this.env.FormData;return uN(n?{"files[]":e}:e,o&&new o)}return r||"application/json"===i?(dN(t,"application/json"),function(e,t,n){if(sN.isString(e))try{return(0,JSON.parse)(e),sN.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||pN.transitional,n=t&&t.silentJSONParsing,r=t&&t.forcedJSONParsing,i=!n&&"json"===this.responseType;if(i||r&&sN.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(i){if("SyntaxError"===e.name)throw cN.from(e,cN.ERR_BAD_RESPONSE,this,null,this.response);throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:null},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};sN.forEach(["delete","get","head"],(function(e){pN.headers[e]={}})),sN.forEach(["post","put","patch"],(function(e){pN.headers[e]=sN.merge(lN)}));var fN=pN,AN=Sw,EN=fN,gN=function(e){return!(!e||!e.__CANCEL__)},_N=Sw,mN=function(e,t,n){var r=this||EN;return AN.forEach(n,(function(n){e=n.call(r,e,t)})),e},IN=gN,TN=fN,RN=Jw;function vN(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new RN}var yN=Sw,SN=function(e,t){t=t||{};var n={};function r(e,t){return yN.isPlainObject(e)&&yN.isPlainObject(t)?yN.merge(e,t):yN.isPlainObject(t)?yN.merge({},t):yN.isArray(t)?t.slice():t}function i(n){return yN.isUndefined(t[n])?yN.isUndefined(e[n])?void 0:r(void 0,e[n]):r(e[n],t[n])}function o(e){if(!yN.isUndefined(t[e]))return r(void 0,t[e])}function s(n){return yN.isUndefined(t[n])?yN.isUndefined(e[n])?void 0:r(void 0,e[n]):r(void 0,t[n])}function a(n){return n in t?r(e[n],t[n]):n in e?r(void 0,e[n]):void 0}var c={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a};return yN.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=c[e]||i,r=t(e);yN.isUndefined(r)&&t!==a||(n[e]=r)})),n},CN="0.27.2",ON=Uw,bN={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){bN[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var wN={};bN.transitional=function(e,t,n){function r(e,t){return"[Axios v0.27.2] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,i,o){if(!1===e)throw new ON(r(i," has been removed"+(t?" in "+t:"")),ON.ERR_DEPRECATED);return t&&!wN[i]&&(wN[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,o)}};var NN=Sw,DN=bw,LN=Dw,PN=function(e){return vN(e),e.headers=e.headers||{},e.data=mN.call(e,e.data,e.headers,e.transformRequest),e.headers=_N.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),_N.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||TN.adapter)(e).then((function(t){return vN(e),t.data=mN.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return IN(t)||(vN(e),t&&t.response&&(t.response.data=mN.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},kN=SN,xN=Hw,MN={assertOptions:function(e,t,n){if("object"!=typeof e)throw new ON("options must be an object",ON.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(e),i=r.length;i-- >0;){var o=r[i],s=t[o];if(s){var a=e[o],c=void 0===a||s(a,o,e);if(!0!==c)throw new ON("option "+o+" must be "+c,ON.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new ON("Unknown option "+o,ON.ERR_BAD_OPTION)}},validators:bN},UN=MN.validators;function BN(e){this.defaults=e,this.interceptors={request:new LN,response:new LN}}BN.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=kN(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var n=t.transitional;void 0!==n&&MN.assertOptions(n,{silentJSONParsing:UN.transitional(UN.boolean),forcedJSONParsing:UN.transitional(UN.boolean),clarifyTimeoutError:UN.transitional(UN.boolean)},!1);var r=[],i=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,r.unshift(e.fulfilled,e.rejected))}));var o,s=[];if(this.interceptors.response.forEach((function(e){s.push(e.fulfilled,e.rejected)})),!i){var a=[PN,void 0];for(Array.prototype.unshift.apply(a,r),a=a.concat(s),o=Promise.resolve(t);a.length;)o=o.then(a.shift(),a.shift());return o}for(var c=t;r.length;){var u=r.shift(),l=r.shift();try{c=u(c)}catch(e){l(e);break}}try{o=PN(c)}catch(e){return Promise.reject(e)}for(;s.length;)o=o.then(s.shift(),s.shift());return o},BN.prototype.getUri=function(e){e=kN(this.defaults,e);var t=xN(e.baseURL,e.url);return DN(t,e.params,e.paramsSerializer)},NN.forEach(["delete","get","head","options"],(function(e){BN.prototype[e]=function(t,n){return this.request(kN(n||{},{method:e,url:t,data:(n||{}).data}))}})),NN.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,i){return this.request(kN(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}BN.prototype[e]=t(),BN.prototype[e+"Form"]=t(!0)}));var FN=BN,VN=Jw;function GN(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,r=n._listeners.length;for(t=0;t<r;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e){n.reason||(n.reason=new VN(e),t(n.reason))}))}GN.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},GN.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},GN.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},GN.source=function(){var e;return{token:new GN((function(t){e=t})),cancel:e}};var QN=GN,jN=Sw,HN=Sw,WN=aw,YN=FN,KN=SN,$N=function e(t){var n=new YN(t),r=WN(YN.prototype.request,n);return HN.extend(r,YN.prototype,n),HN.extend(r,n),r.create=function(n){return e(KN(t,n))},r}(fN);$N.Axios=YN,$N.CanceledError=Jw,$N.CancelToken=QN,$N.isCancel=gN,$N.VERSION=CN,$N.toFormData=Vw,$N.AxiosError=Uw,$N.Cancel=$N.CanceledError,$N.all=function(e){return Promise.all(e)},$N.spread=function(e){return function(t){return e.apply(null,t)}},$N.isAxiosError=function(e){return jN.isObject(e)&&!0===e.isAxiosError},sw.exports=$N,sw.exports.default=$N;var zN=sw.exports;class qN{constructor(e){iw(this,"logger",void 0),iw(this,"prefixLists",[]),this.logger=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.debug(...this.prefixLists,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.info(...this.prefixLists,...t)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.warning(...this.prefixLists,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger.error(...this.prefixLists,...t)}prefix(e){return this.prefixLists.push(e),this}popPrefix(){return this.prefixLists.pop(),this}}class JN{constructor(){iw(this,"_events",{}),iw(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map((e=>e.listener)):[]}on(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;const n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&n.splice(r,1),0===this._events[e].length&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const t=this._events[e].map((e=>e));for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(let n=0;n<t.length;n+=1){const i=t[n];i.once&&this.off(e,i.listener),i.listener.apply(this,r||[])}}_indexOfListener(e,t){let n=e.length;for(;n--;)if(e[n].listener===t)return n;return-1}}const XN=new class extends JN{reportLogUploadError(e){this.emit("REPORT_LOG_UPLOAD",e)}};let ZN;!function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",e.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",e.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED"}(ZN||(ZN={}));class eD extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;super(t),iw(this,"code",void 0),iw(this,"message",void 0),iw(this,"data",void 0),iw(this,"name","AgoraRTCException"),this.code=e,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=n}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),"\n").concat(this.stack):"".concat(this.stack)}print(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error";return"error"===e&&uD.error(this.toString()),"warning"===e&&uD.warning(this.toString()),this}throw(){throw this.print(),this}}const tD={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function nD(e,t){const n=Math.floor(t.timeout*Math.pow(t.timeoutFactor,e));return Math.min(t.maxRetryTimeout,n)}function rD(e,t,n,r){const i=Object.assign({},tD,r);let o=i.timeout;const s=async()=>{await function(e){return new xv((t=>{window.setTimeout(t,e)}))}(o),o*=i.timeoutFactor,o=Math.min(i.maxRetryTimeout,o)};let a=!1;const c=new xv((async(r,o)=>{t=t||(()=>!1),n=n||(()=>!0);for(let c=0;c<i.maxRetryCount;c+=1){if(a)return o(new eD(ZN.OPERATION_ABORTED));try{const n=await e();if(!t(n,c))return r(n);if(c+1===i.maxRetryCount)return r(n);await s()}catch(e){if(!n(e,c))return o(e);if(c+1===i.maxRetryCount)return o(e);await s()}}}));return c.cancel=()=>a=!0,c}function iD(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function oD(){const e=new Date,t=/((\d+:){2}\d+)/.exec((new Date).toUTCString());return t?(null==t?void 0:t[0])+":"+e.getUTCMilliseconds():e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const sD={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},aD=Date.now(),cD=e=>{for(const t in sD)if(Object.prototype.hasOwnProperty.call(sD,t)&&sD[t]===e)return t;return"DEFAULT"},uD=new class{constructor(){iw(this,"proxyServerURL",void 0),iw(this,"logLevel",sD.DEBUG),iw(this,"uploadState","collecting"),iw(this,"uploadLogWaitingList",[]),iw(this,"uploadLogUploadingList",[]),iw(this,"uploadErrorCount",0),iw(this,"currentLogID",0),iw(this,"url",void 0),iw(this,"extLog",((e,t)=>{this.appendLogToWaitingList(e,...t)}))}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[sD.DEBUG].concat(t);this.log.apply(this,r)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[sD.INFO].concat(t);this.log.apply(this,r)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[sD.WARNING].concat(t);this.log.apply(this,r)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[sD.ERROR].concat(t);this.log.apply(this,r)}upload(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[sD.DEBUG].concat(t);this.uploadLog.apply(this,r)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){KD("UPLOAD_LOG",!0)}disableLogUpload(){KD("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new qN(this).prefix(e)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Date.now()-aD<100)return void setTimeout((()=>{this.log(...t)}),Date.now()-aD);const r=Math.max(0,Math.min(4,t[0]));if(t[0]=iD()+" Agora-SDK [".concat(cD(r),"]:"),this.appendLogToWaitingList(r,...t),r<this.logLevel)return;const i=iD()+" %cAgora-SDK [".concat(cD(r),"]:");let o=[];if(!$D("USE_NEW_LOG"))switch(r){case sD.DEBUG:o=[i,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,o);break;case sD.INFO:o=[i,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,o);break;case sD.WARNING:o=[i,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,o);break;case sD.ERROR:o=[i,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,o)}}uploadLog(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Date.now()-aD<100)return void setTimeout((()=>{this.uploadLog(...t)}),Date.now()-aD);const r=Math.max(0,Math.min(4,t[0]));t[0]=iD()+" Agora-SDK [".concat(cD(r),"]:"),this.appendLogToWaitingList(r,...t)}appendLogToWaitingList(e){if(!$D("UPLOAD_LOG"))return;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Array.isArray(n[0])?n[0][0]=oD()+" Agora-SDK [".concat(cD(e),"]:"):n[0]=oD()+" Agora-SDK [".concat(cD(e),"]:");let i="";n.forEach((e=>{"object"==typeof e&&(e=JSON.stringify(e)),i+="".concat(e," ")})),this.uploadLogWaitingList.push({payload_str:i,log_level:e,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}async uploadLogs(){const e=this.uploadLogUploadingList,t={sdk_version:MD,process_id:$D("PROCESS_ID"),payload:JSON.stringify(e)};return rD((async()=>{const e=await zN.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat($D("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat($D("LOG_UPLOAD_SERVER"),"/upload/v1")),t,{responseType:"text"});if("OK"!==e.data){const t=new Error("unexpected upload log response");throw t.response=e,t}}),(()=>(this.uploadLogUploadingList=[],!1)),(e=>(e.response?XN.reportLogUploadError({status:e.response.status,data:e.response.data,headers:e.response.headers,message:e.message}):e.request?XN.reportLogUploadError({status:e.request.status,message:e.message}):XN.reportLogUploadError({status:-1,message:e.message}),!0)),{timeout:$D("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:$D("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,$D("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then((()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout((()=>this.uploadLogInterval()),$D("UPLOAD_LOG_INTERVAL"))})).catch((e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout((()=>this.uploadLogInterval()),$D("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout((()=>this.uploadLogInterval()),$D("UPLOAD_LOG_RETRY_INTERVAL_V1"))})))}},lD={debug:console.log,info:console.log,warning:console.warn,error:console.error},dD={debug:"color: #64B5F6;",info:"color: #1E88E5; font-weight: bold;",warning:"color: #FB8C00; font-weight: bold;",error:"color: #B00020; font-weight: bold;"},hD={debug:0,info:1,warning:2,error:3},pD=[];let fD,AD=0,ED=0,gD=!1;function _D(){const e=new Date;return[e.getTime(),e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()]}function mD(e){if(!$D("UPLOAD_LOG"))return;let t;switch(e.type){case uP.MISC:t=[e.timestamp,e.level,e.type,e.module,e.instanceId,[e.msg]];break;case uP.INTERNAL_EVENT:case uP.PUBLIC_EVENT:case uP.WEB_EVENT:t=[e.timestamp,e.level,e.type,e.module,e.instanceId,[e.event,e.msg]];break;case uP.INTERNAL_API:case uP.PUBLIC_API:case uP.WEB_API:t=[e.timestamp,e.level,e.type,e.module,e.instanceId,[e.api,e.args,e.result]]}pD.push(t)}function ID(e,t){const[n,r]=_D(),i="warning",o="".concat(r," %cAgora-SDK [").concat(i,"] [INTERNAL API]:"),s={[uP.WEB_API]:"logWebAPI",[uP.PUBLIC_API]:"logPublicAPI",[uP.INTERNAL_API]:"logInternalAPI",[uP.WEB_EVENT]:"logWebEvent",[uP.PUBLIC_EVENT]:"logPublicEvent",[uP.INTERNAL_EVENT]:"logInternalEvent",[uP.MISC]:"logMisc"}[e],a=[o,dD.warning,"Log.".concat(s),t];$D("USE_NEW_LOG")&&(RD(i)&&lD.warning.apply(console,a),mD({timestamp:n,level:i,module:"Log",instanceId:void 0,type:uP.INTERNAL_API,api:s,args:void 0,result:t.toString()}))}function TD(e){if(Array.isArray(e)){let[t,n]=e;return t||(t="Global"),{module:t,instanceId:n}}let t,n;if("string"!=typeof e.__moduleName)throw new Error("Cannot get __moduleName from log instance.");t=e.__moduleName;try{n=e.__instanceId}catch(e){throw new Error("Cannot get __instanceId from log instance.")}return{module:t,instanceId:n}}function RD(e){return hD[e]>=ED}function vD(e,t,n,r,i,o){if(e===uP.PUBLIC_API||e===uP.WEB_API||e===uP.INTERNAL_API)try{const{module:s,instanceId:a}=TD(n);i=i&&JSON.stringify(i),o=o instanceof Error?o.toString():o&&JSON.stringify(o);const[c,u]=_D(),l=["".concat(u," %cAgora-SDK [").concat(t,"] [").concat({[uP.PUBLIC_API]:"PUBLIC API",[uP.WEB_API]:"WEB API",[uP.INTERNAL_API]:"INTERNAL API"}[e],"]:"),dD[t],"".concat(s).concat(a?"<".concat(a,">"):"",".").concat(r),i,o];$D("USE_NEW_LOG")&&(RD(t)&&lD[t].apply(console,l),mD({timestamp:c,level:t,module:s,instanceId:a,type:e,api:r,args:i,result:o}))}catch(t){ID(e,t)}}function yD(e,t,n,r,i){if(e===uP.WEB_EVENT||e===uP.INTERNAL_EVENT||e===uP.PUBLIC_EVENT)try{const{module:o,instanceId:s}=TD(n);"string"!=typeof i&&(i=i instanceof Error?i.toString():JSON.stringify(i));const[a,c]=_D(),u=["".concat(c," %cAgora-SDK [").concat(t,"] [").concat({[uP.WEB_EVENT]:"WEB EVENT",[uP.PUBLIC_EVENT]:"PUBLIC EVENT",[uP.INTERNAL_EVENT]:"INTERNAL EVENT"}[e],"]:"),dD[t],"".concat(o).concat(s?"<".concat(s,">"):"",".on(").concat(r,")"),i||""];$D("USE_NEW_LOG")&&(RD(t)&&lD[t].apply(console,u),mD({timestamp:a,level:t,module:o,instanceId:s,type:e,event:r,msg:i}))}catch(t){ID(e,t)}}function SD(e){fD=e}function CD(e,t,n){try{const{module:r,instanceId:i}=TD(t),[o,s]=_D(),a=["".concat(s," %cAgora-SDK [").concat(e,"] [MISC]:"),dD[e],"".concat(r).concat(i?"<".concat(i,">"):""),'"'.concat(n,'"')];$D("USE_NEW_LOG")&&(RD(e)&&lD[e].apply(console,a),mD({timestamp:o,level:e,module:r,instanceId:i,type:uP.MISC,msg:n}))}catch(e){ND("warning",["log"],"logMisc",void 0,e)}}function OD(e,t,n,r){yD(uP.INTERNAL_EVENT,e,t,n,r)}function bD(e,t,n,r){yD(uP.PUBLIC_EVENT,e,t,n,r)}function wD(e,t,n,r){yD(uP.WEB_EVENT,e,t,n,r)}function ND(e,t,n,r,i){vD(uP.INTERNAL_API,e,t,n,r,i)}function DD(e,t,n,r,i){vD(uP.WEB_API,e,t,n,r,i)}function LD(e,t,n,r,i){vD(uP.PUBLIC_API,e,t,n,r,i)}function PD(e,t){return function(n){return class extends n{get __moduleName(){return e}get __instanceId(){if(t){if("function"==typeof this[t])return this[t]();{const e=t.split(".");return e.length>0?lh(e).call(e,((e,t)=>{try{return e?e[t]:e}catch(e){return}}),this):this[t]}}}}}}async function kD(e){if(!e&&gD)return;if(gD=!0,!$D("UPLOAD_LOG"))return void setTimeout((()=>kD(!0)),$D("UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF"));if(0===pD.length)return void setTimeout((()=>kD(!0)),$D("UPLOAD_LOG_INTERVAL"));const t=pD.slice(0,$D("UPLOAD_LOG_LENGTH_EACH_TIME")),n={sdk_version:MD,log_version:$D("LOG_VERSION"),process_id:$D("PROCESS_ID"),index:AD,logs:JSON.stringify(t)};await rD((async()=>{const e=await zN.post(fD?"https://".concat(fD,"/ls/?h=").concat($D("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat($D("LOG_UPLOAD_SERVER"),"/upload/v1"),n,{responseType:"text"});if("OK"!==e.data)throw new Error("Log service response error ".concat(e.data));return e}),void 0,void 0,{timeout:$D("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:$D("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")}),pD.splice(0,$D("UPLOAD_LOG_LENGTH_EACH_TIME")),AD+=t.length,setTimeout((()=>kD(!0)),$D("UPLOAD_LOG_INTERVAL"))}const xD="v4.14.2-0-gbfc9ed7c-dirty(10/27/2022, 5:51:01 PM)",MD=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(t&&t[1]&&t[2]){const e=t[1],n=t[2];return"".concat(e,".").concat(n)}const n=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(n&&n[1]&&n[2]){const e=n[1],t=n[2];return"".concat(e,".").concat(100*(Number(t)+1))}return"4.0.0.999"}("4.14.2"),UD=function(){try{return!0===JSON.parse("true")}catch(e){return!0}}(),BD=function(){const e="us".concat("erna","me"),t="pa".concat("sswo","rd"),n=["t","s","t"];n.splice(1,0,"e");const r=n.join(""),i=[];for(let e=0;e<6;e++)i.push("1");const o=i.join(""),s={};return s[e]=r,s[t]=o,Object.assign(s,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=BD;const FD={"90p":XD(160,90),"90p_1":XD(160,90),"120p":XD(160,120,15,30,65),"120p_1":XD(160,120,15,30,65),"120p_3":XD(120,120,15,30,50),"120p_4":XD(212,120),"180p":XD(320,180,15,30,140),"180p_1":XD(320,180,15,30,140),"180p_3":XD(180,180,15,30,100),"180p_4":XD(240,180,15,30,120),"240p":XD(320,240,15,40,200),"240p_1":XD(320,240,15,40,200),"240p_3":XD(240,240,15,40,140),"240p_4":XD(424,240,15,40,220),"360p":XD(640,360,15,80,400),"360p_1":XD(640,360,15,80,400),"360p_3":XD(360,360,15,80,260),"360p_4":XD(640,360,30,80,600),"360p_6":XD(360,360,30,80,400),"360p_7":XD(480,360,15,80,320),"360p_8":XD(480,360,30,80,490),"360p_9":XD(640,360,15,80,800),"360p_10":XD(640,360,24,80,800),"360p_11":XD(640,360,24,80,1e3),"480p":XD(640,480,15,100,500),"480p_1":XD(640,480,15,100,500),"480p_2":XD(640,480,30,100,1e3),"480p_3":XD(480,480,15,100,400),"480p_4":XD(640,480,30,100,750),"480p_6":XD(480,480,30,100,600),"480p_8":XD(848,480,15,100,610),"480p_9":XD(848,480,30,100,930),"480p_10":XD(640,480,10,100,400),"720p":XD(1280,720,15,120,1130),"720p_1":XD(1280,720,15,120,1130),"720p_2":XD(1280,720,30,120,2e3),"720p_3":XD(1280,720,30,120,1710),"720p_5":XD(960,720,15,120,910),"720p_6":XD(960,720,30,120,1380),"1080p":XD(1920,1080,15,120,2080),"1080p_1":XD(1920,1080,15,120,2080),"1080p_2":XD(1920,1080,30,120,3e3),"1080p_3":XD(1920,1080,30,120,3150),"1080p_5":XD(1920,1080,60,120,4780),"1440p":XD(2560,1440,30,120,4850),"1440p_1":XD(2560,1440,30,120,4850),"1440p_2":XD(2560,1440,60,120,7350),"4k":XD(3840,2160,30,120,8910),"4k_1":XD(3840,2160,30,120,8910),"4k_3":XD(3840,2160,60,120,13500)},VD={"480p":ZD(640,480,5),"480p_1":ZD(640,480,5),"480p_2":ZD(640,480,30),"480p_3":ZD(640,480,15),"720p":ZD(1280,720,5),"720p_1":ZD(1280,720,5),"720p_2":ZD(1280,720,30),"720p_3":ZD(1280,720,15),"1080p":ZD(1920,1080,5),"1080p_1":ZD(1920,1080,5),"1080p_2":ZD(1920,1080,30),"1080p_3":ZD(1920,1080,15)},GD={"1SL1TL":eL(1,1),"3SL3TL":eL(3,3),"2SL3TL":eL(2,3)};function QD(e){return"string"==typeof e?Object.assign({},FD[e]):e}function jD(e){return"string"==typeof e?Object.assign({},VD[e]):e}function HD(e){return"string"==typeof e?Object.assign({},GD[e]):e}const WD={speech_low_quality:JD(16e3,!1),speech_standard:JD(32e3,!1,18),music_standard:JD(48e3,!1),standard_stereo:JD(48e3,!0,56),high_quality:JD(48e3,!1,128),high_quality_stereo:JD(48e3,!0,192)};function YD(e){return"string"==typeof e?Object.assign({},WD[e]):e}function KD(e,t,n){Object.keys(zD).includes(e)&&(!n&&Object.keys(qD).includes(e)||(zD[e]=t))}function $D(e){return zD[e]}const zD={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TCC:!0,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION:2e3,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0},qD={};function JD(e,t,n){return{sampleRate:e,stereo:t,bitrate:n}}function XD(e,t,n,r,i){return{width:e,height:t,frameRate:n,bitrateMin:r,bitrateMax:i}}function ZD(e,t,n,r,i){return{width:{max:e},height:{max:t},frameRate:n,bitrateMin:r,bitrateMax:i}}function eL(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}UD||(zD.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],zD.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],zD.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],zD.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],zD.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],zD.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],zD.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",zD.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",zD.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",zD.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",zD.AREAS=["NORTH_AMERICA","OVERSEA"]);const tL=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],nL=[],rL=[];var iL=Pl,oL=cd,sL=qc,aL=function(e,t,n){var r=iL(t);r in e?oL.f(e,r,sL(0,n)):e[r]=n},cL=eE,uL=jd,lL=aL,dL=Lc.Array,hL=Math.max,pL=function(e,t,n){for(var r=uL(e),i=cL(t,r),o=cL(void 0===n?r:n,r),s=dL(hL(o-i,0)),a=0;i<o;i++,a++)lL(s,a,e[i]);return s.length=a,s},fL=pL,AL=Math.floor,EL=function(e,t){var n=e.length,r=AL(n/2);return n<8?gL(e,t):_L(e,EL(fL(e,0,r),t),EL(fL(e,r),t),t)},gL=function(e,t){for(var n,r,i=e.length,o=1;o<i;){for(r=o,n=e[o];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==o++&&(e[r]=n)}return e},_L=function(e,t,n,r){for(var i=t.length,o=n.length,s=0,a=0;s<i||a<o;)e[s+a]=s<i&&a<o?r(t[s],n[a])<=0?t[s++]:n[a++]:s<i?t[s++]:n[a++];return e},mL=EL,IL=Iu.match(/firefox\/(\d+)/i),TL=!!IL&&+IL[1],RL=/MSIE|Trident/.test(Iu),vL=Iu.match(/AppleWebKit\/(\d+)\./),yL=!!vL&&+vL[1],SL=Ud,CL=wc,OL=ju,bL=il,wL=jd,NL=qg,DL=Rc,LL=mL,PL=Xd,kL=TL,xL=RL,ML=Ou,UL=yL,BL=[],FL=CL(BL.sort),VL=CL(BL.push),GL=DL((function(){BL.sort(void 0)})),QL=DL((function(){BL.sort(null)})),jL=PL("sort"),HL=!DL((function(){if(ML)return ML<70;if(!(kL&&kL>3)){if(xL)return!0;if(UL)return UL<603;var e,t,n,r,i="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(r=0;r<47;r++)BL.push({k:t+r,v:n})}for(BL.sort((function(e,t){return t.v-e.v})),r=0;r<BL.length;r++)t=BL[r].k.charAt(0),i.charAt(i.length-1)!==t&&(i+=t);return"DGBEFHACIJK"!==i}}));SL({target:"Array",proto:!0,forced:GL||!QL||!jL||!HL},{sort:function(e){void 0!==e&&OL(e);var t=bL(this);if(HL)return void 0===e?FL(t):FL(t,e);var n,r,i=[],o=wL(t);for(r=0;r<o;r++)r in t&&VL(i,t[r]);for(LL(i,function(e){return function(t,n){return void 0===n?-1:void 0===t?1:void 0!==e?+e(t,n)||0:NL(t)>NL(n)?1:-1}}(e)),n=i.length,r=0;r<n;)t[r]=i[r++];for(;r<o;)delete t[r++];return t}});var WL=ih("Array").sort,YL=Nc,KL=WL,$L=Array.prototype,zL=function(e){var t=e.sort;return e===$L||YL($L,e)&&t===$L.sort?KL:t};function qL(e,t){if("boolean"!=typeof e)throw new eD(ZN.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function JL(e,t,n){if(!n.includes(e))throw new eD(ZN.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(n)))}function XL(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;if(e<n||e>r||(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&!sP(e))throw new eD(ZN.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(n,", ").concat(r,"]. integer only"))}function ZL(e,t){if("number"!=typeof e){if(!(e.min||e.max||e.ideal||e.exact))throw new eD(ZN.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));void 0!==e.min&&XL(e.min,"".concat(t,".min"),0,1/0),void 0!==e.max&&XL(e.max,"".concat(t,".max"),1,1/0),void 0!==e.exact&&XL(e.exact,"".concat(t,".exact"),1,1/0),void 0!==e.ideal&&XL(e.ideal,"".concat(t,".ideal"),1,1/0)}else XL(e,t,1,1/0)}function eP(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(null==e)throw new eD(ZN.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!oP(e,n,r,i))throw new eD(ZN.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(n,",").concat(r,"].").concat(i?" ASCII characters only.":""))}function tP(e,t){if(!Array.isArray(e))throw new eD(ZN.INVALID_PARAMS,"".concat(t," should be an array"))}function nP(e){if("string"!=typeof e||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw uD.error("Invalid Channel Name ".concat(e)),new eD(ZN.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function rP(e){if(!("number"==typeof(t=e)&&Math.floor(t)===t&&0<=t&&t<=4294967295||oP(e,1,255)))throw uD.error("Invalid UID ".concat(e," ").concat(typeof e)),new eD(ZN.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var t;"string"==typeof e&&uD.warning("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}function iP(e){return null==e}function oP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return"string"==typeof e&&e.length<=n&&e.length>=t&&(!r||aP(e))}function sP(e){return"number"==typeof e&&e%1==0}function aP(e){if("string"!=typeof e)return!1;for(let t=0;t<e.length;t+=1){const n=e.charCodeAt(t);if(n<0||n>255)return!1}return!0}let cP,uP,lP;!function(e){e.FREE="free",e.UPLOADING="uploading"}(cP||(cP={})),function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}(uP||(uP={})),function(e){e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata"}(lP||(lP={}));const dP={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};function hP(e){return eP(e.reportId,"params.reportId",0,100,!1),eP(e.category,"params.category",0,100,!1),eP(e.event,"params.event",0,100,!1),eP(e.label,"params.label",0,100,!1),XL(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}const pP={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};let fP,AP,EP,gP,_P,mP,IP,TP,RP,vP,yP,SP,CP,OP,bP,wP,NP,DP,LP,PP,kP,xP,MP,UP;function BP(e){return XL(e.timeout,"config.timeout",0,1e5),XL(e.timeoutFactor,"config.timeoutFactor",0,100,!1),XL(e.maxRetryCount,"config.maxRetryConfig",0,1/0),XL(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function FP(e){return JL(e.codec,"config.codec",["vp8","vp9","av1","h264"]),JL(e.mode,"config.mode",["rtc","live"]),void 0!==e.audioCodec&&JL(e.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),void 0!==e.proxyServer&&eP(e.proxyServer,"config.proxyServer",1,1e4),void 0!==e.turnServer&&GP(e.turnServer),void 0!==e.httpRetryConfig&&BP(e.httpRetryConfig),void 0!==e.websocketRetryConfig&&BP(e.websocketRetryConfig),!0}function VP(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach((e=>{if(!e.urls)throw Error()}))}catch(e){return!1}return!0}function GP(e){return eP(e.turnServerURL,"turnServerURL"),eP(e.username,"username"),eP(e.password,"password"),e.udpport&&XL(e.udpport,"udpport",1,99999,!0),e.forceturn&&qL(e.forceturn,"forceturn"),e.security&&qL(e.security,"security"),e.tcpport&&XL(e.tcpport,"tcpport",1,99999,!0),!0}function QP(e){return void 0!==e.level&&JL(e.level,"level",[1,2,3]),!0}!function(e){e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics"}(fP||(fP={})),function(e){e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed"}(AP||(AP={})),function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(EP||(EP={})),function(e){e[e.SESSION=26]="SESSION",e[e.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",e[e.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",e[e.JOIN_GATEWAY=28]="JOIN_GATEWAY",e[e.PUBLISH=30]="PUBLISH",e[e.SUBSCRIBE=29]="SUBSCRIBE",e[e.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",e[e.STREAM_SWITCH=32]="STREAM_SWITCH",e[e.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",e[e.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",e[e.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",e[e.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",e[e.API_INVOKE=41]="API_INVOKE",e[e.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",e[e.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",e[e.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",e[e.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",e[e.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",e[e.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",e[e.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",e[e.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",e[e.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",e[e.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",e[e.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",e[e.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",e[e.USER_ANALYTICS=1e4]="USER_ANALYTICS",e[e.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(gP||(gP={})),function(e){e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",e.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",e.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage"}(_P||(_P={})),function(e){e.TRACER="tracer"}(mP||(mP={})),function(e){e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND"}(IP||(IP={})),function(e){e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(TP||(TP={})),function(e){e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(RP||(RP={})),function(e){e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(vP||(vP={})),function(e){e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(yP||(yP={})),function(e){e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(SP||(SP={})),function(e){e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_LICENSE_ILLEGAL=4015]="ERR_LICENSE_ILLEGAL",e[e.ERR_LICENSE_MISSING=4001]="ERR_LICENSE_MISSING",e[e.ERR_LICENSE_EXPIRED=4003]="ERR_LICENSE_EXPIRED",e[e.ERR_LICENSE_MINUTES_EXCEEDED=4005]="ERR_LICENSE_MINUTES_EXCEEDED",e[e.ERR_LICENSE_PERIOD_INVALID=4006]="ERR_LICENSE_PERIOD_INVALID",e[e.ERR_LICENSE_MULTIPLE_SDK_SERVICE=4010]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(CP||(CP={})),function(e){e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(OP||(OP={})),function(e){e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.FALLBACK="FALLBACK"}(bP||(bP={})),function(e){e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.INJECT_STREAM_STATUS="stream-inject-status",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list",e.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",e.CONTENT_INSPECT_ERROR="content-inspect-error",e.CONTENT_INSPECT_RESULT="content-inspect-result"}(wP||(wP={})),function(e){e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK"}(NP||(NP={})),function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed"}(DP||(DP={})),function(e){e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response"}(LP||(LP={})),function(e){e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.SUBSCRIBE="subscribe",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile",e.SET_PARAMETER="set_parameter"}(PP||(PP={})),function(e){e.PUBLISH_STATS="publish_stats",e.PUBLISH_RELATED_STATS="publish_related_stats",e.SUBSCRIBE_STATS="subscribe_stats",e.SUBSCRIBE_RELATED_STATS="subscribe_related_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.TRANSPORT_STATS="transport_stats"}(kP||(kP={})),function(e){e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list"}(xP||(xP={})),function(e){e.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",e.NEED_ANSWER="NEED_ANSWER",e.NEED_RENEGOTIATE="NEED_RENEGOTIATE",e.P2P_LOST="P2P_LOST",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NEED_UNPUB="NEED_UNPUB",e.NEED_UNSUB="NEED_UNSUB",e.NEED_UPLOAD="NEED_UPLOAD",e.NEED_CONTROL="NEED_CONTROL",e.START_RECONNECT="START_RECONNECT",e.END_RECONNECT="END_RECONNECT",e.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(MP||(MP={})),function(e){e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source"}(UP||(UP={}));const jP={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,currentPacketLossRate:0},HP={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},WP={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},YP={uplinkNetworkQuality:0,downlinkNetworkQuality:0},KP={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};let $P,zP,qP;!function(e){e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire"}($P||($P={})),function(e){e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e.INJECT="inject_streaming"}(zP||(zP={})),function(e){e[e.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",e[e.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",e[e.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",e[e.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",e[e.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",e[e.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",e[e.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",e[e.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",e[e.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",e[e.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",e[e.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(qP||(qP={}));const JP={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},XP={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function ZP(e,t){eP(e.url,"".concat(t,".url"),1,1e3,!1),iP(e.x)||XL(e.x,"".concat(t,".x"),0,1e4),iP(e.y)||XL(e.y,"".concat(t,".y"),0,1e4),iP(e.width)||XL(e.width,"".concat(t,".width"),0,1e4),iP(e.height)||XL(e.height,"".concat(t,".height"),0,1e4),iP(e.zOrder)||XL(e.zOrder,"".concat(t,".zOrder"),0,255),iP(e.alpha)||XL(e.alpha,"".concat(t,".alpha"),0,1,!1)}const ek={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},tk={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};let nk,rk,ik,ok,sk,ak,ck,uk,lk,dk,hk,pk,fk,Ak,Ek,gk,_k,mk;function Ik(e){if(!e.channelName)throw new eD(ZN.INVALID_PARAMS,"invalid channelName in info");if(!e.uid||"number"!=typeof e.uid)throw new eD(ZN.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&eP(e.token,"info.token",1,2047),rP(e.uid),nP(e.channelName),!0}function Tk(e){return JL(e,"mediaSource",["screen","window","application"]),!0}!function(e){e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.INJECT_STREAM_STATUS="@live_uap-inject-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address"}(nk||(nk={})),function(e){e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(rk||(rk={})),function(e){e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(ik||(ik={})),function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(ok||(ok={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(sk||(sk={})),function(e){e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}(ak||(ak={})),function(e){e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(ck||(ck={})),function(e){e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(uk||(uk={})),function(e){e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low"}(lk||(lk={})),function(e){e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response"}(dk||(dk={})),function(e){e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data"}(hk||(hk={})),function(e){e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track"}(pk||(pk={})),function(e){e.SCREEN_TRACK="screen_track",e.LOW_STREAM="low_stream"}(fk||(fk={})),function(e){e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM"}(Ak||(Ak={})),function(e){e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY"}(Ek||(Ek={})),function(e){e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed"}(gk||(gk={})),function(e){e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(_k||(_k={})),function(e){e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(mk||(mk={}));const Rk=[mk.AFRICA,mk.ASIA,mk.CHINA,mk.EUROPE,mk.GLOBAL,mk.INDIA,mk.JAPAN,mk.NORTH_AMERICA,mk.OCEANIA,mk.OVERSEA,mk.SOUTH_AMERICA];let vk;!function(e){e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(vk||(vk={}));const yk={CHINA:{},ASIA:{CODE:vk.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:vk.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:vk.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:vk.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","\tuap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:vk.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:vk.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:vk.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:vk.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:vk.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:vk.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:vk.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:vk.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:vk.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};let Sk,Ck,Ok,bk,wk,Nk,Dk,Lk;UD&&(yk.CHINA={CODE:vk.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(e){e.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(Sk||(Sk={}));class Pk extends JN{constructor(e,t){super(),iw(this,"onICEConnectionStateChange",void 0),iw(this,"onConnectionStateChange",void 0),iw(this,"onDTLSTransportStateChange",void 0),iw(this,"onDTLSTransportError",void 0),iw(this,"onICETransportStateChange",void 0),iw(this,"onFirstAudioReceived",void 0),iw(this,"onFirstVideoReceived",void 0),iw(this,"onFirstAudioDecoded",void 0),iw(this,"onFirstVideoDecoded",void 0),iw(this,"onFirstVideoDecodedTimeout",void 0),iw(this,"onSelectedLocalCandidateChanged",void 0),iw(this,"onSelectedRemoteCandidateChanged",void 0)}}!function(e){e.SEND="sendonly",e.RECV="recvonly",e.SENDRECV="sendrecv",e.INACTIVE="inactive"}(Ck||(Ck={})),function(e){e.VIDEO="video",e.AUDIO="audio"}(Ok||(Ok={})),function(e){e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack"}(bk||(bk={})),function(e){e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected"}(wk||(wk={})),function(e){e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange",e.RequestLowStreamParameter="RequestLowStreamParameter"}(Nk||(Nk={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(Dk||(Dk={})),function(e){e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(Lk||(Lk={}));const kk={join:["startJoin","startRequestAp","startJoinGateway","finishJoin"],publish:["startPublish"]};let xk,Mk,Uk,Bk,Fk;!function(e){e.ON_TRACK="on_track",e.ON_NODE="on_node"}(xk||(xk={})),function(e){e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints"}(Mk||(Mk={})),function(e){e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED"}(Uk||(Uk={})),function(e){e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED"}(Bk||(Bk={})),function(e){e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(Fk||(Fk={}));const Vk={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1};function Gk(){return Vk}var Qk="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,jk=jn,Hk=qn,Wk=r.RangeError,Yk=function(e){if(void 0===e)return 0;var t=jk(e),n=Hk(t);if(t!==n)throw Wk("Wrong length or index");return n},Kk=r.Array,$k=Math.abs,zk=Math.pow,qk=Math.floor,Jk=Math.log,Xk=Math.LN2,Zk={pack:function(e,t,n){var r,i,o,s=Kk(n),a=8*n-t-1,c=(1<<a)-1,u=c>>1,l=23===t?zk(2,-24)-zk(2,-77):0,d=e<0||0===e&&1/e<0?1:0,h=0;for((e=$k(e))!=e||e===1/0?(i=e!=e?1:0,r=c):(r=qk(Jk(e)/Xk),e*(o=zk(2,-r))<1&&(r--,o*=2),(e+=r+u>=1?l/o:l*zk(2,1-u))*o>=2&&(r++,o/=2),r+u>=c?(i=0,r=c):r+u>=1?(i=(e*o-1)*zk(2,t),r+=u):(i=e*zk(2,u-1)*zk(2,t),r=0));t>=8;)s[h++]=255&i,i/=256,t-=8;for(r=r<<t|i,a+=t;a>0;)s[h++]=255&r,r/=256,a-=8;return s[--h]|=128*d,s},unpack:function(e,t){var n,r=e.length,i=8*r-t-1,o=(1<<i)-1,s=o>>1,a=i-7,c=r-1,u=e[c--],l=127&u;for(u>>=7;a>0;)l=256*l+e[c--],a-=8;for(n=l&(1<<-a)-1,l>>=-a,a+=t;a>0;)n=256*n+e[c--],a-=8;if(0===l)l=1-s;else{if(l===o)return n?NaN:u?-1/0:1/0;n+=zk(2,t),l-=s}return(u?-1:1)*n*zk(2,l-t)}},ex=Pe,tx=Kn,nx=Xn,rx=ct,ix=yt,ox=g,sx=Kn,ax=Xn,cx=function(e,t,n){var r=rx(t);r in e?ix.f(e,r,ox(0,n)):e[r]=n},ux=r.Array,lx=Math.max,dx=function(e,t,n){for(var r=ax(e),i=sx(t,r),o=sx(void 0===n?r:n,r),s=ux(lx(o-i,0)),a=0;i<o;i++,a++)cx(s,a,e[i]);return s.length=a,s},hx=r,px=v,fx=s,Ax=Qk,Ex=wn,gx=Gt,_x=Hr,mx=o,Ix=ui,Tx=jn,Rx=qn,vx=Yk,yx=Zk,Sx=Pp,Cx=Jr,Ox=Vn.f,bx=yt.f,wx=dx,Nx=ti,Dx=Ex.PROPER,Lx=Ex.CONFIGURABLE,Px=vn.get,kx=vn.set,xx="ArrayBuffer",Mx="Wrong index",Ux=hx.ArrayBuffer,Bx=Ux,Fx=Bx&&Bx.prototype,Vx=hx.DataView,Gx=Vx&&Vx.prototype,Qx=Object.prototype,jx=hx.Array,Hx=hx.RangeError,Wx=px((function(e){for(var t=ex(this),n=nx(t),r=arguments.length,i=tx(r>1?arguments[1]:void 0,n),o=r>2?arguments[2]:void 0,s=void 0===o?n:tx(o,n);s>i;)t[i++]=e;return t})),Yx=px([].reverse),Kx=yx.pack,$x=yx.unpack,zx=function(e){return[255&e]},qx=function(e){return[255&e,e>>8&255]},Jx=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},Xx=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},Zx=function(e){return Kx(e,23,4)},eM=function(e){return Kx(e,52,8)},tM=function(e,t){bx(e.prototype,t,{get:function(){return Px(this)[t]}})},nM=function(e,t,n,r){var i=vx(n),o=Px(e);if(i+t>o.byteLength)throw Hx(Mx);var s=Px(o.buffer).bytes,a=i+o.byteOffset,c=wx(s,a,a+t);return r?c:Yx(c)},rM=function(e,t,n,r,i,o){var s=vx(n),a=Px(e);if(s+t>a.byteLength)throw Hx(Mx);for(var c=Px(a.buffer).bytes,u=s+a.byteOffset,l=r(+i),d=0;d<t;d++)c[u+d]=l[o?d:t-d-1]};if(Ax){var iM=Dx&&Ux.name!==xx;if(mx((function(){Ux(1)}))&&mx((function(){new Ux(-1)}))&&!mx((function(){return new Ux,new Ux(1.5),new Ux(NaN),iM&&!Lx})))iM&&Lx&&gx(Ux,"name",xx);else{(Bx=function(e){return Ix(this,Fx),new Ux(vx(e))}).prototype=Fx;for(var oM,sM=Ox(Ux),aM=0;sM.length>aM;)(oM=sM[aM++])in Bx||gx(Bx,oM,Ux[oM]);Fx.constructor=Bx}Cx&&Sx(Gx)!==Qx&&Cx(Gx,Qx);var cM=new Vx(new Bx(2)),uM=px(Gx.setInt8);cM.setInt8(0,2147483648),cM.setInt8(1,2147483649),!cM.getInt8(0)&&cM.getInt8(1)||_x(Gx,{setInt8:function(e,t){uM(this,e,t<<24>>24)},setUint8:function(e,t){uM(this,e,t<<24>>24)}},{unsafe:!0})}else Fx=(Bx=function(e){Ix(this,Fx);var t=vx(e);kx(this,{bytes:Wx(jx(t),0),byteLength:t}),fx||(this.byteLength=t)}).prototype,Gx=(Vx=function(e,t,n){Ix(this,Gx),Ix(e,Fx);var r=Px(e).byteLength,i=Tx(t);if(i<0||i>r)throw Hx("Wrong offset");if(i+(n=void 0===n?r-i:Rx(n))>r)throw Hx("Wrong length");kx(this,{buffer:e,byteLength:n,byteOffset:i}),fx||(this.buffer=e,this.byteLength=n,this.byteOffset=i)}).prototype,fx&&(tM(Bx,"byteLength"),tM(Vx,"buffer"),tM(Vx,"byteLength"),tM(Vx,"byteOffset")),_x(Gx,{getInt8:function(e){return nM(this,1,e)[0]<<24>>24},getUint8:function(e){return nM(this,1,e)[0]},getInt16:function(e){var t=nM(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=nM(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return Xx(nM(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return Xx(nM(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return $x(nM(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return $x(nM(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){rM(this,1,e,zx,t)},setUint8:function(e,t){rM(this,1,e,zx,t)},setInt16:function(e,t){rM(this,2,e,qx,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){rM(this,2,e,qx,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){rM(this,4,e,Jx,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){rM(this,4,e,Jx,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){rM(this,4,e,Zx,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){rM(this,8,e,eM,t,arguments.length>2?arguments[2]:void 0)}});Nx(Bx,xx),Nx(Vx,"DataView");var lM={ArrayBuffer:Bx,DataView:Vx},dM=Gr,hM=v,pM=o,fM=Nt,AM=Kn,EM=qn,gM=Po,_M=lM.ArrayBuffer,mM=lM.DataView,IM=mM.prototype,TM=hM(_M.prototype.slice),RM=hM(IM.getUint8),vM=hM(IM.setUint8);dM({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:pM((function(){return!new _M(2).slice(1,void 0).byteLength}))},{slice:function(e,t){if(TM&&void 0===t)return TM(fM(this),e);for(var n=fM(this).byteLength,r=AM(e,n),i=AM(void 0===t?n:t,n),o=new(gM(this,_M))(EM(i-r)),s=new mM(this),a=new mM(o),c=0;r<i;)vM(a,c++,RM(s,r++));return o}});var yM,SM,CM,OM={exports:{}},bM=Qk,wM=s,NM=r,DM=F,LM=G,PM=Me,kM=Oi,xM=he,MM=Gt,UM=Qt.exports,BM=yt.f,FM=Y,VM=Pp,GM=Jr,QM=Xe,jM=Ge,HM=NM.Int8Array,WM=HM&&HM.prototype,YM=NM.Uint8ClampedArray,KM=YM&&YM.prototype,$M=HM&&VM(HM),zM=WM&&VM(WM),qM=Object.prototype,JM=NM.TypeError,XM=QM("toStringTag"),ZM=jM("TYPED_ARRAY_TAG"),eU=jM("TYPED_ARRAY_CONSTRUCTOR"),tU=bM&&!!GM&&"Opera"!==kM(NM.opera),nU=!1,rU={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},iU={BigInt64Array:8,BigUint64Array:8},oU=function(e){if(!LM(e))return!1;var t=kM(e);return PM(rU,t)||PM(iU,t)};for(yM in rU)(CM=(SM=NM[yM])&&SM.prototype)?MM(CM,eU,SM):tU=!1;for(yM in iU)(CM=(SM=NM[yM])&&SM.prototype)&&MM(CM,eU,SM);if((!tU||!DM($M)||$M===Function.prototype)&&($M=function(){throw JM("Incorrect invocation")},tU))for(yM in rU)NM[yM]&&GM(NM[yM],$M);if((!tU||!zM||zM===qM)&&(zM=$M.prototype,tU))for(yM in rU)NM[yM]&&GM(NM[yM].prototype,zM);if(tU&&VM(KM)!==zM&&GM(KM,zM),wM&&!PM(zM,XM))for(yM in nU=!0,BM(zM,XM,{get:function(){return LM(this)?this[ZM]:void 0}}),rU)NM[yM]&&MM(NM[yM],ZM,yM);var sU={NATIVE_ARRAY_BUFFER_VIEWS:tU,TYPED_ARRAY_CONSTRUCTOR:eU,TYPED_ARRAY_TAG:nU&&ZM,aTypedArray:function(e){if(oU(e))return e;throw JM("Target is not a typed array")},aTypedArrayConstructor:function(e){if(DM(e)&&(!GM||FM($M,e)))return e;throw JM(xM(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n,r){if(wM){if(n)for(var i in rU){var o=NM[i];if(o&&PM(o.prototype,e))try{delete o.prototype[e]}catch(n){try{o.prototype[e]=t}catch(e){}}}zM[e]&&!n||UM(zM,e,n?t:tU&&WM[e]||t,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(wM){if(GM){if(n)for(r in rU)if((i=NM[r])&&PM(i,e))try{delete i[e]}catch(e){}if($M[e]&&!n)return;try{return UM($M,e,n?t:tU&&$M[e]||t)}catch(e){}}for(r in rU)!(i=NM[r])||i[e]&&!n||UM(i,e,t)}},isView:function(e){if(!LM(e))return!1;var t=kM(e);return"DataView"===t||PM(rU,t)||PM(iU,t)},isTypedArray:oU,TypedArray:$M,TypedArrayPrototype:zM},aU=r,cU=o,uU=so,lU=sU.NATIVE_ARRAY_BUFFER_VIEWS,dU=aU.ArrayBuffer,hU=aU.Int8Array,pU=!lU||!cU((function(){hU(1)}))||!cU((function(){new hU(-1)}))||!uU((function(e){new hU,new hU(null),new hU(1.5),new hU(e)}),!0)||cU((function(){return 1!==new hU(new dU(2),1,void 0).length})),fU=G,AU=Math.floor,EU=Number.isInteger||function(e){return!fU(e)&&isFinite(e)&&AU(e)===e},gU=jn,_U=r.RangeError,mU=r.RangeError,IU=function(e,t){var n=function(e){var t=gU(e);if(t<0)throw _U("The argument can't be less than 0");return t}(e);if(n%t)throw mU("Wrong offset");return n},TU=pi,RU=l,vU=wo,yU=Pe,SU=Xn,CU=Fi,OU=Li,bU=_i,wU=sU.aTypedArrayConstructor,NU=O,DU=r,LU=Array.isArray||function(e){return"Array"==NU(e)},PU=So,kU=G,xU=Xe("species"),MU=DU.Array,UU=pi,BU=P,FU=Pe,VU=Xn,GU=function(e,t){return new(function(e){var t;return LU(e)&&(t=e.constructor,(PU(t)&&(t===MU||LU(t.prototype))||kU(t)&&null===(t=t[xU]))&&(t=void 0)),void 0===t?MU:t}(e))(0===t?0:t)},QU=v([].push),jU=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,o=6==e,s=7==e,a=5==e||o;return function(c,u,l,d){for(var h,p,f=FU(c),A=BU(f),E=UU(u,l),g=VU(A),_=0,m=d||GU,I=t?m(c,g):n||s?m(c,0):void 0;g>_;_++)if((a||_ in A)&&(p=E(h=A[_],_,f),e))if(t)I[_]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return _;case 2:QU(I,h)}else switch(e){case 4:return!1;case 7:QU(I,h)}return o?-1:r||i?i:I}},HU={forEach:jU(0),map:jU(1),filter:jU(2),some:jU(3),every:jU(4),find:jU(5),findIndex:jU(6),filterReject:jU(7)},WU=Gr,YU=r,KU=l,$U=s,zU=pU,qU=sU,JU=lM,XU=ui,ZU=g,eB=Gt,tB=EU,nB=qn,rB=Yk,iB=IU,oB=ct,sB=Me,aB=Oi,cB=G,uB=le,lB=jh,dB=Y,hB=Jr,pB=Vn.f,fB=function(e){var t,n,r,i,o,s,a=vU(this),c=yU(e),u=arguments.length,l=u>1?arguments[1]:void 0,d=void 0!==l,h=OU(c);if(h&&!bU(h))for(s=(o=CU(c,h)).next,c=[];!(i=RU(s,o)).done;)c.push(i.value);for(d&&u>2&&(l=TU(l,arguments[2])),n=SU(c),r=new(wU(a))(n),t=0;n>t;t++)r[t]=d?l(c[t],t):c[t];return r},AB=HU.forEach,EB=si,gB=yt,_B=i,mB=Gf,IB=vn.get,TB=vn.set,RB=gB.f,vB=_B.f,yB=Math.round,SB=YU.RangeError,CB=JU.ArrayBuffer,OB=CB.prototype,bB=JU.DataView,wB=qU.NATIVE_ARRAY_BUFFER_VIEWS,NB=qU.TYPED_ARRAY_CONSTRUCTOR,DB=qU.TYPED_ARRAY_TAG,LB=qU.TypedArray,PB=qU.TypedArrayPrototype,kB=qU.aTypedArrayConstructor,xB=qU.isTypedArray,MB="BYTES_PER_ELEMENT",UB="Wrong length",BB=function(e,t){kB(e);for(var n=0,r=t.length,i=new e(r);r>n;)i[n]=t[n++];return i},FB=function(e,t){RB(e,t,{get:function(){return IB(this)[t]}})},VB=function(e){var t;return dB(OB,e)||"ArrayBuffer"==(t=aB(e))||"SharedArrayBuffer"==t},GB=function(e,t){return xB(e)&&!uB(t)&&t in e&&tB(+t)&&t>=0},QB=function(e,t){return t=oB(t),GB(e,t)?ZU(2,e[t]):vB(e,t)},jB=function(e,t,n){return t=oB(t),!(GB(e,t)&&cB(n)&&sB(n,"value"))||sB(n,"get")||sB(n,"set")||n.configurable||sB(n,"writable")&&!n.writable||sB(n,"enumerable")&&!n.enumerable?RB(e,t,n):(e[t]=n.value,e)};$U?(wB||(_B.f=QB,gB.f=jB,FB(PB,"buffer"),FB(PB,"byteOffset"),FB(PB,"byteLength"),FB(PB,"length")),WU({target:"Object",stat:!0,forced:!wB},{getOwnPropertyDescriptor:QB,defineProperty:jB}),OM.exports=function(e,t,n){var r=e.match(/\d+$/)[0]/8,i=e+(n?"Clamped":"")+"Array",o="get"+e,s="set"+e,a=YU[i],c=a,u=c&&c.prototype,l={},d=function(e,t){RB(e,t,{get:function(){return function(e,t){var n=IB(e);return n.view[o](t*r+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,i){var o=IB(e);n&&(i=(i=yB(i))<0?0:i>255?255:255&i),o.view[s](t*r+o.byteOffset,i,!0)}(this,t,e)},enumerable:!0})};wB?zU&&(c=t((function(e,t,n,i){return XU(e,u),mB(cB(t)?VB(t)?void 0!==i?new a(t,iB(n,r),i):void 0!==n?new a(t,iB(n,r)):new a(t):xB(t)?BB(c,t):KU(fB,c,t):new a(rB(t)),e,c)})),hB&&hB(c,LB),AB(pB(a),(function(e){e in c||eB(c,e,a[e])})),c.prototype=u):(c=t((function(e,t,n,i){XU(e,u);var o,s,a,l=0,h=0;if(cB(t)){if(!VB(t))return xB(t)?BB(c,t):KU(fB,c,t);o=t,h=iB(n,r);var p=t.byteLength;if(void 0===i){if(p%r)throw SB(UB);if((s=p-h)<0)throw SB(UB)}else if((s=nB(i)*r)+h>p)throw SB(UB);a=s/r}else a=rB(t),o=new CB(s=a*r);for(TB(e,{buffer:o,byteOffset:h,byteLength:s,length:a,view:new bB(o)});l<a;)d(e,l++)})),hB&&hB(c,LB),u=c.prototype=lB(PB)),u.constructor!==c&&eB(u,"constructor",c),eB(u,NB,c),DB&&eB(u,DB,i),l[i]=c,WU({global:!0,forced:c!=a,sham:!wB},l),MB in c||eB(c,MB,r),MB in u||eB(u,MB,r),EB(i)}):OM.exports=function(){},(0,OM.exports)("Uint8",(function(e){return function(t,n,r){return e(this,t,n,r)}}));var HB=Xn,WB=jn,YB=sU.aTypedArray;(0,sU.exportTypedArrayMethod)("at",(function(e){var t=YB(this),n=HB(t),r=WB(e),i=r>=0?r:n+r;return i<0||i>=n?void 0:t[i]}));var KB=r,$B=l,zB=sU,qB=Xn,JB=IU,XB=Pe,ZB=o,eF=KB.RangeError,tF=KB.Int8Array,nF=tF&&tF.prototype,rF=nF&&nF.set,iF=zB.aTypedArray,oF=zB.exportTypedArrayMethod,sF=!ZB((function(){var e=new Uint8ClampedArray(2);return $B(rF,e,{length:1,0:3},1),3!==e[1]})),aF=sF&&zB.NATIVE_ARRAY_BUFFER_VIEWS&&ZB((function(){var e=new tF(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));oF("set",(function(e){iF(this);var t=JB(arguments.length>1?arguments[1]:void 0,1),n=XB(e);if(sF)return $B(rF,this,n,t);var r=this.length,i=qB(n),o=0;if(i+t>r)throw eF("Wrong length");for(;o<i;)this[t+o]=n[o++]}),!sF||aF);var cF=dx,uF=Math.floor,lF=function(e,t){var n=e.length,r=uF(n/2);return n<8?dF(e,t):hF(e,lF(cF(e,0,r),t),lF(cF(e,r),t),t)},dF=function(e,t){for(var n,r,i=e.length,o=1;o<i;){for(r=o,n=e[o];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==o++&&(e[r]=n)}return e},hF=function(e,t,n,r){for(var i=t.length,o=n.length,s=0,a=0;s<i||a<o;)e[s+a]=s<i&&a<o?r(t[s],n[a])<=0?t[s++]:n[a++]:s<i?t[s++]:n[a++];return e},pF=lF,fF=K.match(/firefox\/(\d+)/i),AF=!!fF&&+fF[1],EF=/MSIE|Trident/.test(K),gF=K.match(/AppleWebKit\/(\d+)\./),_F=!!gF&&+gF[1],mF=r,IF=v,TF=o,RF=Ee,vF=pF,yF=sU,SF=AF,CF=EF,OF=ee,bF=_F,wF=mF.Array,NF=yF.aTypedArray,DF=yF.exportTypedArrayMethod,LF=mF.Uint16Array,PF=LF&&IF(LF.prototype.sort),kF=!(!PF||TF((function(){PF(new LF(2),null)}))&&TF((function(){PF(new LF(2),{})}))),xF=!!PF&&!TF((function(){if(OF)return OF<74;if(SF)return SF<67;if(CF)return!0;if(bF)return bF<602;var e,t,n=new LF(516),r=wF(516);for(e=0;e<516;e++)t=e%4,n[e]=515-e,r[e]=e-2*t+3;for(PF(n,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(n[e]!==r[e])return!0}));DF("sort",(function(e){return void 0!==e&&RF(e),xF?PF(this,e):vF(NF(this),function(e){return function(t,n){return void 0!==e?+e(t,n)||0:n!=n?-1:t!=t?1:0===t&&0===n?1/t>0&&1/n<0?1:-1:t>n}}(e))}),!xF||kF);var MF=si,UF=lM.ArrayBuffer;let BF;Gr({global:!0,forced:r.ArrayBuffer!==UF},{ArrayBuffer:UF}),MF("ArrayBuffer"),function(e){e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"}(BF||(BF={}));var FF=eu,VF=Array.isArray||function(e){return"Array"==FF(e)},GF=Lc,QF=VF,jF=OI,HF=pu,WF=vl("species"),YF=GF.Array,KF=function(e,t){return new(function(e){var t;return QF(e)&&(t=e.constructor,(jF(t)&&(t===YF||QF(t.prototype))||HF(t)&&null===(t=t[WF]))&&(t=void 0)),void 0===t?YF:t}(e))(0===t?0:t)},$F=ad,zF=su,qF=il,JF=jd,XF=KF,ZF=wc([].push),eV=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,o=6==e,s=7==e,a=5==e||o;return function(c,u,l,d){for(var h,p,f=qF(c),A=zF(f),E=$F(u,l),g=JF(A),_=0,m=d||XF,I=t?m(c,g):n||s?m(c,0):void 0;g>_;_++)if((a||_ in A)&&(p=E(h=A[_],_,f),e))if(t)I[_]=p;else if(p)switch(e){case 3:return!0;case 5:return h;case 6:return _;case 2:ZF(I,h)}else switch(e){case 4:return!1;case 7:ZF(I,h)}return o?-1:r||i?i:I}},tV={forEach:eV(0),map:eV(1),filter:eV(2),some:eV(3),every:eV(4),find:eV(5),findIndex:eV(6),filterReject:eV(7)},nV=tV.forEach,rV=Xd("forEach")?[].forEach:function(e){return nV(this,e,arguments.length>1?arguments[1]:void 0)};Ud({target:"Array",proto:!0,forced:[].forEach!=rV},{forEach:rV});var iV=ih("Array").forEach,oV=gg,sV=al,aV=Nc,cV=iV,uV=Array.prototype,lV={DOMTokenList:!0,NodeList:!0},dV=il,hV=NE;Ud({target:"Object",stat:!0,forced:Rc((function(){hV(1)}))},{keys:function(e){return hV(dV(e))}});var pV=fu.Object.keys,fV=uh,AV=Ud,EV=VF,gV=wc([].reverse),_V=[1,2];AV({target:"Array",proto:!0,forced:String(_V)===String(_V.reverse())},{reverse:function(){return EV(this)&&(this.length=this.length),gV(this)}});var mV=ih("Array").reverse,IV=Nc,TV=mV,RV=Array.prototype,vV=Rc,yV=Ou,SV=vl("species"),CV=function(e){return yV>=51||!vV((function(){var t=[];return(t.constructor={})[SV]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},OV=Ud,bV=Lc,wV=VF,NV=OI,DV=pu,LV=eE,PV=jd,kV=du,xV=aL,MV=vl,UV=kI,BV=CV("slice"),FV=MV("species"),VV=bV.Array,GV=Math.max;OV({target:"Array",proto:!0,forced:!BV},{slice:function(e,t){var n,r,i,o=kV(this),s=PV(o),a=LV(e,s),c=LV(void 0===t?s:t,s);if(wV(o)&&(n=o.constructor,(NV(n)&&(n===VV||wV(n.prototype))||DV(n)&&null===(n=n[FV]))&&(n=void 0),n===VV||void 0===n))return UV(o,a,c);for(r=new(void 0===n?VV:n)(GV(c-a,0)),i=0;a<c;a++,i++)a in o&&xV(r,i,o[a]);return r.length=i,r}});var QV=ih("Array").slice,jV=Nc,HV=QV,WV=Array.prototype;function YV(e,t,n,r,i){var o,s,a,c={};return function(e){var t=e.forEach;return e===uV||aV(uV,e)&&t===uV.forEach||sV(lV,oV(e))?cV:t}(o=pV(r)).call(o,(function(e){c[e]=r[e]})),c.enumerable=!!c.enumerable,c.configurable=!!c.configurable,("value"in c||c.initializer)&&(c.writable=!0),c=fV(s=function(e){var t=e.reverse;return e===RV||IV(RV,e)&&t===RV.reverse?TV:t}(a=function(e){var t=e.slice;return e===WV||jV(WV,e)&&t===WV.slice?HV:t}(n).call(n)).call(a)).call(s,(function(n,r){return r(e,t,n)||n}),c),i&&void 0!==c.initializer&&(c.value=c.initializer?c.initializer.call(i):void 0,c.initializer=void 0),void 0===c.initializer&&(rw(e,t,c),c=null),c}var KV=ih("Array").keys,$V=gg,zV=al,qV=Nc,JV=KV,XV=Array.prototype,ZV={DOMTokenList:!0,NodeList:!0},eG=function(e){var t=e.keys;return e===XV||qV(XV,e)&&t===XV.keys||zV(ZV,$V(e))?JV:t};function tG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tG(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tG(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let rG=0,iG=0;function oG(e,t,n,r){return new xv(((i,o)=>{t.timeout=t.timeout||$D("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!n?(t.data=JSON.stringify(t.data),rG+=Rj(t.data)):n&&(t.data.size?rG+=t.data.size:t.data instanceof FormData?rG+=function(e){let t=0;return/DingTalk/i.test(navigator.userAgent)&&e.realFormData&&(e=e.realFormData),e.forEach((e=>{t+="string"==typeof e?Rj(e):e.size})),t+138}(t.data):rG+=Rj(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,zN.request(t).then((e=>{"string"==typeof e.data?iG+=Rj(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?iG+=e.data.byteLength:iG+=Rj(JSON.stringify(e.data)),r&&i({data:e.data,headers:e.headers}),i(e.data)})).catch((e=>{zN.isCancel(e)?o(new eD(ZN.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?o(new eD(ZN.NETWORK_TIMEOUT,e.message)):e.response?o(new eD(ZN.NETWORK_RESPONSE_ERROR,e.response.status)):o(new eD(ZN.NETWORK_ERROR,e.message))}))}))}async function sG(e,t){const n=new Blob([t.data],{type:"buffer"});return await oG(e,nG(nG({},t),{},{data:n,headers:{"Content-Type":"application/octet-stream"}}),!0)}const aG=new class extends JN{set networkState(e){uD.info("[".concat(this._moduleName,"]")+"network state changed, "+this._networkState+" -> "+e),this.emit(Lk.NETWORK_STATE_CHANGE,e,this._networkState),e===Dk.ONLINE?this.emit(Lk.ONLINE):e===Dk.OFFLINE&&(this.onlineWaiter=new xv((e=>{this.once(Lk.ONLINE,(()=>{this.onlineWaiter=void 0,e(Dk.ONLINE)}))})),this.emit(Lk.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}constructor(){super(),iw(this,"_moduleName","network-indicator"),iw(this,"_networkState",Dk.ONLINE),iw(this,"onlineWaiter",void 0),window.addEventListener("online",(()=>{this.networkState=Dk.ONLINE})),window.addEventListener("offline",(()=>{this.networkState=Dk.OFFLINE}))}};let cG=!1;const uG=new class extends JN{constructor(){super(...arguments),iw(this,"onAutoplayFailed",void 0),iw(this,"onAudioAutoplayFailed",void 0)}};function lG(){if(wb(),!cG){const e=t=>{t.preventDefault(),cG=!1,qb()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};cG=!0,qb()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),uD.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),uG.onAutoplayFailed?uG.onAutoplayFailed():uG.onAudioAutoplayFailed?uD.warning("AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.\n\n  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."):uD.warning("We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.\n\n  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.\n\n  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."),uG.emit("autoplay-failed")}}function dG(e){return(new TextEncoder).encode(e)}const hG=function(e,t){const n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e),0),n.set(new Uint8Array(t),e.byteLength),n},pG=async e=>function(e,t){let n="";return new Uint8Array(e).forEach((e=>{n+=e.toString(16).padStart(2,"0")})),n}(await crypto.subtle.digest("SHA-256",dG(e)));var fG;function AG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function EG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AG(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AG(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gG(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{report:mG};return function(t,n,r){const i=t[n];if("function"==typeof i){const o="AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name;r.value=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];const a=e.report.reportApiInvoke(this._sessionId||null,{name:"".concat(o,".").concat(n),options:r,tag:mP.TRACER,reportResult:e.reportResult});try{const t=i.apply(this,r);return a.onSuccess(e.reportResult&&t),t}catch(e){throw a.onError(e),e}}}return r}}function _G(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{report:mG};return function(t,n,r){const i=r.value;if("function"==typeof i){let o;o=e.className?e.className:"AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name,r.value=async function(){let t;for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];try{s.length>0&&(JSON.stringify(s),t=s)}catch(e){uD.warning("arguments for method ".concat(o,".").concat(n," not serializable from apiInvoke.")),t=[]}const c=(e.report||mG).reportApiInvoke(this._sessionId||null,{name:"".concat(o,".").concat(n),options:t,tag:mP.TRACER});try{const e=await i.apply(this,s);return c.onSuccess(),e}catch(e){throw c.onError(e),e}}}return r}}const mG=new(PD("AgoraRTCEventReport")(fG=class{constructor(){iw(this,"baseInfoMap",new Map),iw(this,"proxyServer",void 0),iw(this,"clientList",nL),iw(this,"eventUploadTimer",void 0),iw(this,"setSessionIdTimer",void 0),iw(this,"url",void 0),iw(this,"backupUrl",void 0),iw(this,"_appId",void 0),iw(this,"keyEventUploadPendingItems",[]),iw(this,"normalEventUploadPendingItems",[]),iw(this,"apiInvokeUploadPendingItems",[]),iw(this,"apiInvokeCount",0),iw(this,"ltsList",[]),iw(this,"lastSendNormalEventTime",Date.now()),iw(this,"customReportCounterTimer",void 0),iw(this,"customReportCount",0),iw(this,"extApiInvoke",(async e=>{for(const t of e){const e=EG(EG({},t),{},{sid:null,invokeId:++this.apiInvokeCount,tag:mP.TRACER});this.sendApiInvoke(e)}})),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),$D("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),$D("EVENT_REPORT_SEND_INTERVAL"))}adjustSessionStartTime(e){if(!this.baseInfoMap.has(e)&&!this.baseInfoMap.get(e))return uD.error("adjust session ".concat(e," start time, sid is not exist or info is undefined")),void ND("error",this,"adjustSessionStartTime","adjust session ".concat(e," start time, sid is not exist or info is undefined"));const t=this.baseInfoMap.get(e),n=Date.now(),r=t.startTime;t.startTime=n,uD.debug("rewrite session ".concat(e," startTime: ").concat(n," , ").concat(n-r,"ms")),ND("debug",this,"adjustSessionStartTime",void 0,"rewrite session ".concat(e," startTime: ").concat(n," , ").concat(n-r,"ms")),this.baseInfoMap.set(e,t)}setAppId(e){this._appId=e}reportApiInvoke(e,t,n){t.timeout=t.timeout||6e4,t.reportResult=void 0===t.reportResult||t.reportResult;const r=Date.now();this.apiInvokeCount+=1;const i=this.apiInvokeCount,o=()=>({tag:t.tag,invokeId:i,sid:e,name:t.name,apiInvokeTime:r,options:t.options,states:t.states||null}),s=!!$D("SHOW_REPORT_INVOKER_LOG");s&&uD.info("".concat(t.name," start"),t.options);let a=!1;vj(t.timeout).then((()=>{a||(this.sendApiInvoke(EG(EG({},o()),{},{error:ZN.API_INVOKE_TIMEOUT,success:!1})),uD.debug("".concat(t.name," timeout")))}));const c=new eD(ZN.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:e=>{const r=()=>{if(a)throw c;return a=!0,this.sendApiInvoke(EG(EG({},o()),{},{success:!0},t.reportResult&&{result:e})),s&&uD.info("".concat(t.name," onSuccess")),e};return n?jj(r,t.name+"Success",n,(()=>a=!0)):r()},onError:e=>{const r=()=>{if(a)throw e;a=!0,this.sendApiInvoke(EG(EG({},o()),{},{success:!1,error:e})),s&&uD.info("".concat(t.name," onFailure"),e.toString())};return n?jj(r,t.name+"Error",n,(()=>a=!0)):r()}}}sessionInit(e,t){if(this.baseInfoMap.has(e))return;const n=Date.now(),r=this.createBaseInfo(e,n);r.cname=t.cname;const i=Object.assign({},{willUploadConsoleLog:$D("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:UD?"global":"oversea",areas:$D("AREAS")&&$D("AREAS").join(",")},t.extend),o=Date.now(),s=EG(EG({},r),{},{eventType:fP.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,build:xD,lts:o,elapse:o-n,extend:JSON.stringify(i),mode:t.mode,process:$D("PROCESS_ID"),appType:$D("APP_TYPE"),success:!0,version:MD});this.send({type:AP.SESSION,data:s},!0)}joinChooseServer(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=EG(EG({},r),{},{eventType:fP.JOIN_CHOOSE_SERVER,lts:i,eventElapse:i-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:i-n.startTime,success:t.succ,chooseServerAddrList:JSON.stringify(t.serverList),uid:t.uid?parseInt(t.uid):null,cid:t.cid?parseInt(t.cid):null,chooseServerIp:t.csIp||"",opid:t.opid,unilbsServerIds:t.unilbsServerIds,extend:t.extend||void 0,isHttp3:t.isHttp3});this.send({type:AP.JOIN_CHOOSE_SERVER,data:o},!0)}reqUserAccount(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=EG(EG({},r),{},{eventType:fP.REQ_USER_ACCOUNT,lts:i,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:i-n.startTime,eventElapse:i-t.lts,extend:JSON.stringify(t.extend)});this.send({type:AP.REQ_USER_ACCOUNT,data:o},!0)}joinGateway(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info;t.vid&&(r.vid=t.vid),r.uid=t.uid,r.cid=t.cid;const i=Date.now(),{firstSuccess:o,avoidJoinStartTime:s,isProxy:a,addr:c}=t,u=i-(o&&s?s:n.startTime),l=EG(EG({},r),{},{eventType:fP.JOIN_GATEWAY,lts:i,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,elapse:u,eventElapse:i-t.lts,firstSuccess:o}),d=l.success?1:0;if(t.succ&&(n.lastJoinSuccessTime=i),o)this.send({type:AP.JOIN_GATEWAY,data:l},!0);else{let e;if(c)if(a){const t=c.match(/h=(\d{1,3}-){3}\d{1,3}/g),n=c.match(/p=[0-9]{1,6}/g);e={isSuccess:d,gatewayIp:t&&t.length?t[0].split("=")[1].replace(/-/g,"."):"",port:n&&n.length?n[0].split("=")[1]:"",isProxy:a?1:0}}else{const t=c.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),n=c.match(/:[0-9]{1,6}/g);e={isSuccess:d,gatewayIp:t&&t.length?t[0].split("//")[1].replace(/-/g,"."):"",port:n&&n.length?n[0].split(":")[1]:"",isProxy:a?1:0}}else e={isSuccess:d,gatewayIp:"",port:"",isProxy:a?1:0};delete l.success,delete l.eventType,delete l.firstSuccess,l.vid=Number(l.vid);const t=Object.assign({},l,e,{eventType:fP.REJOIN_GATEWAY});this.send({type:AP.RE_JOIN_GATEWAY,data:t},!0)}}joinChannelTimeout(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=Date.now(),i=EG(EG({},n.info),{},{lts:r,timeout:t,elapse:r-n.startTime});this.send({type:AP.JOIN_CHANNEL_TIMEOUT,data:i},!0)}publish(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=EG(EG({},r),{},{eventType:fP.PUBLISH,lts:i,eventElapse:t.eventElapse,elapse:i-n.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid});this.send({type:AP.PUBLISH,data:o},!0)}subscribe(e,t,n){const r=this.baseInfoMap.get(e);if(!r)return;const i=r.info,o=Date.now(),s=EG(EG({},i),{},{eventType:fP.SUBSCRIBE,lts:o,eventElapse:t.eventElapse,elapse:o-r.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid},n&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof t.peerid?s.peerSuid=t.peerid:s.peer=t.peerid,this.send({type:AP.SUBSCRIBE,data:s},!0)}wsCompressorInit(e){var t;const n=[...eG(t=this.baseInfoMap).call(t)],r=n.length?n[0]:"UnableToGetSid",i=this.baseInfoMap.get(r);if(!i)return;const o=i.info,s=Date.now(),a=EG(EG({},o),{},{eventType:fP.WS_COMPRESSOR_INIT,lts:s,eventElapse:e.eventElapse,elapse:s-i.startTime,status:e.status?1:2});this.send({type:AP.WS_COMPRESSOR_INIT,data:a},!0)}firstRemoteVideoDecode(e,t,n,r){const i=this.baseInfoMap.get(e);if(!i)return;const o=i.info,s=Date.now(),a=EG(EG(EG({},o),r),{},{elapse:s-i.startTime,eventType:t,lts:s,firstDecodeFrame:Math.max(s-i.startTime,0),apEnd:Math.max(r.apEnd-i.startTime,0),apStart:Math.max(r.apStart-i.startTime,0),joinGwEnd:Math.max(r.joinGwEnd-i.startTime,0),joinGwStart:Math.max(r.joinGwStart-i.startTime,0),pcEnd:Math.max(r.pcEnd-i.startTime,0),pcStart:Math.max(r.pcStart-i.startTime,0),subscriberEnd:Math.max(r.subscriberEnd-i.startTime,0),subscriberStart:Math.max(r.subscriberStart-i.startTime,0),videoAddNotify:Math.max(r.videoAddNotify-i.startTime,0)});this.send({type:n,data:a},!0)}firstRemoteFrame(e,t,n,r){const i=this.baseInfoMap.get(e);if(!i)return;const o=i.info,s=Date.now(),a=EG(EG(EG({},o),r),{},{elapse:s-i.startTime,eventType:t,lts:s});this.send({type:n,data:a},!0)}onGatewayStream(e,t,n,r){const i=this.baseInfoMap.get(e);if(!i)return;const o=i.info,s=Date.now(),a=EG(EG(EG({},o),r),{},{eventType:t,lts:s});this.send({type:n,data:a},!0)}streamSwitch(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=EG(EG({},r),{},{eventType:fP.STREAM_SWITCH,lts:i,isDual:t.isdual,elapse:i-n.startTime,success:t.succ});this.send({type:AP.STREAM_SWITCH,data:o},!0)}requestProxyAppCenter(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=EG(EG({},r),{},{eventType:fP.REQUEST_PROXY_APPCENTER,lts:i,eventElapse:i-t.lts,elapse:i-n.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:AP.REQUEST_PROXY_APPCENTER,data:o},!0)}requestProxyWorkerManager(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=EG(EG({},r),{},{eventType:fP.REQUEST_PROXY_WORKER_MANAGER,lts:i,eventElapse:i-t.lts,elapse:i-n.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:AP.REQUEST_PROXY_WORKER_MANAGER,data:o},!0)}setProxyServer(e){this.proxyServer=e,e?uD.debug("reportProxyServerurl: ".concat(e)):uD.debug("disable reportProxyServerurl: ".concat(e)),ND("debug",this,"setProxyServer",e)}peerPublishStatus(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=EG(EG({},r),{},{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:t.audioPublishDuration>0?1:-1,videotag:t.videoPublishDuration>0?1:-1,lts:i,elapse:i-n.startTime,joinChannelSuccessElapse:i-(n.lastJoinSuccessTime||i),peerPublishDurationVideo:t.videoPublishDuration,peerPublishDurationAudio:t.audioPublishDuration});this.send({type:AP.PEER_PUBLISH_STATUS,data:o},!0)}workerEvent(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now();(function(e,t,n){const r=e[t];if(!r||"string"!=typeof r)return[e];e[t]="";const i=Rj(JSON.stringify(e));let o=0;const s=[];let a=0;for(let n=0;n<r.length;n++)a+=r.charCodeAt(n)<=127?1:3,a<=1300-i||(s[s.length]=Tj(Tj({},e),{},{[t]:r.substring(o,n)}),o=n,a=r.charCodeAt(n)<=127?1:3);return o!==r.length-1&&(s[s.length]=Tj(Tj({},e),{},{[t]:r.substring(o)})),s})(EG(EG(EG({},r),t),{},{elapse:i-n.startTime,lts:i,productType:"WebRTC"}),"payload").forEach((e=>this.send({type:AP.WORKER_EVENT,data:e},!0)))}apworkerEvent(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=EG(EG(EG({},r),t),{},{elapse:i-n.startTime,lts:i});this.send({type:AP.AP_WORKER_EVENT,data:o},!0)}joinWebProxyAP(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=EG(EG(EG({},r),t),{},{elapse:i-n.startTime,lts:i,extend:t.extend||void 0});this.send({type:AP.JOIN_WEB_PROXY_AP,data:o},!0)}WebSocketQuit(e,t){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,i=Date.now(),o=EG(EG(EG({},r),t),{},{elapse:i-n.startTime,lts:i});this.send({type:AP.WEBSOCKET_QUIT,data:o},!0)}async sendCustomReportMessage(e,t){if(this.customReportCount+=t.length,this.customReportCount>$D("CUSTOM_REPORT_LIMIT"))throw new eD(ZN.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval((()=>{this.customReportCount=0}),5e3));const n=t.map((t=>({type:AP.USER_ANALYTICS,data:EG({sid:e},t)})));try{$D("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(n):await this.postDataToStatsCollector(n)}catch(e){throw uD.error("send custom report message failed",e.toString()),new eD(ZN.CUSTOM_REPORT_SEND_FAILED,e.message)}}autoplayFailed(e,t,n,r){if(!e)return;const i=this.baseInfoMap.get(e);if(!i)return;const o=i.info,s=Date.now(),a=EG(EG({},o),{},{vid:void 0===o.vid?0:Number(o.vid),lts:s,elapse:s-i.startTime,cbRegistered:uG.onAutoplayFailed||uG.onAudioAutoplayFailed?1:-1,errorMsg:n,mediaType:t,trackId:r,extend:void 0});this.send({type:AP.AUTOPLAY_FAILED,data:a},!0)}sendApiInvoke(e){const t=$D("NOT_REPORT_EVENT");if(e.tag&&t.includes&&t.includes(e.tag))return!1;if(null===e.sid)return this.apiInvokeUploadPendingItems.push(e),!1;const n=this.baseInfoMap.get(e.sid);if(!n)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:r,uid:i,cid:o}=n.info;let s;if(e.lts=e.lts||Date.now(),e.error)if(e.error instanceof eD){const{code:t,message:n}=e.error;s=t||n||e.error.toString()}else s=e.error.toString();const a={invokeId:e.invokeId,sid:e.sid,cname:r,cid:o,uid:i,lts:e.lts,success:e.success,elapse:e.lts-n.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?s:void 0,errorMsg:e.error?JSON.stringify(e.error):void 0};return this.send({type:AP.API_INVOKE,data:a},!1),!0}appendSessionId(){this.clientList.forEach((e=>{if(e._sessionId){const t=this.apiInvokeUploadPendingItems.length;for(let n=0;n<t;n++){const t=this.apiInvokeUploadPendingItems.shift();t&&(t.sid=e._sessionId,this.sendApiInvoke(Object.assign({},t)))}}}))}send(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>$D("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,t){const n=[],r=[];for(;e.length;){const t=e.shift();n.length<20?n.push(t):r.push(t)}e.push(...r);for(const e of[...n]){var i;-1!==this.ltsList.indexOf(e.data.lts)?(e.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(e.data.lts)):(this.ltsList.push(e.data.lts),zL(i=this.ltsList).call(i,((e,t)=>e-t)))}return t||(this.lastSendNormalEventTime=Date.now()),n.length&&($D("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(n):this.postDataToStatsCollector(n)).catch((e=>n=>{$D("EVENT_REPORT_RETRY")&&(t?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(e):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(e),this.normalEventUploadPendingItems.length>$D("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-$D("NORMAL_EVENT_QUEUE_CAPACITY")),uD.warning("report: drop normal events"))))})(n)),e}async postDataToStatsCollector2(e){aG.networkState===Dk.OFFLINE&&await xv.race([aG.onlineWaiter,vj(2*tD.maxRetryTimeout)]);const t=e=>{let t=new Uint8Array;return e.forEach((e=>{const n=dG(JSON.stringify(e.data)),r=new ArrayBuffer(5),i=(e=>{let t=0;return Object.entries(AP).forEach((n=>{let[r,i]=n;i===e.type&&(t=gP[r])})),t})(e),o=new DataView(r);o.setUint16(0,n.byteLength,!0),o.setUint8(2,255&i),o.setUint8(3,i>>>8&255),o.setUint8(4,i>>>16&255),t=hG(t,new Uint8Array(r)),t=hG(t,n)})),t},n="event";let r=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat($D("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(n):"https://".concat($D("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(n);for(let i=0;i<2;i+=1){1===i&&(r=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat($D("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(n):"https://".concat($D("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(n));try{await oG(r,{timeout:1e4,data:t(e),headers:EG(EG({token:"32f24ab2ddb74f508aa9286c356cec84",biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(e){if(1===i)throw e;continue}return}}async postDataToStatsCollector(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:e.map((e=>JSON.stringify(e))),vid:(e=>{const t=e&&e.data.sid&&this.baseInfoMap.get(e.data.sid);return t&&t.info.vid&&+t.info.vid||0})(e[0])};aG.networkState===Dk.OFFLINE&&await xv.race([aG.onlineWaiter,vj(2*tD.maxRetryTimeout)]);const r=t?"/events/proto-raws":"/events/messages";let i=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat($D("EVENT_REPORT_DOMAIN"),"&p=").concat($D("STATS_COLLECTOR_PORT"),"&d=").concat(r):"https://".concat($D("EVENT_REPORT_DOMAIN"),":").concat($D("STATS_COLLECTOR_PORT")).concat(r));for(let e=0;e<2;e+=1){1===e&&(i=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat($D("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat($D("STATS_COLLECTOR_PORT"),"&d=").concat(r):"https://".concat($D("EVENT_REPORT_BACKUP_DOMAIN"),":").concat($D("STATS_COLLECTOR_PORT")).concat(r)));try{t?await sG(i,{timeout:1e4,data:n}):await oG(i,{timeout:1e4,data:n})}catch(t){if(1===e)throw t;continue}return}}createBaseInfo(e,t){const n=Object.assign({},pP);return n.sid=e,this.baseInfoMap.set(e,{info:n,startTime:t}),n}reportResourceTiming(e,t){const n=performance.getEntriesByName(e),r=n[n.length-1];r&&this.reportApiInvoke(t,{name:"Client.resourceTiming",options:r,tag:mP.TRACER}).onSuccess()}})||fG);XN.on("REPORT_LOG_UPLOAD",(e=>{e.networkState=aG.networkState,mG.reportApiInvoke(null,{name:"logUploadError",options:e,tag:mP.TRACER})}));class IG extends JN{constructor(e,t){super(),iw(this,"trackMediaType",void 0),iw(this,"_ID",void 0),iw(this,"_hints",[]),iw(this,"_isClosed",!1),iw(this,"_originMediaStreamTrack",void 0),iw(this,"_mediaStreamTrack",void 0),iw(this,"_external",{}),this._ID=t||Sj(8,"track-"),this._originMediaStreamTrack=e,this._mediaStreamTrack=e,function(e){rL.includes(e)||rL.push(e)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(e){if(!e){const e=mG.reportApiInvoke(null,{name:_P.GET_MEDIA_STREAM_TRACK,options:[],tag:mP.TRACER});this._mediaStreamTrack&&"string"==typeof this._mediaStreamTrack.label?e.onSuccess(this._mediaStreamTrack.label):e.onSuccess("")}return this._mediaStreamTrack}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,function(e){const t=rL.indexOf(e);-1!==t&&rL.splice(t,1)}(this),this.emit(gk.CLOSED)}}let TG,RG,vG,yG=1;class SG{constructor(e){iw(this,"lockingPromise",xv.resolve()),iw(this,"locks",0),iw(this,"name",""),iw(this,"lockId",void 0),this.lockId=yG++,e&&(this.name=e),uD.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(e){let t;this.locks+=1,uD.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat("string"==typeof e?e:""));const n=new xv((n=>{t=()=>{this.locks-=1,uD.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat("string"==typeof e?e:"")),n()}})),r=this.lockingPromise.then((()=>t));return this.lockingPromise=this.lockingPromise.then((()=>n)),r}}function CG(e,t){return function(n,r,i){const o=i.value;if("function"!=typeof o)throw new Error("Cannot use mutex on object property.");return i.value=async function(){const n=this[t];if(!n)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(e));const i=await n.lock("From ".concat(e,".").concat(r));try{for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return await o.apply(this,a)}finally{i()}},i}}class OG extends IG{get muted(){return this._muted}get enabled(){return this._enabled}constructor(e,t){super(e,t),iw(this,"_enabled",!0),iw(this,"_muted",!1),iw(this,"_isClosed",!1),iw(this,"_trackProcessors",[]),iw(this,"_enabledMutex",void 0),iw(this,"processor",void 0),iw(this,"processorContext",void 0),iw(this,"_handleTrackEnded",(()=>{this.onTrackEnded()})),this._enabledMutex=new SG("".concat(t)),e.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){return this._originMediaStreamTrack.label}close(){this._isClosed||(this.stop(),this._trackProcessors.forEach((e=>e.destroy())),this._trackProcessors=[],this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,uD.debug("[".concat(this.getTrackId(),"] close")),ND("debug",this,"close"),this.emit(pk.NEED_CLOSE),super.close())}async _registerTrackProcessor(e){if(-1!==this._trackProcessors.indexOf(e))return;const t=this._trackProcessors[this._trackProcessors.length-1];this._trackProcessors.push(e),e.onOutputChange=async()=>{const t=e.output||this._originMediaStreamTrack;this._mediaStreamTrack=t,this._updatePlayerSource(),await Dj(this,pk.NEED_REPLACE_TRACK,this)},t?(t.onOutputChange=async()=>{t.output&&await e.setInput(t.output)},await e.setInput(t.output||t.input||this._originMediaStreamTrack)):await e.setInput(this._originMediaStreamTrack)}_getOutputFromProcessors(){if(0===this._trackProcessors.length)return this._originMediaStreamTrack;const e=this._trackProcessors[this._trackProcessors.length-1];return e.output||e.input||this._originMediaStreamTrack}async _updateOriginMediaStreamTrack(e,t){if(e!==this._originMediaStreamTrack){if(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop(),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._trackProcessors.length>0){await this._trackProcessors[0].setInput(e);const t=this._getOutputFromProcessors();this._mediaStreamTrack=t}else this._mediaStreamTrack=this._originMediaStreamTrack;this._updatePlayerSource(),await Dj(this,pk.NEED_REPLACE_TRACK,this),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}}_getDefaultPlayerConfig(){return{}}onTrackEnded(){uD.debug("[".concat(this.getTrackId(),"] track ended")),wD("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(gk.TRACK_ENDED)}stateCheck(e,t){if(uD.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(e,": ").concat(t,"]")),ND("debug",this,"stateCheck",{stateName:e,state:t,muted:this._muted,enabled:this._enabled}),qL(t,e),this._enabled&&this._muted&&"enabled"===e&&!1===t)throw new eD(ZN.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print();if(!this._enabled&&!this._muted&&"muted"===e&&!0===t)throw new eD(ZN.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print()}getProcessorStats(){return this.processorContext.gatherStats()}}(0,OM.exports)("Float32",(function(e){return function(t,n,r){return e(this,t,n,r)}})),function(e){e.IOS_15_INTERRUPTION_START="ios15-interruption-start",e.IOS_15_INTERRUPTION_END="ios15-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change"}(TG||(TG={})),function(e){e.AUDIO_CONTEXT_CREATED="audio_context_created"}(RG||(RG={})),function(e){e.AIDenoiser="AIDenoiser"}(vG||(vG={}));const bG={audioContextInitOptions:{}},wG=new class extends JN{constructor(){super(),iw(this,"registeredPlugins",[])}setOptions(e,t){bG[e]&&(bG[e]=t)}getOptions(e){return bG[e]}installPlugin(e){e instanceof Object&&e.name&&this.registeredPlugins.push(e.name)}};function NG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function DG(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NG(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NG(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const LG=window.AudioContext||window.webkitAudioContext;let PG=null;const kG=new class extends JN{constructor(){super(...arguments),iw(this,"prevState",void 0),iw(this,"curState",void 0),iw(this,"currentTime",void 0),iw(this,"currentTimeStuckAt",void 0),iw(this,"interruptDetectorTrack",void 0),iw(this,"onLocalAudioTrackMute",(()=>{uD.info("ios15-interruption-start"),OD("info",["WebAudio"],"ios15-interruption-start"),this.emit(TG.IOS_15_INTERRUPTION_START)})),iw(this,"onLocalAudioTrackUnmute",(async()=>{uD.info("ios15-interruption-end"),OD("info",["WebAudio"],"ios15-interruption-end"),"running"!==this.curState||this.duringInterruption?uD.info("ios15-interruption-end-canceled"):(PG&&await PG.suspend(),this.emit(TG.IOS_15_INTERRUPTION_END))}))}get duringInterruption(){return"running"===this.prevState&&"interrupted"===this.curState}bindInterruptDetectorTrack(e){uD.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),ND("debug",["WebAudio"],"bindInterruptDetectorTrack",e.getTrackId()),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){uD.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),ND("debug",["WebAudio"],"unbindInterruptDetectorTrack",e.getTrackId()),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function xG(){if(!PG){if(function(){if(!LG)return uD.error("your browser is not support web audio"),void CD("error",["WebAudio"],"your browser is not support web audio");uD.info("create audio context"),DD("info",["WebAudio"],"WebAudioContext");const e=DG(DG({},wG.getOptions("audioContextInitOptions")),$D("WEBAUDIO_INIT_OPTIONS"));uD.debug("audio context init option:",JSON.stringify(e)),PG=new LG(e),wG.emit(RG.AUDIO_CONTEXT_CREATED,PG),kG.curState=PG.state,PG.onstatechange=()=>{kG.prevState=kG.curState,kG.curState=PG?PG.state:void 0,(Bb()||Wb())&&"running"===kG.prevState&&"interrupted"===kG.curState&&(uD.info("ios-interruption-start"),OD("info",["AudioState"],"ios-interruption-start"),kG.emit(TG.IOS_INTERRUPTION_START)),(Bb()||Wb())&&"interrupted"===kG.prevState&&"running"===kG.curState&&(uD.info("ios-interruption-end"),OD("info",["AudioState"],"ios-interruption-end"),kG.emit(TG.IOS_INTERRUPTION_END)),kG.prevState!==kG.curState&&(uD.debug("AudioContext State Change","".concat(kG.prevState,"=>").concat(kG.curState)),wD("debug",["AudioContext",void 0],"statechange","".concat(kG.prevState,"=>").concat(kG.curState)),kG.emit(TG.STATE_CHANGE))},setInterval((()=>{var e;const t=null===(e=PG)||void 0===e?void 0:e.currentTime;kG.currentTime!==t?(kG.currentTimeStuckAt&&(uD.debug("AudioContext current time resume at ".concat(t)),kG.currentTimeStuckAt=void 0),kG.currentTime=t):(t!==kG.currentTimeStuckAt&&(mG.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:t},tag:mP.TRACER}).onSuccess(),uD.warning("AudioContext current time stuck at ".concat(t))),kG.currentTimeStuckAt=t)}),5e3),async function(e){const t=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let n,r=!1,i=!1,o=!1;function s(t){"running"===e.state?a(!1):Bb()||Wb()?"suspended"===e.state&&(a(!0),t&&e.resume().then(c,c)):"closed"!==e.state&&(a(!0),t&&e.resume().then(c,c))}function a(e){if(r!==e){r=e;for(let n=0,r=t;n<r.length;n+=1){const t=r[n];e?window.addEventListener(t,u,{capture:!0,passive:!0}):window.removeEventListener(t,u,{capture:!0,passive:!0})}}}function c(){s(!1)}function u(){s(!0)}function l(e){if(!o)if(n.paused)if(e){let t;d(!1),o=!0;try{t=n.play(),t?t.then(h,h):(n.addEventListener("playing",h),n.addEventListener("abort",h),n.addEventListener("error",h))}catch(e){h()}}else d(!0);else d(!1)}function d(e){if(i!==e){i=e;for(let n=0,r=t;n<r.length;n++){const t=r[n];e?window.addEventListener(t,p,{capture:!0,passive:!0}):window.removeEventListener(t,p,{capture:!0,passive:!0})}}}function h(){n.removeEventListener("playing",h),n.removeEventListener("abort",h),n.removeEventListener("error",h),o=!1,l(!1)}function p(){l(!0)}if(Bb()){const t=e.createMediaStreamDestination(),r=document.createElement("div");r.innerHTML="<audio x-webkit-airplay='deny'></audio>",n=r.children.item(0),n.controls=!1,n.disableRemotePlayback=!0,n.preload="auto",n.srcObject=t.stream,l(!0)}kG.on(TG.STATE_CHANGE,(function(){s(!0)})),s(!1)}(PG)}(),!PG)throw new eD(ZN.NOT_SUPPORTED,"can not create audio context");return PG}return PG}function MG(e){if(function(){if(null!==UG)return UG;const e=xG(),t=e.createBufferSource(),n=e.createGain(),r=e.createGain();t.connect(n),t.connect(r),t.disconnect(n);let i=!1;try{t.disconnect(n)}catch(e){i=!0}return t.disconnect(),UG=i,i}())return;ND("debug",["WebAudio"],"polyfillAudioNode");const t=e.connect,n=e.disconnect;e.connect=(n,r,i)=>(e._inputNodes||(e._inputNodes=[]),e._inputNodes.includes(n)||(n instanceof AudioNode?(e._inputNodes.push(n),t.call(e,n,r,i)):t.call(e,n,r)),e),e.disconnect=(r,i,o)=>{n.call(e),r?kj(e._inputNodes,r):e._inputNodes=[];for(const n of e._inputNodes)t.call(e,n)}}let UG=null;function BG(e,t){const n=1/t,r=xG();let i=r.createGain();i.gain.value=0,i.connect(r.destination);let o=!1;const s=()=>{if(o)return void(i=null);const t=r.createOscillator();t.onended=s,t.connect(i),t.start(0),t.stop(r.currentTime+n),e(r.currentTime)};return s(),()=>{o=!0}}const FG=uD.prefix("[inject-node]");class VG{constructor(){iw(this,"nodeLists",[]),iw(this,"prevNode",void 0),iw(this,"nextNode",void 0)}get firstNode(){return this.nodeLists[0]}get lastNode(){return this.nodeLists[this.nodeLists.length-1]}get isActive(){return!!this.nodeLists.length}get isConnected(){return!(!this.prevNode||!this.nextNode)}connect(e,t){FG.debug("connect audio node, current list:"+this.nodeLists.length),this.nodeLists.length?(this.prevNode&&this.prevNode.disconnect(),e.connect(this.firstNode),this.nextNode&&this.lastNode&&this.lastNode.disconnect(),this.lastNode.connect(t),this.nodeLists.forEach(((e,t)=>{const n=this.nodeLists[t+1];n&&e.connect(n)}))):e.connect(t),this.nextNode=t,this.prevNode=e}disconnect(){var e;FG.debug("disconnect audio node, current list:"+this.nodeLists.length),this.nodeLists.forEach((e=>{e.disconnect()})),null===(e=this.prevNode)||void 0===e||e.disconnect(),this.prevNode=void 0,this.nextNode=void 0}addNode(e){FG.debug("add node in inject node, current list:",this.nodeLists.length),this.prevNode&&this.nextNode?(this.firstNode||(FG.debug("new node is the first node"),this.prevNode.disconnect(),this.prevNode.connect(e),e.connect(this.nextNode)),this.nextNode&&this.lastNode&&(this.lastNode.disconnect(this.nextNode),this.lastNode.connect(e),e.connect(this.nextNode)),this.nodeLists.push(e)):FG.debug("add node is called before inject node connected")}removeNode(e){FG.debug("remove node in inject node, current list:",this.nodeLists.length);const t=this.nodeLists.indexOf(e);if(-1===t)return void FG.debug("$[inject-node] cannot find the node to be removed");const n=this.nodeLists[t+1],r=this.nodeLists[t-1];0===t&&this.prevNode&&this.nextNode&&(this.prevNode.disconnect(e),n?this.prevNode.connect(n):this.prevNode.connect(this.nextNode)),t===this.nodeLists.length-1&&this.nextNode&&r&&(r.disconnect(e),r.connect(this.nextNode)),0!==t&&t!==this.nodeLists.length-1&&(r.disconnect(e),r.connect(n)),FG.debug("remove node in inject node success, current list:",this.nodeLists.length)}}class GG{constructor(){iw(this,"context",void 0),iw(this,"analyserNode",void 0),iw(this,"sourceNode",void 0),this.context=xG(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(e){if(e!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch(e){}this.sourceNode=e,null==e||e.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode)return 0;if(!this.context||Bb()||Wb()||"running"!==this.context.state&&this.context.resume(),!this.analyserNode)return 0;const e=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(e);else{const t=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(t);for(let n=0;n<e.length;++n)e[n]=t[n]/128-1}const t=lh(e).call(e,((e,t)=>e+t*t),0)/e.length;return Math.max(10*Math.log10(t)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var e,t;null===(e=this.sourceNode)||void 0===e||e.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,null===(t=this.sourceNode)||void 0===t||t.connect(this.analyserNode)}catch(e){uD.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class QG extends JN{get processSourceNode(){return this.sourceNode}set processedNode(e){var t;if(!this.isDestroyed&&this._processedNode!==e){try{var n;null===(n=this.sourceNode)||void 0===n||n.disconnect(this.outputNode)}catch(e){}null===(t=this._processedNode)||void 0===t||t.disconnect(),this._processedNode=e,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),iw(this,"outputNode",void 0),iw(this,"outputTrack",void 0),iw(this,"isPlayed",!1),iw(this,"sourceNode",void 0),iw(this,"context",void 0),iw(this,"audioBufferNode",void 0),iw(this,"destNode",void 0),iw(this,"injectNode",void 0),iw(this,"audioOutputLevel",0),iw(this,"volumeLevelAnalyser",void 0),iw(this,"_processedNode",void 0),iw(this,"playNode",void 0),iw(this,"isDestroyed",!1),iw(this,"onNoAudioInput",void 0),iw(this,"isNoAudioInput",!1),iw(this,"_noAudioInputCount",0),this.context=xG(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),MG(this.outputNode),this.injectNode=new VG,this.volumeLevelAnalyser=new GG}startGetAudioBuffer(e){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=e=>{this.emit(UP.ON_AUDIO_BUFFER,function(e){for(let t=0;t<e.outputBuffer.numberOfChannels;t+=1){const n=e.outputBuffer.getChannelData(t);for(let e=0;e<n.length;e+=1)n[e]=0}return e.inputBuffer}(e))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!Gk().webAudioMediaStreamDest)throw new eD(ZN.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(e){"running"!==this.context.state&&Mj((()=>{kG.emit("autoplay-failed")})),this.isPlayed=!0,this.playNode=e||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch(e){}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;Bb()||Wb()?"suspended"===this.context.state&&this.context.resume():"running"!==this.context.state&&this.context.resume();const t=this.volumeLevelAnalyser.getAnalyserNode();let n;t.getFloatTimeDomainData?(n=new Float32Array(t.fftSize),t.getFloatTimeDomainData(n)):(n=new Uint8Array(t.fftSize),t.getByteTimeDomainData(n));let r=!1;for(let e=0;e<n.length;e++)0!==n[e]&&(r=!0);return r?(this.isNoAudioInput=!1,!0):(await vj(200),await this.checkHasAudioInput(e?e+1:1)&&r)}getAudioVolume(){return this.outputNode.gain.value}setVolume(e){this.outputNode.gain.setValueAtTime(e,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}injectAudioNode(e){this.injectNode.addNode(e)}removeAudioNode(e){this.injectNode.removeNode(e)}disconnect(){var e,t;null===(e=this.processedNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var e;this.processedNode?null===(e=this.processedNode)||void 0===e||e.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class jG extends QG{get isFreeze(){return!1}constructor(e,t,n){var r;if(super(),iw(this,"sourceNode",void 0),iw(this,"track",void 0),iw(this,"clonedTrack",void 0),iw(this,"audioElement",void 0),iw(this,"isCurrentTrackCloned",!1),iw(this,"isRemoteTrack",!1),iw(this,"originVolumeLevelAnalyser",void 0),iw(this,"rebuildWebAudio",(async()=>{if(uD.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void uD.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then((()=>uD.info("resume success"))),uD.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const e=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?e.stop():this.isCurrentTrackCloned=!0;const t=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(t),MG(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const n=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(n,this.context.currentTime),MG(this.outputNode),this.emit(UP.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=t,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()})),"audio"!==e.kind)throw new eD(ZN.UNEXPECTED_ERROR);this.track=e;const i=new MediaStream([this.track]);if(this.isRemoteTrack=!!t,this.sourceNode=this.context.createMediaStreamSource(i),MG(this.sourceNode),n){const e=n.clone();e.enabled=!0,this.clonedTrack=e,uD.debug("create an unmuted track ".concat(e.id," from the original track ").concat(n.id," to get the volume"));const t=this.context.createMediaStreamSource(new MediaStream([e]));MG(t),this.originVolumeLevelAnalyser=new GG,this.originVolumeLevelAnalyser.updateSource(t)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=i;const o=wb();t&&o.os===yb.IOS&&Number(null===(r=o.osVersion)||void 0===r?void 0:r.split(".")[0])<15&&(kG.on(TG.STATE_CHANGE,(()=>{"suspended"===this.context.state?document.body.addEventListener("click",this.rebuildWebAudio,!0):"running"===this.context.state&&this.rebuildWebAudio()})),this.checkHasAudioInput().then((e=>{e||document.body.addEventListener("click",this.rebuildWebAudio,!0)})))}updateTrack(e){this.sourceNode.disconnect(),this.track=e,this.isCurrentTrackCloned=!1;const t=new MediaStream([e]);this.sourceNode=this.context.createMediaStreamSource(t),MG(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(UP.UPDATE_SOURCE),this.audioElement.srcObject=t}destroy(){var e;this.audioElement.srcObject=null,this.audioElement.remove(),kG.off("state-change",this.rebuildWebAudio),null===(e=this.originVolumeLevelAnalyser)||void 0===e||e.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(e){return this.context.createMediaStreamSource(new MediaStream([e]))}updateOriginTrack(e){const t=e.clone();t.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=t),uD.debug("create an unmuted track ".concat(t.id," from the original track ").concat(e.id," to get the volume"));const n=this.context.createMediaStreamSource(new MediaStream([t]));MG(n),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(n)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function HG(e,t){const n=(e,t)=>e?"number"!=typeof e?e.max||e.exact||e.ideal||e.min||t:e:t,r={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:n(t.height,1080),maxWidth:n(t.width,1920)}}};return t.frameRate&&"number"!=typeof t.frameRate?(r.video.mandatory.maxFrameRate=t.frameRate.max,r.video.mandatory.minFrameRate=t.frameRate.min):"number"==typeof t.frameRate&&(r.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(r)}async function WG(e){let t=["window","screen"];"application"!==e&&"window"!==e||(t=["window"]),"screen"===e&&(t=["screen"]);const n=KG();if(!n)throw new eD(ZN.ELECTRON_IS_NULL);let r=null;try{var i;r=(null===(i=n.desktopCapturer)||void 0===i?void 0:i.getSources({types:t}))||n.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch(e){r=null}r&&r.then||(r=new xv(((e,r)=>{n.desktopCapturer.getSources({types:t},((t,n)=>{t?r(t):e(n)}))})));try{return await r}catch(e){throw new eD(ZN.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,e.toString())}}let YG=null;function KG(){if(YG)return YG;try{return YG=window.require("electron"),YG}catch(e){return null}}const $G=new SG("safari");let zG=!1,qG=!1;async function JG(e,t){let n=0,r=null;for(;n<2;)try{r=await XG(e,t,n>0);break}catch(r){if(r instanceof eD)throw uD.error("[".concat(t,"] ").concat(r.toString())),ND("error",[],"getLocalStream",{config:e,id:t},r.toString()),r;const i=ZG(r.name||r.code||r,r.message);if(i.code===ZN.MEDIA_OPTION_INVALID){uD.debug("[".concat(t,"] detect media option invalid, retry")),CD("debug",[],"[".concat(t,"] detect media option invalid, retry")),n+=1,await vj(500);continue}throw uD.error("[".concat(t,"] ").concat(i.toString())),ND("error",[],"getLocalStream",{config:e,id:t},i.toString()),i}if(!r)throw new eD(ZN.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return r}async function XG(e,t,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new eD(ZN.NOT_SUPPORTED,"can not find getUserMedia");n&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const r=Gk(),i=new MediaStream;if(e.audioSource&&i.addTrack(e.audioSource),e.videoSource&&i.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return uD.debug("Using Video Source/ Audio Source"),CD("debug",[],"Using Video Source/ Audio Source"),i;if(e.screen)if(KG())e.screen.sourceId?eQ(i,await HG(e.screen.sourceId,e.screen)):eQ(i,await async function(e){const t=await WG(e.mediaSource),n=await function(e){return new xv(((t,n)=>{const r=document.createElement("div");r.innerText="share screen",r.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const i=document.createElement("div");i.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const o=document.createElement("div");o.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",o.setAttribute("style","height: 12%;");const s=document.createElement("div");s.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const a=document.createElement("div");a.setAttribute("style","text-align: right; padding: 16px 0;");const c=document.createElement("button");c.innerHTML="cancel",c.setAttribute("style","width: 85px;"),c.onclick=()=>{document.body.removeChild(u);const e=new Error("NotAllowedError");e.name="NotAllowedError",n(e)},a.appendChild(c),i.appendChild(o),i.appendChild(s),i.appendChild(a);const u=document.createElement("div");u.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),u.appendChild(r),u.appendChild(i),document.body.appendChild(u),e.map((e=>{if(e.id){const n=document.createElement("div");n.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let r=e.thumbnail;const{width:i}=r.getSize();i>1920&&(r=r.resize({width:1920})),n.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+r.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+e.name.replace(/[\u00A0-\u9999<>\&]/g,(function(e){return"&#"+e.charCodeAt(0)+";"}))+"</span>",n.onclick=()=>{document.body.removeChild(u),t(e.id)},s.appendChild(n)}}))}))}(t);return await HG(n,e)}(e.screen));else if(xb()&&e.screen.extensionId&&e.screen.mandatory){if(!r.getStreamFromExtension)throw new eD(ZN.NOT_SUPPORTED,"This browser does not support screen sharing");uD.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"')),CD("debug",[],"[".concat(t,'] Screen access on chrome stable, looking for extension"'));const n=await(o=e.screen.extensionId,s=t,new xv(((e,t)=>{try{chrome.runtime.sendMessage(o,{getStream:!0},(n=>{if(!n||!n.streamId)return uD.error("[".concat(s,"] No response from Chrome Plugin. Plugin not installed properly"),n),ND("error",[],"getSourceIdFromExtension",{extensionId:o,streamId:s},"No response from Chrome Plugin. Plugin not installed properly, ".concat(n)),void t(new eD(ZN.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));e(n.streamId)}))}catch(e){uD.error("[".concat(s,"] AgoraRTC screensharing plugin is not accessible(").concat(o,")"),e.toString()),ND("error",[],"getSourceIdFromExtension",{extensionId:o,streamId:s},"AgoraRTC screensharing plugin is not accessible(".concat(o,"), ").concat(e.toString())),t(new eD(ZN.CHROME_PLUGIN_NOT_INSTALL))}})));e.screen.mandatory.chromeMediaSourceId=n,eQ(i,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(r.getDisplayMedia){e.screen.mediaSource&&Tk(e.screen.mediaSource);const n={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:"screen"===e.screen.mediaSource?"monitor":e.screen.mediaSource};uD.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:n,audio:!!e.screenAudio})),DD("debug",["mediaDevices",t],"getDisplayMedia",{video:n,audio:!!e.screenAudio,trackId:t}),eQ(i,await navigator.mediaDevices.getDisplayMedia({video:n,audio:!!e.screenAudio}))}else{if(!Ub())throw uD.error("[".concat(t,"] This browser does not support screenSharing")),new eD(ZN.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&Tk(e.screen.mediaSource);const n={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};uD.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(n))),DD("debug",["mediaDevices",t],"getUserMedia",n),eQ(i,await navigator.mediaDevices.getUserMedia(n))}}var o,s;if(!e.video&&!e.audio)return i;let a={video:e.video,audio:e.audio},c=$D("MEDIA_DEVICE_CONSTRAINTS");if(c)try{"string"==typeof c&&(c=JSON.parse(c)),a=function e(t,n){if(!Wj(t)||!Wj(n))return n;if(Array.isArray(t)&&!Array.isArray(n)||!Array.isArray(t)&&Array.isArray(n))return n;if(Array.isArray(n)&&Array.isArray(t)){const r=[...t];for(let i=0;i<n.length;i++)r[i]=e(t[i],n[i]);return r}{const r=Tj({},t);for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(Object.prototype.hasOwnProperty.call(t,i)?r[i]=e(t[i],n[i]):r[i]=n[i]);return r}}(a,c),CD("debug",["mediaDevices",t],"merge configConstraints ".concat(JSON.stringify(c)))}catch(e){}uD.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(a)),DD("debug",["mediaDevices",t],"getUserMedia",a),wb();let u,l=null;(Mb()||Bb()||kb())&&(l=await $G.lock());try{u=await navigator.mediaDevices.getUserMedia(a)}catch(e){throw l&&l(),e}return a.audio&&(zG=!0),a.video&&(qG=!0),eQ(i,u),l&&l(),i}function ZG(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new eD(ZN.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new eD(ZN.DEVICE_NOT_FOUND,"".concat(e,": ").concat(t));case"NotSupportedError":return new eD(ZN.NOT_SUPPORTED,"".concat(e,": ").concat(t));case"NotReadableError":return new eD(ZN.NOT_READABLE,"".concat(e,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new eD(ZN.PERMISSION_DENIED,"".concat(e,": ").concat(t));case"ConstraintNotSatisfiedError":return new eD(ZN.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(t));default:return uD.error("getUserMedia unexpected error",e),ND("error",[],"handleGetUserMediaError",void 0,e),new eD(ZN.UNEXPECTED_ERROR,"".concat(e,": ").concat(t))}}function eQ(e,t){const n=e.getVideoTracks()[0],r=e.getAudioTracks()[0],i=t.getVideoTracks()[0],o=t.getAudioTracks()[0];o&&(r&&e.removeTrack(r),e.addTrack(o)),i&&(n&&e.removeTrack(n),e.addTrack(i))}const tQ=new class extends JN{get state(){return this._state}set state(e){e!==this._state&&(this.emit(TP.STATE_CHANGE,e),this._state=e)}constructor(){super(),iw(this,"_state",IP.IDLE),iw(this,"isAccessMicrophonePermission",!1),iw(this,"isAccessCameraPermission",!1),iw(this,"lastAccessMicrophonePermission",!1),iw(this,"lastAccessCameraPermission",!1),iw(this,"checkdeviceMatched",!1),iw(this,"deviceInfoMap",new Map),this.init().then((()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval((()=>{($D("ENUMERATE_DEVICES_INTERVAL")||zb()&&$b())&&this.updateDevicesInfo()}),$D("ENUMERATE_DEVICES_INTERVAL_TIME"))})).catch((e=>uD.error(e.toString())))}async enumerateDevices(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new eD(ZN.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const r=await navigator.mediaDevices.enumerateDevices(),i=this.checkMediaDeviceInfoIsOk(r);let o=!this.isAccessMicrophonePermission&&e,s=!this.isAccessCameraPermission&&t;i.audio&&(o=!1),i.video&&(s=!1);let a=null,c=null,u=null;if(!n&&(o||s)){if($G.isLocked&&(uD.debug("[device manager] wait GUM lock"),(await $G.lock())(),uD.debug("[device manager] GUM unlock")),zG&&(o=!1,this.isAccessMicrophonePermission=!0),qG&&(s=!1,this.isAccessCameraPermission=!0),uD.debug("[device manager] check media device permissions",e,t,o,s),o&&s){try{u=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(e){const t=ZG(e.name||e.code||e,e.message);if(t.code===ZN.PERMISSION_DENIED)throw t;uD.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(o){try{a=await navigator.mediaDevices.getUserMedia({audio:e})}catch(e){const t=ZG(e.name||e.code||e,e.message);if(t.code===ZN.PERMISSION_DENIED)throw t;uD.warning("getUserMedia failed in getDevices",t)}this.isAccessMicrophonePermission=!0}else if(s){try{c=await navigator.mediaDevices.getUserMedia({video:t})}catch(e){const t=ZG(e.name||e.code||e,e.message);if(t.code===ZN.PERMISSION_DENIED)throw t;uD.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0}uD.debug("[device manager] mic permission",e,"cam permission",t)}try{const e=await navigator.mediaDevices.enumerateDevices();return a&&a.getTracks().forEach((e=>e.stop())),c&&c.getTracks().forEach((e=>e.stop())),u&&u.getTracks().forEach((e=>e.stop())),a=null,c=null,u=null,e}catch(e){return a&&a.getTracks().forEach((e=>e.stop())),c&&c.getTracks().forEach((e=>e.stop())),u&&u.getTracks().forEach((e=>e.stop())),a=null,c=null,u=null,new eD(ZN.ENUMERATE_DEVICES_FAILED,e.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter((e=>"audioinput"===e.kind))}async getCamerasDevices(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter((e=>"videoinput"===e.kind))}async getSpeakers(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter((e=>"audiooutput"===e.kind))}searchDeviceIdByName(e){let t=null;return this.deviceInfoMap.forEach((n=>{n.device.label===e&&(t=n.device.deviceId)})),t}async getDeviceById(e){const t=(await this.enumerateDevices(!0,!0,!0)).find((t=>t.deviceId===e));if(!t)throw new eD(ZN.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return t}async init(){this.state=IP.INITING;try{await this.updateDevicesInfo(),this.state=IP.INITEND}catch(e){throw uD.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=IP.IDLE,("boolean"==typeof isSecureContext?isSecureContext:"https:"===location.protocol||"file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname||"::1"===location.hostname)||new eD(ZN.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){const e=await this.enumerateDevices(!0,!0,!0),t=Date.now(),n=[];if(e[0]&&e[0].label&&!1===this.checkdeviceMatched){this.checkdeviceMatched=!0;const t=e.find((e=>"audioinput"===e.kind&&"default"===e.deviceId)),n=e.find((e=>"audiooutput"===e.kind&&"default"===e.deviceId));t&&n?n.groupId===t.groupId?uD.debug("[device-check] default input ".concat(t.label," and output ").concat(n.label," is the same group")):uD.warning("[device-check] default input ".concat(t.label," and output ").concat(n.label," is not the same group")):uD.debug("[device-check] default input or output not found")}const r=this.checkMediaDeviceInfoIsOk(e);if(e.forEach((e=>{if(!e.deviceId)return;const r=this.deviceInfoMap.get("".concat(e.kind,"_").concat(e.deviceId));if("ACTIVE"!==(r?r.state:"INACTIVE")){const r={initAt:t,updateAt:t,device:e,state:"ACTIVE"};this.deviceInfoMap.set("".concat(e.kind,"_").concat(e.deviceId),r),n.push(r)}r&&(r.updateAt=t)})),this.deviceInfoMap.forEach(((e,r)=>{"ACTIVE"===e.state&&e.updateAt!==t&&(e.state="INACTIVE",n.push(e))})),this.state!==IP.INITEND)return r.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(r.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));n.forEach((e=>{switch(e.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(TP.RECORDING_DEVICE_CHANGED,e);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(TP.CAMERA_DEVICE_CHANGED,e);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(TP.PLAYOUT_DEVICE_CHANGED,e)}})),r.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),r.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const t=e.filter((e=>"audioinput"===e.kind)),n=e.filter((e=>"videoinput"===e.kind)),r={audio:!1,video:!1};for(const e of t)if(e.label&&e.deviceId){r.audio=!0;break}for(const e of n)if(e.label&&e.deviceId){r.video=!0;break}return r}};var nQ;let rQ=PD("AudioElementPlayCenter")(nQ=class{constructor(){iw(this,"onAutoplayFailed",void 0),iw(this,"elementMap",new Map),iw(this,"elementStateMap",new Map),iw(this,"elementsNeedToResume",[]),iw(this,"sinkIdMap",new Map),iw(this,"autoResumeAfterInterruption",(()=>{Array.from(this.elementMap.entries()).forEach((e=>{let[t,n]=e;const r=this.elementStateMap.get(t),i=n.srcObject.getAudioTracks()[0];Gb()?i&&"live"===i.readyState&&"running"===kG.curState&&(uD.debug("auto resume after interruption for iOS 15"),CD("debug",["AudioElementPlayCenter",t],"auto resume after interruption for iOS15"),n.pause(),n.play()):r&&"paused"===r&&i&&"live"===i.readyState&&"running"===kG.curState&&(uD.debug("auto resume after interruption for iOS"),CD("debug",["AudioElementPlayCenter",t],"auto resume after interruption for iOS"),n.play())}))})),iw(this,"autoResumeAfterInterruptionOnIOS15",(()=>{Array.from(this.elementMap.entries()).forEach((e=>{let[t,n]=e;const r=n.srcObject.getAudioTracks()[0];r&&"live"===r.readyState&&(uD.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),ND("debug",["AudioElementPlayCenter",t],"autoResumeAfterInterruptionOnIOS15"),n.pause(),n.play())}))})),this.autoResumeAudioElement(),kG.on(TG.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),kG.on(TG.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),kG.on(TG.STATE_CHANGE,(()=>{Bb()&&"suspended"===kG.prevState&&"running"===kG.curState&&this.autoResumeAfterInterruption()}))}async setSinkID(e,t){const n=this.elementMap.get(e);if(this.sinkIdMap.set(e,t),n)try{await n.setSinkId(t)}catch(e){throw new eD(ZN.PERMISSION_DENIED,"can not set sink id: "+e.toString())}}play(e,t,n,r){if(this.elementMap.has(t))return;const i=document.createElement("audio");i.autoplay=!0,i.srcObject=new MediaStream([e]),this.bindAudioElementEvents(t,i),this.elementMap.set(t,i),this.elementStateMap.set(t,lP.INIT),this.setVolume(t,n);const o=this.sinkIdMap.get(t);if(o)try{i.setSinkId(o).catch((e=>{uD.warning("[".concat(t,"] set sink id failed"),e.toString()),DD("warning",["HTMLAudioElement",t],"setSinkId",e.toString())}))}catch(e){uD.warning("[".concat(t,"] set sink id failed"),e.toString())}const s=i.play();s&&s.then&&s.catch((e=>{r&&mG.autoplayFailed(r,"audio",e.message,t),uD.warning("audio element play warning",e.toString()),DD("warning",["HTMLAudioElement",t],"play",e.toString()),this.elementMap.has(t)&&"NotAllowedError"===e.name&&(uD.warning("detected audio element autoplay failed"),ND("warning",["AudioElementPlayCenter",t],"play",e.toString()),this.elementsNeedToResume.push(i),Mj((()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),lG()})))}))}updateTrack(e,t){const n=this.elementMap.get(e);n&&(n.srcObject=new MediaStream([t]))}isPlaying(e){return this.elementMap.has(e)}setVolume(e,t){const n=this.elementMap.get(e);n&&(t=Math.max(0,Math.min(100,t)),n.volume=t/100)}stop(e){const t=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!t)return;const n=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(n,1),t.srcObject=null,t.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,t){iQ.forEach((n=>{t.addEventListener(n,(t=>{const n=this.elementStateMap.get(e),r="pause"===t.type?"paused":t.type;uD.debug("[".concat(e,"] audio-element-status change ").concat(n," => ").concat(r)),wD("debug",["HTMLAudioElement",e],"statusChange","".concat(n," => ").concat(r)),this.elementStateMap.set(e,r)}))}))}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach((e=>{e.play().then((e=>{uD.debug("Auto resume audio element success"),ND("debug",["AudioElementPlayCenter"],"autoResumeAudioElement")})).catch((e=>{uD.warning("Auto resume audio element failed!",e),ND("warning",["AudioElementPlayCenter"],"autoResumeAudioElement",e.toString())}))})),this.elementsNeedToResume=[]};new xv((e=>{document.body?e():window.addEventListener("load",(()=>e()))})).then((()=>{qb()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0))}))}})||nQ;const iQ=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended"],oQ=new rQ;function sQ(){return function(e,t,n){const r=n.value;return"function"==typeof r&&(n.value=function(){this._isClosed&&new eD(ZN.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning");for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const i=r.apply(this,t);return i instanceof xv?new xv(((e,t)=>{i.then(e).catch(t)})):i}),n}}var aQ,cQ,uQ,lQ,dQ,hQ,pQ,fQ,AQ,EQ,gQ,_Q,mQ,IQ,TQ,RQ,vQ,yQ,SQ,CQ,OQ,bQ,wQ,NQ,DQ,LQ,PQ,kQ,xQ,MQ,UQ=ih("Array").values,BQ=gg,FQ=al,VQ=Nc,GQ=UQ,QQ=Array.prototype,jQ={DOMTokenList:!0,NodeList:!0},HQ=function(e){var t=e.values;return e===QQ||VQ(QQ,e)&&t===QQ.values||FQ(jQ,BQ(e))?GQ:t};class WQ extends JN{constructor(e){super(),iw(this,"name","VideoProcessorDestination"),iw(this,"ID","0"),iw(this,"_source",void 0),iw(this,"videoContext",void 0),iw(this,"inputTrack",void 0),this.videoContext=e}get kind(){return"video"}get enabled(){return!0}pipe(){throw new eD(ZN.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new eD(ZN.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(e){if(e.context!==this.videoContext)throw new Error("ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.\nProbably you are making pipeline like this:\nvideoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).");e.track&&e.track!==this.inputTrack&&(this.inputTrack=e.track,this.emit(xk.ON_TRACK,e.track))}reset(){this.inputTrack=void 0,this.emit(xk.ON_TRACK,void 0)}}class YQ extends JN{constructor(e){super(),iw(this,"constraintsMap",new Map),iw(this,"statsRegistry",[]),iw(this,"trackId",void 0),this.trackId=e}async getConstraints(){return await Nj(this,Mk.REQUEST_CONSTRAINTS)}async requestApplyConstraints(e,t){var n;return uD.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),Dj(this,Mk.REQUEST_UPDATE_CONSTRAINTS,Array.from(HQ(n=this.constraintsMap).call(n)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return uD.info("processor ".concat(e.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(e),Dj(this,Mk.REQUEST_UPDATE_CONSTRAINTS,Array.from(HQ(t=this.constraintsMap).call(t)))}registerStats(e,t,n){this.statsRegistry.find((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t))||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:n})}unregisterStats(e,t){const n=this.statsRegistry.findIndex((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t));-1!==n&&this.statsRegistry.splice(n,1)}gatherStats(){const e=[];for(const{processorID:t,processorName:n,type:r,cb:i}of this.statsRegistry)try{const o=i();e.push({processorID:t,processorName:n,type:r,stats:o})}catch(e){uD.error(new eD(ZN.UNEXPECTED_ERROR,e.message))}return e}}class KQ extends JN{constructor(e){super(),iw(this,"name","AudioProcessorDestination"),iw(this,"ID","0"),iw(this,"inputTrack",void 0),iw(this,"inputNode",void 0),iw(this,"audioProcessorContext",void 0),iw(this,"_source",void 0),this.audioProcessorContext=e}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new eD(ZN.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new eD(ZN.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.emit(xk.ON_TRACK,void 0),this.emit(xk.ON_NODE,void 0)}updateInput(e){if(e.context!==this.audioProcessorContext)throw new Error("ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.\n        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).");e.track&&this.inputTrack!==e.track&&(this.inputTrack=e.track,this.emit(xk.ON_TRACK,this.inputTrack)),e.node&&this.inputNode!==e.node&&(this.inputNode=e.node,this.emit(xk.ON_NODE,this.inputNode))}}class $Q extends JN{constructor(e,t){super(),iw(this,"constraintsMap",new Map),iw(this,"statsRegistry",[]),iw(this,"audioContext",void 0),iw(this,"trackId",void 0),this.audioContext=e,this.trackId=t}async getConstraints(){return Nj(this,Mk.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(e,t){var n;return uD.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),Dj(this,Mk.REQUEST_UPDATE_CONSTRAINTS,Array.from(HQ(n=this.constraintsMap).call(n)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return this.constraintsMap.delete(e),Dj(this,Mk.REQUEST_UPDATE_CONSTRAINTS,Array.from(HQ(t=this.constraintsMap).call(t)))}registerStats(e,t,n){this.statsRegistry.find((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t))||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:n})}unregisterStats(e,t){const n=this.statsRegistry.findIndex((n=>n.processorID===e.ID&&n.processorName===e.name&&n.type===t));-1!==n&&this.statsRegistry.splice(n,1)}gatherStats(){const e=[];for(const{processorID:t,processorName:n,type:r,cb:i}of this.statsRegistry)try{const o=i();e.push({processorID:t,processorName:n,type:r,stats:o})}catch(e){uD.error(new eD(ZN.UNEXPECTED_ERROR,e.message))}return e}}function zQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qQ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?zQ(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zQ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let JQ=(aQ=PD("LocalAudioTrack","getTrackId"),cQ=sQ(),uQ=CG("LocalAudioTrack","_enabledMutex"),lQ=_G({className:"LocalAudioTrack"}),dQ=sQ(),hQ=CG("LocalAudioTrack","_enabledMutex"),pQ=_G({className:"LocalAudioTrack"}),fQ=sQ(),AQ=sQ(),EQ=sQ(),gQ=sQ(),_Q=sQ(),aQ((YV((IQ=class extends OG{get isPlaying(){return this._useAudioElement?oQ.isPlaying(this.getTrackId()):this._source.isPlayed}constructor(e,t,n,r){super(e,n),iw(this,"trackMediaType","audio"),iw(this,"_encoderConfig",void 0),iw(this,"_source",void 0),iw(this,"_enabled",!0),iw(this,"_volume",100),iw(this,"_useAudioElement",!1),iw(this,"_bypassWebAudio",!1),iw(this,"processor",void 0),iw(this,"processorContext",void 0),iw(this,"processorDestination",void 0),iw(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=t,this._getOriginVolumeLevel=!!r,this._source=new jG(e,!1,this._getOriginVolumeLevel?e:void 0),$D("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0),this.processorContext=new $Q(this._source.context,this.getTrackId()),this.processorDestination=new KQ(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(UP.UPDATE_SOURCE,(()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})}))}setVolume(e){XL(e,"volume",0,1e3);const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.LOCAL_AUDIO_TRACK_SET_VOLUME,options:[this.getTrackId(),e]},300);this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&oQ.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return uD.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio.")),void t.onSuccess();const e=this._source.createOutputTrack();this._mediaStreamTrack!==e&&(this._mediaStreamTrack=e,Dj(this,pk.NEED_REPLACE_TRACK,this).then((()=>{uD.debug("[".concat(this.getTrackId(),"] replace web audio track success")),CD("debug",this,"replace web audio track success")})).catch((e=>{uD.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),e),CD("warning",this,"replace web audio track failed ".concat(e.toString()))})))}catch(e){}t.onSuccess()}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),e]});if(!this._useAudioElement)throw new eD(ZN.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{await oQ.setSinkID(this.getTrackId(),e)}catch(e){throw t.onError(e),e}t.onSuccess()}async setEnabled(e,t,n){return this._setEnabled(e,t,n)}async _setEnabled(e,t,n){if(!n){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(uD.info("[".concat(this.getTrackId(),"] start setEnabled"),e),ND("info",this,"setEnabled",e),e){this._originMediaStreamTrack.enabled=!0;try{n||(this._enabled=!0),await Dj(this,pk.NEED_ENABLE_TRACK,this),uD.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success")),ND("info",this,"setEnabled",e,"success")}catch(t){throw n||(this._enabled=!1),uD.error("[".concat(this.getTrackId(),"] setEnabled to true error"),t.toString()),ND("error",this,"setEnabled",e,t.toString()),t}}else{this._originMediaStreamTrack.enabled=!1,n||(this._enabled=!1);try{await Dj(this,pk.NEED_DISABLE_TRACK,this)}catch(t){throw n||(this._enabled=!0),uD.error("[".concat(this.getTrackId(),"] setEnabled to false error"),t.toString()),ND("info",this,"setEnabled",e,t.toString()),t}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,uD.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),ND("debug",this,"setMuted",e),e?await Dj(this,pk.NEED_MUTE_TRACK,this):await Dj(this,pk.NEED_UNMUTE_TRACK,this))}getStats(){return Fj((()=>{uD.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead"),CD("warning",this,"LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")}),"localAudioTrackGetStatsWarning"),Lj(this,pk.GET_STATS)||qQ({},jP)}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(UP.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(UP.ON_AUDIO_BUFFER),this._source.on(UP.ON_AUDIO_BUFFER,(t=>e(t)))}play(){const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.LOCAL_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});uD.debug("[".concat(this.getTrackId(),"] start audio playback")),ND("debug",this,"play"),this._useAudioElement?(uD.debug("[".concat(this.getTrackId(),"] start audio playback in element")),CD("debug",this,"start audio playback in element"),oQ.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play(),e.onSuccess()}stop(){const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.LOCAL_AUDIO_TRACK_STOP,options:[this.getTrackId()]});uD.debug("[".concat(this.getTrackId(),"] stop audio playback")),ND("debug",this,"stop"),this._useAudioElement?oQ.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];uD.debug("[".concat(this.getTrackId(),"] update player source track")),ND("debug",this,"_updatePlayerSource"),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&oQ.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,t){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),e.addEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop(),this._originMediaStreamTrack=e,this.processor&&this.processor.updateInput({track:e,context:this.processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Dj(this,pk.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(e))}renewMediaStreamTrack(e){return xv.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new eD(ZN.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new eD(ZN.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(xk.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e),await Dj(this,pk.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Dj(this,pk.NEED_REPLACE_TRACK,this))})),this.processorDestination.on(xk.ON_NODE,(e=>{this._source.processedNode=e}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(xk.ON_TRACK),this.processorDestination.removeAllListeners(xk.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(Mk.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(Mk.REQUEST_CONSTRAINTS)}}).prototype,"setPlaybackDevice",[cQ],Object.getOwnPropertyDescriptor(IQ.prototype,"setPlaybackDevice"),IQ.prototype),YV(IQ.prototype,"setEnabled",[uQ,lQ,dQ],Object.getOwnPropertyDescriptor(IQ.prototype,"setEnabled"),IQ.prototype),YV(IQ.prototype,"setMuted",[hQ,pQ,fQ],Object.getOwnPropertyDescriptor(IQ.prototype,"setMuted"),IQ.prototype),YV(IQ.prototype,"getStats",[AQ],Object.getOwnPropertyDescriptor(IQ.prototype,"getStats"),IQ.prototype),YV(IQ.prototype,"setAudioFrameCallback",[EQ],Object.getOwnPropertyDescriptor(IQ.prototype,"setAudioFrameCallback"),IQ.prototype),YV(IQ.prototype,"play",[gQ],Object.getOwnPropertyDescriptor(IQ.prototype,"play"),IQ.prototype),YV(IQ.prototype,"stop",[_Q],Object.getOwnPropertyDescriptor(IQ.prototype,"stop"),IQ.prototype),mQ=IQ))||mQ),XQ=(TQ=PD("MicrophoneAudioTrack","getTrackId"),RQ=sQ(),vQ=CG("MicrophoneAudioTrack","_enabledMutex"),yQ=_G({className:"MicrophoneAudioTrack"}),SQ=sQ(),TQ((YV((OQ=class extends JQ{constructor(e,t,n,r){super(e,t.encoderConfig?YD(t.encoderConfig):{},r,$D("GET_VOLUME_OF_MUTED_AUDIO_TRACK")),iw(this,"_config",void 0),iw(this,"_deviceName","default"),iw(this,"_constraints",void 0),iw(this,"_originalConstraints",void 0),iw(this,"_enabled",!0),LD("info",this,"constructor",{trackId:r,deviceId:e.label,constraints:n}),this._config=t,this._constraints=n,this._originalConstraints=n,this._deviceName=e.label,"boolean"==typeof t.bypassWebAudio&&(this._bypassWebAudio=t.bypassWebAudio),Gb()&&kG.bindInterruptDetectorTrack(this),this.bindProcessorContextEvents()}async setDevice(e){const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.MIC_AUDIO_TRACK_SET_DEVICE,options:[this.getTrackId(),e]});if(uD.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),ND("info",this,"setDevice",e),this._enabled)try{const n=await tQ.getDeviceById(e),r={};r.audio=qQ({},this._constraints),r.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let i=null;try{i=await JG(r,this.getTrackId())}catch(t){throw uD.error("[".concat(this.getTrackId(),"] setDevice failed"),t.toString()),ND("error",this,"setDevice",e,t.toString()),i=await JG({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(i.getAudioTracks()[0],!1),t}await this._updateOriginMediaStreamTrack(i.getAudioTracks()[0],!1),this._deviceName=n.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(n){throw t.onError(n),uD.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),ND("error",this,"setDevice",e,n.toString()),n}else try{const t=await tQ.getDeviceById(e);this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(n){throw t.onError(n),uD.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),ND("error",this,"setDevice",e,n.toString()),n}t.onSuccess(),uD.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success")),ND("info",this,"setDevice",e,"success")}async setEnabled(e,t,n){if(t)return uD.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),CD("debug",this,"setEnabled false (do not close microphone)"),await super._setEnabled(e);if(!n){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(uD.info("[".concat(this.getTrackId(),"] start setEnabled"),e),ND("info",this,"setEnabled",e),!e){var r;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),null===(r=this._source.clonedTrack)||void 0===r||r.stop(),n||(this._enabled=!1);try{await Dj(this,pk.NEED_DISABLE_TRACK,this)}catch(t){throw uD.error("[".concat(this.getTrackId(),"] setEnabled false failed"),t.toString()),ND("error",this,"setEnabled",e,t.toString()),t}return}const i=qQ({},this._constraints),o=tQ.searchDeviceIdByName(this._deviceName);o&&!i.deviceId&&(i.deviceId=o);try{n||(this._enabled=!0);const e=await JG({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!1),await Dj(this,pk.NEED_ENABLE_TRACK,this)}catch(t){throw n||(this._enabled=!1),uD.error("[".concat(this.getTrackId(),"] setEnabled true failed"),t.toString()),ND("error",this,"setEnabled",e,t.toString()),t}uD.info("[".concat(this.getTrackId(),"] setEnabled success")),ND("info",this,"setEnabled",e,"success")}close(){super.close(),Gb()&&kG.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((Bb()||Wb())&&this._enabled&&!this._isClosed&&kG.duringInterruption){const e=async()=>{kG.off(TG.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(uD.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),CD("debug",this,"try capture microphone media device for interrupted iOS device"),await this.setEnabled(!1),await this.setEnabled(!0))};kG.on(TG.IOS_INTERRUPTION_END,e)}else uD.debug("[".concat(this.getTrackId(),"] track ended")),wD("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(gk.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,n=tQ.searchDeviceIdByName(this._deviceName);n&&!t.deviceId&&(t.deviceId=n),this._constraints=t,this._originMediaStreamTrack.stop();const r=await JG({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(r.getAudioTracks()[0],!0)}bindProcessorContextEvents(){this.processorContext.on(Mk.REQUEST_UPDATE_CONSTRAINTS,(async(e,t,n)=>{try{const n=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(n),t()}catch(e){n(e)}})),this.processorContext.on(Mk.REQUEST_CONSTRAINTS,(async e=>{e(this._originMediaStreamTrack.getSettings())}))}}).prototype,"setDevice",[RQ],Object.getOwnPropertyDescriptor(OQ.prototype,"setDevice"),OQ.prototype),YV(OQ.prototype,"setEnabled",[vQ,yQ,SQ],Object.getOwnPropertyDescriptor(OQ.prototype,"setEnabled"),OQ.prototype),CQ=OQ))||CQ),ZQ=(bQ=PD("BufferSourceAudioTrack","getTrackId"),wQ=sQ(),NQ=sQ(),DQ=sQ(),LQ=sQ(),PQ=sQ(),bQ((YV((xQ=class extends JQ{constructor(e,t,n,r){super(t.createOutputTrack(),n,r),iw(this,"source",void 0),iw(this,"_bufferSource",void 0),LD("info",this,"constructor",{trackId:r}),this.source=e,this._bufferSource=t,this._bufferSource.on(UP.AUDIO_SOURCE_STATE_CHANGE,(e=>{this.emit(gk.SOURCE_STATE_CHANGE,e)}));try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.BUFFER_AUDIO_TRACK_START,options:[this.getTrackId(),e,this.duration]});e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer(),t.onSuccess()}pauseProcessAudioBuffer(){const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.BUFFER_AUDIO_TRACK_PAUSE,options:[this.getTrackId()]});this._bufferSource.pauseProcessAudioBuffer(),e.onSuccess()}seekAudioBuffer(e){const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.BUFFER_AUDIO_TRACK_SEEK,options:[this.getTrackId()]});this._bufferSource.seekAudioBuffer(e),t.onSuccess()}resumeProcessAudioBuffer(){const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.BUFFER_AUDIO_TRACK_RESUME,options:[this.getTrackId()]});this._bufferSource.resumeProcessAudioBuffer(),e.onSuccess()}stopProcessAudioBuffer(){const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.BUFFER_AUDIO_TRACK_STOP,options:[this.getTrackId()]});this._bufferSource.stopProcessAudioBuffer(),e.onSuccess()}}).prototype,"startProcessAudioBuffer",[wQ],Object.getOwnPropertyDescriptor(xQ.prototype,"startProcessAudioBuffer"),xQ.prototype),YV(xQ.prototype,"pauseProcessAudioBuffer",[NQ],Object.getOwnPropertyDescriptor(xQ.prototype,"pauseProcessAudioBuffer"),xQ.prototype),YV(xQ.prototype,"seekAudioBuffer",[DQ],Object.getOwnPropertyDescriptor(xQ.prototype,"seekAudioBuffer"),xQ.prototype),YV(xQ.prototype,"resumeProcessAudioBuffer",[LQ],Object.getOwnPropertyDescriptor(xQ.prototype,"resumeProcessAudioBuffer"),xQ.prototype),YV(xQ.prototype,"stopProcessAudioBuffer",[PQ],Object.getOwnPropertyDescriptor(xQ.prototype,"stopProcessAudioBuffer"),xQ.prototype),kQ=xQ))||kQ),ej=PD("MixingAudioTrack","getTrackId")(MQ=class extends JQ{get isActive(){for(const e of this.trackList)if(e._enabled&&!e._isClosed&&!e.muted)return!0;return!1}constructor(){const e=xG().createMediaStreamDestination();super(e.stream.getAudioTracks()[0],void 0,Sj(8,"track-mix-")),iw(this,"trackList",void 0),iw(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}this.destNode=e,this.trackList=[]}hasAudioTrack(e){return-1!==this.trackList.indexOf(e)}addAudioTrack(e){if(-1!==this.trackList.indexOf(e))return uD.debug("track ".concat(e.getTrackId()," is already added")),void CD("debug",this,"track already added");uD.debug("add ".concat(e.getTrackId()," to mixing track")),ND("debug",this,"addAudioTrack",e.getTrackId()),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()}removeAudioTrack(e){if(-1!==this.trackList.indexOf(e)){uD.debug("remove ".concat(e.getTrackId()," from mixing track")),ND("debug",this,"removeAudioTrack",e.getTrackId());try{e._source.outputNode.disconnect(this.destNode)}catch(e){}kj(this.trackList,e),this.updateEncoderConfig()}}updateEncoderConfig(){const e={};this.trackList.forEach((t=>{t._encoderConfig&&((t._encoderConfig.bitrate||0)>(e.bitrate||0)&&(e.bitrate=t._encoderConfig.bitrate),(t._encoderConfig.sampleRate||0)>(e.sampleRate||0)&&(e.sampleRate=t._encoderConfig.sampleRate),(t._encoderConfig.sampleSize||0)>(e.sampleSize||0)&&(e.sampleSize=t._encoderConfig.sampleSize),t._encoderConfig.stereo&&(e.stereo=!0))})),this._encoderConfig=e}})||MQ;class tj extends JN{constructor(){super(...arguments),iw(this,"resultStorage",new Map)}setLocalAudioStats(e,t,n){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",e,this.checkAudioInputLevel(n,t)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",e,this.checkSendAudioBitrate(n,t))}setLocalVideoStats(e,t,n){this.record("SEND_VIDEO_BITRATE_TOO_LOW",e,this.checkSendVideoBitrate(n,t)),this.record("FRAMERATE_INPUT_TOO_LOW",e,this.checkFramerateInput(n,t)),this.record("FRAMERATE_SENT_TOO_LOW",e,this.checkFramerateSent(n))}setRemoteAudioStats(e,t){const n=e.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",n,this.checkAudioOutputLevel(t))}setRemoteVideoStats(e,t){const n=e.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",n,this.checkVideoDecode(t))}record(e,t,n){this.resultStorage.has(e)||this.resultStorage.set(e,{result:[],isPrevNormal:!0});const r=this.resultStorage.get(e);if(r&&(r.result.push(n),r.result.length>=5)){const n=r.result.includes(!0);r.isPrevNormal&&!n&&this.emit("exception",nj[e],e,t),!r.isPrevNormal&&n&&this.emit("exception",nj[e]+2e3,e+"_RECOVER",t),r.isPrevNormal=n,r.result=[]}}checkAudioOutputLevel(e){return!(e.receiveBitrate>0&&0===e.receiveLevel)}checkAudioInputLevel(e,t){return t instanceof ej&&!t.isActive||!!t.muted||0!==e.sendVolumeLevel}checkFramerateInput(e,t){let n=null;t._encoderConfig&&t._encoderConfig.frameRate&&(n=hj(t._encoderConfig.frameRate));const r=e.captureFrameRate;return!n||!r||!(n>10&&r<5||n<10&&n>=5&&r<=1)}checkFramerateSent(e){return!(e.captureFrameRate&&e.sendFrameRate&&e.captureFrameRate>5&&e.sendFrameRate<=1)}checkSendVideoBitrate(e,t){return!!t.muted||0!==e.sendBitrate}checkSendAudioBitrate(e,t){return t instanceof ej&&!t.isActive||!!t.muted||0!==e.sendBitrate}checkVideoDecode(e){return 0===e.receiveBitrate||0!==e.decodeFrameRate}}const nj={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},rj=new class{markSubscribeStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(t))}markPublishStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(t))}measureFromSubscribeStart(e,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(t));if(n.length>0){const e=n[n.length-1];return Math.round(performance.now()-e.startTime)}return 0}measureFromPublishStart(e,t){const n=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(t));if(n.length>0){const e=n[n.length-1];return Math.round(performance.now()-e.startTime)}return 0}};function ij(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ij(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ij(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class sj{constructor(e){iw(this,"store",void 0),iw(this,"onStatsException",void 0),iw(this,"onUploadPublishDuration",void 0),iw(this,"localStats",new Map),iw(this,"remoteStats",new Map),iw(this,"updateStatsInterval",void 0),iw(this,"trafficStats",void 0),iw(this,"trafficStatsPeerList",[]),iw(this,"uplinkStats",void 0),iw(this,"exceptionMonitor",void 0),iw(this,"p2pChannel",void 0),iw(this,"updateStats",(()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))})),this.store=e,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new tj,this.exceptionMonitor.on("exception",((e,t,n)=>{this.onStatsException&&this.onStatsException(e,t,n)}))}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(bk.LocalAudioTrack)||oj({},jP)}getLocalVideoTrackStats(){return this.localStats.get(bk.LocalVideoTrack)||oj({},HP)}getRemoteAudioTrackStats(e){const t=(e,t)=>{if(!this.trafficStats)return t;const n=this.trafficStats.peer_delay.find((t=>t.peer_uid===e));return n&&(t.publishDuration=n.B_ppad+(Date.now()-this.trafficStats.timestamp)),t},n={};if(e){var r;const i=null===(r=this.remoteStats.get(e))||void 0===r?void 0:r.audioStats;i&&(n[e]=t(e,i))}else Array.from(this.remoteStats.entries()).forEach((e=>{let[r,{audioStats:i}]=e;i&&(n[r]=t(r,i))}));return n}getRemoteNetworkQualityStats(e){const t={};if(e){var n;const r=null===(n=this.remoteStats.get(e))||void 0===n?void 0:n.networkStats;r&&(t[e]=r)}else Array.from(this.remoteStats.entries()).forEach((e=>{let[n,{networkStats:r}]=e;r&&(t[n]=r)}));return t}getRemoteVideoTrackStats(e){const t=(e,t)=>{if(!this.trafficStats)return t;const n=this.trafficStats.peer_delay.find((t=>t.peer_uid===e));return n&&(t.publishDuration=n.B_ppvd+(Date.now()-this.trafficStats.timestamp)),t},n={};if(e){var r;const i=null===(r=this.remoteStats.get(e))||void 0===r?void 0:r.videoStats;i&&(n[e]=t(e,i))}else Array.from(this.remoteStats.entries()).forEach((e=>{let[r,{videoStats:i}]=e;i&&(n[r]=t(r,i))}));return n}getRTCStats(){let e=0,t=0,n=0,r=0;const i=this.localStats.get(bk.LocalAudioTrack);i&&(e+=i.sendBytes,t+=i.sendBitrate);const o=this.localStats.get(bk.LocalVideoTrack);o&&(e+=o.sendBytes,t+=o.sendBitrate);const s=this.localStats.get(bk.LocalVideoLowTrack);s&&(e+=s.sendBytes,t+=s.sendBitrate),this.remoteStats.forEach((e=>{let{audioStats:t,videoStats:i}=e;t&&(n+=t.receiveBytes,r+=t.receiveBitrate),i&&(n+=i.receiveBytes,r+=i.receiveBitrate)}));let a=1;return this.trafficStats&&(a+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:a,SendBitrate:t,SendBytes:e,RecvBytes:n,RecvBitrate:r,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(e){this.localStats.set(e,void 0)}removeLocalStats(e){e?this.localStats.delete(e):this.localStats.clear()}addRemoteStats(e){this.remoteStats.set(e,{})}removeRemoteStats(e){e?this.remoteStats.delete(e):this.remoteStats.clear()}addP2PChannel(e){this.p2pChannel=e}updateTrafficStats(e){e.peer_delay=e.peer_delay.filter((e=>void 0!==e.B_ppad||void 0!==e.B_ppvd)),e.peer_delay.filter((e=>-1===this.trafficStatsPeerList.indexOf(e.peer_uid))).forEach((e=>{var t;const n=null===(t=this.p2pChannel)||void 0===t?void 0:t.getRemoteMedia(e.peer_uid),r=null!=n&&n.videoSSRC?rj.measureFromSubscribeStart(this.store.clientId,n.videoSSRC):0,i=null!=n&&n.audioSSRC?rj.measureFromSubscribeStart(this.store.clientId,n.audioSSRC):0;void 0!==e.B_ppad&&void 0!==e.B_ppvd&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(e.peer_uid,e.B_ppad,e.B_ppvd,r>i?r:i),this.trafficStatsPeerList.push(e.peer_uid))})),this.trafficStats=e}updateUplinkStats(e){this.uplinkStats&&this.uplinkStats.B_fir!==e.B_fir&&uD.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(e.B_fir)),this.uplinkStats=e}static isRemoteVideoFreeze(e,t,n){if(!e)return!1;const r=!!n&&t.framesDecodeFreezeTime>n.framesDecodeFreezeTime,i=!n||t.framesDecodeCount>n.framesDecodeCount;return r||!i}static isRemoteAudioFreeze(e){return!!e&&e._isFreeze()}isLocalVideoFreeze(e){return!(!e.inputFrame||!e.sentFrame)&&e.inputFrame.frameRate>5&&e.sentFrame.frameRate<3}updateLocalStats(e){Array.from(this.localStats.entries()).forEach((t=>{let[n,r]=t;switch(n){case bk.LocalVideoTrack:case bk.LocalVideoLowTrack:{const t=r,i=oj({},HP),o=e.getStats(),s=e.getLocalMedia(n);if(o){const n=o.videoSend.find((e=>e.ssrc===(null==s?void 0:s.ssrcs[0].ssrcId)));if(n){const r=e.getLocalVideoSize(),o=e.getEncoderConfig(bk.LocalVideoTrack);"H264"!==n.codec&&"VP8"!==n.codec&&"VP9"!==n.codec&&"AV1X"!==n.codec&&"AV1"!==n.codec||(i.codecType=n.codec),i.sendBytes=n.bytes,i.sendBitrate=t?8*Math.max(0,i.sendBytes-t.sendBytes):0,n.inputFrame?(i.captureFrameRate=n.inputFrame.frameRate,i.captureResolutionHeight=n.inputFrame.height,i.captureResolutionWidth=n.inputFrame.width):r&&(i.captureResolutionWidth=r.width,i.captureResolutionHeight=r.height),n.sentFrame?(i.sendFrameRate=n.sentFrame.frameRate,i.sendResolutionHeight=n.sentFrame.height,i.sendResolutionWidth=n.sentFrame.width):r&&(i.sendResolutionWidth=r.width,i.sendResolutionHeight=r.height),n.avgEncodeMs&&(i.encodeDelay=n.avgEncodeMs),o&&o.bitrateMax&&(i.targetSendBitrate=1e3*o.bitrateMax),i.sendPackets=n.packets,i.sendPacketsLost=n.packetsLost,i.totalDuration=t?t.totalDuration+1:1,i.totalFreezeTime=t?t.totalFreezeTime:0,this.isLocalVideoFreeze(n)&&(i.totalFreezeTime+=1)}this.trafficStats&&(i.sendPacketsLost=this.trafficStats.B_pvlr4/100)}this.localStats.set(n,i),i&&s&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,s.track,i);break}case bk.LocalAudioTrack:{const t=r,i=oj({},jP),o=e.getStats(),s=e.getLocalMedia(n);if(o){const n=o.audioSend.find((e=>e.ssrc===(null==s?void 0:s.ssrcs[0].ssrcId)));if(n){if("opus"!==n.codec&&"aac"!==n.codec&&"PCMU"!==n.codec&&"PCMA"!==n.codec&&"G722"!==n.codec||(i.codecType=n.codec),n.inputLevel)i.sendVolumeLevel=Math.round(32767*n.inputLevel);else{const t=e.getLocalAudioVolume();t&&(i.sendVolumeLevel=Math.round(32767*t))}i.sendBytes=n.bytes,i.sendPackets=n.packets,i.sendPacketsLost=n.packetsLost,i.sendBitrate=t?8*Math.max(0,i.sendBytes-t.sendBytes):0}}this.trafficStats&&(i.sendPacketsLost=this.trafficStats.B_pvlr4/100),this.localStats.set(bk.LocalAudioTrack,i),i&&s&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,s.track,i);break}}}))}updateRemoteStats(e){Array.from(this.remoteStats.entries()).forEach((t=>{let[n,{videoStats:r,audioStats:i,videoPcStats:o}]=t;const s=i,a=r,c=o,u=oj({},WP),l=oj({},KP),d=oj({},YP),{audioTrack:h,videoTrack:p,audioSSRC:f,videoSSRC:A}=e.getRemoteMedia(n),E=e.getStats(),g=null==E?void 0:E.audioRecv.find((e=>e.ssrc===f)),_=null==E?void 0:E.videoRecv.find((e=>e.ssrc===A)),m=this.trafficStats&&this.trafficStats.peer_delay.find((e=>e.peer_uid===n));if(g&&("opus"!==g.codec&&"aac"!==g.codec&&"PCMU"!==g.codec&&"PCMA"!==g.codec&&"G722"!==g.codec||(u.codecType=g.codec),g.outputLevel?u.receiveLevel=Math.round(32767*g.outputLevel):h&&(u.receiveLevel=Math.round(32767*h.getVolumeLevel())),u.receiveBytes=g.bytes,u.receivePackets=g.packets,u.receivePacketsLost=g.packetsLost,u.packetLossRate=u.receivePacketsLost/(u.receivePackets+u.receivePacketsLost),u.receiveBitrate=s?8*Math.max(0,u.receiveBytes-s.receiveBytes):0,u.totalDuration=s?s.totalDuration+1:1,u.totalFreezeTime=s?s.totalFreezeTime:0,u.freezeRate=u.totalFreezeTime/u.totalDuration,u.receiveDelay=g.jitterBufferMs,u.totalDuration>10&&sj.isRemoteAudioFreeze(h)&&(u.totalFreezeTime+=1)),_){"H264"!==_.codec&&"VP8"!==_.codec&&"VP9"!==_.codec&&"AV1X"!==_.codec&&"AV1"!==_.codec||(l.codecType=_.codec),l.receiveBytes=_.bytes,l.receiveBitrate=a?8*Math.max(0,l.receiveBytes-a.receiveBytes):0,l.decodeFrameRate=_.decodeFrameRate<0?0:_.decodeFrameRate,l.renderFrameRate=_.decodeFrameRate<0?0:_.decodeFrameRate,_.outputFrame&&(l.renderFrameRate=_.outputFrame.frameRate),_.receivedFrame?(l.receiveFrameRate=_.receivedFrame.frameRate,l.receiveResolutionHeight=_.receivedFrame.height,l.receiveResolutionWidth=_.receivedFrame.width):p&&(l.receiveResolutionHeight=p._videoHeight||0,l.receiveResolutionWidth=p._videoWidth||0),void 0!==_.framesRateFirefox&&(l.receiveFrameRate=Math.round(_.framesRateFirefox)),l.receivePackets=_.packets,l.receivePacketsLost=_.packetsLost,l.packetLossRate=l.receivePacketsLost/(l.receivePackets+l.receivePacketsLost),l.totalDuration=a?a.totalDuration+1:1,l.totalFreezeTime=a?a.totalFreezeTime:0,l.receiveDelay=_.jitterBufferMs||0;const t=!!A&&e.getRemoteVideoIsReady(A);p&&t&&sj.isRemoteVideoFreeze(p,_,c)&&(l.totalFreezeTime+=1),l.freezeRate=l.totalFreezeTime/l.totalDuration}m&&(u.end2EndDelay=m.B_ad,l.end2EndDelay=m.B_vd,u.transportDelay=m.B_ed,l.transportDelay=m.B_ed,u.currentPacketLossRate=m.B_ealr4/100,l.currentPacketLossRate=m.B_evlr4/100,d.uplinkNetworkQuality=m.B_punq?m.B_punq:0,d.downlinkNetworkQuality=m.B_pdnq?m.B_pdnq:0),this.remoteStats.set(n,{audioStats:u,videoStats:l,videoPcStats:_,networkStats:d}),h&&this.exceptionMonitor.setRemoteAudioStats(h,u),p&&this.exceptionMonitor.setRemoteVideoStats(p,l)}))}}function aj(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aj(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aj(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function uj(e){if(!e.address||!e.tcp)throw new eD(ZN.UNEXPECTED_RESPONSE,"Invalid address format ".concat(e));return e.address.match(/^[\.\:\d]+$/)?"".concat(e.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(uD.info("Cannot recognized as IP address ".concat(e.address,". Used As Host instead")),"".concat(e.address,":").concat(e.tcp))}function lj(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat($D("TURN_DOMAIN")):(uD.info("Cannot recognized as IP address ".concat(e,". Used As Host instead")),e)}function dj(e,t){var n,r;const i=$D("GATEWAY_DOMAINS");let o=i[1]&&-1!==t.indexOf(i[1])?1:0;e.addresses=e.addresses||[];const s=e.addresses.map((e=>e.domain_prefix?{address:"".concat(e.domain_prefix,".").concat(i[o++%i.length],":").concat(e.port)}:e.ip.match(/^[\.\:\d]+$/)?{ip:e.ip,port:e.port,address:"".concat(e.ip.replace(/[^\d]/g,"-"),".").concat(i[o++%i.length],":").concat(e.port)}:(uD.info("Cannot recognized as IP address ".concat(e.ip,". Used As Host instead")),{ip:e.ip,port:e.port,address:"".concat(e.ip,":").concat(e.port)})));if(null!==(n=e.detail)&&void 0!==n&&n[18]&&"string"==typeof(null===(r=e.detail)||void 0===r?void 0:r[18])){const t=e.detail[18],n=null==t?void 0:t.split(";");for(let e=0;e<n.length;e++){var a;const t=pb(a=n[e]).call(a);s[e]&&t&&(s[e].ip6=t)}}return{gatewayAddrs:s,uid:e.uid,cid:e.cid,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function hj(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function pj(e){const t=e._encoderConfig;if(!t)return{};const n={resolution:t.width&&t.height?"".concat(hj(t.width),"x").concat(hj(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return"number"==typeof t.frameRate?(n.maxFrameRate=t.frameRate,n.minFrameRate=t.frameRate):t.frameRate&&(n.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,n.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),n}function fj(e,t,n){var r;const i=t.videoSend.find((t=>t.ssrc===e));if(!i)return null;const o=null==n||null===(r=n.videoSend.find((t=>t.ssrc===e)))||void 0===r?void 0:r.inputFrame,s={id:Sj(10,""),timestamp:new Date(t.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:i.ssrc.toString()};return i.inputFrame&&(o&&i.inputFrame.height===o.height||(s.A_fhi=i.inputFrame.height?i.inputFrame.height.toString():"0"),o&&i.inputFrame.width===o.width||(s.A_fwi=i.inputFrame.width?i.inputFrame.width.toString():"0"),o&&i.inputFrame.frameRate===o.frameRate||(s.A_fri=i.inputFrame.frameRate?i.inputFrame.frameRate.toString():"0")),s}function Aj(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function Ej(e,t){let n,r,i;switch(t){case BF.CHOOSE_SERVER:n=4096,r="choose server";break;case BF.CLOUD_PROXY:n=1048576,r="proxy";break;case BF.CLOUD_PROXY_5:n=4194304,r="proxy5";break;case BF.CLOUD_PROXY_FALLBACK:n=4194310,r="proxy fallback";break;default:throw new eD(ZN.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach((t=>{t.buffer&&t.buffer.flag===n&&(i={code:t.buffer.code,addresses:(t.buffer.edges_services||[]).map((e=>cj(cj({},e),{},{ticket:t.buffer.cert}))),server_ts:e.enter_ts,uid:t.buffer.uid,cid:t.buffer.cid,cname:t.buffer.cname,detail:cj(cj({},t.buffer.detail),e.detail),flag:t.buffer.flag,opid:e.opid})})),!i)throw new eD(ZN.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(r," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return i}async function gj(e,t){return await xv.all(e.addresses.map((async e=>({address:lj(e.ip),tcpport:e.port,udpport:e.port,username:t&&$D("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():BD.username,password:t&&$D("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await pG(t.toString()):BD.password}))))}function _j(e,t){const n=t._videoWidth||t.getMediaStreamTrack(!0).getSettings().width;return n||uD.warning("cannot get original video track's width, default scale down 4 times for low stream"),n?n/hj(e.width):4}function mj(e){let{candidateType:t,relayProtocol:n,type:r,address:i,port:o,protocol:s}=e;return"local-candidate"===r?{candidateType:t,relayProtocol:n,protocol:s}:{candidateType:t,relayProtocol:n,address:i,port:o,protocol:s}}function Ij(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tj(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ij(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ij(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Rj(e){return window.TextEncoder?(new TextEncoder).encode(e).length:e.length}function vj(e){return new xv((t=>{window.setTimeout(t,e)}))}function yj(e){const t=new eD(ZN.TIMEOUT,"timeout");return new xv(((n,r)=>{window.setTimeout((()=>r(t)),e)}))}function Sj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const n=Math.random().toString(16).substr(2,e).toLowerCase();return n.length===e?"".concat(t).concat(n):"".concat(t).concat(n)+Sj(e-n.length,"")}function Cj(){return Sj(32,"").toUpperCase()}const Oj=()=>{};function bj(e){return new xv(((t,n)=>{let r=!1;const i=document.createElement("video");i.setAttribute("autoplay",""),i.setAttribute("muted",""),i.muted=!0,i.autoplay=!0,i.setAttribute("playsinline",""),i.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(i);const o=Bb()?"canplay":"playing";i.addEventListener(o,(()=>{const e=i.videoWidth,n=i.videoHeight;!e&&Ub()||(r=!0,i.srcObject=null,i.remove(),t([e,n]))})),i.srcObject=new MediaStream([e]),i.play().catch(Oj),setTimeout((()=>{r||(i.srcObject=null,i.remove(),t([i.videoWidth,i.videoHeight]))}),4e3)}))}function wj(e){return xv.all(e.map((e=>e.then((e=>{throw e}),(e=>e))))).then((e=>{throw e}),(e=>e))}function Nj(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return 0===e.getListeners(t).length?xv.reject(new eD(ZN.UNEXPECTED_ERROR,"can not emit promise")):new xv(((n,i)=>{e.emit(t,...r,n,i)}))}function Dj(e,t){if(0===e.getListeners(t).length)return xv.resolve();for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return Nj(e,t,...r)}function Lj(e,t){if(0===e.getListeners(t).length)return null;for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return Pj(e,t,...r)}function Pj(e,t){let n=null,r=null;for(var i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];if(e.emit(t,...o,(e=>{n=e}),(e=>{r=e})),null!==r)throw r;if(null===n)throw new eD(ZN.UNEXPECTED_ERROR,"handler is not sync");return n}function kj(e,t){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}function xj(e){const t=[];return e.forEach((e=>{-1===t.indexOf(e)&&t.push(e)})),t}function Mj(e){xv.resolve().then(e)}function Uj(e){return JSON.parse(JSON.stringify(e))}const Bj={};function Fj(e,t){Bj[t]||(Bj[t]=!0,e())}function Vj(e){const t=window.atob(e),n=new Uint8Array(new ArrayBuffer(t.length));for(let e=0;e<t.length;e+=1)n[e]=t.charCodeAt(e);return n}function Gj(e){let t="";for(let n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}const Qj=new class{constructor(){iw(this,"fnMap",new Map)}throttleByKey(e,t,n,r){for(var i=arguments.length,o=new Array(i>4?i-4:0),s=4;s<i;s++)o[s-4]=arguments[s];if(this.fnMap.has(t)){const i=this.fnMap.get(t);if(i.threshold!==n){i.fn(...i.args),clearTimeout(i.timer);const s=window.setTimeout((()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)}),n);this.fnMap.set(t,{fn:e,threshold:n,timer:s,args:o,skipFn:r})}else i.skipFn&&i.skipFn(...i.args),this.fnMap.set(t,Tj(Tj({},i),{},{fn:e,args:o,skipFn:r}))}else{const i=window.setTimeout((()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)}),n);this.fnMap.set(t,{fn:e,threshold:n,timer:i,args:o,skipFn:r})}}},jj=Qj.throttleByKey.bind(Qj),Hj=async e=>{let{fragementLength:t,referenceList:n,asyncMapHandler:r,allFailedhandler:i,promisesCollector:o}=e,s=0;const a=t;let c,u=0;const l=async()=>{const e=(()=>{const e=s*a,t=e+a;return n.slice(e,t).map(r)})();o&&o.push(...e);try{c=await wj(e)}catch(e){if(u+=a,s++,!(u>=n.length))return void await l();i(e)}e.forEach((e=>e.cancel()))};return await l(),c};function Wj(e){return"object"==typeof e&&null!==e&&!(e instanceof RegExp)}var Yj=Rc,Kj=vl("iterator"),$j=!Yj((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[Kj]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://ÑÐµÑÑ").host||"#%D0%B1"!==new URL("http://a#Ð±").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host})),zj=Vc,qj=wc,Jj=jc,Xj=Rc,Zj=NE,eH=EE,tH=Hc,nH=il,rH=su,iH=Object.assign,oH=Object.defineProperty,sH=qj([].concat),aH=!iH||Xj((function(){if(zj&&1!==iH({b:1},iH(oH({},"a",{enumerable:!0,get:function(){oH(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=iH({},e)[n]||Zj(iH({},t)).join("")!=r}))?function(e,t){for(var n=nH(e),r=arguments.length,i=1,o=eH.f,s=tH.f;r>i;)for(var a,c=rH(arguments[i++]),u=o?sH(Zj(c),o(c)):Zj(c),l=u.length,d=0;l>d;)a=u[d++],zj&&!Jj(s,c,a)||(n[a]=c[a]);return n}:iH,cH=fd,uH=Pg,lH=ad,dH=jc,hH=il,pH=function(e,t,n,r){try{return r?t(cH(n)[0],n[1]):t(n)}catch(t){uH(e,"throw",t)}},fH=ag,AH=OI,EH=jd,gH=aL,_H=wg,mH=Rg,IH=Lc.Array,TH=wc,RH=2147483647,vH=/[^\0-\u007E]/,yH=/[.\u3002\uFF0E\uFF61]/g,SH="Overflow: input needs wider integers to process",CH=Lc.RangeError,OH=TH(yH.exec),bH=Math.floor,wH=String.fromCharCode,NH=TH("".charCodeAt),DH=TH([].join),LH=TH([].push),PH=TH("".replace),kH=TH("".split),xH=TH("".toLowerCase),MH=function(e){return e+22+75*(e<26)},UH=function(e,t,n){var r=0;for(e=n?bH(e/700):e>>1,e+=bH(e/t);e>455;)e=bH(e/35),r+=36;return bH(r+36*e/(e+38))},BH=function(e){var t,n,r=[],i=(e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=NH(e,n++);if(i>=55296&&i<=56319&&n<r){var o=NH(e,n++);56320==(64512&o)?LH(t,((1023&i)<<10)+(1023&o)+65536):(LH(t,i),n--)}else LH(t,i)}return t}(e)).length,o=128,s=0,a=72;for(t=0;t<e.length;t++)(n=e[t])<128&&LH(r,wH(n));var c=r.length,u=c;for(c&&LH(r,"-");u<i;){var l=RH;for(t=0;t<e.length;t++)(n=e[t])>=o&&n<l&&(l=n);var d=u+1;if(l-o>bH((RH-s)/d))throw CH(SH);for(s+=(l-o)*d,o=l,t=0;t<e.length;t++){if((n=e[t])<o&&++s>RH)throw CH(SH);if(n==o){for(var h=s,p=36;;){var f=p<=a?1:p>=a+26?26:p-a;if(h<f)break;var A=h-f,E=36-f;LH(r,wH(MH(f+A%E))),h=bH(A/E),p+=36}LH(r,wH(MH(h))),a=UH(s,d,u==c),s=0,u++}}s++,o++}return DH(r,"")},FH=Lc.TypeError,VH=Ud,GH=Lc,QH=mu,jH=jc,HH=wc,WH=$j,YH=nm,KH=Xm,$H=Im,zH=Om,qH=$_,JH=oI,XH=Bc,ZH=al,eW=ad,tW=gg,nW=fd,rW=pu,iW=qg,oW=qE,sW=qc,aW=wg,cW=Rg,uW=function(e,t){if(e<t)throw FH("Not enough arguments");return e},lW=mL,dW=vl("iterator"),hW="URLSearchParams",pW="URLSearchParamsIterator",fW=qH.set,AW=qH.getterFor(hW),EW=qH.getterFor(pW),gW=QH("fetch"),_W=QH("Request"),mW=QH("Headers"),IW=_W&&_W.prototype,TW=mW&&mW.prototype,RW=GH.RegExp,vW=GH.TypeError,yW=GH.decodeURIComponent,SW=GH.encodeURIComponent,CW=HH("".charAt),OW=HH([].join),bW=HH([].push),wW=HH("".replace),NW=HH([].shift),DW=HH([].splice),LW=HH("".split),PW=HH("".slice),kW=/\+/g,xW=Array(4),MW=function(e){return xW[e-1]||(xW[e-1]=RW("((?:%[\\da-f]{2}){"+e+"})","gi"))},UW=function(e){try{return yW(e)}catch(t){return e}},BW=function(e){var t=wW(e,kW," "),n=4;try{return yW(t)}catch(e){for(;n;)t=wW(t,MW(n--),UW);return t}},FW=/[!'()~]|%20/g,VW={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},GW=function(e){return VW[e]},QW=function(e){return wW(SW(e),FW,GW)},jW=zH((function(e,t){fW(this,{type:pW,iterator:aW(AW(e).entries),kind:t})}),"Iterator",(function(){var e=EW(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n}),!0),HW=function(e){this.entries=[],this.url=null,void 0!==e&&(rW(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===CW(e,0)?PW(e,1):e:iW(e)))};HW.prototype={type:hW,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,n,r,i,o,s,a,c=cW(e);if(c)for(n=(t=aW(e,c)).next;!(r=jH(n,t)).done;){if(o=(i=aW(nW(r.value))).next,(s=jH(o,i)).done||(a=jH(o,i)).done||!jH(o,i).done)throw vW("Expected sequence with length 2");bW(this.entries,{key:iW(s.value),value:iW(a.value)})}else for(var u in e)ZH(e,u)&&bW(this.entries,{key:u,value:iW(e[u])})},parseQuery:function(e){if(e)for(var t,n,r=LW(e,"&"),i=0;i<r.length;)(t=r[i++]).length&&(n=LW(t,"="),bW(this.entries,{key:BW(NW(n)),value:BW(OW(n,"="))}))},serialize:function(){for(var e,t=this.entries,n=[],r=0;r<t.length;)e=t[r++],bW(n,QW(e.key)+"="+QW(e.value));return OW(n,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var WW=function(){JH(this,YW),fW(this,new HW(arguments.length>0?arguments[0]:void 0))},YW=WW.prototype;if(KH(YW,{append:function(e,t){uW(arguments.length,2);var n=AW(this);bW(n.entries,{key:iW(e),value:iW(t)}),n.updateURL()},delete:function(e){uW(arguments.length,1);for(var t=AW(this),n=t.entries,r=iW(e),i=0;i<n.length;)n[i].key===r?DW(n,i,1):i++;t.updateURL()},get:function(e){uW(arguments.length,1);for(var t=AW(this).entries,n=iW(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){uW(arguments.length,1);for(var t=AW(this).entries,n=iW(e),r=[],i=0;i<t.length;i++)t[i].key===n&&bW(r,t[i].value);return r},has:function(e){uW(arguments.length,1);for(var t=AW(this).entries,n=iW(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){uW(arguments.length,1);for(var n,r=AW(this),i=r.entries,o=!1,s=iW(e),a=iW(t),c=0;c<i.length;c++)(n=i[c]).key===s&&(o?DW(i,c--,1):(o=!0,n.value=a));o||bW(i,{key:s,value:a}),r.updateURL()},sort:function(){var e=AW(this);lW(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=AW(this).entries,r=eW(e,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new jW(this,"keys")},values:function(){return new jW(this,"values")},entries:function(){return new jW(this,"entries")}},{enumerable:!0}),YH(YW,dW,YW.entries,{name:"entries"}),YH(YW,"toString",(function(){return AW(this).serialize()}),{enumerable:!0}),$H(WW,hW),VH({global:!0,forced:!WH},{URLSearchParams:WW}),!WH&&XH(mW)){var KW=HH(TW.has),$W=HH(TW.set),zW=function(e){if(rW(e)){var t,n=e.body;if(tW(n)===hW)return t=e.headers?new mW(e.headers):new mW,KW(t,"content-type")||$W(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),oW(e,{body:sW(0,iW(n)),headers:sW(0,t)})}return e};if(XH(gW)&&VH({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return gW(e,arguments.length>1?zW(arguments[1]):{})}}),XH(_W)){var qW=function(e){return JH(this,IW),new _W(e,arguments.length>1?zW(arguments[1]):{})};IW.constructor=qW,qW.prototype=IW,VH({global:!0,forced:!0},{Request:qW})}}var JW,XW={URLSearchParams:WW,getState:AW},ZW=Ud,eY=Vc,tY=$j,nY=Lc,rY=ad,iY=wc,oY=OE.f,sY=nm,aY=oI,cY=al,uY=aH,lY=function(e){var t=hH(e),n=AH(this),r=arguments.length,i=r>1?arguments[1]:void 0,o=void 0!==i;o&&(i=lH(i,r>2?arguments[2]:void 0));var s,a,c,u,l,d,h=mH(t),p=0;if(!h||this==IH&&fH(h))for(s=EH(t),a=n?new this(s):IH(s);s>p;p++)d=o?i(t[p],p):t[p],gH(a,p,d);else for(l=(u=_H(t,h)).next,a=n?new this:[];!(c=dH(l,u)).done;p++)d=o?pH(u,i,[c.value,p],!0):c.value,gH(a,p,d);return a.length=p,a},dY=pL,hY=gv.codeAt,pY=qg,fY=Im,AY=XW,EY=$_,gY=EY.set,_Y=EY.getterFor("URL"),mY=AY.URLSearchParams,IY=AY.getState,TY=nY.URL,RY=nY.TypeError,vY=nY.parseInt,yY=Math.floor,SY=Math.pow,CY=iY("".charAt),OY=iY(/./.exec),bY=iY([].join),wY=iY(1..toString),NY=iY([].pop),DY=iY([].push),LY=iY("".replace),PY=iY([].shift),kY=iY("".split),xY=iY("".slice),MY=iY("".toLowerCase),UY=iY([].unshift),BY="Invalid scheme",FY="Invalid host",VY="Invalid port",GY=/[a-z]/i,QY=/[\d+-.a-z]/i,jY=/\d/,HY=/^0x/i,WY=/^[0-7]+$/,YY=/^\d+$/,KY=/^[\da-f]+$/i,$Y=/[\0\t\n\r #%/:<>?@[\\\]^|]/,zY=/[\0\t\n\r #/:<>?@[\\\]^|]/,qY=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,JY=/[\t\n\r]/g,XY=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)UY(t,e%256),e=yY(e/256);return bY(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=wY(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},ZY={},eK=uY({},ZY,{" ":1,'"':1,"<":1,">":1,"`":1}),tK=uY({},eK,{"#":1,"?":1,"{":1,"}":1}),nK=uY({},tK,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),rK=function(e,t){var n=hY(e,0);return n>32&&n<127&&!cY(t,e)?e:encodeURIComponent(e)},iK={ftp:21,file:null,http:80,https:443,ws:80,wss:443},oK=function(e,t){var n;return 2==e.length&&OY(GY,CY(e,0))&&(":"==(n=CY(e,1))||!t&&"|"==n)},sK=function(e){var t;return e.length>1&&oK(xY(e,0,2))&&(2==e.length||"/"===(t=CY(e,2))||"\\"===t||"?"===t||"#"===t)},aK=function(e){return"."===e||"%2e"===MY(e)},cK={},uK={},lK={},dK={},hK={},pK={},fK={},AK={},EK={},gK={},_K={},mK={},IK={},TK={},RK={},vK={},yK={},SK={},CK={},OK={},bK={},wK=function(e,t,n){var r,i,o,s=pY(e);if(t){if(i=this.parse(s))throw RY(i);this.searchParams=null}else{if(void 0!==n&&(r=new wK(n,!0)),i=this.parse(s,null,r))throw RY(i);(o=IY(new mY)).bindURL(this),this.searchParams=o}};wK.prototype={type:"URL",parse:function(e,t,n){var r,i,o,s,a,c=this,u=t||cK,l=0,d="",h=!1,p=!1,f=!1;for(e=pY(e),t||(c.scheme="",c.username="",c.password="",c.host=null,c.port=null,c.path=[],c.query=null,c.fragment=null,c.cannotBeABaseURL=!1,e=LY(e,qY,"")),e=LY(e,JY,""),r=lY(e);l<=r.length;){switch(i=r[l],u){case cK:if(!i||!OY(GY,i)){if(t)return BY;u=lK;continue}d+=MY(i),u=uK;break;case uK:if(i&&(OY(QY,i)||"+"==i||"-"==i||"."==i))d+=MY(i);else{if(":"!=i){if(t)return BY;d="",u=lK,l=0;continue}if(t&&(c.isSpecial()!=cY(iK,d)||"file"==d&&(c.includesCredentials()||null!==c.port)||"file"==c.scheme&&!c.host))return;if(c.scheme=d,t)return void(c.isSpecial()&&iK[c.scheme]==c.port&&(c.port=null));d="","file"==c.scheme?u=TK:c.isSpecial()&&n&&n.scheme==c.scheme?u=dK:c.isSpecial()?u=AK:"/"==r[l+1]?(u=hK,l++):(c.cannotBeABaseURL=!0,DY(c.path,""),u=CK)}break;case lK:if(!n||n.cannotBeABaseURL&&"#"!=i)return BY;if(n.cannotBeABaseURL&&"#"==i){c.scheme=n.scheme,c.path=dY(n.path),c.query=n.query,c.fragment="",c.cannotBeABaseURL=!0,u=bK;break}u="file"==n.scheme?TK:pK;continue;case dK:if("/"!=i||"/"!=r[l+1]){u=pK;continue}u=EK,l++;break;case hK:if("/"==i){u=gK;break}u=SK;continue;case pK:if(c.scheme=n.scheme,i==JW)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=dY(n.path),c.query=n.query;else if("/"==i||"\\"==i&&c.isSpecial())u=fK;else if("?"==i)c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=dY(n.path),c.query="",u=OK;else{if("#"!=i){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=dY(n.path),c.path.length--,u=SK;continue}c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,c.path=dY(n.path),c.query=n.query,c.fragment="",u=bK}break;case fK:if(!c.isSpecial()||"/"!=i&&"\\"!=i){if("/"!=i){c.username=n.username,c.password=n.password,c.host=n.host,c.port=n.port,u=SK;continue}u=gK}else u=EK;break;case AK:if(u=EK,"/"!=i||"/"!=CY(d,l+1))continue;l++;break;case EK:if("/"!=i&&"\\"!=i){u=gK;continue}break;case gK:if("@"==i){h&&(d="%40"+d),h=!0,o=lY(d);for(var A=0;A<o.length;A++){var E=o[A];if(":"!=E||f){var g=rK(E,nK);f?c.password+=g:c.username+=g}else f=!0}d=""}else if(i==JW||"/"==i||"?"==i||"#"==i||"\\"==i&&c.isSpecial()){if(h&&""==d)return"Invalid authority";l-=lY(d).length+1,d="",u=_K}else d+=i;break;case _K:case mK:if(t&&"file"==c.scheme){u=vK;continue}if(":"!=i||p){if(i==JW||"/"==i||"?"==i||"#"==i||"\\"==i&&c.isSpecial()){if(c.isSpecial()&&""==d)return FY;if(t&&""==d&&(c.includesCredentials()||null!==c.port))return;if(s=c.parseHost(d))return s;if(d="",u=yK,t)return;continue}"["==i?p=!0:"]"==i&&(p=!1),d+=i}else{if(""==d)return FY;if(s=c.parseHost(d))return s;if(d="",u=IK,t==mK)return}break;case IK:if(!OY(jY,i)){if(i==JW||"/"==i||"?"==i||"#"==i||"\\"==i&&c.isSpecial()||t){if(""!=d){var _=vY(d,10);if(_>65535)return VY;c.port=c.isSpecial()&&_===iK[c.scheme]?null:_,d=""}if(t)return;u=yK;continue}return VY}d+=i;break;case TK:if(c.scheme="file","/"==i||"\\"==i)u=RK;else{if(!n||"file"!=n.scheme){u=SK;continue}if(i==JW)c.host=n.host,c.path=dY(n.path),c.query=n.query;else if("?"==i)c.host=n.host,c.path=dY(n.path),c.query="",u=OK;else{if("#"!=i){sK(bY(dY(r,l),""))||(c.host=n.host,c.path=dY(n.path),c.shortenPath()),u=SK;continue}c.host=n.host,c.path=dY(n.path),c.query=n.query,c.fragment="",u=bK}}break;case RK:if("/"==i||"\\"==i){u=vK;break}n&&"file"==n.scheme&&!sK(bY(dY(r,l),""))&&(oK(n.path[0],!0)?DY(c.path,n.path[0]):c.host=n.host),u=SK;continue;case vK:if(i==JW||"/"==i||"\\"==i||"?"==i||"#"==i){if(!t&&oK(d))u=SK;else if(""==d){if(c.host="",t)return;u=yK}else{if(s=c.parseHost(d))return s;if("localhost"==c.host&&(c.host=""),t)return;d="",u=yK}continue}d+=i;break;case yK:if(c.isSpecial()){if(u=SK,"/"!=i&&"\\"!=i)continue}else if(t||"?"!=i)if(t||"#"!=i){if(i!=JW&&(u=SK,"/"!=i))continue}else c.fragment="",u=bK;else c.query="",u=OK;break;case SK:if(i==JW||"/"==i||"\\"==i&&c.isSpecial()||!t&&("?"==i||"#"==i)){if(".."===(a=MY(a=d))||"%2e."===a||".%2e"===a||"%2e%2e"===a?(c.shortenPath(),"/"==i||"\\"==i&&c.isSpecial()||DY(c.path,"")):aK(d)?"/"==i||"\\"==i&&c.isSpecial()||DY(c.path,""):("file"==c.scheme&&!c.path.length&&oK(d)&&(c.host&&(c.host=""),d=CY(d,0)+":"),DY(c.path,d)),d="","file"==c.scheme&&(i==JW||"?"==i||"#"==i))for(;c.path.length>1&&""===c.path[0];)PY(c.path);"?"==i?(c.query="",u=OK):"#"==i&&(c.fragment="",u=bK)}else d+=rK(i,tK);break;case CK:"?"==i?(c.query="",u=OK):"#"==i?(c.fragment="",u=bK):i!=JW&&(c.path[0]+=rK(i,ZY));break;case OK:t||"#"!=i?i!=JW&&("'"==i&&c.isSpecial()?c.query+="%27":c.query+="#"==i?"%23":rK(i,ZY)):(c.fragment="",u=bK);break;case bK:i!=JW&&(c.fragment+=rK(i,eK))}l++}},parseHost:function(e){var t,n,r;if("["==CY(e,0)){if("]"!=CY(e,e.length-1))return FY;if(!(t=function(e){var t,n,r,i,o,s,a,c=[0,0,0,0,0,0,0,0],u=0,l=null,d=0,h=function(){return CY(e,d)};if(":"==h()){if(":"!=CY(e,1))return;d+=2,l=++u}for(;h();){if(8==u)return;if(":"!=h()){for(t=n=0;n<4&&OY(KY,h());)t=16*t+vY(h(),16),d++,n++;if("."==h()){if(0==n)return;if(d-=n,u>6)return;for(r=0;h();){if(i=null,r>0){if(!("."==h()&&r<4))return;d++}if(!OY(jY,h()))return;for(;OY(jY,h());){if(o=vY(h(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;d++}c[u]=256*c[u]+i,2!=++r&&4!=r||u++}if(4!=r)return;break}if(":"==h()){if(d++,!h())return}else if(h())return;c[u++]=t}else{if(null!==l)return;d++,l=++u}}if(null!==l)for(s=u-l,u=7;0!=u&&s>0;)a=c[u],c[u--]=c[l+s-1],c[l+--s]=a;else if(8!=u)return;return c}(xY(e,1,-1))))return FY;this.host=t}else if(this.isSpecial()){if(e=function(e){var t,n,r=[],i=kH(PH(xH(e),yH,"."),".");for(t=0;t<i.length;t++)n=i[t],LH(r,OH(vH,n)?"xn--"+BH(n):n);return DH(r,".")}(e),OY($Y,e))return FY;if(null===(t=function(e){var t,n,r,i,o,s,a,c=kY(e,".");if(c.length&&""==c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=c[r]))return e;if(o=10,i.length>1&&"0"==CY(i,0)&&(o=OY(HY,i)?16:8,i=xY(i,8==o?1:2)),""===i)s=0;else{if(!OY(10==o?YY:8==o?WY:KY,i))return e;s=vY(i,o)}DY(n,s)}for(r=0;r<t;r++)if(s=n[r],r==t-1){if(s>=SY(256,5-t))return null}else if(s>255)return null;for(a=NY(n),r=0;r<n.length;r++)a+=n[r]*SY(256,3-r);return a}(e)))return FY;this.host=t}else{if(OY(zY,e))return FY;for(t="",n=lY(e),r=0;r<n.length;r++)t+=rK(n[r],ZY);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return cY(iK,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&oK(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,n=e.username,r=e.password,i=e.host,o=e.port,s=e.path,a=e.query,c=e.fragment,u=t+":";return null!==i?(u+="//",e.includesCredentials()&&(u+=n+(r?":"+r:"")+"@"),u+=XY(i),null!==o&&(u+=":"+o)):"file"==t&&(u+="//"),u+=e.cannotBeABaseURL?s[0]:s.length?"/"+bY(s,"/"):"",null!==a&&(u+="?"+a),null!==c&&(u+="#"+c),u},setHref:function(e){var t=this.parse(e);if(t)throw RY(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new NK(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+XY(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(pY(e)+":",cK)},getUsername:function(){return this.username},setUsername:function(e){var t=lY(pY(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var n=0;n<t.length;n++)this.username+=rK(t[n],nK)}},getPassword:function(){return this.password},setPassword:function(e){var t=lY(pY(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var n=0;n<t.length;n++)this.password+=rK(t[n],nK)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?XY(e):XY(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,_K)},getHostname:function(){var e=this.host;return null===e?"":XY(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,mK)},getPort:function(){var e=this.port;return null===e?"":pY(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=pY(e))?this.port=null:this.parse(e,IK))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+bY(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,yK))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=pY(e))?this.query=null:("?"==CY(e,0)&&(e=xY(e,1)),this.query="",this.parse(e,OK)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=pY(e))?("#"==CY(e,0)&&(e=xY(e,1)),this.fragment="",this.parse(e,bK)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var NK=function(e){var t=aY(this,DK),n=gY(t,new wK(e,!1,arguments.length>1?arguments[1]:void 0));eY||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},DK=NK.prototype,LK=function(e,t){return{get:function(){return _Y(this)[e]()},set:t&&function(e){return _Y(this)[t](e)},configurable:!0,enumerable:!0}};if(eY&&oY(DK,{href:LK("serialize","setHref"),origin:LK("getOrigin"),protocol:LK("getProtocol","setProtocol"),username:LK("getUsername","setUsername"),password:LK("getPassword","setPassword"),host:LK("getHost","setHost"),hostname:LK("getHostname","setHostname"),port:LK("getPort","setPort"),pathname:LK("getPathname","setPathname"),search:LK("getSearch","setSearch"),searchParams:LK("getSearchParams"),hash:LK("getHash","setHash")}),sY(DK,"toJSON",(function(){return _Y(this).serialize()}),{enumerable:!0}),sY(DK,"toString",(function(){return _Y(this).serialize()}),{enumerable:!0}),TY){var PK=TY.createObjectURL,kK=TY.revokeObjectURL;PK&&sY(NK,"createObjectURL",rY(PK,TY)),kK&&sY(NK,"revokeObjectURL",rY(kK,TY))}fY(NK,"URL"),ZW({global:!0,forced:!tY,sham:!eY},{URL:NK});var xK=fu.URL;const MK={[RP.ACCESS_POINT]:{[SP.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[SP.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[SP.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[SP.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[SP.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[SP.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voice service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[SP.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[RP.UNILBS]:{[yP.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[yP.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[yP.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[yP.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[yP.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[yP.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[yP.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[yP.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[yP.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[yP.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[yP.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[yP.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[RP.STRING_UID_ALLOCATOR]:{[vP.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[vP.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[vP.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function UK(e){const t=MK[Math.floor(e/1e4)];if(!t)return{desc:"unkonw error",retry:!1};const n=t[e%1e4];if(!n){if(Math.floor(e/1e4)===RP.ACCESS_POINT){const t=e%1e4;if("1"===t.toString()[0])return{desc:e.toString(),retry:!1};if("2"===t.toString()[0])return{desc:e.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return n}const BK={[CP.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[CP.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[CP.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[CP.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[CP.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[CP.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[CP.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[CP.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[CP.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[CP.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[CP.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[CP.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[CP.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[CP.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[CP.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[CP.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[CP.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[CP.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[CP.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[CP.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[CP.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[CP.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[CP.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[CP.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[CP.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[CP.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[CP.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[CP.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[CP.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[CP.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[CP.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[CP.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[CP.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[CP.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[CP.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[CP.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[CP.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[CP.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[CP.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[CP.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[CP.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[CP.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[CP.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[CP.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[CP.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[CP.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[CP.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[CP.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[CP.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[CP.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[CP.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[CP.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[CP.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[CP.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[CP.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[CP.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[CP.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[CP.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[CP.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[CP.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[CP.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[CP.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[CP.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[CP.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function FK(e){return BK[e]||{desc:"UNKNOW_ERROR_".concat(e),action:"failed"}}var VK={exports:{}};!function(e,t){e.exports=function(){var e={d:function(t,n){for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{DataViewIndexOutOfBoundsError:function(){return V},DecodeError:function(){return _},Decoder:function(){return j},EXT_TIMESTAMP:function(){return m},Encoder:function(){return w},ExtData:function(){return E},ExtensionCodec:function(){return C},decode:function(){return W},decodeArrayStream:function(){return Z},decodeAsync:function(){return X},decodeMulti:function(){return Y},decodeMultiStream:function(){return ee},decodeStream:function(){return te},decodeTimestampExtension:function(){return y},decodeTimestampToTimeSpec:function(){return v},encode:function(){return D},encodeDateToTimeSpec:function(){return T},encodeTimeSpecToTimestamp:function(){return I},encodeTimestampExtension:function(){return R}});var n=4294967295;function r(e,t,n){var r=Math.floor(n/4294967296),i=n;e.setUint32(t,r),e.setUint32(t+4,i)}function i(e,t){return 4294967296*e.getInt32(t)+e.getUint32(t+4)}var o=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},s=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},a="undefined"!=typeof TextEncoder&&"undefined"!=typeof TextDecoder;function c(e){for(var t=e.length,n=0,r=0;r<t;){var i=e.charCodeAt(r++);if(0!=(4294967168&i))if(0==(4294965248&i))n+=2;else{if(i>=55296&&i<=56319&&r<t){var o=e.charCodeAt(r);56320==(64512&o)&&(++r,i=((1023&i)<<10)+(1023&o)+65536)}n+=0==(4294901760&i)?3:4}else n++}return n}var u=a?new TextEncoder:void 0,l=a?"undefined"!=typeof process?200:0:n,d=(null==u?void 0:u.encodeInto)?function(e,t,n){u.encodeInto(e,t.subarray(n))}:function(e,t,n){t.set(u.encode(e),n)};function h(e,t,n){for(var r=t,i=r+n,a=[],c="";r<i;){var u=e[r++];if(0==(128&u))a.push(u);else if(192==(224&u)){var l=63&e[r++];a.push((31&u)<<6|l)}else if(224==(240&u)){l=63&e[r++];var d=63&e[r++];a.push((31&u)<<12|l<<6|d)}else if(240==(248&u)){var h=(7&u)<<18|(l=63&e[r++])<<12|(d=63&e[r++])<<6|63&e[r++];h>65535&&(h-=65536,a.push(h>>>10&1023|55296),h=56320|1023&h),a.push(h)}else a.push(u);a.length>=4096&&(c+=String.fromCharCode.apply(String,s([],o(a))),a.length=0)}return a.length>0&&(c+=String.fromCharCode.apply(String,s([],o(a)))),c}var p,f=a?new TextDecoder:null,A=a?"undefined"!=typeof process?200:0:n,E=function(e,t){this.type=e,this.data=t},g=(p=function(e,t){return(p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}p(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),_=function(e){function t(n){var r=e.call(this,n)||this,i=Object.create(t.prototype);return Object.setPrototypeOf(r,i),Object.defineProperty(r,"name",{configurable:!0,enumerable:!1,value:t.name}),r}return g(t,e),t}(Error),m=-1;function I(e){var t,n=e.sec,i=e.nsec;if(n>=0&&i>=0&&n<=17179869183){if(0===i&&n<=4294967295){var o=new Uint8Array(4);return(t=new DataView(o.buffer)).setUint32(0,n),o}var s=n/4294967296,a=4294967295&n;return o=new Uint8Array(8),(t=new DataView(o.buffer)).setUint32(0,i<<2|3&s),t.setUint32(4,a),o}return o=new Uint8Array(12),(t=new DataView(o.buffer)).setUint32(0,i),r(t,4,n),o}function T(e){var t=e.getTime(),n=Math.floor(t/1e3),r=1e6*(t-1e3*n),i=Math.floor(r/1e9);return{sec:n+i,nsec:r-1e9*i}}function R(e){return e instanceof Date?I(T(e)):null}function v(e){var t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:var n=t.getUint32(0);return{sec:4294967296*(3&n)+t.getUint32(4),nsec:n>>>2};case 12:return{sec:i(t,4),nsec:t.getUint32(0)};default:throw new _("Unrecognized data size for timestamp (expected 4, 8, or 12): "+e.length)}}function y(e){var t=v(e);return new Date(1e3*t.sec+t.nsec/1e6)}var S={type:m,encode:R,decode:y},C=function(){function e(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(S)}return e.prototype.register=function(e){var t=e.type,n=e.encode,r=e.decode;if(t>=0)this.encoders[t]=n,this.decoders[t]=r;else{var i=1+t;this.builtInEncoders[i]=n,this.builtInDecoders[i]=r}},e.prototype.tryToEncode=function(e,t){for(var n=0;n<this.builtInEncoders.length;n++)if(null!=(r=this.builtInEncoders[n])&&null!=(i=r(e,t)))return new E(-1-n,i);for(n=0;n<this.encoders.length;n++){var r,i;if(null!=(r=this.encoders[n])&&null!=(i=r(e,t)))return new E(n,i)}return e instanceof E?e:null},e.prototype.decode=function(e,t,n){var r=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return r?r(e,t,n):new E(t,e)},e.defaultCodec=new e,e}();function O(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}var b=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},w=function(){function e(e,t,n,r,i,o,s,a){void 0===e&&(e=C.defaultCodec),void 0===t&&(t=void 0),void 0===n&&(n=100),void 0===r&&(r=2048),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),this.extensionCodec=e,this.context=t,this.maxDepth=n,this.initialBufferSize=r,this.sortKeys=i,this.forceFloat32=o,this.ignoreUndefined=s,this.forceIntegerToFloat=a,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}return e.prototype.getUint8Array=function(){return this.bytes.subarray(0,this.pos)},e.prototype.reinitializeState=function(){this.pos=0},e.prototype.encode=function(e){return this.reinitializeState(),this.doEncode(e,1),this.getUint8Array()},e.prototype.doEncode=function(e,t){if(t>this.maxDepth)throw new Error("Too deep objects in depth "+t);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.encodeObject(e,t)},e.prototype.ensureBufferSizeToWrite=function(e){var t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)},e.prototype.resizeBuffer=function(e){var t=new ArrayBuffer(e),n=new Uint8Array(t),r=new DataView(t);n.set(this.bytes),this.view=r,this.bytes=n},e.prototype.encodeNil=function(){this.writeU8(192)},e.prototype.encodeBoolean=function(e){!1===e?this.writeU8(194):this.writeU8(195)},e.prototype.encodeNumber=function(e){Number.isSafeInteger(e)&&!this.forceIntegerToFloat?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):(this.writeU8(211),this.writeI64(e)):this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))},e.prototype.writeStringHeader=function(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else{if(!(e<4294967296))throw new Error("Too long string: "+e+" bytes in UTF-8");this.writeU8(219),this.writeU32(e)}},e.prototype.encodeString=function(e){if(e.length>l){var t=c(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),d(e,this.bytes,this.pos),this.pos+=t}else t=c(e),this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,n){for(var r=e.length,i=n,o=0;o<r;){var s=e.charCodeAt(o++);if(0!=(4294967168&s)){if(0==(4294965248&s))t[i++]=s>>6&31|192;else{if(s>=55296&&s<=56319&&o<r){var a=e.charCodeAt(o);56320==(64512&a)&&(++o,s=((1023&s)<<10)+(1023&a)+65536)}0==(4294901760&s)?(t[i++]=s>>12&15|224,t[i++]=s>>6&63|128):(t[i++]=s>>18&7|240,t[i++]=s>>12&63|128,t[i++]=s>>6&63|128)}t[i++]=63&s|128}else t[i++]=s}}(e,this.bytes,this.pos),this.pos+=t},e.prototype.encodeObject=function(e,t){var n=this.extensionCodec.tryToEncode(e,this.context);if(null!=n)this.encodeExtension(n);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else{if("object"!=typeof e)throw new Error("Unrecognized object: "+Object.prototype.toString.apply(e));this.encodeMap(e,t)}},e.prototype.encodeBinary=function(e){var t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large binary: "+t);this.writeU8(198),this.writeU32(t)}var n=O(e);this.writeU8a(n)},e.prototype.encodeArray=function(e,t){var n,r,i=e.length;if(i<16)this.writeU8(144+i);else if(i<65536)this.writeU8(220),this.writeU16(i);else{if(!(i<4294967296))throw new Error("Too large array: "+i);this.writeU8(221),this.writeU32(i)}try{for(var o=b(e),s=o.next();!s.done;s=o.next()){var a=s.value;this.doEncode(a,t+1)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.prototype.countWithoutUndefined=function(e,t){var n,r,i=0;try{for(var o=b(t),s=o.next();!s.done;s=o.next())void 0!==e[s.value]&&i++}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i},e.prototype.encodeMap=function(e,t){var n,r,i=Object.keys(e);this.sortKeys&&i.sort();var o=this.ignoreUndefined?this.countWithoutUndefined(e,i):i.length;if(o<16)this.writeU8(128+o);else if(o<65536)this.writeU8(222),this.writeU16(o);else{if(!(o<4294967296))throw new Error("Too large map object: "+o);this.writeU8(223),this.writeU32(o)}try{for(var s=b(i),a=s.next();!a.done;a=s.next()){var c=a.value,u=e[c];this.ignoreUndefined&&void 0===u||(this.encodeString(c),this.doEncode(u,t+1))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}},e.prototype.encodeExtension=function(e){var t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else{if(!(t<4294967296))throw new Error("Too large extension object: "+t);this.writeU8(201),this.writeU32(t)}this.writeI8(e.type),this.writeU8a(e.data)},e.prototype.writeU8=function(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++},e.prototype.writeU8a=function(e){var t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t},e.prototype.writeI8=function(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++},e.prototype.writeU16=function(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2},e.prototype.writeI16=function(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2},e.prototype.writeU32=function(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4},e.prototype.writeI32=function(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4},e.prototype.writeF32=function(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4},e.prototype.writeF64=function(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8},e.prototype.writeU64=function(e){this.ensureBufferSizeToWrite(8),function(e,t,n){var r=n/4294967296,i=n;e.setUint32(t,r),e.setUint32(t+4,i)}(this.view,this.pos,e),this.pos+=8},e.prototype.writeI64=function(e){this.ensureBufferSizeToWrite(8),r(this.view,this.pos,e),this.pos+=8},e}(),N={};function D(e,t){return void 0===t&&(t=N),new w(t.extensionCodec,t.context,t.maxDepth,t.initialBufferSize,t.sortKeys,t.forceFloat32,t.ignoreUndefined,t.forceIntegerToFloat).encode(e)}function L(e){return(e<0?"-":"")+"0x"+Math.abs(e).toString(16).padStart(2,"0")}var P=function(){function e(e,t){void 0===e&&(e=16),void 0===t&&(t=16),this.maxKeyLength=e,this.maxLengthPerKey=t,this.hit=0,this.miss=0,this.caches=[];for(var n=0;n<this.maxKeyLength;n++)this.caches.push([])}return e.prototype.canBeCached=function(e){return e>0&&e<=this.maxKeyLength},e.prototype.find=function(e,t,n){var r,i,o=this.caches[n-1];try{e:for(var s=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(o),a=s.next();!a.done;a=s.next()){for(var c=a.value,u=c.bytes,l=0;l<n;l++)if(u[l]!==e[t+l])continue e;return c.str}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}return null},e.prototype.store=function(e,t){var n=this.caches[e.length-1],r={bytes:e,str:t};n.length>=this.maxLengthPerKey?n[Math.random()*n.length|0]=r:n.push(r)},e.prototype.decode=function(e,t,n){var r=this.find(e,t,n);if(null!=r)return this.hit++,r;this.miss++;var i=h(e,t,n),o=Uint8Array.prototype.slice.call(e,t,t+n);return this.store(o,i),i},e}(),k=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},x=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){!function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}(r,i,(t=e[n](t)).done,t.value)}))}}},M=function(e){return this instanceof M?(this.v=e,this):new M(e)},U=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof M?Promise.resolve(n.value.v).then(c,u):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}},B=new DataView(new ArrayBuffer(0)),F=new Uint8Array(B.buffer),V=function(){try{B.getInt8(0)}catch(e){return e.constructor}throw new Error("never reached")}(),G=new V("Insufficient data"),Q=new P,j=function(){function e(e,t,r,i,o,s,a,c){void 0===e&&(e=C.defaultCodec),void 0===t&&(t=void 0),void 0===r&&(r=n),void 0===i&&(i=n),void 0===o&&(o=n),void 0===s&&(s=n),void 0===a&&(a=n),void 0===c&&(c=Q),this.extensionCodec=e,this.context=t,this.maxStrLength=r,this.maxBinLength=i,this.maxArrayLength=o,this.maxMapLength=s,this.maxExtLength=a,this.keyDecoder=c,this.totalPos=0,this.pos=0,this.view=B,this.bytes=F,this.headByte=-1,this.stack=[]}return e.prototype.reinitializeState=function(){this.totalPos=0,this.headByte=-1,this.stack.length=0},e.prototype.setBuffer=function(e){this.bytes=O(e),this.view=function(e){if(e instanceof ArrayBuffer)return new DataView(e);var t=O(e);return new DataView(t.buffer,t.byteOffset,t.byteLength)}(this.bytes),this.pos=0},e.prototype.appendBuffer=function(e){if(-1!==this.headByte||this.hasRemaining(1)){var t=this.bytes.subarray(this.pos),n=O(e),r=new Uint8Array(t.length+n.length);r.set(t),r.set(n,t.length),this.setBuffer(r)}else this.setBuffer(e)},e.prototype.hasRemaining=function(e){return this.view.byteLength-this.pos>=e},e.prototype.createExtraByteError=function(e){var t=this.view,n=this.pos;return new RangeError("Extra "+(t.byteLength-n)+" of "+t.byteLength+" byte(s) found at buffer["+e+"]")},e.prototype.decode=function(e){this.reinitializeState(),this.setBuffer(e);var t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t},e.prototype.decodeMulti=function(e){return k(this,(function(t){switch(t.label){case 0:this.reinitializeState(),this.setBuffer(e),t.label=1;case 1:return this.hasRemaining(1)?[4,this.doDecodeSync()]:[3,3];case 2:return t.sent(),[3,1];case 3:return[2]}}))},e.prototype.decodeAsync=function(e){var t,n,r,i,o,s,a;return o=this,void 0,a=function(){var o,s,a,c,u,l,d,h;return k(this,(function(p){switch(p.label){case 0:o=!1,p.label=1;case 1:p.trys.push([1,6,7,12]),t=x(e),p.label=2;case 2:return[4,t.next()];case 3:if((n=p.sent()).done)return[3,5];if(a=n.value,o)throw this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{s=this.doDecodeSync(),o=!0}catch(e){if(!(e instanceof V))throw e}this.totalPos+=this.pos,p.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return c=p.sent(),r={error:c},[3,12];case 7:return p.trys.push([7,,10,11]),n&&!n.done&&(i=t.return)?[4,i.call(t)]:[3,9];case 8:p.sent(),p.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:if(o){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return[2,s]}throw l=(u=this).headByte,d=u.pos,h=u.totalPos,new RangeError("Insufficient data in parsing "+L(l)+" at "+h+" ("+d+" in the current buffer)")}}))},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{i(a.next(e))}catch(e){t(e)}}function r(e){try{i(a.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s((function(e){e(i)}))).then(n,r)}i((a=a.apply(o,[])).next())}))},e.prototype.decodeArrayStream=function(e){return this.decodeMultiAsync(e,!0)},e.prototype.decodeStream=function(e){return this.decodeMultiAsync(e,!1)},e.prototype.decodeMultiAsync=function(e,t){return U(this,arguments,(function(){var n,r,i,o,s,a,c,u,l;return k(this,(function(d){switch(d.label){case 0:n=t,r=-1,d.label=1;case 1:d.trys.push([1,13,14,19]),i=x(e),d.label=2;case 2:return[4,M(i.next())];case 3:if((o=d.sent()).done)return[3,12];if(s=o.value,t&&0===r)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),n&&(r=this.readArraySize(),n=!1,this.complete()),d.label=4;case 4:d.trys.push([4,9,,10]),d.label=5;case 5:return[4,M(this.doDecodeSync())];case 6:return[4,d.sent()];case 7:return d.sent(),0==--r?[3,8]:[3,5];case 8:return[3,10];case 9:if(!((a=d.sent())instanceof V))throw a;return[3,10];case 10:this.totalPos+=this.pos,d.label=11;case 11:return[3,2];case 12:return[3,19];case 13:return c=d.sent(),u={error:c},[3,19];case 14:return d.trys.push([14,,17,18]),o&&!o.done&&(l=i.return)?[4,M(l.call(i))]:[3,16];case 15:d.sent(),d.label=16;case 16:return[3,18];case 17:if(u)throw u.error;return[7];case 18:return[7];case 19:return[2]}}))}))},e.prototype.doDecodeSync=function(){e:for(;;){var e=this.readHeadByte(),t=void 0;if(e>=224)t=e-256;else if(e<192)if(e<128)t=e;else if(e<144){if(0!=(r=e-128)){this.pushMapState(r),this.complete();continue e}t={}}else if(e<160){if(0!=(r=e-144)){this.pushArrayState(r),this.complete();continue e}t=[]}else{var n=e-160;t=this.decodeUtf8String(n,0)}else if(192===e)t=null;else if(194===e)t=!1;else if(195===e)t=!0;else if(202===e)t=this.readF32();else if(203===e)t=this.readF64();else if(204===e)t=this.readU8();else if(205===e)t=this.readU16();else if(206===e)t=this.readU32();else if(207===e)t=this.readU64();else if(208===e)t=this.readI8();else if(209===e)t=this.readI16();else if(210===e)t=this.readI32();else if(211===e)t=this.readI64();else if(217===e)n=this.lookU8(),t=this.decodeUtf8String(n,1);else if(218===e)n=this.lookU16(),t=this.decodeUtf8String(n,2);else if(219===e)n=this.lookU32(),t=this.decodeUtf8String(n,4);else if(220===e){if(0!==(r=this.readU16())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(221===e){if(0!==(r=this.readU32())){this.pushArrayState(r),this.complete();continue e}t=[]}else if(222===e){if(0!==(r=this.readU16())){this.pushMapState(r),this.complete();continue e}t={}}else if(223===e){if(0!==(r=this.readU32())){this.pushMapState(r),this.complete();continue e}t={}}else if(196===e){var r=this.lookU8();t=this.decodeBinary(r,1)}else if(197===e)r=this.lookU16(),t=this.decodeBinary(r,2);else if(198===e)r=this.lookU32(),t=this.decodeBinary(r,4);else if(212===e)t=this.decodeExtension(1,0);else if(213===e)t=this.decodeExtension(2,0);else if(214===e)t=this.decodeExtension(4,0);else if(215===e)t=this.decodeExtension(8,0);else if(216===e)t=this.decodeExtension(16,0);else if(199===e)r=this.lookU8(),t=this.decodeExtension(r,1);else if(200===e)r=this.lookU16(),t=this.decodeExtension(r,2);else{if(201!==e)throw new _("Unrecognized type byte: "+L(e));r=this.lookU32(),t=this.decodeExtension(r,4)}this.complete();for(var i=this.stack;i.length>0;){var o=i[i.length-1];if(0===o.type){if(o.array[o.position]=t,o.position++,o.position!==o.size)continue e;i.pop(),t=o.array}else{if(1===o.type){if("string"!=(s=typeof t)&&"number"!==s)throw new _("The type of key must be string or number but "+typeof t);if("__proto__"===t)throw new _("The key __proto__ is not allowed");o.key=t,o.type=2;continue e}if(o.map[o.key]=t,o.readCount++,o.readCount!==o.size){o.key=null,o.type=1;continue e}i.pop(),t=o.map}}return t}var s},e.prototype.readHeadByte=function(){return-1===this.headByte&&(this.headByte=this.readU8()),this.headByte},e.prototype.complete=function(){this.headByte=-1},e.prototype.readArraySize=function(){var e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new _("Unrecognized array type byte: "+L(e))}},e.prototype.pushMapState=function(e){if(e>this.maxMapLength)throw new _("Max length exceeded: map length ("+e+") > maxMapLengthLength ("+this.maxMapLength+")");this.stack.push({type:1,size:e,key:null,readCount:0,map:{}})},e.prototype.pushArrayState=function(e){if(e>this.maxArrayLength)throw new _("Max length exceeded: array length ("+e+") > maxArrayLength ("+this.maxArrayLength+")");this.stack.push({type:0,size:e,array:new Array(e),position:0})},e.prototype.decodeUtf8String=function(e,t){var n;if(e>this.maxStrLength)throw new _("Max length exceeded: UTF-8 byte length ("+e+") > maxStrLength ("+this.maxStrLength+")");if(this.bytes.byteLength<this.pos+t+e)throw G;var r,i=this.pos+t;return r=this.stateIsMapKey()&&(null===(n=this.keyDecoder)||void 0===n?void 0:n.canBeCached(e))?this.keyDecoder.decode(this.bytes,i,e):e>A?function(e,t,n){var r=e.subarray(t,t+n);return f.decode(r)}(this.bytes,i,e):h(this.bytes,i,e),this.pos+=t+e,r},e.prototype.stateIsMapKey=function(){return this.stack.length>0&&1===this.stack[this.stack.length-1].type},e.prototype.decodeBinary=function(e,t){if(e>this.maxBinLength)throw new _("Max length exceeded: bin length ("+e+") > maxBinLength ("+this.maxBinLength+")");if(!this.hasRemaining(e+t))throw G;var n=this.pos+t,r=this.bytes.subarray(n,n+e);return this.pos+=t+e,r},e.prototype.decodeExtension=function(e,t){if(e>this.maxExtLength)throw new _("Max length exceeded: ext length ("+e+") > maxExtLength ("+this.maxExtLength+")");var n=this.view.getInt8(this.pos+t),r=this.decodeBinary(e,t+1);return this.extensionCodec.decode(r,n,this.context)},e.prototype.lookU8=function(){return this.view.getUint8(this.pos)},e.prototype.lookU16=function(){return this.view.getUint16(this.pos)},e.prototype.lookU32=function(){return this.view.getUint32(this.pos)},e.prototype.readU8=function(){var e=this.view.getUint8(this.pos);return this.pos++,e},e.prototype.readI8=function(){var e=this.view.getInt8(this.pos);return this.pos++,e},e.prototype.readU16=function(){var e=this.view.getUint16(this.pos);return this.pos+=2,e},e.prototype.readI16=function(){var e=this.view.getInt16(this.pos);return this.pos+=2,e},e.prototype.readU32=function(){var e=this.view.getUint32(this.pos);return this.pos+=4,e},e.prototype.readI32=function(){var e=this.view.getInt32(this.pos);return this.pos+=4,e},e.prototype.readU64=function(){var e,t,n=(e=this.view,t=this.pos,4294967296*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,n},e.prototype.readI64=function(){var e=i(this.view,this.pos);return this.pos+=8,e},e.prototype.readF32=function(){var e=this.view.getFloat32(this.pos);return this.pos+=4,e},e.prototype.readF64=function(){var e=this.view.getFloat64(this.pos);return this.pos+=8,e},e}(),H={};function W(e,t){return void 0===t&&(t=H),new j(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decode(e)}function Y(e,t){return void 0===t&&(t=H),new j(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeMulti(e)}var K=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},$=function(e){return this instanceof $?(this.v=e,this):new $(e)},z=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=i[e](t)).value instanceof $?Promise.resolve(n.value.v).then(c,u):l(o[0][2],n)}catch(e){l(o[0][3],e)}var n}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}};function q(e){if(null==e)throw new Error("Assertion Failure: value must not be null nor undefined")}function J(e){return null!=e[Symbol.asyncIterator]?e:function(e){return z(this,arguments,(function(){var t,n,r,i;return K(this,(function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,$(t.read())];case 3:return n=o.sent(),r=n.done,i=n.value,r?[4,$(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return q(i),[4,$(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}}))}))}(e)}function X(e,t){return void 0===t&&(t=H),n=this,void 0,i=function(){var n;return function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(r){return n=J(e),[2,new j(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeAsync(n)]}))},new((r=void 0)||(r=Promise))((function(e,t){function o(e){try{a(i.next(e))}catch(e){t(e)}}function s(e){try{a(i.throw(e))}catch(e){t(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(o,s)}a((i=i.apply(n,[])).next())}));var n,r,i}function Z(e,t){void 0===t&&(t=H);var n=J(e);return new j(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeArrayStream(n)}function ee(e,t){void 0===t&&(t=H);var n=J(e);return new j(t.extensionCodec,t.context,t.maxStrLength,t.maxBinLength,t.maxArrayLength,t.maxMapLength,t.maxExtLength).decodeStream(n)}function te(e,t){return void 0===t&&(t=H),ee(e,t)}return t}()}(VK),(0,OM.exports)("Int8",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,OM.exports)("Int16",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,OM.exports)("Int32",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,OM.exports)("Uint16",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,OM.exports)("Uint32",(function(e){return function(t,n,r){return e(this,t,n,r)}})),(0,OM.exports)("Float64",(function(e){return function(t,n,r){return e(this,t,n,r)}}));let GK,QK;async function jK(){if(GK)return GK;const e={};let t,n={};for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);let r=!1,i=!1;r="object"==typeof window,i="function"==typeof importScripts,"object"==typeof process&&"object"==typeof process.versions&&process.versions.node;let o="";(r||i)&&(i?o=self.location.href:"undefined"!=typeof document&&document.currentScript&&(o=document.currentScript.src),o=0!==o.indexOf("blob:")?o.substr(0,o.lastIndexOf("/")+1):""),e.print||console.log.bind(console);const s=e.printErr||console.warn.bind(console);for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);let a;n=null,e.arguments,e.thisProgram,e.quit,e.wasmBinary,e.noExitRuntime,"object"!=typeof WebAssembly&&T("no native wasm support detected");let c=!1;function u(t){const n=e["_"+t];return n||T("Assertion failed: Cannot call unknown function "+t+", make sure it is exported"),n}function l(e,t,n,r,i){const o={string:function(e){let t=0;if(null!=e&&0!==e){const n=1+(e.length<<2);t=N(n),function(e,t,n){!function(e,t,n,r){if(!(r>0))return 0;const i=n+r-1;for(let r=0;r<e.length;++r){let o=e.charCodeAt(r);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++r)),o<=127){if(n>=i)break;t[n++]=o}else if(o<=2047){if(n+1>=i)break;t[n++]=192|o>>6,t[n++]=128|63&o}else if(o<=65535){if(n+2>=i)break;t[n++]=224|o>>12,t[n++]=128|o>>6&63,t[n++]=128|63&o}else{if(n+3>=i)break;t[n++]=240|o>>18,t[n++]=128|o>>12&63,t[n++]=128|o>>6&63,t[n++]=128|63&o}}t[n]=0}(e,p,t,n)}(e,t,n)}return t},array:function(e){const t=N(e.length);var n,r;return n=e,r=t,h.set(n,r),t}},s=u(e),a=[];let c=0;if(r)for(let e=0;e<r.length;e++){const t=o[n[e]];t?(0===c&&(c=b()),a[e]=t(r[e])):a[e]=r[e]}let l=s.apply(null,a);return l=function(e){return"string"===t?(n=e)?function(e,t,n){const r=t+undefined;let i=t,o="";for(;e[i]&&!(i>=r);)++i;if(i-t>16&&e.subarray&&d)return d.decode(e.subarray(t,i));for(;t<i;){let n=e[t++];if(!(128&n)){o+=String.fromCharCode(n);continue}const r=63&e[t++];if(192==(224&n)){o+=String.fromCharCode((31&n)<<6|r);continue}const i=63&e[t++];if(n=224==(240&n)?(15&n)<<12|r<<6|i:(7&n)<<18|r<<12|i<<6|63&e[t++],n<65536)o+=String.fromCharCode(n);else{const e=n-65536;o+=String.fromCharCode(55296|e>>10,56320|1023&e)}}return o}(p,n):"":"boolean"===t?Boolean(e):e;var n}(l),0!==c&&w(c),l}const d="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;let h,p,f;"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le"),e.INITIAL_MEMORY;const A=[],E=[],g=[],_=[];E.push({func:function(){S()}});let m=0,I=null;function T(t){throw e.onAbort&&e.onAbort(t),s(t+=""),c=!0,t="abort("+t+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(t)}e.preloadedImages={},e.preloadedAudios={};let R="deflate.wasm";function v(t){for(;t.length>0;){const n=t.shift();if("function"==typeof n){n(e);continue}const r=n.func;"number"==typeof r?void 0===n.arg?f.get(r)():f.get(r)(n.arg):r(void 0===n.arg?null:n.arg)}}R.startsWith("data:application/octet-stream;base64,")||(R=function(t){return e.locateFile?e.locateFile(t,o):o+t}(R));const y={emscripten_memcpy_big:function(e,t,n){p.copyWithin(e,t,t+n)},emscripten_resize_heap:function(e){T("OOM")}};await async function(){const t={env:y,wasi_snapshot_preview1:y};function n(t,n){const r=t.exports;var i;e.asm=r,a=e.asm.memory,i=a.buffer,e.HEAP8=h=new Int8Array(i),e.HEAP16=new Int16Array(i),e.HEAP32=new Int32Array(i),e.HEAPU8=p=new Uint8Array(i),e.HEAPU16=new Uint16Array(i),e.HEAPU32=new Uint32Array(i),e.HEAPF32=new Float32Array(i),e.HEAPF64=new Float64Array(i),f=e.asm.__indirect_function_table,function(t){if(m--,e.monitorRunDependencies&&e.monitorRunDependencies(m),0==m&&I){const e=I;I=null,e()}}()}if(m++,e.monitorRunDependencies&&e.monitorRunDependencies(m),e.instantiateWasm)try{return e.instantiateWasm(t,n)}catch(e){return s("Module.instantiateWasm callback failed with error: "+e),!1}return await function(e){return new xv(((e,t)=>{e(function(e){const t=window.atob("AGFzbQEAAAABMAlgA39/fwF/YAF/AGACf38AYAF/AX9gAn9/AX9gA39/fwBgBH9/f38AYAABf2AAAAI6AgNlbnYWZW1zY3JpcHRlbl9yZXNpemVfaGVhcAADA2VudhVlbXNjcmlwdGVuX21lbWNweV9iaWcAAAMjIggAAAAAAQEDAQEEBAQEAQEGAQYCBQUAAgAHAwEDAAIHAQMEBQFwAQYGBQYBAYACgAIGCQF/AUHQ48ACCweUAQoGbWVtb3J5AgARX193YXNtX2NhbGxfY3RvcnMAAhlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQAGbWFsbG9jABwEZnJlZQAdEF9fZXJybm9fbG9jYXRpb24AGwx6bGliQ29tcHJlc3MAGglzdGFja1NhdmUAIQxzdGFja1Jlc3RvcmUAIgpzdGFja0FsbG9jACMJCwEAQQELBRgZDA0PCq6FAiIDAAELpQcBBH8gAEH//wNxIQMgAEEQdiEEQQEhACACQQFGBEAgAyABLQAAaiIAQfH/A2sgACAAQfD/A0sbIgAgBGoiA0EQdCIEQYCAPGogBCADQfD/A0sbIAByDwsgAQR/IAJBEE8EQAJAAkACQCACQa8rSwRAA0AgAkGwK2shAkHbAiEFIAEhAANAIAMgAC0AAGoiAyAEaiADIAAtAAFqIgNqIAMgAC0AAmoiA2ogAyAALQADaiIDaiADIAAtAARqIgNqIAMgAC0ABWoiA2ogAyAALQAGaiIDaiADIAAtAAdqIgNqIAMgAC0ACGoiA2ogAyAALQAJaiIDaiADIAAtAApqIgNqIAMgAC0AC2oiA2ogAyAALQAMaiIDaiADIAAtAA1qIgNqIAMgAC0ADmoiA2ogAyAALQAPaiIDaiEEIABBEGohACAFQQFrIgUNAAsgBEHx/wNwIQQgA0Hx/wNwIQMgAUGwK2ohASACQa8rSw0ACyACRQ0DIAJBEEkNAQsDQCADIAEtAABqIgAgBGogACABLQABaiIAaiAAIAEtAAJqIgBqIAAgAS0AA2oiAGogACABLQAEaiIAaiAAIAEtAAVqIgBqIAAgAS0ABmoiAGogACABLQAHaiIAaiAAIAEtAAhqIgBqIAAgAS0ACWoiAGogACABLQAKaiIAaiAAIAEtAAtqIgBqIAAgAS0ADGoiAGogACABLQANaiIAaiAAIAEtAA5qIgBqIAAgAS0AD2oiA2ohBCABQRBqIQEgAkEQayICQQ9LDQALIAJFDQELIAJBAWshBiACQQNxIgUEQCABIQADQCACQQFrIQIgAyAALQAAaiIDIARqIQQgAEEBaiIBIQAgBUEBayIFDQALCyAGQQNJDQADQCADIAEtAABqIgAgAS0AAWoiBSABLQACaiIGIAEtAANqIgMgBiAFIAAgBGpqamohBCABQQRqIQEgAkEEayICDQALCyAEQfH/A3AhBCADQfH/A3AhAwsgBEEQdCADcg8LAkAgAkUNACACQQFrIQYgAkEDcSIFBEAgASEAA0AgAkEBayECIAMgAC0AAGoiAyAEaiEEIABBAWoiASEAIAVBAWsiBQ0ACwsgBkEDSQ0AA0AgAyABLQAAaiIAIAEtAAFqIgUgAS0AAmoiBiABLQADaiIDIAYgBSAAIARqampqIQQgAUEEaiEBIAJBBGsiAg0ACwsgBEHx/wNwQRB0IANB8f8DayADIANB8P8DSxtyBSAACwsKACAAIAEgAhADC4UJAQJ/IAFFBEBBAA8LIABBf3MhAAJAIAJFDQAgAUEDcUUNACABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACACQQFrIgRBACABQQFqIgNBA3EbRQRAIAMhASAEIQIMAQsgAS0AASAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEDAkAgAkECayIERQ0AIANBA3FFDQAgAS0AAiAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUEDaiEDAkAgAkEDayIERQ0AIANBA3FFDQAgAS0AAyAAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAkEEayECIAFBBGohAQwCCyADIQEgBCECDAELIAMhASAEIQILIAJBH0sEQANAIAEoAhwgASgCGCABKAIUIAEoAhAgASgCDCABKAIIIAEoAgQgASgCACAAcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAc3MiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzcyIAQQZ2QfwHcUGAGGooAgAgAEH/AXFBAnRBgCBqKAIAcyAAQQ52QfwHcUGAEGooAgBzIABBFnZB/AdxQYAIaigCAHNzIgBBBnZB/AdxQYAYaigCACAAQf8BcUECdEGAIGooAgBzIABBDnZB/AdxQYAQaigCAHMgAEEWdkH8B3FBgAhqKAIAcyEAIAFBIGohASACQSBrIgJBH0sNAAsLIAJBA0sEQANAIAEoAgAgAHMiAEEGdkH8B3FBgBhqKAIAIABB/wFxQQJ0QYAgaigCAHMgAEEOdkH8B3FBgBBqKAIAcyAAQRZ2QfwHcUGACGooAgBzIQAgAUEEaiEBIAJBBGsiAkEDSw0ACwsCQCACRQ0AIAJBAXEEfyABLQAAIABB/wFxc0ECdEGACGooAgAgAEEIdnMhACABQQFqIQEgAkEBawUgAgshAyACQQFGDQADQCABLQABIAEtAAAgAEH/AXFzQQJ0QYAIaigCACAAQQh2cyIAQf8BcXNBAnRBgAhqKAIAIABBCHZzIQAgAUECaiEBIANBAmsiAw0ACwsgAEF/cwsKACAAIAEgAhAFC9wEAQN/AkBByN8ALQAAQTFHDQAgAEUNACAAQQA2AhggACgCICIBRQRAIABBADYCKCAAQQE2AiBBASEBCyAAKAIkRQRAIABBAjYCJAsgACgCKEEBQcQtIAERAAAiAUUNACAAIAE2AhwgAUEPNgIwIAFBADYCHCABQQA2AhggAUEqNgIEIAEgADYCACABQQs2AlAgAUGAgAI2AiwgAUH//wE2AjQgAUGAEDYCTCABQQQ2AlggAUH/DzYCVCABIAAoAihBgIACQQIgACgCIBEAADYCOCABIAAoAiggASgCLEECIAAoAiARAAA2AkAgACgCKCABKAJMQQIgACgCIBEAACECIAFBADYCwC0gASACNgJEIAFBgAg2ApwtIAEgACgCKEGACEEEIAAoAiARAAAiAjYCCCABIAEoApwtIgNBAnQ2AgwCQAJAIAEoAjhFDQAgASgCQEUNACACRQ0AIAEoAkQNAQsgAUGaBTYCBCAAQbjfACgCADYCGCAAEAgPCyABQQA2AogBIAFBCTYChAEgAUEIOgAkIAEgAiADQQNsajYCmC0gASACIANBfnFqNgKkLSAAEAkNACAAKAIcIgAgACgCLEEBdDYCPCAAKAJEIgEgACgCTEEBdEECayIDakEAOwEAIAEgAxAgIABBADYCtC0gAEKAgICAIDcCdCAAQgA3AmggAEKAgICAIDcCXCAAQQA2AkggACAAKAKEAUEMbCIBQYTIAGovAQA2ApABIAAgAUGAyABqLwEANgKMASAAIAFBgsgAai8BADYCgAEgACABQYbIAGovAQA2AnwLC6kCAQN/AkAgAEUNACAAKAIgRQ0AIAAoAiQiA0UNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgJBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIAJBmgVGDQAgAkEqRw0BCwJ/An8CfyABKAIIIgIEQCAAKAIoIAIgAxECACAAKAIcIQELIAEoAkQiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAkAiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAEoAjgiAgsEQCAAKAIoIAIgACgCJBECACAAKAIcIQELIAAoAiggASAAKAIkEQIAIABBADYCHAsLlgIBA39BfiECAkAgAEUNACAAKAIgRQ0AIAAoAiRFDQAgACgCHCIBRQ0AIAEoAgAgAEcNAAJAAkAgASgCBCIDQTlrDjkBAgICAgICAgICAgIBAgICAQICAgICAgICAgICAgICAgICAQICAgICAgICAgICAQICAgICAgICAgEACyADQZoFRg0AIANBKkcNAQsgAEECNgIsIABBADYCCCAAQgA3AhQgAUEANgIUIAEgASgCCDYCECABKAIYIgJBf0wEQCABQQAgAmsiAjYCGAsgAUE5QSpB8QAgAhsgAkECRhs2AgQgAAJ/IAJBAkYEQEEAQQBBABAGDAELQQBBAEEAEAQLNgIwQQAhAiABQQA2AiggARAQCyACC9wIAQt/IAAoAiwiB0GGAmshCyAAKAJ0IQUgByEBA0AgACgCPCAFayAAKAJsIghrIQYgASALaiAITQRAIAAoAjgiASABIAdqIAcgBmsQHxogACAAKAJwIAdrNgJwIAAgACgCbCAHayIINgJsIAAgACgCXCAHazYCXCAAKAJMIgRBAWshCiAAKAJEIARBAXRqIQMgACgCLCEBIARBA3EiAgRAA0AgA0ECayIDQQAgAy8BACIFIAFrIgkgBSAJSRs7AQAgBEEBayEEIAJBAWsiAg0ACwsgCkEDTwRAA0AgA0ECayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EEayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EGayICQQAgAi8BACICIAFrIgUgAiAFSRs7AQAgA0EIayIDQQAgAy8BACICIAFrIgUgAiAFSRs7AQAgBEEEayIEDQALCyABQQFrIQogACgCQCABQQF0aiEDIAEhBCABQQNxIgIEQANAIANBAmsiA0EAIAMvAQAiBSABayIJIAUgCUkbOwEAIARBAWshBCACQQFrIgINAAsLIApBA08EQANAIANBAmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBGsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBBmsiAkEAIAIvAQAiAiABayIFIAIgBUkbOwEAIANBCGsiA0EAIAMvAQAiAiABayIFIAIgBUkbOwEAIARBBGsiBA0ACwsgBiAHaiEGCwJAIAAoAgAiASgCBCIERQ0AIAAoAnQhAiAGIAQgBCAGSxsiAwRAIAAoAjghBSABIAQgA2s2AgQgBSAIaiACaiABKAIAIAMQHyEEAkACQAJAIAEoAhwoAhhBAWsOAgABAgsgASABKAIwIAQgAxAENgIwDAELIAEgASgCMCAEIAMQBjYCMAsgASABKAIAIANqNgIAIAEgASgCCCADajYCCCAAKAJ0IQILIAAgAiADaiIFNgJ0AkAgACgCtC0iAyAFakEDSQ0AIAAgACgCOCIJIAAoAmwgA2siAWoiBC0AACICNgJIIAAgACgCVCIIIAQtAAEgAiAAKAJYIgZ0c3EiBDYCSANAIANFDQEgACABIAlqLQACIAQgBnRzIAhxIgQ2AkggACgCQCAAKAI0IAFxQQF0aiAAKAJEIARBAXRqIgIvAQA7AQAgAiABOwEAIAAgA0EBayIDNgK0LSABQQFqIQEgAyAFakECSw0ACwsgBUGFAksNACAAKAIAKAIERQ0AIAAoAiwhAQwBCwsCQCAAKAI8IgQgACgCwC0iAU0NACAAKAJ0IAAoAmxqIgMgAUsEQCAAKAI4IANqIAQgA2siAUGCAiABQYICSRsiARAgIAAgASADajYCwC0PCyADQYICaiIDIAFNDQAgACgCOCABaiAEIAFrIgQgAyABayIBIAEgBEsbIgEQICAAIAAoAsAtIAFqNgLALQsLsSwBCn8CQCAARQ0AIAAoAiBFDQAgACgCJEUNACAAKAIcIgFFDQAgASgCACAARw0AAkACQCABKAIEIgNBOWsOOQECAgICAgICAgICAgECAgIBAgICAgICAgICAgICAgICAgIBAgICAgICAgICAgIBAgICAgICAgICAQALIANBmgVGDQAgA0EqRw0BCwJAAkAgACgCDEUNACAAKAIEIgIEQCAAKAIARQ0BCyADQZoFRw0BCyAAQbDfACgCADYCGA8LIAAoAhBFBEAgAEG83wAoAgA2AhgPCyABKAIoIQUgAUEDNgIoAkAgASgCFARAIAEQEwJAIAAoAhAiAyABKAIUIgQgAyAESRsiAkUNACAAKAIMIAEoAhAgAhAfGiAAIAAoAgwgAmo2AgwgASABKAIQIAJqNgIQIAAgACgCFCACajYCFCAAIAAoAhAgAmsiAzYCECABIAEoAhQgAmsiBDYCFCAEDQAgASABKAIINgIQQQAhBAsgAwRAIAEoAgQhAwwCCyABQX82AigPCyACDQAgBUEBdEF3QQAgBUEEShtqQQZIDQAgAEG83wAoAgA2AhgPCwJAAkACQAJAAn8CQAJAAkACQAJAAkAgA0EqRwRAIANBmgVHDQEgACgCBEUNAiAAQbzfACgCADYCGA8LIAEoAjBBDHRBgPABayEDQQAhAgJAIAEoAogBQQFKDQAgASgChAEiBUECSA0AQcAAIQIgBUEGSA0AQYABQcABIAVBBkYbIQILIAEgBEEBajYCFCABKAIIIARqIAIgA3IiAkEgciACIAEoAmwbIgJBCHY6AAAgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQR9wIAJyQR9zOgAAIAEoAmwEQCAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQRh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEQdjoAACAAKAIwIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACQQh2OgAAIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAAAsgAEEAQQBBABAENgIwIAFB8QA2AgQgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBCABKAIEIQMLAkACQAJAAkACQAJAAkAgA0E5RgR/IABBAEEAQQAQBjYCMCABIAEoAhQiAkEBajYCFCACIAEoAghqQR86AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakGLAToAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQg6AAAgASgCHCICDQIgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAACABIAEoAhQiAkEBajYCFCACIAEoAghqQQA6AAAgASABKAIUIgJBAWo2AhQgAiABKAIIakEAOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBADoAAEECIQIgASgChAEiA0EJRwRAQQQgASgCiAFBAUpBAnQgA0ECSBshAgsgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEgASgCFCICQQFqNgIUIAIgASgCCGpBAzoAACABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIUDQEgASgCBAUgAwtBxQBrDiMCBgYGAwYGBgYGBgYGBgYGBgYGBgYGBAYGBgYGBgYGBgYGBQYLIAFBfzYCKA8LIAIoAiQhAyACKAIcIQQgAigCECEFIAIoAiwhBiACKAIAIQggASABKAIUIgdBAWo2AhRBAiECIAcgASgCCGogBkEAR0EBdCAIQQBHciAFQQBHQQJ0ciAEQQBHQQN0ciADQQBHQQR0cjoAACABKAIcKAIEIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAhwoAgQhAyABIAEoAhQiBEEBajYCFCAEIAEoAghqIANBCHY6AAAgASgCHC8BBiEDIAEgASgCFCIEQQFqNgIUIAQgASgCCGogAzoAACABKAIcLQAHIQMgASABKAIUIgRBAWo2AhQgBCABKAIIaiADOgAAIAEoAoQBIgNBCUcEQEEEIAEoAogBQQFKQQJ0IANBAkgbIQILIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAjoAACABKAIcKAIMIQIgASABKAIUIgNBAWo2AhQgAyABKAIIaiACOgAAIAEoAhwiAigCEAR/IAIoAhQhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAI6AAAgASgCHCgCFCECIAEgASgCFCIDQQFqNgIUIAMgASgCCGogAkEIdjoAACABKAIcBSACCygCLARAIAAgACgCMCABKAIIIAEoAhQQBjYCMAsgAUHFADYCBCABQQA2AiALIAEoAhwiBCgCECIDBEAgASgCFCICIAQvARQgASgCICIGayIFaiABKAIMIgRLBEADQCABKAIIIAJqIAMgBmogBCACayIEEB8aIAEgASgCDCIDNgIUAkAgAiADTw0AIAEoAhwoAixFDQAgACAAKAIwIAEoAgggAmogAyACaxAGNgIwCyABIAEoAiAgBGo2AiAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIGIAMgBkkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQEQCABQX82AigPCyABKAIgIQYgASgCHCgCECEDQQAhAiAFIARrIgUgASgCDCIESw0ACwsgASgCCCACaiADIAZqIAUQHxogASABKAIUIAVqIgM2AhQCQCACIANPDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCACaiADIAJrEAY2AjALIAFBADYCIAsgAUHJADYCBAsgASgCHCgCHARAIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCHCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLAkAgASgCHCgCLEUNACABKAIUIgIgBU0NACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAFBADYCIAsgAUHbADYCBAsCQCABKAIcKAIkRQ0AIAEoAhQiAiEFA0ACQCACIAEoAgxHDQACQCACIAVNDQAgASgCHCgCLEUNACAAIAAoAjAgASgCCCAFaiACIAVrEAY2AjALIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQC0EAIQJBACEFIAEoAhRFDQAgAUF/NgIoDwsgASgCHCgCJCEDIAEgASgCICIEQQFqNgIgIAMgBGotAAAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAMEQCABKAIUIQIMAQsLIAEoAhwoAixFDQAgASgCFCICIAVNDQAgACAAKAIwIAEoAgggBWogAiAFaxAGNgIwCyABQecANgIECyABKAIcKAIsBEAgASgCDCABKAIUIgJBAmpJBEAgACgCHCICEBMCQCAAKAIQIgMgAigCFCIEIAMgBEkbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrNgIQIAIgAigCFCADayIDNgIUIAMNACACIAIoAgg2AhALIAEoAhQNBUEAIQILIAAoAjAhAyABIAJBAWo2AhQgASgCCCACaiADOgAAIAAoAjAhAiABIAEoAhQiA0EBajYCFCADIAEoAghqIAJBCHY6AAAgAEEAQQBBABAGNgIwCyABQfEANgIEIAAoAhwiAhATAkAgACgCECIDIAIoAhQiBCADIARJGyIDRQ0AIAAoAgwgAigCECADEB8aIAAgACgCDCADajYCDCACIAIoAhAgA2o2AhAgACAAKAIUIANqNgIUIAAgACgCECADazYCECACIAIoAhQgA2siAzYCFCADDQAgAiACKAIINgIQCyABKAIURQ0AIAFBfzYCKA8LIAAoAgQNAQsgASgCdA0AIAEoAgRBmgVGDQgLIAEoAoQBIgJFBEAgAUEDEAwMBAsCQAJAIAEoAogBQQJrDgIAAQQLA0ACQAJAIAEoAnQNACABEAogASgCdA0AIAFBADYCtC0MAQsgAUEANgJgIAEoAjggASgCbGotAAAhAiABKAKkLSABKAKgLSIDQQF0akEAOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAjoAACABIAJBAnRqQZQBaiICIAIvAQBBAWo7AQAgASABKAJ0QQFrNgJ0IAEgASgCbEEBaiICNgJsIAEoAqAtIAEoApwtQQFrRw0BIAEgASgCXCIEQQBOBH8gASgCOCAEagVBAAsgAiAEa0EAEBQgASABKAJsNgJcIAEoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAEoAgAoAhANAQwHCwsgASgCoC1FDQcgASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNBQwHCwNAAkACQAJAIAEoAnQiAkGDAk8EQCABQQA2AmAMAQsgARAKIAEoAnQiAgRAIAFBADYCYCACQQJLDQEgASgCbCEDDAILIAFBADYCtC0gASgCoC1FDQogASABKAJcIgNBAE4EfyABKAI4IANqBUEACyABKAJsIANrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEEUNCAwKCyABKAJsIgNFBEBBACEDDAELIAEoAjggA2oiBkEBayIFLQAAIgQgBi0AAEcNACAEIAUtAAJHDQAgBCAFLQADRw0AIAZBggJqIQlBfyEIAkACQAJAAkACQAJAA0AgBiAIaiIFLQAEIARGBEAgBCAFLQAFRw0CIAQgBS0ABkcNAyAEIAUtAAdHDQQgBCAGIAhBCGoiCmoiBy0AAEcNByAEIAUtAAlHDQUgBCAFLQAKRw0GIAVBC2ohByAIQfYBSg0HIAohCCAEIActAABGDQEMBwsLIAVBBGohBwwFCyAFQQVqIQcMBAsgBUEGaiEHDAMLIAVBB2ohBwwCCyAFQQlqIQcMAQsgBUEKaiEHCyABIAIgByAJa0GCAmoiBCACIARJGyICNgJgIAJBA0kNACABKAKkLSABKAKgLSIDQQF0akEBOwEAIAEgA0EBajYCoC0gAyABKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAWpBmAlqIgIgAi8BAEEBajsBACABQYDJAC0AAEECdGpBiBNqIgIgAi8BAEEBajsBACABKAJgIQIgAUEANgJgIAEgASgCdCACazYCdCABIAIgASgCbGoiAjYCbCABKAKgLSABKAKcLUEBa0cNAgwBCyABKAI4IANqLQAAIQIgASgCpC0gASgCoC0iA0EBdGpBADsBACABIANBAWo2AqAtIAMgASgCmC1qIAI6AAAgASACQQJ0akGUAWoiAiACLwEAQQFqOwEAIAEgASgCdEEBazYCdCABIAEoAmxBAWoiAjYCbCABKAKgLSABKAKcLUEBa0cNAQsgASABKAJcIgRBAE4EfyABKAI4IARqBUEACyACIARrQQAQFCABIAEoAmw2AlwgASgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgASgCACgCEA0ACwwECyABQX82AigPCyABQX82AigPCyABQQMgAkEMbEGIyABqKAIAEQQACyICQX5xQQJGBEAgAUGaBTYCBAsgAkF9cQ0BCyAAKAIQDQMgAUF/NgIoDwsgAkEBRw0BCyABQQBBAEEAEBIgASgCRCICIAEoAkxBAXRBAmsiA2pBADsBACACIAMQICABKAJ0RQRAIAFBADYCtC0gAUEANgJcIAFBADYCbAsgACgCHCICEBMCQCAAKAIQIgQgAigCFCIDIAMgBEsbIgNFDQAgACgCDCACKAIQIAMQHxogACAAKAIMIANqNgIMIAIgAigCECADajYCECAAIAAoAhQgA2o2AhQgACAAKAIQIANrIgQ2AhAgAiACKAIUIANrIgM2AhQgAw0AIAIgAigCCDYCEAsgBA0AIAFBfzYCKAsLC7YNAQt/IAAoAgAiBCgCBCEJQQEhCAJAIAQoAhAiAyAAKAK8LUEqakEDdSICSQ0AIAAoAiwiBSAAKAIMQQVrIgYgBSAGSRshCiABQQRHIQsDQCAKIAMgAmsiAyAAKAJsIAAoAlxrIgYgBCgCBGoiAkH//wMgAkH//wNJGyIFIAMgBUkbIgNLBEAgAiADRw0CIAFFDQIgCyADRXENAgsgAEEAQQAgAUEERiACIANGcSIHEBIgACgCFCAAKAIIakEEayADOgAAIAAoAhQgACgCCGpBA2sgA0EIdjoAACAAKAIUIAAoAghqQQJrIANBf3MiAjoAACAAKAIUIAAoAghqQQFrIAJBCHY6AAAgACgCACICKAIcIgQQEwJAIAIoAhAiBSAEKAIUIgwgBSAMSRsiBUUNACACKAIMIAQoAhAgBRAfGiACIAIoAgwgBWo2AgwgBCAEKAIQIAVqNgIQIAIgAigCFCAFajYCFCACIAIoAhAgBWs2AhAgBCAEKAIUIAVrIgI2AhQgAg0AIAQgBCgCCDYCEAsCfyAGBEAgACgCACgCDCAAKAI4IAAoAlxqIAMgBiADIAZJGyICEB8aIAAoAgAiBCAEKAIMIAJqNgIMIAQgBCgCECACazYCECAEIAQoAhQgAmo2AhQgACAAKAJcIAJqNgJcIAMgAmshAwsgAwsEQCAAKAIAIgIoAgwhBSADIAIoAgQiBiADIAZJGyIEBEAgAiAGIARrNgIEIAUgAigCACAEEB8hBQJAAkACQCACKAIcKAIYQQFrDgIAAQILIAIgAigCMCAFIAQQBDYCMAwBCyACIAIoAjAgBSAEEAY2AjALIAIgAigCACAEajYCACACIAIoAgggBGo2AgggACgCACICKAIMIQULIAIgAyAFajYCDCACIAIoAhAgA2s2AhAgAiACKAIUIANqNgIUCyAAKAIAIQQgBwRAQQAhCAwCCyAEKAIQIgMgACgCvC1BKmpBA3UiAk8NAAsLAkAgCSAEKAIEayIDRQRAIAAoAmwhAgwBCwJAIAAoAiwiAiADTQRAIABBAjYCsC0gACgCOCAEKAIAIAJrIAIQHxogACAAKAIsIgQ2AmwgBCECDAELAkAgACgCPCAAKAJsIgRrIANLDQAgACAEIAJrIgQ2AmwgACgCOCIFIAIgBWogBBAfGiAAKAKwLSICQQFLDQAgACACQQFqNgKwLQsgACgCOCAAKAJsaiAAKAIAKAIAIANrIAMQHxogACAAKAJsIANqIgI2AmwgACgCLCEECyAAIAI2AlwgACAEIAAoArQtIgVrIgQgAyADIARLGyAFajYCtC0LIAIgACgCwC1LBEAgACACNgLALQtBAyEDAkAgCEUNACAAKAIAIgQoAgQhAwJAAkAgAUF7cUUNACADDQBBASEDIAIgACgCXEYNAiAAKAI8IAJBf3NqIQVBACEDDAELIAMgACgCPCACQX9zaiIFTQ0AIAAoAlwiByAAKAIsIgZIDQAgACACIAZrIgM2AmwgACAHIAZrNgJcIAAoAjgiAiACIAZqIAMQHxogACgCsC0iA0EBTQRAIAAgA0EBajYCsC0LIAAoAiwgBWohBSAAKAIAIgQoAgQhAwsCQCADIAUgAyAFSRsiAkUEQCAAKAJsIQMMAQsgACgCbCEFIAAoAjghBiAEIAMgAms2AgQgBSAGaiAEKAIAIAIQHyEDAkACQAJAIAQoAhwoAhhBAWsOAgABAgsgBCAEKAIwIAMgAhAENgIwDAELIAQgBCgCMCADIAIQBjYCMAsgBCAEKAIAIAJqNgIAIAQgBCgCCCACajYCCCAAIAAoAmwgAmoiAzYCbAsgAyAAKALALUsEQCAAIAM2AsAtCyADIAAoAlwiBmsiBCAAKAIsIgMgACgCDCAAKAK8LUEqakEDdWsiAkH//wMgAkH//wNJGyICIAIgA0sbSQRAQQAhAyABRQ0BIAFBBEYgBEEAR3JFDQEgAiAESQ0BIAAoAgAoAgQNAQtBACEFIAAgACgCOCAGaiACIAQgAiAESRsiAwJ/IAFBBEYEQCAAKAIAKAIERSACIARPcSEFCyAFCxASIAAgACgCXCADajYCXCAAKAIAIgAoAhwiAxATAkAgACgCECICIAMoAhQiBCACIARJGyICRQ0AIAAoAgwgAygCECACEB8aIAAgACgCDCACajYCDCADIAMoAhAgAmo2AhAgACAAKAIUIAJqNgIUIAAgACgCECACazYCECADIAMoAhQgAmsiADYCFCAADQAgAyADKAIINgIQC0ECQQAgBRshAwsgAwu5CwENfwJAA0ACQAJAIAAoAnRBhQJNBEAgABAKIAAoAnQhAgJAIAENACACQYYCTw0AQQAPCyACRQ0EIAJBA0kNAQsgACAAKAJUIAAoAmwiAiAAKAI4ai0AAiAAKAJIIAAoAlh0c3EiAzYCSCAAKAJAIAIgACgCNHFBAXRqIAAoAkQgA0EBdGoiBC8BACIDOwEAIAQgAjsBACADRQ0AIAAoAixBhgJrIAIgA2tJDQAgACAAIAMQDiICNgJgDAELIAAoAmAhAgsCQCACQQNPBEAgACgCpC0gACgCoC0iA0EBdGogACgCbCAAKAJwayIEOwEAIAAgA0EBajYCoC0gAyAAKAKYLWogAkEDayICOgAAIAJB/wFxQYDNAGotAABBAnQgAGpBmAlqIgIgAi8BAEEBajsBACAAIARBAWtB//8DcSICIAJBB3ZBgAJqIAJBgAJJG0GAyQBqLQAAQQJ0akGIE2oiAiACLwEAQQFqOwEAIAAgACgCdCAAKAJgIgJrIgM2AnQgACgCnC1BAWshBiAAKAKgLSEHAkAgA0EDSQ0AIAIgACgCgAFLDQAgACACQQFrIgM2AmAgACgCSCEEIAAoAmwhAiAAKAI0IQggACgCQCEJIAAoAkQhCiAAKAJUIQsgACgCOCEMIAAoAlghDQNAIAAgAiIFQQFqIgI2AmwgACAFIAxqLQADIAQgDXRzIAtxIgQ2AkggCSACIAhxQQF0aiAKIARBAXRqIg4vAQA7AQAgDiACOwEAIAAgA0EBayIDNgJgIAMNAAsgACAFQQJqIgI2AmwgBiAHRw0DDAILIABBADYCYCAAIAAoAmwgAmoiAjYCbCAAIAAoAjggAmoiAy0AACIENgJIIAAgACgCVCADLQABIAQgACgCWHRzcTYCSCAGIAdHDQIMAQsgACgCOCAAKAJsai0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBACAAIAAoAnRBAWs2AnQgACAAKAJsQQFqIgI2AmwgACgCoC0gACgCnC1BAWtHDQELQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQALQQAPCyAAIAAoAmwiAkECIAJBAkkbNgK0LSABQQRGBEBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EBEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALQQNBAiAAKAIAKAIQGw8LAkAgACgCoC1FDQBBACEDIAAgACgCXCIEQQBOBH8gACgCOCAEagUgAwsgAiAEa0EAEBQgACAAKAJsNgJcIAAoAgAiAigCHCIDEBMCQCACKAIQIgQgAygCFCIFIAQgBUkbIgRFDQAgAigCDCADKAIQIAQQHxogAiACKAIMIARqNgIMIAMgAygCECAEajYCECACIAIoAhQgBGo2AhQgAiACKAIQIARrNgIQIAMgAygCFCAEayICNgIUIAINACADIAMoAgg2AhALIAAoAgAoAhANAEEADwtBAQukBAEQfyAAKAJ8IgMgA0ECdiAAKAJ4IgQgACgCjAFJGyEJQQAgACgCbCIDIAAoAixrQYYCaiICIAIgA0sbIQwgACgCdCIHIAAoApABIgIgAiAHSxshDSAAKAI4Ig4gA2oiBUGCAmohDyAEIAVqIgMtAAAhCiADQQFrLQAAIQsgACgCNCEQIAAoAkAhEQNAAkACQCABIA5qIgMgBGoiAi0AACAKRw0AIAJBAWstAAAgC0cNACADLQAAIAUtAABHDQBBAiEGIAMtAAEgBS0AAUcNAAJAAkACQAJAAkACQAJAA0AgBSAGaiICLQABIAMtAANHDQYgAi0AAiADLQAERw0FIAItAAMgAy0ABUcNBCACLQAEIAMtAAZHDQMgAi0ABSADLQAHRw0CIAItAAYgAy0ACEcNASACLQAHIAMtAAlGBEAgBkH5AUshCCAFIAZBCGoiBmohAiAIDQggAy0ACiEIIANBCGohAyACLQAAIAhGDQEMCAsLIAJBB2ohAgwGCyACQQZqIQIMBQsgAkEFaiECDAQLIAJBBGohAgwDCyACQQNqIQIMAgsgAkECaiECDAELIAJBAWohAgsgAiAPayICQYICaiIDIARMDQAgACABNgJwIAMgDU4EQCADIQQMAgsgAyAFai0AACEKIAIgBWotAIECIQsgAyEECyAJQQFrIglFDQAgDCARIAEgEHFBAXRqLwEAIgFJDQELCyAHIAQgBCAHSxsL3Q4BB38DQAJAAkACQCAAKAJ0QYUCSw0AIAAQCiAAKAJ0IQICQCABDQAgAkGGAk8NAEEADwsgAkUNAiACQQJLDQAgACAAKAJgIgI2AnggACAAKAJwNgJkQQIhAyAAQQI2AmAMAQtBAiEDIAAgACgCVCAAKAJsIgIgACgCOGotAAIgACgCSCAAKAJYdHNxIgQ2AkggACgCQCACIAAoAjRxQQF0aiAAKAJEIARBAXRqIgUvAQAiBDsBACAFIAI7AQAgACAAKAJgIgI2AnggACAAKAJwNgJkIABBAjYCYCAERQ0AAkAgAiAAKAKAAU8NACAAKAIsQYYCayAAKAJsIARrSQ0AIAAgACAEEA4iAzYCYCADQQVLDQAgACgCiAFBAUcEQCADQQNHDQFBAyEDIAAoAmwgACgCcGtBgSBJDQELQQIhAyAAQQI2AmALIAAoAnghAgsCQCACQQNJDQAgAiADSQ0AIAAoAnQhBCAAKAKkLSAAKAKgLSIDQQF0aiAAKAJsIgUgACgCZEF/c2oiBjsBACAAIANBAWo2AqAtIAMgACgCmC1qIAJBA2siAjoAACACQf8BcUGAzQBqLQAAQQJ0IABqQZgJaiICIAIvAQBBAWo7AQAgACAGQQFrQf//A3EiAiACQQd2QYACaiACQYACSRtBgMkAai0AAEECdGpBiBNqIgIgAi8BAEEBajsBACAAIAAoAngiAkECayIDNgJ4IAAgACgCdCACa0EBajYCdCAEIAVqQQNrIQUgACgCnC1BAWshByAAKAJsIQIgACgCoC0hCANAIAAgAiIEQQFqIgI2AmwgAiAFTQRAIAAgACgCVCAEIAAoAjhqLQADIAAoAkggACgCWHRzcSIGNgJIIAAoAkAgACgCNCACcUEBdGogACgCRCAGQQF0aiIGLwEAOwEAIAYgAjsBAAsgACADQQFrIgM2AnggAw0ACyAAQQI2AmAgAEEANgJoIAAgBEECaiICNgJsIAcgCEcNAkEAIQMgACAAKAJcIgRBAE4EfyAAKAI4IARqBSADCyACIARrQQAQFCAAIAAoAmw2AlwgACgCACICKAIcIgMQEwJAIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACgCACgCEA0CQQAPCyAAKAJoBEAgACgCbCAAKAI4akEBay0AACECIAAoAqQtIAAoAqAtIgNBAXRqQQA7AQAgACADQQFqNgKgLSADIAAoApgtaiACOgAAIAAgAkECdGpBlAFqIgIgAi8BAEEBajsBAAJAIAAoAqAtIAAoApwtQQFrRw0AQQAhAyAAIAAoAlwiAkEATgR/IAAoAjggAmoFIAMLIAAoAmwgAmtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATIAIoAhAiBCADKAIUIgUgBCAFSRsiBEUNACACKAIMIAMoAhAgBBAfGiACIAIoAgwgBGo2AgwgAyADKAIQIARqNgIQIAIgAigCFCAEajYCFCACIAIoAhAgBGs2AhAgAyADKAIUIARrIgI2AhQgAg0AIAMgAygCCDYCEAsgACAAKAJsQQFqNgJsIAAgACgCdEEBazYCdCAAKAIAKAIQDQJBAA8FIABBATYCaCAAIAAoAmxBAWo2AmwgACAAKAJ0QQFrNgJ0DAILAAsLIAAoAmgEQCAAKAJsIAAoAjhqQQFrLQAAIQIgACgCpC0gACgCoC0iA0EBdGpBADsBACAAIANBAWo2AqAtIAMgACgCmC1qIAI6AAAgACACQQJ0akGUAWoiAiACLwEAQQFqOwEAIABBADYCaAsgACAAKAJsIgJBAiACQQJJGzYCtC0gAUEERgRAQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBARAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQC0EDQQIgACgCACgCEBsPCwJAIAAoAqAtRQ0AQQAhAyAAIAAoAlwiBEEATgR/IAAoAjggBGoFIAMLIAIgBGtBABAUIAAgACgCbDYCXCAAKAIAIgIoAhwiAxATAkAgAigCECIEIAMoAhQiBSAEIAVJGyIERQ0AIAIoAgwgAygCECAEEB8aIAIgAigCDCAEajYCDCADIAMoAhAgBGo2AhAgAiACKAIUIARqNgIUIAIgAigCECAEazYCECADIAMoAhQgBGsiAjYCFCACDQAgAyADKAIINgIQCyAAKAIAKAIQDQBBAA8LQQELYQAgAEEANgK8LSAAQQA7AbgtIABBuBZqQajPADYCACAAIABB/BRqNgKwFiAAQawWakGUzwA2AgAgACAAQYgTajYCpBYgAEGgFmpBgM8ANgIAIAAgAEGUAWo2ApgWIAAQEQvwBAEDfyAAQZQBaiECA0AgAiABQQJ0IgNqQQA7AQAgAiADQQRyakEAOwEAIAFBAmoiAUGeAkcNAAsgAEEAOwH8FCAAQQA7AYgTIABBxBVqQQA7AQAgAEHAFWpBADsBACAAQbwVakEAOwEAIABBuBVqQQA7AQAgAEG0FWpBADsBACAAQbAVakEAOwEAIABBrBVqQQA7AQAgAEGoFWpBADsBACAAQaQVakEAOwEAIABBoBVqQQA7AQAgAEGcFWpBADsBACAAQZgVakEAOwEAIABBlBVqQQA7AQAgAEGQFWpBADsBACAAQYwVakEAOwEAIABBiBVqQQA7AQAgAEGEFWpBADsBACAAQYAVakEAOwEAIABB/BNqQQA7AQAgAEH4E2pBADsBACAAQfQTakEAOwEAIABB8BNqQQA7AQAgAEHsE2pBADsBACAAQegTakEAOwEAIABB5BNqQQA7AQAgAEHgE2pBADsBACAAQdwTakEAOwEAIABB2BNqQQA7AQAgAEHUE2pBADsBACAAQdATakEAOwEAIABBzBNqQQA7AQAgAEHIE2pBADsBACAAQcQTakEAOwEAIABBwBNqQQA7AQAgAEG8E2pBADsBACAAQbgTakEAOwEAIABBtBNqQQA7AQAgAEGwE2pBADsBACAAQawTakEAOwEAIABBqBNqQQA7AQAgAEGkE2pBADsBACAAQaATakEAOwEAIABBnBNqQQA7AQAgAEGYE2pBADsBACAAQZQTakEAOwEAIABBkBNqQQA7AQAgAEGME2pBADsBACAAQgA3AqwtIABBlAlqQQE7AQAgAEEANgKoLSAAQQA2AqAtC7IDAQJ/IAAgAC8BuC0gA0H//wNxIgUgACgCvC0iBHRyIgM7AbgtAkACQAJ/IARBDk4EQCAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAM6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAAQbktai0AADoAACAAIAVBECAAKAK8LSIEa3YiAzsBuC0gBEENawwBCyAEQQNqCyIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGohBCAAQbktai0AACEDDAELIARBAUgNASAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQLIAQgAzoAAAsgAEEANgK8LSAAQQA7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAjoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAJBCHY6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiACQX9zIgM6AAAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiADQQh2OgAAIAAoAgggACgCFGogASACEB8aIAAgACgCFCACajYCFAusAQEBfwJAIAACfyAAKAK8LSIBQRBGBEAgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIAAoAhQiAUEBajYCFCABIAAoAghqIABBuS1qLQAAOgAAIABBADsBuC1BAAwBCyABQQhIDQEgACAAKAIUIgFBAWo2AhQgASAAKAIIaiAALQC4LToAACAAIABBuS1qLQAAOwG4LSAAKAK8LUEIaws2ArwtCwuhEwENfwJ/AkACQAJAIAAoAoQBQQFOBEAgACgCACIGKAIsQQJHDQNB/4D/n38hBANAAkAgBEEBcUUNACAAIAVBAnRqLwGUAUUNAEEAIQQMBAsCQCAEQQJxRQ0AIAAgBUECdEEEcmovAZQBRQ0AQQAhBAwECyAEQQJ2IQQgBUECaiIFQSBHDQALDAELIAJBBWoiBQwDCwJAIAAvAbgBDQAgAC8BvAENACAALwHIAQ0AQSAhBQNAIAAgBUECdCIEai8BlAENASAAIARBBHJqLwGUAQ0BIAAgBEEIcmovAZQBDQEgACAEQQxyai8BlAENAUEAIQQgBUEEaiIFQYACRw0ACwwBC0EBIQQLIAYgBDYCLAsgACAAQZgWahAVIAAgAEGkFmoQFSAALwGWASEEIAAgAEGcFmooAgAiCkECdGpB//8DOwGaASAKQQBOBEBBB0GKASAEGyEJQQRBAyAEGyELIABBwBVqIQ4gAEHEFWohDyAAQbwVaiEQQX8hDANAIAQhBSAAIAgiDUEBaiIIQQJ0ai8BlgEhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgAEGKE2ovAQAhBCAAIABBqBZqKAIAIgpBAnRqQY4TakH//wM7AQBBACEHIApBAE4EQEEHQYoBIAQbIQlBBEEDIAQbIQsgAEHAFWohDiAAQcQVaiEPIABBvBVqIRBBfyEMQQAhCANAIAQhBSAAIAgiDUEBaiIIQQJ0akGKE2ovAQAhBAJAAkAgB0EBaiIGIAlODQAgBCAFRw0AIAYhBwwBCwJ/IAYgC0gEQCAAIAVBAnRqQfwUaiIHLwEAIAZqDAELIAUEQCAFIAxHBEAgACAFQQJ0akH8FGoiBiAGLwEAQQFqOwEACyAQIgcvAQBBAWoMAQsgB0EJTARAIA4iBy8BAEEBagwBCyAPIgcvAQBBAWoLIQYgByAGOwEAQQAhBwJ/IARFBEBBAyELQYoBDAELQQNBBCAEIAVGIgYbIQtBBkEHIAYbCyEJIAUhDAsgCiANRw0ACwsgACAAQbAWahAVIAAgACgCqC0Cf0ESIABBuhVqLwEADQAaQREgAEGCFWovAQANABpBECAAQbYVai8BAA0AGkEPIABBhhVqLwEADQAaQQ4gAEGyFWovAQANABpBDSAAQYoVai8BAA0AGkEMIABBrhVqLwEADQAaQQsgAEGOFWovAQANABpBCiAAQaoVai8BAA0AGkEJIABBkhVqLwEADQAaQQggAEGmFWovAQANABpBByAAQZYVai8BAA0AGkEGIABBohVqLwEADQAaQQUgAEGaFWovAQANABpBBCAAQZ4Vai8BAA0AGkEDQQIgAEH+FGovAQAbCyIIQQNsaiIEQRFqNgKoLSAEQRtqQQN2IgQgACgCrC1BCmpBA3YiBSAEIAVJGwshBAJAAkAgAUUNACACQQRqIARLDQAgACABIAIgAxASDAELIAAoArwtIQYCQCAEIAVHBEAgACgCiAFBBEcNAQsgACAALwG4LSADQQJqQf//A3EiBCAGdHIiBTsBuC0gAAJ/IAZBDk4EQCAAIAAoAhQiBkEBajYCFCAGIAAoAghqIAU6AAAgACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAAQbktai0AADoAACAAIARBECAAKAK8LSIFa3Y7AbgtIAVBDWsMAQsgBkEDags2ArwtIABBwM8AQcDYABAWDAELIAAvAbgtIANBBGpB//8DcSIHIAZ0ciEFAkAgBkEOTgRAIAAgBTsBuC0gACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAFOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUENayEEIAdBECAFa3YhBQwBCyAGQQNqIQQLIAAgBDYCvC0gAEGcFmooAgAiCkGA/gNqQf//A3EiByAEdCEGIABBqBZqKAIAIQkCfyAEQQxOBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBC2shBCAHQRAgBWt2DAELIARBBWohBCAFIAZyCyEFIAAgBDYCvC0gCUH//wNxIgcgBHQhBgJ/IARBDE4EQCAAIAUgBnIiBDsBuC0gACAAKAIUIgVBAWo2AhQgBSAAKAIIaiAEOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAEG5LWotAAA6AAAgACgCvC0iBUELayEEIAdBECAFa3YMAQsgBEEFaiEEIAUgBnILIQUgACAENgK8LSAIQf3/A2pB//8DcSIHIAR0IQYCfyAEQQ1OBEAgACAFIAZyIgQ7AbgtIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBDoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIABBuS1qLQAAOgAAIAAoArwtIgVBDGshBCAHQRAgBWt2DAELIARBBGohBCAFIAZyCyEGIAAgBDYCvC1BACEFIABBuS1qIQ0DQCAAIAYgACAFQZDcAGotAABBAnRqQf4Uai8BACIHIAR0ciIGOwG4LSAAAn8gBEEOTgRAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogBjoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIA0tAAA6AAAgACAHQRAgACgCvC0iBGt2IgY7AbgtIARBDWsMAQsgBEEDagsiBDYCvC0gBSAIRyEHIAVBAWohBSAHDQALIAAgAEGUAWoiBCAKEBcgACAAQYgTaiIFIAkQFyAAIAQgBRAWCyAAEBEgAwRAAkACfyAAKAK8LSIEQQlOBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAALQC4LToAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIQQgAEG5LWotAAAMAQsgBEEBSA0BIAAgACgCFCIEQQFqNgIUIAQgACgCCGohBCAALQC4LQshBSAEIAU6AAALIABBADYCvC0gAEEAOwG4LQsLsRUBFX8jAEEgayEKIAEoAgAhCSABKAIIIgIoAgAhBSACKAIMIQ0gAEKAgICA0McANwLQKEF/IRACQCANQQBKBEBBACECA0ACQCAJIAJBAnRqIgMvAQAEQCAAIAAoAtAoQQFqIgM2AtAoIAAgA0ECdGpB3BZqIAI2AgAgACACakHYKGpBADoAACACIRAMAQsgA0EAOwECCyACQQFqIgIgDUcNAAsgACgC0CgiBEEBSg0BCwNAIAAgBEEBaiICNgLQKCAAIAJBAnRqQdwWaiAQQQFqIgNBACAQQQJIIgQbIgI2AgAgCSACQQJ0IgdqQQE7AQAgACACakHYKGpBADoAACAAIAAoAqgtQQFrNgKoLSAFBEAgACAAKAKsLSAFIAdqLwECazYCrC0LIAMgECAEGyEQIAAoAtAoIgRBAkgNAAsLIAEgEDYCBCAEQQF2IQgDQCAAIAhBAnRqQdwWaigCACELAkAgCCICQQF0IgMgBEoNACAAIAtqQdgoaiEPIAkgC0ECdGohBiAIIQUDQAJAIAMgBE4EQCADIQIMAQsgCSAAQdwWaiICIANBAXIiBEECdGooAgAiDkECdGovAQAiByAJIAIgA0ECdGooAgAiDEECdGovAQAiAk8EQCACIAdHBEAgAyECDAILIAMhAiAAQdgoaiIDIA5qLQAAIAMgDGotAABLDQELIAQhAgsgBi8BACIEIAkgACACQQJ0akHcFmooAgAiA0ECdGovAQAiB0kEQCAFIQIMAgsCQCAEIAdHDQAgDy0AACAAIANqQdgoai0AAEsNACAFIQIMAgsgACAFQQJ0akHcFmogAzYCACACIQUgAkEBdCIDIAAoAtAoIgRMDQALCyAAIAJBAnRqQdwWaiALNgIAIAhBAk4EQCAIQQFrIQggACgC0CghBAwBCwsgACgC0CghAwNAIA0hCCAAIANBAWsiBDYC0CggACgC4BYhCyAAIAAgA0ECdGpB3BZqKAIAIg02AuAWQQEhAgJAIANBA0gNACAAIA1qQdgoaiEPQQIhAyAJIA1BAnRqIQZBASEFA0ACQCADIAROBEAgAyECDAELIAkgAEHcFmoiAiADQQFyIgRBAnRqKAIAIg5BAnRqLwEAIgcgCSACIANBAnRqKAIAIgxBAnRqLwEAIgJPBEAgAiAHRwRAIAMhAgwCCyADIQIgAEHYKGoiAyAOai0AACADIAxqLQAASw0BCyAEIQILIAYvAQAiBCAJIAAgAkECdGpB3BZqKAIAIgNBAnRqLwEAIgdJBEAgBSECDAILAkAgBCAHRw0AIA8tAAAgACADakHYKGotAABLDQAgBSECDAILIAAgBUECdGpB3BZqIAM2AgAgAiEFIAJBAXQiAyAAKALQKCIETA0ACwtBAiEDIABB3BZqIgYgAkECdGogDTYCACAAIAAoAtQoQQFrIgQ2AtQoIAAoAuAWIQIgBiAEQQJ0aiALNgIAIAAgACgC1ChBAWsiBDYC1CggBiAEQQJ0aiACNgIAIAkgCEECdGoiDiAJIAJBAnRqIgQvAQAgCSALQQJ0aiIFLwEAajsBACAAQdgoaiIMIAhqIg8gAiAMai0AACICIAsgDGotAAAiByACIAdLG0EBajoAACAEIAg7AQIgBSAIOwECIAAgCDYC4BZBASEFQQEhAgJAIAAoAtAoIgRBAkgNAANAAn8gAyADIARODQAaIAkgBiADQQFyIgRBAnRqKAIAIgtBAnRqLwEAIgIgCSAGIANBAnRqKAIAIg1BAnRqLwEAIgdPBEAgAyACIAdHDQEaIAMgCyAMai0AACAMIA1qLQAASw0BGgsgBAshAiAOLwEAIgQgCSAAIAJBAnRqQdwWaigCACIDQQJ0ai8BACIHSQRAIAUhAgwCCwJAIAQgB0cNACAPLQAAIAAgA2pB2ChqLQAASw0AIAUhAgwCCyAAIAVBAnRqQdwWaiADNgIAIAIhBSACQQF0IgMgACgC0CgiBEwNAAsLIAhBAWohDSAAIAJBAnRqQdwWaiAINgIAIAAoAtAoIgNBAUoNAAsgACAAKALUKEEBayICNgLUKCAAQdwWaiIDIAJBAnRqIAAoAuAWNgIAIAEoAgQhByABKAIIIgIoAhAhBiACKAIIIREgAigCBCETIAIoAgAhEiABKAIAIQwgAEHUFmoiAUIANwEAIABBzBZqIhRCADcBACAAQcQWaiIVQgA3AQAgAEG8FmoiFkIANwEAQQAhCCAMIAMgACgC1ChBAnRqKAIAQQJ0akEAOwECAkAgACgC1CgiAkG7BEoNACACQQFqIQJBACEOA0AgDCAAIAJBAnRqQdwWaigCACIEQQJ0Ig1qIgUgDCAFLwECQQJ0ai8BAiIDQQFqIAYgAyAGSBsiDzsBAiADIAZOIQMCQCAEIAdKDQAgACAPQQF0akG8FmoiCyALLwEAQQFqOwEAQQAhCyAEIBFOBEAgEyAEIBFrQQJ0aigCACELCyAAIAAoAqgtIAUvAQAiBCALIA9qbGo2AqgtIBJFDQAgACAAKAKsLSALIA0gEmovAQJqIARsajYCrC0LIAMgDmohDiACQQFqIgJBvQRHDQALIA5FDQAgACAGQQF0akG8FmohDwNAIAYhAgNAIAAgAiIDQQFrIgJBAXRqQbwWaiIELwEAIgVFDQALIAQgBUEBazsBACAAIANBAXRqQbwWaiICIAIvAQBBAmo7AQAgDyAPLwEAQQFrIgI7AQAgDkECSiEDIA5BAmshDiADDQALIAZFDQBBvQQhBQNAIAJB//8DcSEDIAUhAgNAIAMEQCAAIAJBAWsiAkECdGpB3BZqKAIAIgQgB0oNASAMIARBAnRqIgQvAQIiBSAGRwRAIAAgACgCqC0gBC8BACAGIAVrbGo2AqgtIAQgBjsBAgsgA0EBayEDIAIhBQwBCwsgBkEBayIGRQ0BIAAgBkEBdGpBvBZqLwEAIQIMAAsACyAKIBYvAQBBAXQiAjsBAiAKIAIgAEG+FmovAQBqQQF0IgI7AQQgCiACIABBwBZqLwEAakEBdCICOwEGIAogAiAAQcIWai8BAGpBAXQiAjsBCCAKIAIgFS8BAGpBAXQiAjsBCiAKIAIgAEHGFmovAQBqQQF0IgI7AQwgCiACIABByBZqLwEAakEBdCICOwEOIAogAiAAQcoWai8BAGpBAXQiAjsBECAKIAIgFC8BAGpBAXQiAjsBEiAKIAIgAEHOFmovAQBqQQF0IgI7ARQgCiACIABB0BZqLwEAakEBdCICOwEWIAogAiAAQdIWai8BAGpBAXQiAjsBGCAKIAEvAQAgAmpBAXQiAjsBGiAKIABB1hZqLwEAIAJqQQF0IgI7ARwgCiACIABB2BZqLwEAakEBdDsBHiAQQQBOBEADQCAJIAhBAnRqIgcvAQIiBARAIAogBEEBdGoiACAALwEAIgBBAWo7AQAgBEEDcSEDQQAhAiAEQQFrQQNPBEAgBEH8/wNxIQUDQCAAQQN2QQFxIABBAnZBAXEgAEECcSACIABBAXFyQQJ0cnJBAXRyIgRBAXQhAiAAQQR2IQAgBUEEayIFDQALCyADBEADQCACIABBAXFyIgRBAXQhAiAAQQF2IQAgA0EBayIDDQALCyAHIAQ7AQALIAggEEchACAIQQFqIQggAA0ACwsL2QgBCn8CQCAAKAKgLUUEQCAAKAK8LSEDDAELIABBuS1qIQgDQCAEQQFqIQogACgCmC0gBGotAAAhBQJAIAACfyAAKAKkLSAEQQF0ai8BACIHRQRAIAEgBUECdGoiAy8BAiEEIAAgAC8BuC0gAy8BACIFIAAoArwtIgN0ciIHOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAgsgAyAEagwBCyAFQYDNAGotAAAiC0ECdCIJQYAIciABaiIDLwEGIQQgACAALwG4LSADLwEEIgwgACgCvC0iBnRyIgM7AbgtIAACf0EQIARrIAZIBEAgACAAKAIUIgZBAWo2AhQgBiAAKAIIaiADOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIGa3YiAzsBuC0gBCAGakEQawwBCyAEIAZqCyIENgK8LSALQQhrQRNNBEAgACADIAUgCUGw3ABqKAIAa0H//wNxIgYgBHRyIgM7AbgtIAACf0EQIAlBwNkAaigCACIFayAESARAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogAzoAACAAIAAoAhQiBEEBajYCFCAEIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBGt2IgM7AbgtIAQgBWpBEGsMAQsgBCAFagsiBDYCvC0LIAIgB0EBayIFIAVBB3ZBgAJqIAVBgAJJG0GAyQBqLQAAIgtBAnQiCWoiBi8BAiEHIAAgAyAGLwEAIgwgBHRyIgY7AbgtIAACf0EQIAdrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAGOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAxBECAAKAK8LSIEa3YiBjsBuC0gBCAHakEQawwBCyAEIAdqCyIDNgK8LSALQQRJDQEgACAGIAUgCUGw3QBqKAIAa0H//wNxIgUgA3RyIgc7AbgtQRAgCUHA2gBqKAIAIgRrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAHOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAoiBCAAKAKgLUkNAAsLIAFBgghqLwEAIQQgACAALwG4LSABLwGACCIKIAN0ciIFOwG4LUEQIARrIANIBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAFOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogAEG5LWotAAA6AAAgACAKQRAgACgCvC0iA2t2OwG4LSAAIAMgBGpBEGs2ArwtDwsgACADIARqNgK8LQuXCwEMfyACQQBOBEBBBEEDIAEvAQIiChshBkEHQYoBIAobIQMgAEG5LWohCEF/IQcDQCAKIQkgASALIgxBAWoiC0ECdGovAQIhCgJAAkAgBUEBaiIEIANODQAgCSAKRw0AIAQhBQwBCwJAIAQgBkgEQCAAIAlBAnRqIgVB/BRqIQ0gBUH+FGohDiAAKAK8LSEFA0AgDi8BACEDIAAgAC8BuC0gDS8BACIGIAV0ciIHOwG4LSAAAn9BECADayAFSARAIAAgACgCFCIFQQFqNgIUIAUgACgCCGogBzoAACAAIAAoAhQiBUEBajYCFCAFIAAoAghqIAgtAAA6AAAgACAGQRAgACgCvC0iBWt2OwG4LSADIAVqQRBrDAELIAMgBWoLIgU2ArwtIARBAWsiBA0ACwwBCyAAAn8gCQRAAkAgByAJRgRAIAAoArwtIQMgBCEFDAELIAAgCUECdGoiBEH+FGovAQAhAyAAIAAvAbgtIARB/BRqLwEAIgYgACgCvC0iBHRyIgc7AbgtIAACf0EQIANrIARIBEAgACAAKAIUIgRBAWo2AhQgBCAAKAIIaiAHOgAAIAAgACgCFCIEQQFqNgIUIAQgACgCCGogCC0AADoAACAAIAZBECAAKAK8LSIEa3Y7AbgtIAMgBGpBEGsMAQsgAyAEagsiAzYCvC0LIAAvAbgtIAAvAbwVIgcgA3RyIQQCQEEQIAAvAb4VIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQf3/A2pB//8DcSIFIAN0ciIEOwG4LSADQQ9OBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBDmsMAgsgA0ECagwBCyAFQQlMBEAgAC8BuC0gAC8BwBUiByAAKAK8LSIDdHIhBAJAQRAgAC8BwhUiBmsgA0gEQCAAIAQ7AbgtIAAgACgCFCIDQQFqNgIUIAMgACgCCGogBDoAACAAIAAoAhQiA0EBajYCFCADIAAoAghqIAgtAAA6AAAgBiAAKAK8LSIEakEQayEDIAdBECAEa3YhBAwBCyADIAZqIQMLIAAgAzYCvC0gACAEIAVB/v8DakH//wNxIgUgA3RyIgQ7AbgtIANBDk4EQCAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAAgBUEQIAAoArwtIgNrdjsBuC0gA0ENawwCCyADQQNqDAELIAAvAbgtIAAvAcQVIgcgACgCvC0iA3RyIQQCQEEQIAAvAcYVIgZrIANIBEAgACAEOwG4LSAAIAAoAhQiA0EBajYCFCADIAAoAghqIAQ6AAAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAILQAAOgAAIAYgACgCvC0iBGpBEGshAyAHQRAgBGt2IQQMAQsgAyAGaiEDCyAAIAM2ArwtIAAgBCAFQfb/A2pB//8DcSIFIAN0ciIEOwG4LSADQQpOBEAgACAAKAIUIgNBAWo2AhQgAyAAKAIIaiAEOgAAIAAgACgCFCIDQQFqNgIUIAMgACgCCGogCC0AADoAACAAIAVBECAAKAK8LSIDa3Y7AbgtIANBCWsMAQsgA0EHags2ArwtC0EAIQUCfyAKRQRAQYoBIQNBAwwBC0EGQQcgCSAKRiIEGyEDQQNBBCAEGwshBiAJIQcLIAIgDEcNAAsLCwkAIAEgAmwQHAsGACABEB0LXwEBfyMAQUBqIgMkACADQQA2AjAgA0IANwMoIAMgADYCCCADIAI2AhQgAyABNgIMIAMgAUEDbDYCGCADQQhqEAcgA0EIahALIANBCGoQCCADKAIcIQEgA0FAayQAIAELBgBB1N8AC6QuAQx/IwBBEGsiDCQAAkACQAJAAkACQAJAAkACQAJAAkACQAJAIABB9AFNBEBB2N8AKAIAIgZBECAAQQtqQXhxIABBC0kbIgRBA3YiAXYiAEEDcQRAIABBf3NBAXEgAWoiAkEDdCIDQYjgAGooAgAiAUEIaiEAAkAgASgCCCIEIANBgOAAaiIDRgRAQdjfACAGQX4gAndxNgIADAELIAQgAzYCDCADIAQ2AggLIAEgAkEDdCICQQNyNgIEIAEgAmoiASABKAIEQQFyNgIEDA0LIARB4N8AKAIAIghNDQEgAARAAkAgACABdEECIAF0IgBBACAAa3JxIgBBACAAa3FBAWsiACAAQQx2QRBxIgB2IgFBBXZBCHEiAiAAciABIAJ2IgBBAnZBBHEiAXIgACABdiIAQQF2QQJxIgFyIAAgAXYiAEEBdkEBcSIBciAAIAF2aiICQQN0IgNBiOAAaigCACIBKAIIIgAgA0GA4ABqIgNGBEBB2N8AIAZBfiACd3EiBjYCAAwBCyAAIAM2AgwgAyAANgIICyABQQhqIQAgASAEQQNyNgIEIAEgBGoiAyACQQN0IgUgBGsiAkEBcjYCBCABIAVqIAI2AgAgCARAIAhBA3YiBUEDdEGA4ABqIQRB7N8AKAIAIQECfyAGQQEgBXQiBXFFBEBB2N8AIAUgBnI2AgAgBAwBCyAEKAIICyEFIAQgATYCCCAFIAE2AgwgASAENgIMIAEgBTYCCAtB7N8AIAM2AgBB4N8AIAI2AgAMDQtB3N8AKAIAIglFDQEgCUEAIAlrcUEBayIAIABBDHZBEHEiAHYiAUEFdkEIcSICIAByIAEgAnYiAEECdkEEcSIBciAAIAF2IgBBAXZBAnEiAXIgACABdiIAQQF2QQFxIgFyIAAgAXZqQQJ0QYjiAGooAgAiAygCBEF4cSAEayEBIAMhAgNAAkAgAigCECIARQRAIAIoAhQiAEUNAQsgACgCBEF4cSAEayICIAEgASACSyICGyEBIAAgAyACGyEDIAAhAgwBCwsgAyAEaiILIANNDQIgAygCGCEKIAMgAygCDCIFRwRAIAMoAggiAEHo3wAoAgBJGiAAIAU2AgwgBSAANgIIDAwLIANBFGoiAigCACIARQRAIAMoAhAiAEUNBCADQRBqIQILA0AgAiEHIAAiBUEUaiICKAIAIgANACAFQRBqIQIgBSgCECIADQALIAdBADYCAAwLC0F/IQQgAEG/f0sNACAAQQtqIgBBeHEhBEHc3wAoAgAiCEUNAEEfIQcgBEH///8HTQRAIABBCHYiACAAQYD+P2pBEHZBCHEiAHQiASABQYDgH2pBEHZBBHEiAXQiAiACQYCAD2pBEHZBAnEiAnRBD3YgACABciACcmsiAEEBdCAEIABBFWp2QQFxckEcaiEHC0EAIARrIQECQAJAAkAgB0ECdEGI4gBqKAIAIgJFBEBBACEADAELQQAhACAEQQBBGSAHQQF2ayAHQR9GG3QhAwNAAkAgAigCBEF4cSAEayIGIAFPDQAgAiEFIAYiAQ0AQQAhASACIQAMAwsgACACKAIUIgYgBiACIANBHXZBBHFqKAIQIgJGGyAAIAYbIQAgA0EBdCEDIAINAAsLIAAgBXJFBEBBAiAHdCIAQQAgAGtyIAhxIgBFDQMgAEEAIABrcUEBayIAIABBDHZBEHEiAHYiAkEFdkEIcSIDIAByIAIgA3YiAEECdkEEcSICciAAIAJ2IgBBAXZBAnEiAnIgACACdiIAQQF2QQFxIgJyIAAgAnZqQQJ0QYjiAGooAgAhAAsgAEUNAQsDQCAAKAIEQXhxIARrIgYgAUkhAyAGIAEgAxshASAAIAUgAxshBSAAKAIQIgIEfyACBSAAKAIUCyIADQALCyAFRQ0AIAFB4N8AKAIAIARrTw0AIAQgBWoiByAFTQ0BIAUoAhghCSAFIAUoAgwiA0cEQCAFKAIIIgBB6N8AKAIASRogACADNgIMIAMgADYCCAwKCyAFQRRqIgIoAgAiAEUEQCAFKAIQIgBFDQQgBUEQaiECCwNAIAIhBiAAIgNBFGoiAigCACIADQAgA0EQaiECIAMoAhAiAA0ACyAGQQA2AgAMCQsgBEHg3wAoAgAiAE0EQEHs3wAoAgAhAQJAIAAgBGsiAkEQTwRAQeDfACACNgIAQezfACABIARqIgM2AgAgAyACQQFyNgIEIAAgAWogAjYCACABIARBA3I2AgQMAQtB7N8AQQA2AgBB4N8AQQA2AgAgASAAQQNyNgIEIAAgAWoiACAAKAIEQQFyNgIECyABQQhqIQAMCwsgBEHk3wAoAgAiA0kEQEHk3wAgAyAEayIBNgIAQfDfAEHw3wAoAgAiACAEaiICNgIAIAIgAUEBcjYCBCAAIARBA3I2AgQgAEEIaiEADAsLQQAhACAEQS9qIggCf0Gw4wAoAgAEQEG44wAoAgAMAQtBvOMAQn83AgBBtOMAQoCggICAgAQ3AgBBsOMAIAxBDGpBcHFB2KrVqgVzNgIAQcTjAEEANgIAQZTjAEEANgIAQYAgCyIBaiIGQQAgAWsiB3EiBSAETQ0KQZDjACgCACIBBEBBiOMAKAIAIgIgBWoiCSACTQ0LIAEgCUkNCwtBlOMALQAAQQRxDQUCQAJAQfDfACgCACIBBEBBmOMAIQADQCABIAAoAgAiAk8EQCACIAAoAgRqIAFLDQMLIAAoAggiAA0ACwtBABAeIgNBf0YNBiAFIQZBtOMAKAIAIgBBAWsiASADcQRAIAUgA2sgASADakEAIABrcWohBgsgBCAGTw0GIAZB/v///wdLDQZBkOMAKAIAIgAEQEGI4wAoAgAiASAGaiICIAFNDQcgACACSQ0HCyAGEB4iACADRw0BDAgLIAYgA2sgB3EiBkH+////B0sNBSAGEB4iAyAAKAIAIAAoAgRqRg0EIAMhAAsCQCAEQTBqIAZNDQAgAEF/Rg0AQbjjACgCACIBIAggBmtqQQAgAWtxIgFB/v///wdLBEAgACEDDAgLIAEQHkF/RwRAIAEgBmohBiAAIQMMCAtBACAGaxAeGgwFCyAAIQMgAEF/Rw0GDAQLAAtBACEFDAcLQQAhAwwFCyADQX9HDQILQZTjAEGU4wAoAgBBBHI2AgALIAVB/v///wdLDQEgBRAeIgNBABAeIgBPDQEgA0F/Rg0BIABBf0YNASAAIANrIgYgBEEoak0NAQtBiOMAQYjjACgCACAGaiIANgIAQYzjACgCACAASQRAQYzjACAANgIACwJAAkACQEHw3wAoAgAiAQRAQZjjACEAA0AgAyAAKAIAIgIgACgCBCIFakYNAiAAKAIIIgANAAsMAgtB6N8AKAIAIgBBACAAIANNG0UEQEHo3wAgAzYCAAtBACEAQZzjACAGNgIAQZjjACADNgIAQfjfAEF/NgIAQfzfAEGw4wAoAgA2AgBBpOMAQQA2AgADQCAAQQN0IgFBiOAAaiABQYDgAGoiAjYCACABQYzgAGogAjYCACAAQQFqIgBBIEcNAAtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiAWsiAjYCAEHw3wAgASADaiIBNgIAIAEgAkEBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCAAwCCyABIANPDQAgASACSQ0AIAAoAgxBCHENACAAIAUgBmo2AgRB8N8AIAFBeCABa0EHcUEAIAFBCGpBB3EbIgBqIgI2AgBB5N8AQeTfACgCACAGaiIDIABrIgA2AgAgAiAAQQFyNgIEIAEgA2pBKDYCBEH03wBBwOMAKAIANgIADAELQejfACgCACADSwRAQejfACADNgIACyADIAZqIQJBmOMAIQACQAJAAkACQAJAAkADQCACIAAoAgBHBEAgACgCCCIADQEMAgsLIAAtAAxBCHFFDQELQZjjACEAA0AgASAAKAIAIgJPBEAgAiAAKAIEaiICIAFLDQMLIAAoAgghAAwACwALIAAgAzYCACAAIAAoAgQgBmo2AgQgA0F4IANrQQdxQQAgA0EIakEHcRtqIgcgBEEDcjYCBCACQXggAmtBB3FBACACQQhqQQdxG2oiBiAHayAEayECIAQgB2ohBCABIAZGBEBB8N8AIAQ2AgBB5N8AQeTfACgCACACaiIANgIAIAQgAEEBcjYCBAwDCyAGQezfACgCAEYEQEHs3wAgBDYCAEHg3wBB4N8AKAIAIAJqIgA2AgAgBCAAQQFyNgIEIAAgBGogADYCAAwDCyAGKAIEIgBBA3FBAUYEQCAAQXhxIQgCQCAAQf8BTQRAIAYoAggiASAAQQN2IgVBA3RBgOAAakYaIAEgBigCDCIARgRAQdjfAEHY3wAoAgBBfiAFd3E2AgAMAgsgASAANgIMIAAgATYCCAwBCyAGKAIYIQkCQCAGIAYoAgwiA0cEQCAGKAIIIgAgAzYCDCADIAA2AggMAQsCQCAGQRRqIgAoAgAiAQ0AIAZBEGoiACgCACIBDQBBACEDDAELA0AgACEFIAEiA0EUaiIAKAIAIgENACADQRBqIQAgAygCECIBDQALIAVBADYCAAsgCUUNAAJAIAYgBigCHCIBQQJ0QYjiAGoiACgCAEYEQCAAIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiABd3E2AgAMAgsgCUEQQRQgCSgCECAGRhtqIAM2AgAgA0UNAQsgAyAJNgIYIAYoAhAiAARAIAMgADYCECAAIAM2AhgLIAYoAhQiAEUNACADIAA2AhQgACADNgIYCyAGIAhqIQYgAiAIaiECCyAGIAYoAgRBfnE2AgQgBCACQQFyNgIEIAIgBGogAjYCACACQf8BTQRAIAJBA3YiAUEDdEGA4ABqIQACf0HY3wAoAgAiAkEBIAF0IgFxRQRAQdjfACABIAJyNgIAIAAMAQsgACgCCAshASAAIAQ2AgggASAENgIMIAQgADYCDCAEIAE2AggMAwtBHyEAIAJB////B00EQCACQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgEgAUGA4B9qQRB2QQRxIgF0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAXIgA3JrIgBBAXQgAiAAQRVqdkEBcXJBHGohAAsgBCAANgIcIARCADcCECAAQQJ0QYjiAGohAQJAQdzfACgCACIDQQEgAHQiBXFFBEBB3N8AIAMgBXI2AgAgASAENgIAIAQgATYCGAwBCyACQQBBGSAAQQF2ayAAQR9GG3QhACABKAIAIQMDQCADIgEoAgRBeHEgAkYNAyAAQR12IQMgAEEBdCEAIAEgA0EEcWpBEGoiBSgCACIDDQALIAUgBDYCACAEIAE2AhgLIAQgBDYCDCAEIAQ2AggMAgtB5N8AIAZBKGsiAEF4IANrQQdxQQAgA0EIakEHcRsiBWsiBzYCAEHw3wAgAyAFaiIFNgIAIAUgB0EBcjYCBCAAIANqQSg2AgRB9N8AQcDjACgCADYCACABIAJBJyACa0EHcUEAIAJBJ2tBB3EbakEvayIAIAAgAUEQakkbIgVBGzYCBCAFQaDjACkCADcCECAFQZjjACkCADcCCEGg4wAgBUEIajYCAEGc4wAgBjYCAEGY4wAgAzYCAEGk4wBBADYCACAFQRhqIQADQCAAQQc2AgQgAEEIaiEDIABBBGohACACIANLDQALIAEgBUYNAyAFIAUoAgRBfnE2AgQgASAFIAFrIgZBAXI2AgQgBSAGNgIAIAZB/wFNBEAgBkEDdiICQQN0QYDgAGohAAJ/QdjfACgCACIDQQEgAnQiAnFFBEBB2N8AIAIgA3I2AgAgAAwBCyAAKAIICyECIAAgATYCCCACIAE2AgwgASAANgIMIAEgAjYCCAwEC0EfIQAgAUIANwIQIAZB////B00EQCAGQQh2IgAgAEGA/j9qQRB2QQhxIgB0IgIgAkGA4B9qQRB2QQRxIgJ0IgMgA0GAgA9qQRB2QQJxIgN0QQ92IAAgAnIgA3JrIgBBAXQgBiAAQRVqdkEBcXJBHGohAAsgASAANgIcIABBAnRBiOIAaiECAkBB3N8AKAIAIgNBASAAdCIFcUUEQEHc3wAgAyAFcjYCACACIAE2AgAgASACNgIYDAELIAZBAEEZIABBAXZrIABBH0YbdCEAIAIoAgAhAwNAIAMiAigCBEF4cSAGRg0EIABBHXYhAyAAQQF0IQAgAiADQQRxakEQaiIFKAIAIgMNAAsgBSABNgIAIAEgAjYCGAsgASABNgIMIAEgATYCCAwDCyABKAIIIgAgBDYCDCABIAQ2AgggBEEANgIYIAQgATYCDCAEIAA2AggLIAdBCGohAAwFCyACKAIIIgAgATYCDCACIAE2AgggAUEANgIYIAEgAjYCDCABIAA2AggLQeTfACgCACIAIARNDQBB5N8AIAAgBGsiATYCAEHw3wBB8N8AKAIAIgAgBGoiAjYCACACIAFBAXI2AgQgACAEQQNyNgIEIABBCGohAAwDC0HU3wBBMDYCAEEAIQAMAgsCQCAJRQ0AAkAgBSgCHCICQQJ0QYjiAGoiACgCACAFRgRAIAAgAzYCACADDQFB3N8AIAhBfiACd3EiCDYCAAwCCyAJQRBBFCAJKAIQIAVGG2ogAzYCACADRQ0BCyADIAk2AhggBSgCECIABEAgAyAANgIQIAAgAzYCGAsgBSgCFCIARQ0AIAMgADYCFCAAIAM2AhgLAkAgAUEPTQRAIAUgASAEaiIAQQNyNgIEIAAgBWoiACAAKAIEQQFyNgIEDAELIAUgBEEDcjYCBCAHIAFBAXI2AgQgASAHaiABNgIAIAFB/wFNBEAgAUEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACICQQEgAXQiAXFFBEBB2N8AIAEgAnI2AgAgAAwBCyAAKAIICyEBIAAgBzYCCCABIAc2AgwgByAANgIMIAcgATYCCAwBC0EfIQAgAUH///8HTQRAIAFBCHYiACAAQYD+P2pBEHZBCHEiAHQiAiACQYDgH2pBEHZBBHEiAnQiBCAEQYCAD2pBEHZBAnEiBHRBD3YgACACciAEcmsiAEEBdCABIABBFWp2QQFxckEcaiEACyAHIAA2AhwgB0IANwIQIABBAnRBiOIAaiECAkACQCAIQQEgAHQiBHFFBEBB3N8AIAQgCHI2AgAgAiAHNgIAIAcgAjYCGAwBCyABQQBBGSAAQQF2ayAAQR9GG3QhACACKAIAIQQDQCAEIgIoAgRBeHEgAUYNAiAAQR12IQQgAEEBdCEAIAIgBEEEcWpBEGoiAygCACIEDQALIAMgBzYCACAHIAI2AhgLIAcgBzYCDCAHIAc2AggMAQsgAigCCCIAIAc2AgwgAiAHNgIIIAdBADYCGCAHIAI2AgwgByAANgIICyAFQQhqIQAMAQsCQCAKRQ0AAkAgAygCHCICQQJ0QYjiAGoiACgCACADRgRAIAAgBTYCACAFDQFB3N8AIAlBfiACd3E2AgAMAgsgCkEQQRQgCigCECADRhtqIAU2AgAgBUUNAQsgBSAKNgIYIAMoAhAiAARAIAUgADYCECAAIAU2AhgLIAMoAhQiAEUNACAFIAA2AhQgACAFNgIYCwJAIAFBD00EQCADIAEgBGoiAEEDcjYCBCAAIANqIgAgACgCBEEBcjYCBAwBCyADIARBA3I2AgQgCyABQQFyNgIEIAEgC2ogATYCACAIBEAgCEEDdiIEQQN0QYDgAGohAkHs3wAoAgAhAAJ/QQEgBHQiBCAGcUUEQEHY3wAgBCAGcjYCACACDAELIAIoAggLIQQgAiAANgIIIAQgADYCDCAAIAI2AgwgACAENgIIC0Hs3wAgCzYCAEHg3wAgATYCAAsgA0EIaiEACyAMQRBqJAAgAAvMDAEHfwJAIABFDQAgAEEIayICIABBBGsoAgAiAUF4cSIAaiEFAkAgAUEBcQ0AIAFBA3FFDQEgAiACKAIAIgFrIgJB6N8AKAIASQ0BIAAgAWohACACQezfACgCAEcEQCABQf8BTQRAIAIoAggiBCABQQN2IgdBA3RBgOAAakYaIAQgAigCDCIBRgRAQdjfAEHY3wAoAgBBfiAHd3E2AgAMAwsgBCABNgIMIAEgBDYCCAwCCyACKAIYIQYCQCACIAIoAgwiA0cEQCACKAIIIgEgAzYCDCADIAE2AggMAQsCQCACQRRqIgEoAgAiBA0AIAJBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAQJAIAIgAigCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAwsgBkEQQRQgBigCECACRhtqIAM2AgAgA0UNAgsgAyAGNgIYIAIoAhAiAQRAIAMgATYCECABIAM2AhgLIAIoAhQiAUUNASADIAE2AhQgASADNgIYDAELIAUoAgQiAUEDcUEDRw0AQeDfACAANgIAIAUgAUF+cTYCBCACIABBAXI2AgQgACACaiAANgIADwsgAiAFTw0AIAUoAgQiAUEBcUUNAAJAIAFBAnFFBEAgBUHw3wAoAgBGBEBB8N8AIAI2AgBB5N8AQeTfACgCACAAaiIANgIAIAIgAEEBcjYCBCACQezfACgCAEcNA0Hg3wBBADYCAEHs3wBBADYCAA8LIAVB7N8AKAIARgRAQezfACACNgIAQeDfAEHg3wAoAgAgAGoiADYCACACIABBAXI2AgQgACACaiAANgIADwsgAUF4cSAAaiEAAkAgAUH/AU0EQCAFKAIIIgQgAUEDdiIHQQN0QYDgAGpGGiAEIAUoAgwiAUYEQEHY3wBB2N8AKAIAQX4gB3dxNgIADAILIAQgATYCDCABIAQ2AggMAQsgBSgCGCEGAkAgBSAFKAIMIgNHBEAgBSgCCCIBQejfACgCAEkaIAEgAzYCDCADIAE2AggMAQsCQCAFQRRqIgEoAgAiBA0AIAVBEGoiASgCACIEDQBBACEDDAELA0AgASEHIAQiA0EUaiIBKAIAIgQNACADQRBqIQEgAygCECIEDQALIAdBADYCAAsgBkUNAAJAIAUgBSgCHCIEQQJ0QYjiAGoiASgCAEYEQCABIAM2AgAgAw0BQdzfAEHc3wAoAgBBfiAEd3E2AgAMAgsgBkEQQRQgBigCECAFRhtqIAM2AgAgA0UNAQsgAyAGNgIYIAUoAhAiAQRAIAMgATYCECABIAM2AhgLIAUoAhQiAUUNACADIAE2AhQgASADNgIYCyACIABBAXI2AgQgACACaiAANgIAIAJB7N8AKAIARw0BQeDfACAANgIADwsgBSABQX5xNgIEIAIgAEEBcjYCBCAAIAJqIAA2AgALIABB/wFNBEAgAEEDdiIBQQN0QYDgAGohAAJ/QdjfACgCACIEQQEgAXQiAXFFBEBB2N8AIAEgBHI2AgAgAAwBCyAAKAIICyEBIAAgAjYCCCABIAI2AgwgAiAANgIMIAIgATYCCA8LQR8hASACQgA3AhAgAEH///8HTQRAIABBCHYiASABQYD+P2pBEHZBCHEiAXQiBCAEQYDgH2pBEHZBBHEiBHQiAyADQYCAD2pBEHZBAnEiA3RBD3YgASAEciADcmsiAUEBdCAAIAFBFWp2QQFxckEcaiEBCyACIAE2AhwgAUECdEGI4gBqIQQCQAJAAkBB3N8AKAIAIgNBASABdCIFcUUEQEHc3wAgAyAFcjYCACAEIAI2AgAgAiAENgIYDAELIABBAEEZIAFBAXZrIAFBH0YbdCEBIAQoAgAhAwNAIAMiBCgCBEF4cSAARg0CIAFBHXYhAyABQQF0IQEgBCADQQRxakEQaiIFKAIAIgMNAAsgBSACNgIAIAIgBDYCGAsgAiACNgIMIAIgAjYCCAwBCyAEKAIIIgAgAjYCDCAEIAI2AgggAkEANgIYIAIgBDYCDCACIAA2AggLQfjfAEH43wAoAgBBAWsiAkF/IAIbNgIACwtVAQJ/QdDfACgCACIBIABBA2pBfHEiAmohAAJAIAJBAU5BACAAIAFNGw0APwBBEHQgAEkEQCAAEABFDQELQdDfACAANgIAIAEPC0HU3wBBMDYCAEF/C4IEAQN/IAJBgARPBEAgACABIAIQARogAA8LIAAgAmohAwJAIAAgAXNBA3FFBEACQCACQQFIBEAgACECDAELIABBA3FFBEAgACECDAELIAAhAgNAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANPDQEgAkEDcQ0ACwsCQCADQXxxIgRBwABJDQAgAiAEQUBqIgVLDQADQCACIAEoAgA2AgAgAiABKAIENgIEIAIgASgCCDYCCCACIAEoAgw2AgwgAiABKAIQNgIQIAIgASgCFDYCFCACIAEoAhg2AhggAiABKAIcNgIcIAIgASgCIDYCICACIAEoAiQ2AiQgAiABKAIoNgIoIAIgASgCLDYCLCACIAEoAjA2AjAgAiABKAI0NgI0IAIgASgCODYCOCACIAEoAjw2AjwgAUFAayEBIAJBQGsiAiAFTQ0ACwsgAiAETw0BA0AgAiABKAIANgIAIAFBBGohASACQQRqIgIgBEkNAAsMAQsgA0EESQRAIAAhAgwBCyAAIANBBGsiBEsEQCAAIQIMAQsgACECA0AgAiABLQAAOgAAIAIgAS0AAToAASACIAEtAAI6AAIgAiABLQADOgADIAFBBGohASACQQRqIgIgBE0NAAsLIAIgA0kEQANAIAIgAS0AADoAACABQQFqIQEgAkEBaiICIANHDQALCyAAC9YCAQJ/AkAgAUUNACAAIAFqIgJBAWtBADoAACAAQQA6AAAgAUEDSQ0AIAJBAmtBADoAACAAQQA6AAEgAkEDa0EAOgAAIABBADoAAiABQQdJDQAgAkEEa0EAOgAAIABBADoAAyABQQlJDQAgAEEAIABrQQNxIgNqIgJBADYCACACIAEgA2tBfHEiA2oiAUEEa0EANgIAIANBCUkNACACQQA2AgggAkEANgIEIAFBCGtBADYCACABQQxrQQA2AgAgA0EZSQ0AIAJBADYCGCACQQA2AhQgAkEANgIQIAJBADYCDCABQRBrQQA2AgAgAUEUa0EANgIAIAFBGGtBADYCACABQRxrQQA2AgAgAyACQQRxQRhyIgNrIgFBIEkNACACIANqIQIDQCACQgA3AxggAkIANwMQIAJCADcDCCACQgA3AwAgAkEgaiECIAFBIGsiAUEfSw0ACwsLBAAjAAsGACAAJAALEAAjACAAa0FwcSIAJAAgAAsLvVYIAEGECAvxQJYwB3csYQ7uulEJmRnEbQeP9GpwNaVj6aOVZJ4yiNsOpLjceR7p1eCI2dKXK0y2Cb18sX4HLbjnkR2/kGQQtx3yILBqSHG5895BvoR91Noa6+TdbVG11PTHhdODVphsE8Coa2R6+WL97Mllik9cARTZbAZjYz0P+vUNCI3IIG47XhBpTORBYNVycWei0eQDPEfUBEv9hQ3Sa7UKpfqotTVsmLJC1sm720D5vKzjbNgydVzfRc8N1txZPdGrrDDZJjoA3lGAUdfIFmHQv7X0tCEjxLNWmZW6zw+lvbieuAIoCIgFX7LZDMYk6Quxh3xvLxFMaFirHWHBPS1mtpBB3HYGcdsBvCDSmCoQ1e+JhbFxH7W2BqXkv58z1LjooskHeDT5AA+OqAmWGJgO4bsNan8tPW0Il2xkkQFcY+b0UWtrYmFsHNgwZYVOAGLy7ZUGbHulARvB9AiCV8QP9cbZsGVQ6bcS6ri+i3yIufzfHd1iSS3aFfN804xlTNT7WGGyTc5RtTp0ALyj4jC71EGl30rXldg9bcTRpPv01tNq6WlD/NluNEaIZ63QuGDacy0EROUdAzNfTAqqyXwN3TxxBVCqQQInEBALvoYgDMkltWhXs4VvIAnUZrmf5GHODvneXpjJ2SkimNCwtKjXxxc9s1mBDbQuO1y9t61susAgg7jttrO/mgzitgOa0rF0OUfV6q930p0VJtsEgxbccxILY+OEO2SUPmptDahaanoLzw7knf8JkyeuAAqxngd9RJMP8NKjCIdo8gEe/sIGaV1XYvfLZ2WAcTZsGecGa252G9T+4CvTiVp62hDMSt1nb9+5+fnvvo5DvrcX1Y6wYOij1tZ+k9GhxMLYOFLy30/xZ7vRZ1e8pt0GtT9LNrJI2isN2EwbCq/2SgM2YHoEQcPvYN9V32eo745uMXm+aUaMs2HLGoNmvKDSbyU24mhSlXcMzANHC7u5FgIiLyYFVb47usUoC72yklq0KwRqs1yn/9fCMc/QtYue2Swdrt5bsMJkmybyY+yco2p1CpNtAqkGCZw/Ng7rhWcHchNXAAWCSr+VFHq44q4rsXs4G7YMm47Skg2+1eW379x8Id/bC9TS04ZC4tTx+LPdaG6D2h/NFr6BWya59uF3sG93R7cY5loIiHBqD//KOwZmXAsBEf+eZY9prmL40/9rYUXPbBZ44gqg7tIN11SDBE7CswM5YSZnp/cWYNBNR2lJ23duPkpq0a7cWtbZZgvfQPA72DdTrrypxZ673n/Pskfp/7UwHPK9vYrCusowk7NTpqO0JAU20LqTBtfNKVfeVL9n2SMuemazuEphxAIbaF2UK28qN74LtKGODMMb3wVaje8CLQAAAABBMRsZgmI2MsNTLSsExWxkRfR3fYanWlbHlkFPCIrZyEm7wtGK6O/6y9n04wxPtaxNfq61ji2Dns8cmIdREsJKECPZU9Nw9HiSQe9hVdeuLhTmtTfXtZgcloSDBVmYG4IYqQCb2/otsJrLNqldXXfmHGxs/98/QdSeDlrNoiSEleMVn4wgRrKnYXepvqbh6PHn0PPoJIPew2Wyxdqqrl1d659GRCjMa29p/XB2rmsxOe9aKiAsCQcLbTgcEvM2Rt+yB13GcVRw7TBla/T38yq7tsIxonWRHIk0oAeQ+7yfF7qNhA553qklOO+yPP9583O+SOhqfRvFQTwq3lgFT3nwRH5i6YctT8LGHFTbAYoVlEC7Do2D6COmwtk4vw3FoDhM9Lshj6eWCs6WjRMJAMxcSDHXRYti+m7KU+F3VF27uhVsoKPWP42Ilw6WkVCY194RqczH0vrh7JPL+vVc12JyHeZ5a961VECfhE9ZWBIOFhkjFQ/acDgkm0EjPadr/WXmWuZ8JQnLV2Q40E6jrpEB4p+KGCHMpzNg/bwqr+Ekre7QP7QtgxKfbLIJhqskSMnqFVPQKUZ++2h3ZeL2eT8vt0gkNnQbCR01KhIE8rxTS7ONSFJw3mV5Me9+YP7z5ue/wv3+fJHQ1T2gy8z6NoqDuweRmnhUvLE5ZaeoS5iDOwqpmCLJ+rUJiMuuEE9d718ObPRGzT/ZbYwOwnRDElrzAiNB6sFwbMGAQXfYR9c2lwbmLY7FtQClhIQbvBqKQXFbu1pomOh3Q9nZbFoeTy0VX342DJwtGyfdHAA+EgCYuVMxg6CQYq6L0VO1khbF9N1X9O/ElKfC79WW2fbpvAeuqI0ct2veMZwq7yqF7XlryqxIcNNvG134LipG4eE23magB8V/Y1ToVCJl803l87ICpMKpG2eRhDAmoJ8puK7F5Pmf3v06zPPWe/3oz7xrqYD9WrKZPgmfsn84hKuwJBws8RUHNTJGKh5zdzEHtOFwSPXQa1E2g0Z6d7JdY07X+ssP5uHSzLXM+Y2E1+BKEpavCyONtshwoJ2JQbuERl0jAwdsOBrEPxUxhQ4OKEKYT2cDqVR+wPp5VYHLYkwfxTiBXvQjmJ2nDrPclhWqGwBU5VoxT/yZYmLX2FN5zhdP4UlWfvpQlS3Xe9QczGITio0tUruWNJHoux/Q2aAG7PN+Xq3CZUdukUhsL6BTdeg2EjqpBwkjalQkCCtlPxHkeaeWpUi8j2YbkaQnKoq94LzL8qGN0Oti3v3AI+/m2b3hvBT80KcNP4OKJn6ykT+5JNBw+BXLaTtG5kJ6d/1btWtl3PRafsU3CVPudjhI97GuCbjwnxKhM8w/inL9JJMAAAAAN2rCAW7UhANZvkYC3KgJB+vCywayfI0EhRZPBbhREw6PO9EP1oWXDeHvVQxk+RoJU5PYCAotngo9R1wLcKMmHEfJ5B0ed6IfKR1gHqwLLxubYe0awt+rGPW1aRnI8jUS/5j3E6YmsRGRTHMQFFo8FSMw/hR6jrgWTeR6F+BGTTjXLI85jpLJO7n4Czo87kQ/C4SGPlI6wDxlUAI9WBdeNm99nDc2w9o1AakYNIS/VzGz1ZUw6mvTMt0BETOQ5Wskp4+pJf4x7yfJWy0mTE1iI3snoCIimeYgFfMkISi0eCof3rorRmD8KXEKPij0HHEtw3azLJrI9S6tojcvwI2acPfnWHGuWR5zmTPcchwlk3crT1F2cvEXdEWb1XV43Il+T7ZLfxYIDX0hYs98pHSAeZMeQnjKoAR6/crGe7AuvGyHRH5t3vo4b+mQ+m5shrVrW+x3agJSMWg1OPNpCH+vYj8VbWNmqythUcHpYNTXpmXjvWRkugMiZo1p4Gcgy9dIF6EVSU4fU0t5dZFK/GPeT8sJHE6St1pMpd2YTZiaxEav8AZH9k5ARcEkgkREMs1Bc1gPQCrmSUIdjItDUGjxVGcCM1U+vHVXCda3VozA+FO7qjpS4hR8UNV+vlHoOeJa31MgW4btZlmxh6RYNJHrXQP7KVxaRW9ebS+tX4AbNeG3cffg7s+x4tmlc+Ncszzma9n+5zJnuOUFDXrkOEom7w8g5O5WnqLsYfRg7eTiL+jTiO3pijar671caerwuBP9x9LR/J5sl/6pBlX/LBAa+ht62PtCxJ75da5c+EjpAPN/g8LyJj2E8BFXRvGUQQn0oyvL9fqVjffN/0/2YF142Vc3utgOifzaOeM+27z1cd6Ln7Pf0iH13eVLN9zYDGvX72ap1rbY79SBsi3VBKRi0DPOoNFqcObTXRok0hD+XsUnlJzEfiraxklAGMfMVlfC+zyVw6KC08GV6BHAqK9Ny5/Fj8rGe8nI8RELyXQHRMxDbYbNGtPAzy25As5Alq+Rd/xtkC5CK5IZKOmTnD6mlqtUZJfy6iKVxYDglPjHvJ/PrX6elhM4nKF5+p0kb7WYEwV3mUq7MZt90fOaMDWJjQdfS4xe4Q2OaYvPj+ydgIrb90KLgkkEibUjxoiIZJqDvw5YguawHoDR2tyBVMyThGOmUYU6GBeHDXLVhqDQ4qmXuiCozgRmqvlupKt8eOuuSxIprxKsb60lxq2sGIHxpy/rM6Z2VXWkQT+3pcQp+KDzQzqhqv18o52XvqLQc8S15xkGtL6nQLaJzYK3DNvNsjuxD7NiD0mxVWWLsGgi17tfSBW6BvZTuDGckbm0it68g+AcvdpeWr/tNJi+AAAAAGVnvLiLyAmq7q+1EleXYo8y8N433F9rJbk4153vKLTFik8IfWTgvW8BhwHXuL/WSt3YavIzd9/gVhBjWJ9XGVD6MKXoFJ8Q+nH4rELIwHvfrafHZ0MIcnUmb87NcH+tlRUYES37t6Q/ntAYhyfozxpCj3OirCDGsMlHegg+rzKgW8iOGLVnOwrQAIeyaThQLwxf7Jfi8FmFh5flPdGHhmW04DrdWk+Pzz8oM3eGEOTq43dYUg3Y7UBov1H4ofgr8MSfl0gqMCJaT1ee4vZvSX+TCPXHfadA1RjA/G1O0J81K7cjjcUYlp+gfyonGUf9unwgQQKSj/QQ9+hIqD1YFJtYP6gjtpAdMdP3oYlqz3YUD6jKrOEHf76EYMMG0nCgXrcXHOZZuKn0PN8VTIXnwtHggH5pDi/Le2tId8OiDw3Lx2ixcynHBGFMoLjZ9ZhvRJD/0/x+UGbuGzfaVk0nuQ4oQAW2xu+wpKOIDBwasNuBf9dnOZF40iv0H26TA/cmO2aQmoOIPy+R7ViTKVRgRLQxB/gM36hNHrrP8abs35L+ibguRmcXm1QCcCfsu0jwcd4vTMkwgPnbVedFY5ygP2v5x4PTF2g2wXIPinnLN13krlDhXED/VE4lmOj2c4iLrhbvNxb4QIIEnSc+vCQf6SFBeFWZr9fgi8qwXDM7tlntXtHlVbB+UEfVGez/bCE7YglGh9rn6TLIgo6OcNSe7Six+VGQX1bkgjoxWDqDCY+n5m4zHwjBhg1tpjq1pOFAvcGG/AUvKUkXSk71r/N2IjKWEZ6KeL4rmB3ZlyBLyfR4Lq5IwMAB/dKlZkFqHF6W93k5Kk+Xlp9d8vEj5QUZa01gftf1jtFi5+u23l9SjgnCN+m1etlGAGi8IbzQ6jHfiI9WYzBh+dYiBJ5qmr2mvQfYwQG/Nm60rVMJCBWaTnId/ynOpRGGe7d04ccPzdkQkqi+rCpGERk4I3algHVmxtgQAXpg/q7PcpvJc8oi8aRXR5YY76k5rf3MXhFFBu5NdmOJ8c6NJkTc6EH4ZFF5L/k0HpNB2rEmU7/WmuvpxvmzjKFFC2IO8BkHaUyhvlGbPNs2J4Q1mZKWUP4uLpm5VCb83uieEnFdjHcW4TTOLjapq0mKEUXmPwMggYO7dpHg4xP2XFv9WelJmD5V8SEGgmxEYT7Uqs6Lxs+pN344QX/WXSbDbrOJdnzW7srEb9YdWQqxoeHkHhTzgXmoS9dpyxOyDnerXKHCuTnGfgGA/qmc5ZkVJAs2oDZuURyOpxZmhsJx2j4s3m8sSbnTlPCBBAmV5rixe0kNox4usRtIPtJDLVlu+8P22+mmkWdRH6mwzHrODHSUYblm8QYF3gAAAAB3BzCW7g5hLJkJUboHbcQZcGr0j+ljpTWeZJWjDtuIMnncuKTg1ekel9LZiAm2TCt+sXy957gtB5C/HZEdtxBkarAg8vO5cUiEvkHeGtrUfW3d5Ov01LVRg9OFxxNsmFZka6jA/WL5eoplyewUAVxPYwZs2foPPWONCA31O24gyExpEF7VYEHkomdxcjwD5NFLBNRH0g2F/aUKtWs1taj6QrKYbNu7ydasvPlAMths40XfXHXc1g3Pq9E9WSbZMKxR3gA6yNdRgL/QYRYhtPS1VrPEI8+6lZm4vaUPKAK4nl8FiAjGDNmysQvpJC9vfIdYaEwRwWEdq7ZmLT123EGQAdtxBpjSILzv1RAqcbGFiQa2tR+fv+Sl6LjUM3gHyaIPAPk0lgmojuEOmBh/ag27CG09LZFkbJfmY1wBa2tR9BxsYWKFZTDY8mIATmwGle0bAaV7ggj0wfUPxFdlsNnGErfpUIu+uOr8uYh8Yt0d3xXaLUmM03zz+9RMZU2yYVg6tVHOo7wAdNS7MOJK36VBPdiV16TRxG3T1vT7Q2npajRu2fytZ4hG2mC40EQELXMzAx3lqgpMX90NfMlQBXE8JwJBqr4LEBDJDCCGV2i1JSBvhbO5ZtQJzmHkn17e+Q4p2cmYsNCYIsfXqLRZsz0XLrQNgbe9XDvAumyt7biDIJq/s7YDtuIMdLHSmurVRzmd0nevBNsmFXPcFoPjYwsSlGQ7hA1taj56alqo5A7PC5MJ/50KAK4nfQeesfAPk0SHCKPSHgHyaGkGwv73YlddgGVnyxlsNnFuawbn/tQbdonTK+AQ2npaZ91KzPm532+Ovu/5F7e+Q2CwjtXW1qPoodGTfjjYwsRP3/JS0btn8aa8V2c/tQbdSLI2S9gNK9qvChtMNgNK9kEEemDfYO/DqGffVTFuju9Gab55y2GzjLxmgxolb9KgUmjiNswMd5W7C0cDIgIWuVUFJi/Fuju+sr0LKCu0WpJcs2oEwtf/p7XQzzEs2Z6LW96uHZtkwrDsY/ImdWqjnAJtkwqcCQap6w42P3IHZ4UFAFcTlb9KguK4ehR7sSuuDLYbOJLSjpvl1b4NfNzvtwvb3yGG09LU8dTiQmjds/gf2oNugb4Wzfa5JltvsHfhGLdHd4gIWub/D2pwZgY7yhEBC1yPZZ7/+GKuaWFr/9MWbM9FoArieNcN0u5OBINUOQOzwqdnJmHQYBb3SWlHTT5ud9uu0WpK2dZa3EDfC2Y32DvwqbyuU967nsVHss9/MLX/6b298hzKusKKU7OTMCS0o6a60DYFzdcGk1TeVykj2We/s2Z6LsRhSrhdaBsCKm8rlLQLvjfDDI6hWgXfGy0C740AAAAAGRsxQTI2YoIrLVPDZGzFBH139EVWWqeGT0GWx8jZigjRwrtJ+u/oiuP02custU8Mta5+TZ6DLY6HmBzPSsISUVPZIxB49HDTYe9Bki6u11U3teYUHJi11wWDhJaCG5hZmwCpGLAt+tupNsua5nddXf9sbBzUQT/fzVoOnpWEJKKMnxXjp7JGIL6pd2Hx6OGm6PPQ58PegyTaxbJlXV2uqkRGn+tva8wodnD9aTkxa64gKlrvCwcJLBIcOG3fRjbzxl0Hsu1wVHH0a2Uwuyrz96IxwraJHJF1kAegNBefvPsOhI26JaneeTyy7zhz83n/auhIvkHFG31Y3io88HlPBelifkTCTy2H21QcxpQVigGNDrtApiPog7842cI4oMUNIbv0TAqWp48TjZbOXMwACUXXMUhu+mKLd+FTyrq7XVSjoGwViI0/1pGWDpfe15hQx8ypEezh+tL1+suTcmLXXGt55h1AVLXeWU+EnxYOElgPFSMZJDhw2j0jQZtl/WunfOZa5lfLCSVO0DhkAZGuoxiKn+Izp8whKrz9YK0k4a+0P9DunxKDLYYJsmzJSCSr0FMV6vt+RiniZXdoLz959jYkSLcdCRt0BBIqNUtTvPJSSI2zeWXecGB+7zHn5vP+/v3Cv9XQkXzMy6A9g4o2+pqRB7uxvFR4qKdlOTuDmEsimKkKCbX6yRCuy4hf711PRvRsDm3ZP810wg6M81oSQ+pBIwLBbHDB2HdBgJc210eOLeYGpQC1xbwbhIRxQYoaaFq7W0N36JhabNnZFS1PHgw2fl8nGy2cPgAc3bmYABKggzFTi65ikJK1U9Hd9MUWxO/0V+/Cp5T22ZbVrge86bccjaicMd5rhSrvKspree3TcEis+F0bb+FGKi5m3jbhf8UHoFToVGNN82UiArLz5RupwqQwhJFnKZ+gJuTFrrj93p/51vPMOs/o/XuAqWu8mbJa/bKfCT6rhDh/LBwksDUHFfEeKkYyBzF3c0hw4bRRa9D1ekaDNmNdsnfL+tdO0uHmD/nMtczg14SNr5YSSraNIwudoHDIhLtBiQMjXUYaOGwHMRU/xCgODoVnT5hCflSpA1V5+sBMYsuBgTjFH5gj9F6zDqedqhWW3OVUABv8TzFa12Jimc55U9hJ4U8XUPp+VnvXLZVizBzULY2KEzSWu1Ifu+iRBqDZ0F5+8+xHZcKtbEiRbnVToC86EjboIwkHqQgkVGoRP2Urlqd55I+8SKWkkRtmvYoqJ/LLvODr0I2hwP3eYtnm7yMUvOG9DafQ/CaKgz8/kbJ+cNAkuWnLFfhC5kY7W/13etxla7XFflr07lMJN/dIOHa4Ca6xoRKf8Io/zDOTJP1yAAAAAAHCajcDhNRuAka+WQcJqNwGy8LrBI18sgVPFoUOE1G4D9E7jw2XhdYMVe/hCRr5ZAjYk1MKni0KC1xHPRwmo3Ad5MlHH6J3Hh5gHSkbLwusGu1hmxir38IZabX1EjXyyBP3mP8RsSamEHNMkRU8WhQU/jAjFriOehd65E04TUbgOY8s1zvJko46C/i5P0TuPD6GhAs8wDpSPQJQZTZeF1g3nH1vNdrDNjQYqQExV7+EMJXVszLTa+ozEQHdJGvlkCWpj6cn7zH+Ji1bySNiTUwioCd7IOaZIiEk8xUqeLQoK7reHyn8YEYoPgpxLXEc9CyzdsMu9ciaLzeirXCajcBxWOf3cx5ZrnLcM5l3kyUcdlFPK3QX8XJ11ZtFfonceH9Ltk99DQgWfM9iIXmAdKR4Qh6TegSgynvGyv1svC6wbX5Eh284+t5u+pDpa7WGbGp37FtoMVICafM4NWKvfwhjbRU/YSurZmDpwVFlptfUZGS942YiA7pn4GmNSNfLIEkVoRdLUx9OSpF1eU/eY/xOHAnLTFq3kk2Y3aVGxJqYRwbwr0VATvZEgiTBQc0yREAPWHNCSeYqQ4uMHVTxaFBVMwJnV3W8Pla31glT+MCMUjqqu1B8FOJRvn7VWuI56FsgU99ZZu2GWKSHsV3rkTRcKfsDXm9FWl+tL23hNRuA4Pdxt+Kxz+7jc6XZ5jyzXOf+2WvluGcy5HoNBe8mSjju5CAP7KKeVu1g9GHoL+Lk6e2I0+urNorqaVy9/RO48PzR0sf+l2ye/1UGqfoaECz72Hob+Z7EQvhcrnXzAOlI8sKDf/CEPSbxRlcR9AlBlPXLK6P3jZX69k//zdl4XWDYujdX2vyJDts+4znecfW837Ofi931IdLcN0vl12sM2NapZu/U79i21S2ygdBipATRoM4z0+ZwatIkGl3FXv4QxJyUJ8baKn7HGEBJwldWzMOVPPvB04KiwBHolctNr6jKj8WfyMl7xskLEfHMRAd0zYZtQ8/A0xrOArktka+WQJBt/HeSK0Iuk+koGZamPpyXZFSrlSLq8pTggMWfvMf4nn6tz5w4E5ad+nmhmLVvJJl3BRObMbtKmvPRfY2JNTCMS18Hjg3hXo/Pi2mKgJ3si0L324kESYKIxiO1g5pkiIJYDr+AHrDmgdza0YSTzFSFUaZjhxcYOobVcg2p4tCgqCC6l6pmBM6rpG75rut4fK8pEkutb6wSrK3GJafxgRimM+svpHVVdqW3P0Gg+CnEoTpD86N8/aqivpedtcRz0LQGGee2QKe+t4LNibLN2wyzD7E7sUkPYrCLZVW71yJouhVIX7hT9ga5kZwxvN6KtL0c4IO/Wl7avpg07QAAAAC4vGdlqgnIixK1r+6PYpdXN97wMiVrX9yd1zi5xbQo730IT4pvveBk1wGHAUrWv7jyatjd4N93M1hjEFZQGVef6KUw+voQnxRCrPhx33vAyGfHp611cghDzc5vJpWtf3AtERgVP6S3+4cY0J4az+gnonOPQrDGIKwIekfJoDKvPhiOyFsKO2e1socA0C9QOGmX7F8MhVnw4j3ll4dlhofR3TrgtM+PT1p3Myg/6uQQhlJYd+NA7dgN+FG/aPAr+KFIl5/EWiIwKuKeV09/SW/2x/UIk9VAp31t/MAYNZ/QTo0jtyuflhjFJyp/oLr9RxkCQSB8EPSPkqhI6PebFFg9I6g/WDEdkLaJoffTFHbPaqzKqA++fwfhBsNghF6gcNLmHBe39Km4WUwV3zzRwueFaX6A4HvLLw7Dd0hryw0PonOxaMdhBMcp2bigTERvmPX80/+Q7mZQflbaNxsOuSdNtgVAKKSw78YcDIijgduwGjln138r0niRk24f9Dsm9wODmpBmkS8/iCmTWO20RGBUDPgHMR5NqN+m8c+6/pLf7EYuuIlUmxdn7CdwAnHwSLvJTC/e2/mAMGNF51VrP6Cc04PH+cE2aBd5ig9y5F03y1zhUK5OVP9A9uiYJa6LiHMWN+8WBIJA+Lw+J50h6R8kmVV4QYvg168zXLDK7Vm2O1Xl0V5HUH6w/+wZ1WI7IWzah0YJyDLp53COjoIo7Z7UkFH5sYLkVl86WDE6p48Jgx8zbuYNhsEItTqmbb1A4aQF/IbBF0kpL6/1TkoyInbzip4Rlpgrvnggl9kdePTJS8BIri7S/QHAakFmpfeWXhxPKjl5XZ+Wl+Uj8fJNaxkF9dd+YOdi0Y5f3rbrwgmOUnq16TdoAEbZ0LwhvIjfMeowY1aPItb5YZpqngQHvaa9vwHB2K20bjYVCAlTHXJOmqXOKf+3e4YRD8fhdJIQ2c0qrL6oOBkRRoCldiPYxmZ1YHoBEHLPrv7Kc8mbV6TxIu8Ylkf9rTmpRRFezHZN7gbO8Ylj3EQmjWT4Qej5L3lRQZMeNFMmsdrrmta/s/nG6QtFoYwZ8A5ioUxpBzybUb6EJzbblpKZNS4u/lAmVLmZnuje/IxdcRI04RZ3qTYuzhGKSasDP+ZFu4OBIOPgkXZbXPYTSelZ/fFVPphsggYh1D5hRMaLzqp+N6nP1n9BOG7DJl18domzxMru1lkd1m/hobEK8xQe5EuoeYETy2nXq3cOsrnCoVwBfsY5nKn+gCQVmeU2oDYLjhxRboZmFqc+2nHCLG/eLJTTuUkJBIHwsbjmlaMNSXsbsS4eQ9I+SPtuWS3p2/bDUWeRpsywqR90DM56ZrlhlN4FBvEAAAAAAAAAAAMAAAAEAAQACAAEAAQAAAAEAAUAEAAIAAQAAAAEAAYAIAAgAAQAAAAEAAQAEAAQAAUAAAAIABAAIAAgAAUAAAAIABAAgACAAAUAAAAIACAAgAAAAQUAAAAgAIAAAgEABAUAAAAgAAIBAgEAEAUAQYHJAAu2EAECAwQEBQUGBgYGBwcHBwgICAgICAgICQkJCQkJCQkKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDw8PDwAAEBESEhMTFBQUFBUVFRUWFhYWFhYWFhcXFxcXFxcXGBgYGBgYGBgYGBgYGBgYGBkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHB0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0dHR0AAQIDBAUGBwgICQkKCgsLDAwMDA0NDQ0ODg4ODw8PDxAQEBAQEBAQERERERERERESEhISEhISEhMTExMTExMTFBQUFBQUFBQUFBQUFBQUFBUVFRUVFRUVFRUVFRUVFRUWFhYWFhYWFhYWFhYWFhYWFxcXFxcXFxcXFxcXFxcXFxgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkZGRkaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxsbGxscwCcAAMAsAAABAQAAHgEAAA8AAABALAAAQC0AAAAAAAAeAAAADwAAAAAAAADALQAAAAAAABMAAAAHAAAAAAAAAAwACACMAAgATAAIAMwACAAsAAgArAAIAGwACADsAAgAHAAIAJwACABcAAgA3AAIADwACAC8AAgAfAAIAPwACAACAAgAggAIAEIACADCAAgAIgAIAKIACABiAAgA4gAIABIACACSAAgAUgAIANIACAAyAAgAsgAIAHIACADyAAgACgAIAIoACABKAAgAygAIACoACACqAAgAagAIAOoACAAaAAgAmgAIAFoACADaAAgAOgAIALoACAB6AAgA+gAIAAYACACGAAgARgAIAMYACAAmAAgApgAIAGYACADmAAgAFgAIAJYACABWAAgA1gAIADYACAC2AAgAdgAIAPYACAAOAAgAjgAIAE4ACADOAAgALgAIAK4ACABuAAgA7gAIAB4ACACeAAgAXgAIAN4ACAA+AAgAvgAIAH4ACAD+AAgAAQAIAIEACABBAAgAwQAIACEACAChAAgAYQAIAOEACAARAAgAkQAIAFEACADRAAgAMQAIALEACABxAAgA8QAIAAkACACJAAgASQAIAMkACAApAAgAqQAIAGkACADpAAgAGQAIAJkACABZAAgA2QAIADkACAC5AAgAeQAIAPkACAAFAAgAhQAIAEUACADFAAgAJQAIAKUACABlAAgA5QAIABUACACVAAgAVQAIANUACAA1AAgAtQAIAHUACAD1AAgADQAIAI0ACABNAAgAzQAIAC0ACACtAAgAbQAIAO0ACAAdAAgAnQAIAF0ACADdAAgAPQAIAL0ACAB9AAgA/QAIABMACQATAQkAkwAJAJMBCQBTAAkAUwEJANMACQDTAQkAMwAJADMBCQCzAAkAswEJAHMACQBzAQkA8wAJAPMBCQALAAkACwEJAIsACQCLAQkASwAJAEsBCQDLAAkAywEJACsACQArAQkAqwAJAKsBCQBrAAkAawEJAOsACQDrAQkAGwAJABsBCQCbAAkAmwEJAFsACQBbAQkA2wAJANsBCQA7AAkAOwEJALsACQC7AQkAewAJAHsBCQD7AAkA+wEJAAcACQAHAQkAhwAJAIcBCQBHAAkARwEJAMcACQDHAQkAJwAJACcBCQCnAAkApwEJAGcACQBnAQkA5wAJAOcBCQAXAAkAFwEJAJcACQCXAQkAVwAJAFcBCQDXAAkA1wEJADcACQA3AQkAtwAJALcBCQB3AAkAdwEJAPcACQD3AQkADwAJAA8BCQCPAAkAjwEJAE8ACQBPAQkAzwAJAM8BCQAvAAkALwEJAK8ACQCvAQkAbwAJAG8BCQDvAAkA7wEJAB8ACQAfAQkAnwAJAJ8BCQBfAAkAXwEJAN8ACQDfAQkAPwAJAD8BCQC/AAkAvwEJAH8ACQB/AQkA/wAJAP8BCQAAAAcAQAAHACAABwBgAAcAEAAHAFAABwAwAAcAcAAHAAgABwBIAAcAKAAHAGgABwAYAAcAWAAHADgABwB4AAcABAAHAEQABwAkAAcAZAAHABQABwBUAAcANAAHAHQABwADAAgAgwAIAEMACADDAAgAIwAIAKMACABjAAgA4wAIAAAABQAQAAUACAAFABgABQAEAAUAFAAFAAwABQAcAAUAAgAFABIABQAKAAUAGgAFAAYABQAWAAUADgAFAB4ABQABAAUAEQAFAAkABQAZAAUABQAFABUABQANAAUAHQAFAAMABQATAAUACwAFABsABQAHAAUAFwAFAEHg2QALTQEAAAABAAAAAQAAAAEAAAACAAAAAgAAAAIAAAACAAAAAwAAAAMAAAADAAAAAwAAAAQAAAAEAAAABAAAAAQAAAAFAAAABQAAAAUAAAAFAEHQ2gALZQEAAAABAAAAAgAAAAIAAAADAAAAAwAAAAQAAAAEAAAABQAAAAUAAAAGAAAABgAAAAcAAAAHAAAACAAAAAgAAAAJAAAACQAAAAoAAAAKAAAACwAAAAsAAAAMAAAADAAAAA0AAAANAEGA3AALIwIAAAADAAAABwAAAAAAAAAQERIACAcJBgoFCwQMAw0CDgEPAEG03AALaQEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACgAAAAwAAAAOAAAAEAAAABQAAAAYAAAAHAAAACAAAAAoAAAAMAAAADgAAABAAAAAUAAAAGAAAABwAAAAgAAAAKAAAADAAAAA4ABBtN0AC5oCAQAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAABAAAAAYAAAAIAAAADAAAAAAAEAAIABAAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAAAAgAAAAMAAAAEAAAABgAABuZWVkIGRpY3Rpb25hcnkAc3RyZWFtIGVuZAAAZmlsZSBlcnJvcgBzdHJlYW0gZXJyb3IAZGF0YSBlcnJvcgBpbnN1ZmZpY2llbnQgbWVtb3J5AGJ1ZmZlciBlcnJvcgBpbmNvbXBhdGlibGUgdmVyc2lvbgAAAAAoLwAAOC8AAEMvAABELwAATy8AAFwvAABnLwAAey8AAIgvAABDLwAAMS4yLjExAEHQ3wALA9AxUA==").split("").map((e=>e.charCodeAt(0)));return new Uint8Array(t,0,t.length/Uint8Array.BYTES_PER_ELEMENT)}().buffer)})).then((function(e){return WebAssembly.instantiate(e,t)})).then(e,(function(e){s("failed to asynchronously prepare wasm: "+e),T(e)}))}((function(e){n(e.instance)})),{}}();let S=e.___wasm_call_ctors=function(){return(S=e.___wasm_call_ctors=e.asm.__wasm_call_ctors).apply(null,arguments)},C=e._malloc=function(){return(C=e._malloc=e.asm.malloc).apply(null,arguments)};e._free=function(){return(e._free=e.asm.free).apply(null,arguments)},e.___errno_location=function(){return(e.___errno_location=e.asm.__errno_location).apply(null,arguments)},e._zlibCompress=function(){return(e._zlibCompress=e.asm.zlibCompress).apply(null,arguments)};let O,b=e.stackSave=function(){return(b=e.stackSave=e.asm.stackSave).apply(null,arguments)},w=e.stackRestore=function(){return(w=e.stackRestore=e.asm.stackRestore).apply(null,arguments)},N=e.stackAlloc=function(){return(N=e.stackAlloc=e.asm.stackAlloc).apply(null,arguments)};function D(t){function n(){O||(O=!0,e.calledRun=!0,c||(v(E),v(g),e.onRuntimeInitialized&&e.onRuntimeInitialized(),function(){if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)t=e.postRun.shift(),_.unshift(t);var t;v(_)}()))}m>0||(function(){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)t=e.preRun.shift(),A.unshift(t);var t;v(A)}(),m>0||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),n()}),1)):n()))}if(e.ccall=l,e.cwrap=function(e,t,n,r){const i=(n=n||[]).every((function(e){return"number"===e}));return"string"!==t&&i&&!r?u(e):function(){return l(e,t,n,arguments)}},e.allocate=function(e,t){let n;return n=1==t?N(e.length):C(e.length),e.subarray||e.slice?p.set(e,n):p.set(new Uint8Array(e),n),n},I=function e(){O||D(),O||(I=e)},e.run=D,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return D(),GK=e,e}const HK=Uint8Array.BYTES_PER_ELEMENT,WK={bytesReceived:"br",frameDropped:"fd",frameReceived:"fr",googJitterReceived:"jr",isAudioMute:"am",isFreeze:"fz",mediaType:"mt",packetsLost:"pl",packetsReceived:"pr",peerId:"pid",id:"id",ssrc:"ssrc",timestamp:"ts",type:"tp",frameRateInput:"fi",frameRateSent:"fs",googRtt:"rt",isVideoMute:"vm"},YK={stats:"sts",state:"st",stream_id:"stid",session_id:"seid",stream_type:"stt",app_id:"aid",channel_key:"ck",channel_name:"cn",sdk_version:"sv",browser:"b",process_id:"pcid",mode:"m",codec:"c",role:"r",has_changed_gateway:"hcg",ap_response:"ar",extends:"es",details:"d",features:"ft",p2p_id:"ppid",sdp:"sdp",audio:"a",video:"v",attributes:"at",hq:"h",lq:"l",stereo:"str",speech:"spe",extend:"e",pingpongElapse:"ppe"},KK={_message:"m",_type:"t",_id:"id"},$K={join_v2:"j2",publish:"pub",publish_related_stats:"prs",ping:"pi",traffic_stats:"ts",ping_back:"pib",publish_stats:"pubs"};let zK;class qK{constructor(){iw(this,"zlibCompress",void 0)}async init(){if(!zK){const e=await(async()=>(QK||(QK=await jK()),{zlibCompress:e=>{const t=new Uint8Array(e),n=HK*t.byteLength,r=QK._malloc(n),i=QK._malloc(3*n);for(let e=0;e<n;e++)QK.HEAP8[r/HK+e]=t[e];const o=QK._zlibCompress(r,n,i),s=new Uint8Array(QK.HEAP8.slice(i,i+o));return QK._free(r),QK._free(i),s}}))();zK=e.zlibCompress}this.zlibCompress=zK}msgPackCompress(e){return VK.exports.encode(e)}compress(e){const t=Date.now(),n=this.compressKeyAndValue(JSON.parse(JSON.stringify(e))),r=this.msgPackCompress(n),i=this.zlibCompress(r),o=new Uint8Array([49,49,49,50,...Array.from(i)]);return{origin:Object.assign({},e),originLength:JSON.stringify(e).length,shortKeyAndValue:n,msgpackSer:r,compressed:o,compressedLength:o.length,time:Date.now()-t}}compressKeyAndValue(e){return this._ObjectKeyCompress(this._typeCompress(e))}_typeCompress(e){const t=e._type;if(!t)return e;const n=$K[t];return e._type=n||t,e}_ObjectKeyCompress(e){const t=e._message;if(t){const n=t.stats;n&&(t.stats=this._statsCompress(n)),e._message=this._messageCompress(t)}return this._reportCompress(e)}_statsCompress(e){return this._keyCompress(e,WK)}_messageCompress(e){return this._keyCompress(e,YK)}_reportCompress(e){return this._keyCompress(e,KK)}_keyCompress(e,t){const n={},r=Object.keys(e);return lh(r).call(r,((r,i)=>{const o=e[i];return t[i]?n[t[i]]=o:n[i]=o,n}),n),n}}class JK extends JN{get queue(){return[...this.highPriorityQueue,...this.lowPriorityQueue]}constructor(e){super(),iw(this,"lowPriorityQueue",[]),iw(this,"highPriorityQueue",[]),iw(this,"AgoraWebSocketManager",void 0),this.AgoraWebSocketManager=e}reset(){this.lowPriorityQueue=[],this.highPriorityQueue=[]}pushMessage(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]?this.highPriorityQueue.push(e):this.lowPriorityQueue.push(e),this.sendMessage()}sendMessage(){const e=this.queue.length;let t=0;t=e<5?15*e:60+3*(e-4),setTimeout((()=>{this._sendMessage()}),t)}_sendMessage(){if(!this.queue.length)return;const e=this.AgoraWebSocketManager.getConnection();if(!e||1!==e.readyState)return;const t=this.queue.shift();return this.lowPriorityQueue.includes(t)?this.lowPriorityQueue.shift():this.highPriorityQueue.shift(),e.send(t.compressed),t}}var XK;function ZK(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}let e$=PD("AgoraWebSocketManager","connectionID")(XK=class extends JN{get url(){return this.websocket?this.websocket.url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){["tryNext","recover"].includes(e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit($P.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit($P.CONNECTED):"closed"===this._state?this.emit($P.CLOSED):"failed"===this._state&&this.emit($P.FAILED))}resetReconnectCount(e){uD.debug("websocket reset reconnect count, reason: "+e),ND("debug",this,"resetReconnectCount",e,"websocket reset reconnect count, reason: "+e),this.reconnectCount=0}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0;super(),iw(this,"connectionID",0),iw(this,"currentURLIndex",0),iw(this,"urls",void 0),iw(this,"_reconnectMode","tryNext"),iw(this,"reconnectReason",void 0),iw(this,"_initMutex",new SG("websocket")),iw(this,"name",void 0),iw(this,"_state","closed"),iw(this,"reconnectInterrupter",void 0),iw(this,"websocket",void 0),iw(this,"retryConfig",void 0),iw(this,"reconnectCount",0),iw(this,"forceCloseTimeout",5e3),iw(this,"onlineReconnectListener",void 0),iw(this,"compressor",new qK),iw(this,"compressorInitStatus","initializing"),iw(this,"compress",void 0),iw(this,"messageSender",void 0),iw(this,"useCompress",void 0),iw(this,"tryDoubleDomain",!1),iw(this,"wsInflateLength",0),iw(this,"wsDeflateLength",0),iw(this,"closeEstablishingWs",(()=>{})),iw(this,"store",void 0),iw(this,"joinChannelServiceRecordIndex",void 0),this.store=i,this.name=e,this.retryConfig=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ZK(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZK(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t),this.useCompress=n,this.tryDoubleDomain=r;const{timeout:o,timeoutFactor:s}=t,a=Math.max(300,Math.floor(3*o/5)),c=Math.max(1.2,Math.floor(8*s)/10);Dk.ONLINE&&(this.retryConfig.timeout=a,this.retryConfig.timeoutFactor=c),aG.on(Lk.NETWORK_STATE_CHANGE,((e,t)=>{e!==t&&(this.resetReconnectCount("network state change: ".concat(t," -> ").concat(e)),e===Dk.ONLINE?(this.retryConfig.timeout=a,this.retryConfig.timeoutFactor=c):(this.retryConfig.timeout=o,this.retryConfig.timeoutFactor=s))}));const u=Date.now();this.compressor.init().then((()=>{this.compressorInitStatus="initialized";const e=Date.now()-u;uD.debug("websocket compressor initialized successfully in ".concat(e,"ms")),ND("debug",this.compressor,"init",void 0,"websocket compressor initialized successfully in ".concat(e,"ms")),mG.wsCompressorInit({status:!0,ec:null,eventElapse:e}),this.compress=this.compressor.compress.bind(this.compressor)})).catch((e=>{this.compressorInitStatus="failed";const t=e?e.message||e.toString():"Empty Error";uD.debug("websocket compressor failed to initialize because of ".concat(t)),ND("debug",this.compressor,"init",void 0,"websocket compressor failed to initialize because of ".concat(t)),mG.wsCompressorInit({status:!1,ec:t,eventElapse:1})}))}getConnection(){return this.websocket||void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;this.forceCloseTimeout=t;const n=(t,n)=>{this.urls=e;const r=this.urls[this.currentURLIndex];this.state="connecting",this.messageSender=new JK(this),this.createWebSocketConnection(r).then(t).catch(n),this.once($P.CLOSED,(()=>n(new eD(ZN.WS_DISCONNECT)))),this.once($P.CONNECTED,(()=>t()))};return this._initMutex.lock().then((e=>new xv(((e,t)=>{n(e,t)})).then((()=>{e()})).catch((()=>{e()}))))}close(e,t){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const e=this.websocket;t?setTimeout((()=>e.close()),500):e.close(),this.websocket=void 0}this.state=e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(e,t){if(!this.websocket)return uD.warning("[".concat(this.name,"] can not reconnect, no websocket")),void ND("warning",this,"reconnect","can not reconnect, no websocket");var n;void 0!==e&&(this.reconnectMode=e),uD.debug("[".concat(this.name,"] reconnect is triggered initiative")),ND("debug",this,"reconnect"),"number"==typeof this.joinChannelServiceRecordIndex&&(null===(n=this.store)||void 0===n||n.recordJoinChannelService({status:"error",errors:[new Error(t)]},this.joinChannelServiceRecordIndex));const r=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),r&&r.bind(this.websocket)({code:9999,reason:t})}sendMessageWithJSON(e){const t=JSON.stringify(e);return{compressed:t,compressedLength:t.length,origin:e}}sendMessageWithUint8Array(e){return{compressed:e,compressedLength:e.byteLength,origin:e}}sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new eD(ZN.WS_ABORT,"websocket is not ready");try{let r=null;if(n)r=this.sendMessageWithUint8Array(e);else if("initialized"===this.compressorInitStatus&&this.useCompress&&$D("WEBSOCKET_COMPRESS"))try{r=this.compress(e),this.setWsInflateData(r)}catch(t){r=this.sendMessageWithJSON(e)}else r=this.sendMessageWithJSON(e);t?this.websocket.send(r.compressed):this.messageSender.pushMessage(r)}catch(e){throw new eD(ZN.WS_ERR,"send websocket message error"+e.toString())}}setWsInflateData(e){this.wsDeflateLength=this.wsDeflateLength+e.originLength,this.wsInflateLength=this.wsInflateLength+e.compressedLength}getWsInflateData(){const e=this.wsInflateLength,t=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:e,wsDeflateLength:t}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(e,t){return this.connectionID+=1,this.connectionID,this.joinChannelServiceRecordIndex=void 0,new xv(((n,r)=>{var i;const o=()=>{uD.debug("[".concat(this.name,"] websocket opened:"),e),wD("debug",["WebSocket",this.connectionID],"open",e),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),n()},s=async e=>{if(uD.debug("[".concat(this.name,"] websocket close ").concat(this.websocket&&this.websocket.url,", code: ").concat(e.code,", reason: ").concat(e.reason,", current mode: ").concat(this.reconnectMode)),wD("debug",["WebSocket",this.connectionID],"close",{code:e.code,reason:e.reason,url:this.websocket&&this.websocket.url,reconnectMode:this.reconnectMode}),this.reconnectCount<this.retryConfig.maxRetryCount){"connected"===this.state&&(this.reconnectReason=e.reason,this.state="reconnecting");const t=Lj(this,$P.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,i=await this.reconnectWithAction(t);if("closed"===this.state)return uD.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect")),void CD("debug",this,"ws is closed, no need to reconnect");if(!i)return r(new eD(ZN.WS_DISCONNECT,"websocket reconnect failed: ".concat(e.code))),void this.close(!0);n()}else r(new eD(ZN.WS_DISCONNECT,"websocket close: ".concat(e.code))),this.close()},a=e=>{this.emit($P.ON_MESSAGE,e)};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),$D("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(e=$D("GATEWAY_WSS_ADDRESS")),uD.debug("[".concat(this.name,"] start connect, url: ").concat(e)),CD("debug",this,"start connect, url: ".concat(e));const c=null===(i=this.store)||void 0===i?void 0:i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});this.chooseBestWebsocketConnection(e,!!t,c).then((e=>{var t;this.websocket=e,o&&o(),e.onclose=s,e.onmessage=a,null===(t=this.store)||void 0===t||t.recordJoinChannelService({endTs:Date.now(),status:"success"},c),this.joinChannelServiceRecordIndex=c})).catch((e=>{var t;if(null===(t=this.store)||void 0===t||t.recordJoinChannelService({endTs:Date.now(),status:e instanceof eD&&e.code===ZN.WS_ABORT?"aborted":"error",errors:[e]},c),"closed"!==this.state){if(e instanceof eD&&e.code===ZN.WS_ERR){const t=new eD(ZN.WS_ERR,"init websocket failed! Error: ".concat(e.toString()));return uD.error("[".concat(this.name,"]").concat(t)),ND("error",this,"chooseBestWebsocketConnection",void 0,e.toString()),void r(t)}s&&s(e)}else r(new eD(ZN.WS_DISCONNECT,"websocket is closed: ".concat(e.toString())))}))}))}async reconnectWithAction(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount)return!1;if(!this.urls)return!1;if("closed"===this.state)return!1;this.onlineReconnectListener||aG.networkState!==Dk.OFFLINE||(this.onlineReconnectListener=aG.onlineWaiter&&aG.onlineWaiter.then((()=>{this.onlineReconnectListener=void 0})));let n=!0;if(this.reconnectInterrupter=()=>{n=!1},t){const t=nD(this.reconnectCount,this.retryConfig);uD.debug("[".concat(this.name,"] wait ").concat(t,"ms to reconnect websocket, mode: ").concat(e)),ND("debug",this,"reconnectWithAction",{timeout:t,action:e}),await xv.race([vj(t),this.onlineReconnectListener||new xv((()=>{}))])}if("closed"===this.state||!n)return!1;this.reconnectCount+=1;const r=async(e,t)=>{this.emit($P.RECONNECT_CREATE_CONNECTION,t),await this.createWebSocketConnection(e)};try{if("retry"===e){const t=this.urls[this.currentURLIndex];this.emit($P.RECONNECT_WAITTING_FINISH,e),await r(t,e)}else if("tryNext"===e){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return await this.reconnectWithAction("recover",!1);uD.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),CD("debug",this,"websocket url length: ".concat(this.urls.length," current index: ").concat(this.currentURLIndex));const t=this.urls[this.currentURLIndex];this.emit($P.RECONNECT_WAITTING_FINISH,e),await r(t,e)}else if("recover"===e){uD.debug("[".concat(this.name,"] request new urls")),CD("debug",this,"request new urls"),this.resetReconnectCount("recover mode"),this.emit($P.RECONNECT_WAITTING_FINISH,e),this.urls=await Nj(this,$P.REQUEST_NEW_URLS),this.currentURLIndex=0;const t=this.urls[this.currentURLIndex];await r(t,e)}return!0}catch(n){var i;return uD.error("[".concat(this.name,"] reconnect failed"),n.toString()),ND("error",this,"reconnectWithAction",void 0,n.toString()),null!=n&&null!==(i=n.data)&&void 0!==i&&i.desc&&Array.isArray(n.data.desc)&&n.data.desc.length&&n.data.desc.includes("dynamic key expired")?(this.emit($P.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(e,t)}}async chooseBestWebsocketConnection(e,t,n){return new xv(((r,i)=>{let o=!1;const s=[];this.closeEstablishingWs=()=>{uD.debug("[choose-best-ws] close establishing websockets"),s.forEach((e=>{e.onclose=null,e.onopen=null,e.onmessage=null,e.close()})),i(new eD(ZN.WS_ABORT,"choose best websocket aborted"))};const a=$D("GATEWAY_DOMAINS");let c;const u=e.indexOf("?h="),l=a.find((t=>-1!==u?e.includes(t,u):e.includes(t)));uD.debug("[choose-best-ws] currentDomain: ",l,", domains: ",a),ND("debug",this,"chooseBestWebsocketConnection",{currentDomain:l,domains:a});let d=!this.tryDoubleDomain||t||!l;if(!d&&l){var h;const t=Date.now();try{a.forEach((t=>{const n=-1===u?e.replace(l,t):e.substr(0,u)+e.substr(u).replace(l,t),r=new WebSocket(n);r.binaryType="arraybuffer",s.push(r),uD.debug("[choose-best-ws] ws is connecting:",r.url),CD("debug",this,"ws is connecting: ".concat(r.url))}))}catch(e){for(uD.debug("[choose-best-ws] ws create failed, fallback to single url"),CD("debug",this,"ws create failed, fallback to single url"),s.forEach((e=>e.close()));s.length;)s.pop();d=!0}null===(h=this.store)||void 0===h||h.recordJoinChannelService({urls:s.map((e=>e.url)),service:"gateway"},n),s.forEach((e=>{e.onopen=()=>{if(o)return;const n=Date.now()-t;uD.debug("[choose-best-ws] ws open cost ".concat(n,"ms")),s.filter((t=>t!==e)).forEach((e=>{uD.debug("[choose-best-ws]close backup websocket: ".concat(e.url)),CD("debug",this,"close backup websocket: ".concat(e.url)),e.close()})),o=!0,r(e)},e.onclose=e=>{c=e,o||s.find((e=>!(e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING)))||(uD.debug("[choose-best-ws] all websocket is closed"),CD("debug",this,"all websocket is closed"),o=!0,i(c))},e.onmessage=t=>{uD.debug("[choose-best-ws]".concat(e.url," onmessage: ").concat(t.data)),CD("debug",this,"".concat(e.url," onmessage: ").concat(t.data))}})),vj(this.forceCloseTimeout).then((()=>{s.forEach((e=>{e.readyState!==WebSocket.OPEN&&e.close()}))}))}if(d){var p;let t;uD.debug("[choose-best-ws] use single url: ",e),CD("debug",this,"use single url: ".concat(e)),null===(p=this.store)||void 0===p||p.recordJoinChannelService({urls:[e],service:"gateway"},n);try{t=new WebSocket(e),s.push(t),t.binaryType="arraybuffer"}catch(e){const t=new eD(ZN.WS_ERR,"init websocket failed! Error: ".concat(e.toString()));return uD.error("[".concat(this.name,"]").concat(t)),ND("error",this,"chooseBestWebsocketConnection",void 0,e.toString()),void i(t)}t.onopen=()=>{r(t)},t.onclose=e=>{i(e)},t.onmessage=e=>{uD.debug("[choose-best-ws]".concat(t.url," onmessage: ").concat(e.data)),CD("debug",this,"".concat(t.url," onmessage: ").concat(e.data))},vj(this.forceCloseTimeout).then((()=>{t&&t.readyState!==WebSocket.OPEN&&t.close()}))}})).then((e=>(this.closeEstablishingWs=void 0,e))).catch((e=>{throw this.closeEstablishingWs=void 0,e}))}})||XK;class t${constructor(e){iw(this,"input",[]),iw(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}mean(){var e;return 0===this.input.length?0:lh(e=this.input).call(e,((e,t)=>e+t))/this.input.length}}var n$;let r$=PD("AgoraRTCSignal","websocket.connectionID")(n$=class extends JN{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===DP.CONNECTED?this.emit(LP.WS_CONNECTED):e===DP.RECONNECTING?this.emit(LP.WS_RECONNECTING,this._websocketReconnectReason):e===DP.CLOSED&&this.emit(LP.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),iw(this,"_disconnectedReason",void 0),iw(this,"_websocketReconnectReason",void 0),iw(this,"_connectionState",DP.CLOSED),iw(this,"reconnectToken",void 0),iw(this,"websocket",void 0),iw(this,"openConnectionTime",void 0),iw(this,"clientId",void 0),iw(this,"lastMsgTime",Date.now()),iw(this,"uploadCache",[]),iw(this,"uploadCacheInterval",void 0),iw(this,"rttRolling",new t$(5)),iw(this,"pingpongTimer",void 0),iw(this,"wsInflateDataTimer",void 0),iw(this,"pingpongTimeoutCount",0),iw(this,"joinResponse",void 0),iw(this,"multiIpOption",void 0),iw(this,"initError",void 0),iw(this,"spec",void 0),iw(this,"store",void 0),iw(this,"onWebsocketMessage",(e=>{if(e.data instanceof ArrayBuffer)return void this.emit(LP.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")&&(this.emit(t._type,t._message),t._type===xP.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===xP.ON_USER_BANNED))switch(t._message.error_code){case 14:this.close(bP.UID_BANNED);break;case 15:this.close(bP.IP_BANNED);break;case 16:this.close(bP.CHANNEL_BANNED)}})),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new e$("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,t),this.handleWebsocketEvents(),window.addEventListener("offline",(()=>{this.connectionState===DP.CONNECTED&&this.reconnect("retry",NP.OFFLINE)}))}async request(e,t,n,r){const i=Sj(6,""),o={_id:i,_type:e,_message:t},s=this.websocket.connectionID,a=()=>new xv(((t,n)=>{if(this.connectionState===DP.CONNECTED)return t();const r=()=>{this.off(LP.WS_CLOSED,i),t()},i=()=>{this.off(LP.WS_CONNECTED,r),n(new eD(ZN.WS_ABORT))};this.once(LP.WS_CONNECTED,r),this.once(LP.WS_CLOSED,i),e!==PP.PUBLISH&&e!==PP.SUBSCRIBE&&e!==PP.UNSUBSCRIBE&&e!==PP.UNPUBLISH&&e!==PP.CONTROL||this.once(LP.DISCONNECT_P2P,(()=>{n(new eD(ZN.DISCONNECT_P2P))})),e===PP.PUBLISH&&this.once(LP.ABORT_P2P_EXECUTION,(()=>{n(new eD(ZN.DISCONNECT_P2P))}))}));if(this.connectionState!==DP.CONNECTING&&this.connectionState!==DP.RECONNECTING||e===PP.JOIN||e===PP.REJOIN||await a(),this.websocket.sendMessage(o,!0),r)return;const c=new xv(((n,r)=>{let o=!1;const a=(r,i)=>{o=!0,n({isSuccess:"success"===r,message:i||{}}),this.off(LP.WS_CLOSED,c),this.off(LP.WS_RECONNECTING,c),this.emit(LP.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(i),a);const c=()=>{r(new eD(ZN.WS_ABORT,"type: ".concat(e))),this.off(LP.WS_CLOSED,c),this.off(LP.WS_RECONNECTING,c),this.off("res-@".concat(i),a)};this.once(LP.WS_CLOSED,c),this.once(LP.WS_RECONNECTING,c),vj($D("SIGNAL_REQUEST_TIMEOUT")).then((()=>{this.websocket.connectionID!==s||o||(uD.warning("ws request timeout, type: ".concat(e)),CD("warning",this,"ws request timeout, type: ".concat(e)),this.emit(LP.REQUEST_TIMEOUT,e,t))}))}));let u=null;try{u=await c}catch(r){if(this.connectionState===DP.CLOSED||e===PP.LEAVE)throw new eD(ZN.WS_ABORT);return!this.spec.forceWaitGatewayResponse||n?r.throw():e===PP.JOIN||e===PP.REJOIN?null:(await a(),await this.request(e,t))}if(u.isSuccess)return u.message;const l=Number(u.message.error_code||u.message.code),d=FK(l),h=new eD(ZN.UNEXPECTED_RESPONSE,"".concat(d.desc,": ").concat(u.message.error_str),{code:l,data:u.message});return"success"===d.action?u.message:(uD.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(l,", message: ").concat(d.desc,", action: ").concat(d.action)),CD("warning",this,"unexpected response from type ".concat(e,", error_code: ").concat(l,", message: ").concat(d.desc,", action: ").concat(d.action)),l===CP.ERR_TOO_MANY_BROADCASTERS?e===PP.JOIN||e===PP.REJOIN?(this.initError=h,this.close(),h.throw()):h.throw():"failed"===d.action?h.throw():"quit"===d.action?(this.initError=h,this.close(),h.throw()):(l===CP.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=u.message.option,uD.warning("[".concat(this.clientId,"] detect multi ip, recover")),CD("warning",this,"detect multi ip, recover"),this.reconnect("recover",NP.MULTI_IP)):this.reconnect(d.action,NP.SERVER_ERROR),e===PP.JOIN||e===PP.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new xv((n=>{const r=i=>{(!t||t(i))&&(this.off(e,r),n(i))};this.on(e,r)}))}upload(e,t){const n={_type:e,_message:t};try{this.websocket.sendMessage(n)}catch(e){const t=$D("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(n),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval((()=>{if(this.connectionState!==DP.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)}),$D("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const n={_type:e,_message:t};this.websocket.sendMessage(n)}init(e,t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new xv(((n,r)=>{this.once(LP.WS_CONNECTED,(()=>n(this.joinResponse))),this.once(LP.WS_CLOSED,(()=>r(this.initError||new eD(ZN.WS_ABORT)))),this.connectionState=DP.CONNECTING,this.websocket.init(e).catch(r),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval((()=>{this.handleWsInflateData()}),2e4),setTimeout((()=>{t&&void 0===this.openConnectionTime&&(uD.debug("[".concat(this.clientId,"] init websocket timeout while join with fallback to proxy")),r(new eD(ZN.INIT_WEBSOCKET_TIMEOUT)))}),$D("JOIN_WITH_FALLBACK_PROXY_PENDING_DURATION"))}))}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||bP.LEAVE,this.connectionState=DP.CLOSED,uD.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),e===bP.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new e$("gateway-".concat(this.clientId),this.spec.retryConfig,!0,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(LP.ABORT_P2P_EXECUTION);const e=await Nj(this,LP.REQUEST_JOIN_INFO),t=await this.request(PP.JOIN,e);if(!t)return this.emit(LP.REPORT_JOIN_GATEWAY,ZN.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(LP.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=DP.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new eD(ZN.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=Pj(this,LP.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const t=await this.request(PP.REJOIN,e);return!!t&&(this.connectionState=DP.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),t.peers&&t.peers.forEach((e=>{this.emit(xP.ON_USER_ONLINE,{uid:e.uid}),e.audio&&this.emit(xP.ON_ADD_AUDIO_STREAM,{uid:e.uid,uint_id:e.uint_id,audio:!0,ssrcId:e.audio_ssrc}),e.video&&this.emit(xP.ON_ADD_VIDEO_STREAM,{uid:e.uid,uint_id:e.uint_id,video:!0,ssrcId:e.video_ssrc}),e.audio_mute?this.emit(xP.MUTE_AUDIO,{uid:e.uid}):this.emit(xP.UNMUTE_AUDIO,{uid:e.uid}),e.video_mute?this.emit(xP.MUTE_VIDEO,{uid:e.uid}):this.emit(xP.UNMUTE_VIDEO,{uid:e.uid}),e.audio_enable_local?this.emit(xP.ENABLE_LOCAL_AUDIO,{uid:e.uid}):this.emit(xP.DISABLE_LOCAL_AUDIO,{uid:e.uid}),e.video_enable_local?this.emit(xP.ENABLE_LOCAL_VIDEO,{uid:e.uid}):this.emit(xP.DISABLE_LOCAL_VIDEO,{uid:e.uid}),e.audio||e.video||this.emit(xP.ON_REMOVE_STREAM,{uid:e.uid,uint_id:e.uint_id})})),!0)}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleNotification(e){uD.debug("[".concat(this.clientId,"] receive notification: "),e),ND("debug",this,"handleNotification",e);const t=FK(e.code);if("success"!==t.action)return"failed"===t.action?(uD.error("[".concat(this.clientId,"] ignore error: "),t.desc),void CD("error",this,"ignore error: ".concat(t.desc))):"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(bP.UID_BANNED),void this.close()):void this.reconnect(t.action,NP.SERVER_ERROR)}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=$D("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(uD.warning("PINGPONG Timeout. Last Socket Message: ".concat(t-this.lastMsgTime,"ms")),CD("warning",this,"PINGPONG Timeout. Last Socket Message: ".concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>$D("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",NP.TIMEOUT):this.request(PP.PING,void 0,!0).then((()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),$D("REPORT_STATS")&&this.send(PP.PING_BACK,{pingpongElapse:e})})).catch((e=>{}))}handleWsInflateData(){const{wsInflateLength:e,wsDeflateLength:t}=this.websocket.getWsInflateData();0!==e&&0!==t&&this.upload(kP.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:t,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on($P.RECONNECT_WAITTING_FINISH,(e=>{this.emit(LP.WS_RECONNECT_WAITTING_FINISH,e)})),this.websocket.on($P.RECONNECT_CREATE_CONNECTION,(e=>{this.emit(LP.WS_RECONNECT_CREATE_CONNECTION,e)})),this.websocket.on($P.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on($P.CLOSED,(()=>{this.connectionState=DP.CLOSED})),this.websocket.on($P.FAILED,(()=>{this._disconnectedReason=bP.NETWORK_ERROR,this.connectionState=DP.CLOSED})),this.websocket.on($P.RECONNECTING,(e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===DP.CONNECTED?this.connectionState=DP.RECONNECTING:this.connectionState=DP.CONNECTING})),this.websocket.on($P.WILL_RECONNECT,((e,t)=>{if(Pj(this,LP.IS_P2P_DISCONNECTED)&&"retry"===e)return uD.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),CD("debug",this,"".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(LP.NEED_RENEW_SESSION),this.emit(LP.DISCONNECT_P2P),t("tryNext");"retry"!==e&&(uD.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(e)),CD("debug",this,"".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0,this.emit(LP.NEED_RENEW_SESSION),this.emit(LP.DISCONNECT_P2P)),t(e)})),this.websocket.on($P.CONNECTED,(()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch((e=>{uD.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),ND("warning",this,"rejoin",void 0,e.toString()),this.reconnect("tryNext",NP.SERVER_ERROR)})):this.join().catch((e=>{if(this.emit(LP.REPORT_JOIN_GATEWAY,e.message||e.code,this.url||""),e instanceof eD&&e.code===ZN.UNEXPECTED_RESPONSE&&e.data.code===CP.ERR_NO_AUTHORIZED)return uD.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),CD("warning",this,"reconnect no authorized, recover"),void this.reconnect("recover",NP.SERVER_ERROR);uD.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),ND("error",this,"join",void 0,e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",NP.SERVER_ERROR):(this.initError=e,this.close())}))})),this.websocket.on($P.REQUEST_NEW_URLS,((e,t)=>{Nj(this,LP.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)})),this.websocket.on($P.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{this.emit(xP.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}))}})||n$;var i$;function o$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o$(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const a$=new Map;let c$=PD("AgoraRTCGateway","store.clientId")(i$=class extends JN{get state(){return this._state}set state(e){if(e===this._state)return;const t=this._state;this._state=e,"DISCONNECTED"===e&&this._disconnectedReason?this.emit(dk.CONNECTION_STATE_CHANGE,e,t,this._disconnectedReason):this.emit(dk.CONNECTION_STATE_CHANGE,e,t)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(e){uD.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),ND("debug",this,"joinGatewayStartTime",e,"[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),this._joinGatewayStartTime=e}constructor(e,t){super(),iw(this,"store",void 0),iw(this,"joinInfo",void 0),iw(this,"key",void 0),iw(this,"signal",void 0),iw(this,"role",void 0),iw(this,"inChannelInfo",{joinAt:null,duration:0}),iw(this,"spec",void 0),iw(this,"_state","DISCONNECTED"),iw(this,"_statsCollector",void 0),iw(this,"_disconnectedReason",void 0),iw(this,"isSignalRecover",!1),iw(this,"hasChangeBGPAddress",!1),iw(this,"trafficStatsInterval",void 0),iw(this,"networkQualityInterval",void 0),iw(this,"_joinGatewayStartTime",0),iw(this,"_signalTimeout",!1),iw(this,"_clientRoleOptions",void 0),iw(this,"_isProactiveJoin",!1),this.store=e,this.spec=t,this.signal=new r$(s$(s$({},t),{},{retryConfig:t.websocketRetryConfig}),e),this._statsCollector=t.statsCollector,this.role=t.role||"audience",this._clientRoleOptions=t.clientRoleOptions,this.handleSignalEvents()}async join(e,t,n){this.store.joinGatewayStart(),"disabled"!==e.cloudProxyServer&&(this.hasChangeBGPAddress=!0);const r=Date.now();let i=a$.get(e.cname);if(i||(i=new Map,a$.set(e.cname,i)),this._isProactiveJoin=!0,i.has(e.uid)){const t=new eD(ZN.UID_CONFLICT);throw mG.joinGateway(e.sid,{lts:r,succ:!1,ec:t.message,addr:null,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!e.proxyServer}),this._isProactiveJoin=!1,t}i.set(e.uid,!0),this.joinInfo=e,this.key=t;const o=e.proxyServer,s=o?e.gatewayAddrs.map((e=>{const t=e.address.split(":");return"wss://".concat(o,"/ws/?h=").concat(t[0],"&p=").concat(t[1])})):e.gatewayAddrs.map((e=>"wss://".concat(e.address)));let a=0;this.joinGatewayStartTime=r;try{a=(await this.signal.init(s,n)).uid}catch(t){if(t&&t.code===ZN.INIT_WEBSOCKET_TIMEOUT)throw uD.warning("[".concat(this.store.clientId,"] User join failed"),t.toString()),t;throw uD.error("[".concat(this.store.clientId,"] User join failed"),t.toString()),ND("error",this,"join",void 0,t.toString()),mG.joinGateway(e.sid,{lts:r,succ:!1,ec:t.message,addr:this.signal.url,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!o}),this._isProactiveJoin=!1,i.delete(e.uid),this.signal.close(),t}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),uD.debug("[".concat(this.store.clientId,"] Connected to gateway server")),ND("debug",this,"join",void 0,"success"),this.trafficStatsInterval=window.setInterval((()=>{this.updateTrafficStats().catch((e=>{uD.warning("[".concat(this.store.clientId,"] get traffic stats error"),e.toString()),ND("warning",this,"trafficStatsInterval",void 0,e.toString())}))}),3e3),this.networkQualityInterval=window.setInterval((()=>{navigator&&void 0!==navigator.onLine&&!navigator.onLine?this.emit(dk.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(dk.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):"CONNECTED"===this.state&&this._statsCollector.trafficStats?this.emit(dk.NETWORK_QUALITY,{uplinkNetworkQuality:Aj(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:Aj(this._statsCollector.trafficStats.B_dnq)}):this.emit(dk.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})}),2e3),this.store.joinGatewayEnd(),a}async leave(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if("DISCONNECTED"!==this.state){t!==bP.FALLBACK&&(this.state="DISCONNECTING");try{e||this.signal.connectionState!==DP.CONNECTED||await function(e,t){return xv.race([e,yj(3e3)])}(this.signal.request(PP.LEAVE,void 0,!0))}catch(e){uD.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),e),CD("warning",this,"leave request failed, ignore, ".concat(e.toString()))}this.signal.close(t),t!==bP.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new eD(ZN.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const r={state:"offer",p2p_id:this.store.p2pId,ortc:t,mode:this.spec.mode,extend:$D("PUB_EXTEND")};try{return(await this.signal.request(PP.PUBLISH,r,!0))._message}catch(r){if(n&&r.data&&r.data.code===CP.ERR_PUBLISH_REQUEST_INVALID)return uD.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),r.toString()),CD("warning",this,"receive publish error code, retry, ".concat(r.toString())),await this.tryUnpubBeforeRepub(e,t),this.publish(e,t,!1);throw r}}async unpublish(e,t){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new eD(ZN.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(PP.UNPUBLISH,{stream_id:t,ortc:e},!0)}catch(e){uD.warning("unpublish warning: ",e),ND("warning",this,"unpublish",void 0,e.toString())}}async subscribe(e,t,n){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new eD(ZN.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const r={stream_id:e,stream_type:t.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,tcc:!!$D("SUBSCRIBE_TCC"),extend:$D("SUB_EXTEND"),ssrcId:t.ssrcId};try{return(await this.signal.request(PP.SUBSCRIBE,r,!0))._message}catch(r){if(n&&r.data&&r.data.code===CP.ERR_SUBSCRIBE_REQUEST_INVALID)return uD.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),r.toString()),CD("warning",this,"receiver subscribe error code, retry"),await this.tryUnsubBeforeResub(e,t),await this.subscribe(e,t,!1);throw r}}async subscribeAll(e,t){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new eD(ZN.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const n={p2p_id:this.store.p2pId,users:e,dtx:!1};try{return await this.signal.request(PP.SUBSCRIBE_STREAMS,n,!0)}catch(n){if(t&&n.data&&n.data.code===CP.ERR_SUBSCRIBE_REQUEST_INVALID)return uD.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),n.toString()),CD("warning",this,"receiver massSubscribe error code, retry"),await this.tryMassUnsubBeforeResub(e),await this.subscribeAll(e,!1);throw n}}async setVideoProfile(e){const t=function(e){if(!(e.bitrateMax&&e.bitrateMin&&e.frameRate&&e.height&&e.width))return;let t=e.frameRate,n=e.width,r=e.height,i=!0;return"number"!=typeof t&&(t=t.exact||t.ideal||t.max||t.min||0,t||(i=!1)),"number"!=typeof n&&(n=n.exact||n.ideal||n.max||n.min||0,n||(i=!1)),"number"!=typeof r&&(r=r.exact||r.ideal||r.max||r.min||0,t||(i=!1)),i?{stream_type:0,width:n,height:r,fps:t,start_bps:1e3*e.bitrateMax,min_bps:1e3*e.bitrateMin,target_bps:1e3*e.bitrateMax}:void 0}(e);return t?this.signal.request(PP.SET_VIDEO_PROFILE,t):(uD.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway")),void CD("debug",this,"encoder config is not complete, do not report to gateway"))}async unsubscribe(e,t){try{await this.signal.request(PP.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:e,stream_id:t},!0)}catch(e){uD.warning("unsubscribe warning: ",e),ND("warning",this,"unsubscribe",void 0,e.toString())}}async massUnsubscribe(e){try{await this.signal.request(PP.UNSUBSCRIBE_STREAMS,e,!0)}catch(e){uD.warning("unsubscribeAll warning: ",e),ND("warning",this,"unsubscribeAll",void 0,e.toString())}}async reconnectPC(e){const{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}=e;return{gatewayEstablishParams:await this.signal.request(PP.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(PP.GATEWAY_INFO)}renewToken(e){return this.signal.request(PP.RENEW_TOKEN,e)}async setClientRole(e,t){if(t&&(this._clientRoleOptions=Object.assign({},t)),"CONNECTED"!==this.state)return void(this.role=e);let n;n="audience"===e?this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:0,await this.signal.request(PP.SET_CLIENT_ROLE,{role:e,level:n,client_ts:Date.now()}),this.role=e}async setRemoteVideoStreamType(e,t){await this.signal.request(PP.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:t})}async setDefaultRemoteVideoStreamType(e){await this.signal.request(PP.DEFAULT_VIDEO_STREAM,{stream_type:e})}async setStreamFallbackOption(e,t){await this.signal.request(PP.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:t})}async pickSVCLayer(e,t){await this.signal.request(PP.PICK_SVC_LAYER,{stream_id:e,spatial_layer:t.spatialLayer,temporal_layer:t.temporalLayer})}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),s$({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(PP.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const e=a$.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const e=function(e){const t=e.match(/(wss\:\/\/)?([^:]+):(\d+)/);return t?{username:BD.username,password:BD.password,turnServerURL:t[2],tcpport:parseInt(t[3])+30,udpport:parseInt(t[3])+30,forceturn:!1}:null}(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],e&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&this.joinInfo.turnServer.serversFromGateway.push(s$(s$({},BD),{},{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if("CONNECTED"!==this.state)return;const e=await this.signal.request(PP.TRAFFIC_STATS,void 0,!0);e.timestamp=Date.now(),e.peer_delay.forEach((e=>{const t=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find((t=>t.peer_uid===e.peer_uid));t&&t.B_st!==e.B_st&&Mj((()=>{this.emit(dk.STREAM_TYPE_CHANGE,e.peer_uid,e.B_st)}))})),this._statsCollector.updateTrafficStats(e)}getJoinMessage(e){if(!this.joinInfo||!this.key)throw new eD(ZN.UNEXPECTED_ERROR,"can not generate join message, no join info");const t=Object.assign({},this.joinInfo.apResponse);let n=$D("REPORT_APP_SCENARIO");if("string"!=typeof n)try{n=JSON.stringify(n)}catch(e){n=void 0}n&&n.length>128&&(n=void 0);const r=s$({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:MD,browser:navigator.userAgent,process_id:$D("PROCESS_ID"),mode:this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:t,extend:$D("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:"proxy3"===this.joinInfo.cloudProxyServer?"1":"proxy5"===this.joinInfo.cloudProxyServer?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:n,attributes:{userAttributes:{enablePublishedUserList:$D("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:$D("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:"number"==typeof $D("SUBSCRIBE_AUDIO_FILTER_TOPN")?$D("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:"boolean"==typeof $D("ENABLE_PUBLISH_AUDIO_FILTER")?$D("ENABLE_PUBLISH_AUDIO_FILTER"):void 0}},join_ts:this.joinGatewayStartTime},e);return this.joinInfo.stringUid&&(r.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(r.aes_mode=this.joinInfo.aesmode,$D("ENCRYPT_AES")?(r.aes_secret=this.joinInfo.aespassword,r.aes_encrypt=!0):r.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(r.aes_salt=this.joinInfo.aessalt)),t.addresses[this.signal.websocket.currentURLIndex]&&(r.ap_response.ticket=t.addresses[this.signal.websocket.currentURLIndex].ticket,delete t.addresses),void 0!==this.joinInfo.defaultVideoStream&&(r.default_video_stream=this.joinInfo.defaultVideoStream),r}getRejoinMessage(){if(!this.joinInfo)throw new eD(ZN.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(LP.WS_RECONNECT_WAITTING_FINISH,(e=>{["tryNext","recover"].includes(e)&&this.joinInfo&&mG.adjustSessionStartTime(this.joinInfo.sid)})),this.signal.on(LP.WS_RECONNECT_CREATE_CONNECTION,(e=>{this.joinGatewayStartTime=Date.now()})),this.signal.on(LP.WS_RECONNECTING,(e=>{this.joinInfo&&mG.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||NP.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",mG.sessionInit(this.joinInfo.sid,{lts:(new Date).getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())})),this.signal.on(LP.WS_CLOSED,(e=>{let t;switch(e){case bP.LEAVE:t=NP.LEAVE;break;case bP.UID_BANNED:case bP.IP_BANNED:case bP.CHANNEL_BANNED:case bP.SERVER_ERROR:t=NP.SERVER_ERROR;break;case bP.FALLBACK:t=NP.FALLBACK;break;default:t=NP.NETWORK_ERROR}uD.debug("[signal] websocket closed, reason: ".concat(t||"undefined -> "+NP.NETWORK_ERROR)),OD("debug",this,"ws_closed","reason: ".concat(e)),this.joinInfo&&mG.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:e===bP.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t}),this._disconnectedReason=e,e!==bP.FALLBACK&&(this.state="DISCONNECTED"),this.reset()})),this.signal.on(LP.WS_CONNECTED,(()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&("audience"===this.role&&this._clientRoleOptions&&this._clientRoleOptions.level&&(uD.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),CD("debug",this,"patch to send set client role, role: ".concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions&&this._clientRoleOptions.level)),this.setClientRole(this.role,this._clientRoleOptions)),mG.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint)){const e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!e)return uD.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(e)),void CD("error",this,"set local access point after joined failed: ".concat(e));KD("EVENT_REPORT_DOMAIN",e[1]),KD("EVENT_REPORT_BACKUP_DOMAIN",e[1]),KD("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}})),this.signal.on(xP.ON_UPLINK_STATS,(e=>{this._statsCollector.updateUplinkStats(e)})),this.signal.on(LP.REQUEST_RECOVER,((e,t,n)=>{if(!this.joinInfo)return n(new eD(ZN.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,Nj(this,dk.REQUEST_NEW_GATEWAY_LIST).then(t).catch(n)})),this.signal.on(LP.REQUEST_JOIN_INFO,(async e=>{var t;this.updateTurnConfigFromSignal();const{iceParameters:n,dtlsParameters:r,rtpCapabilities:i}=await Nj(this,dk.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:null===(t=this.joinInfo)||void 0===t?void 0:t.turnServer});e(this.getJoinMessage({ortc:{iceParameters:n,dtlsParameters:r,rtpCapabilities:i,version:"2"}}))})),this.signal.on(LP.REQUEST_REJOIN_INFO,(e=>{e(this.getRejoinMessage())})),this.signal.on(LP.REPORT_JOIN_GATEWAY,((e,t)=>{this.joinInfo&&(mG.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:e,addr:t,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer}),this._isProactiveJoin=!1)})),this.signal.on(LP.IS_P2P_DISCONNECTED,(e=>{e(Pj(this,dk.IS_P2P_DISCONNECTED))})),this.signal.on(LP.DISCONNECT_P2P,(()=>{this.emit(dk.DISCONNECT_P2P)})),this.signal.on(LP.NEED_RENEW_SESSION,(()=>{this.emit(dk.NEED_RENEW_SESSION)})),this.signal.on(LP.REQUEST_SUCCESS,(()=>{this._signalTimeout=!1})),this.signal.on(LP.REQUEST_TIMEOUT,(()=>{this._signalTimeout=!0})),this.signal.on(LP.JOIN_RESPONSE,(e=>{const t=this.getCurrentGatewayAddress();this.emit(dk.JOIN_RESPONSE,e,t)}))}async tryUnsubBeforeResub(e,t){try{await this.signal.request(PP.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:e,ortc:[t]},!0)}catch(t){throw uD.warning("unsubscribe warning",t),ND("warning",this,"tryUnsubBeforeResub",e,t.toString()),t}}async tryUnpubBeforeRepub(e,t){try{await this.signal.request(PP.UNPUBLISH,{stream_id:e,ortc:t},!0)}catch(t){throw uD.warning("unpublish warning: ",t),ND("warning",this,"tryUnpubBeforeRepub",e,t.toString()),t}}async tryMassUnsubBeforeResub(e){const t={users:e.map((e=>({stream_id:e.stream_id,stream_type:e.stream_type})))};try{await this.signal.request(PP.UNSUBSCRIBE_STREAMS,t,!0)}catch(t){throw uD.warning("massUnsubscribe warning",t),ND("warning",this,"tryUnsubAllBeforeResub",e.map((e=>e.stream_id)),t.toString()),t}}async muteLocal(e,t){const n={action:e.find((e=>e.stream_type===lk.Audio))?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(PP.CONTROL,n,!0,!0)}catch(e){throw uD.warning("gateway unmuteLocal warning: ",e),ND("warning",this,"muteLocal",t,e.toString()),e}}async unmuteLocal(e,t){const n={action:e.find((e=>e.stream_type===lk.Audio))?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(PP.CONTROL,n,!0,!0)}catch(e){throw uD.warning("gateway muteLocal warning: ",e),ND("warning",this,"unmuteLocal",t,e.toString()),e}}uploadStats(e,t){this.signal.upload(e,t)}getSignalRTT(){return this.signal.rtt}async restartICE(e){const t={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:e};try{return{restartICEResponse:await this.signal.request(PP.RESTART_ICE,t,!0),gatewayAddress:this.getCurrentGatewayAddress()}}catch(e){throw uD.warning("P2PChannel.restartICE warning: ",e),ND("warning",this,"restartICE",void 0,e.toString()),e}}reconnect(){"CONNECTED"===this.state&&this.signal.reconnect(void 0,NP.P2P_FAILED)}getCurrentGatewayAddress(){var e;if(!$D("GATEWAY_WSS_ADDRESS"))return null!==(e=this.joinInfo)&&void 0!==e&&e.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(e){await this.signal.request(PP.SET_PARAMETER,{enablePublishAudioFilter:e})}})||i$;function u$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u$(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(){var t;function n(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var r,i="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e},o=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof e&&e];for(var n=0;n<t.length;++n){var r=t[n];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function s(e,t){if(t)e:{var n=o;e=e.split(".");for(var r=0;r<e.length-1;r++){var s=e[r];if(!(s in n))break e;n=n[s]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&i(n,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function c(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:n(e)}}if(s("Symbol",(function(e){function t(e,t){this.A=e,i(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.A};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(i){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(i||"")+"_"+r++,i)}})),s("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<t.length;r++){var s=o[t[r]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&i(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(n(this))}})}return e})),"function"==typeof Object.setPrototypeOf)r=Object.setPrototypeOf;else{var u;e:{var l={};try{l.__proto__={a:!0},u=l.a;break e}catch(e){}u=!1}r=u?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var d=r;function h(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function p(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function f(e,t){return e.h=3,{value:t}}function A(e){this.g=new h,this.G=e}function E(e,t,n,r){try{var i=t.call(e.g.j,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.g.m=!1,i;var o=i.value}catch(t){return e.g.j=null,e.g.s(t),g(e)}return e.g.j=null,r.call(e.g,o),g(e)}function g(e){for(;e.g.h;)try{var t=e.G(e.g);if(t)return e.g.m=!1,{value:t.value,done:!1}}catch(t){e.g.v=void 0,e.g.s(t)}if(e.g.m=!1,e.g.l){if(t=e.g.l,e.g.l=null,t.F)throw t.D;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return e.o(t)},this.throw=function(t){return e.s(t)},this.return=function(t){return function(e,t){p(e.g);var n=e.g.j;return n?E(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),g(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function m(e,t){return t=new _(new A(t)),d&&e.prototype&&d(t,e.prototype),t}if(h.prototype.o=function(e){this.v=e},h.prototype.s=function(e){this.l={D:e,F:!0},this.h=this.C||this.u},h.prototype.return=function(e){this.l={return:e},this.h=this.u},A.prototype.o=function(e){return p(this.g),this.g.j?E(this,this.g.j.next,e,this.g.o):(this.g.o(e),g(this))},A.prototype.s=function(e){return p(this.g),this.g.j?E(this,this.g.j.throw,e,this.g.o):(this.g.s(e),g(this))},s("Array.prototype.entries",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return[e,t]}))}})),"undefined"!=typeof Blob&&("undefined"==typeof FormData||!FormData.prototype.keys)){var I=function(e,t){for(var n=0;n<e.length;n++)t(e[n])},T=function(e){return e.replace(/\r?\n|\r/g,"\r\n")},R=function(e,t,n){return t instanceof Blob?(n=void 0!==n?String(n+""):"string"==typeof t.name?t.name:"blob",t.name===n&&"[object Blob]"!==Object.prototype.toString.call(t)||(t=new File([t],n)),[String(e),t]):[String(e),String(t)]},v=function(e,t){if(e.length<t)throw new TypeError(t+" argument required, but only "+e.length+" present.")},y="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,S=y.FormData,C=y.XMLHttpRequest&&y.XMLHttpRequest.prototype.send,O=y.Request&&y.fetch,b=y.navigator&&y.navigator.sendBeacon,w=y.Element&&y.Element.prototype,N=y.Symbol&&Symbol.toStringTag;N&&(Blob.prototype[N]||(Blob.prototype[N]="Blob"),"File"in y&&!File.prototype[N]&&(File.prototype[N]="File"));try{new File([],"")}catch(e){y.File=function(e,t,n){return e=new Blob(e,n||{}),Object.defineProperties(e,{name:{value:t},lastModified:{value:+(n&&void 0!==n.lastModified?new Date(n.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),N&&Object.defineProperty(e,N,{value:"File"}),e}}var D=function(e){return e.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},L=function(e){this.i=[];var t=this;e&&I(e.elements,(function(e){if(e.name&&!e.disabled&&"submit"!==e.type&&"button"!==e.type&&!e.matches("form fieldset[disabled] *"))if("file"===e.type){var n=e.files&&e.files.length?e.files:[new File([],"",{type:"application/octet-stream"})];I(n,(function(n){t.append(e.name,n)}))}else"select-multiple"===e.type||"select-one"===e.type?I(e.options,(function(n){!n.disabled&&n.selected&&t.append(e.name,n.value)})):"checkbox"===e.type||"radio"===e.type?e.checked&&t.append(e.name,e.value):(n="textarea"===e.type?T(e.value):e.value,t.append(e.name,n))}))};if((t=L.prototype).append=function(e,t,n){v(arguments,2),this.i.push(R(e,t,n))},t.delete=function(e){v(arguments,1);var t=[];e=String(e),I(this.i,(function(n){n[0]!==e&&t.push(n)})),this.i=t},t.entries=function e(){var t,n=this;return m(e,(function(e){if(1==e.h&&(t=0),3!=e.h)return t<n.i.length?e=f(e,n.i[t]):(e.h=0,e=void 0),e;t++,e.h=2}))},t.forEach=function(e,t){v(arguments,1);for(var n=c(this),r=n.next();!r.done;r=n.next()){var i=c(r.value);r=i.next().value,i=i.next().value,e.call(t,i,r,this)}},t.get=function(e){v(arguments,1);var t=this.i;e=String(e);for(var n=0;n<t.length;n++)if(t[n][0]===e)return t[n][1];return null},t.getAll=function(e){v(arguments,1);var t=[];return e=String(e),I(this.i,(function(n){n[0]===e&&t.push(n[1])})),t},t.has=function(e){v(arguments,1),e=String(e);for(var t=0;t<this.i.length;t++)if(this.i[t][0]===e)return!0;return!1},t.keys=function e(){var t,n,r=this;return m(e,(function(e){if(1==e.h&&(t=c(r),n=t.next()),3!=e.h)return n.done?void(e.h=0):f(e,c(n.value).next().value);n=t.next(),e.h=2}))},t.set=function(e,t,n){v(arguments,2),e=String(e);var r=[],i=R(e,t,n),o=!0;I(this.i,(function(t){t[0]===e?o&&(o=!r.push(i)):r.push(t)})),o&&r.push(i),this.i=r},t.values=function e(){var t,n,r,i,o=this;return m(e,(function(e){if(1==e.h&&(t=c(o),n=t.next()),3!=e.h)return n.done?void(e.h=0):(r=n.value,(i=c(r)).next(),f(e,i.next().value));n=t.next(),e.h=2}))},L.prototype._asNative=function(){for(var e=new S,t=c(this),n=t.next();!n.done;n=t.next()){var r=c(n.value);n=r.next().value,r=r.next().value,e.append(n,r)}return e},L.prototype._blob=function(){var e="----formdata-polyfill-"+Math.random(),t=[],n="--"+e+'\r\nContent-Disposition: form-data; name="';return this.forEach((function(e,r){return"string"==typeof e?t.push(n+D(T(r))+'"\r\n\r\n'+T(e)+"\r\n"):t.push(n+D(T(r))+'"; filename="'+D(e.name)+'"\r\nContent-Type: '+(e.type||"application/octet-stream")+"\r\n\r\n",e,"\r\n")})),t.push("--"+e+"--"),new Blob(t,{type:"multipart/form-data; boundary="+e})},L.prototype[Symbol.iterator]=function(){return this.entries()},L.prototype.toString=function(){return"[object FormData]"},w&&!w.matches&&(w.matches=w.matchesSelector||w.mozMatchesSelector||w.msMatchesSelector||w.oMatchesSelector||w.webkitMatchesSelector||function(e){for(var t=(e=(this.document||this.ownerDocument).querySelectorAll(e)).length;0<=--t&&e.item(t)!==this;);return-1<t}),N&&(L.prototype[N]="FormData"),C){var P=y.XMLHttpRequest.prototype.setRequestHeader;y.XMLHttpRequest.prototype.setRequestHeader=function(e,t){P.call(this,e,t),"content-type"===e.toLowerCase()&&(this.B=!0)},y.XMLHttpRequest.prototype.send=function(e){e instanceof L?(e=e._blob(),this.B||this.setRequestHeader("Content-Type",e.type),C.call(this,e)):C.call(this,e)}}O&&(y.fetch=function(e,t){return t&&t.body&&t.body instanceof L&&(t.body=t.body._blob()),O.call(this,e,t)}),b&&(y.navigator.sendBeacon=function(e,t){return t instanceof L&&(t=t._asNative()),b.call(this,e,t)}),y.FormData=L}}();let d$=1;let h$=1;function p$(e,t,n,r){let{url:i,areaCode:o}=e;ND("debug",["AjaxAPI",t.clientId],"requestChooseServer",{url:i,areaCode:o});const s=Date.now();let a;const[c,u]=g$(t,o,[BF.CHOOSE_SERVER]);let l=aG.networkState;return rD((async()=>{l&&aG.networkState===Dk.OFFLINE&&aG.onlineWaiter&&await xv.race([aG.onlineWaiter,vj(r&&r.maxRetryTimeout||tD.maxRetryTimeout)]),l=aG.networkState;const{data:e,headers:o}=await oG(i,{data:c,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);a="1"===o.http3?1:-1,mG.reportResourceTiming(i,t.sid),A$(e,i,t,s,[BF.CHOOSE_SERVER],a);const u=Ej(e,BF.CHOOSE_SERVER);return E$(u),dj(u,i)}),(e=>(e&&mG.joinChooseServer(t.sid,{lts:s,succ:!0,csAddr:i,opid:u,serverList:e.gatewayAddrs.map((e=>e.address)),ec:null,cid:e.cid.toString(),uid:e.uid.toString(),csIp:e.csIp,unilbsServerIds:[BF.CHOOSE_SERVER].toString(),isHttp3:a}),!1)),(e=>e.code!==ZN.OPERATION_ABORTED&&(e.code===ZN.CAN_NOT_GET_GATEWAY_SERVER?e.data.retry:(mG.joinChooseServer(t.sid,{lts:s,succ:!1,csAddr:i,serverList:null,opid:u,ec:e.code,csIp:e.data&&e.data.csIp,unilbsServerIds:[BF.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:l}),isHttp3:a}),uD.warning("[".concat(t.clientId,"] Choose server network error, retry"),e),CD("warning",["AjaxAPI",t.clientId],"Choose server network error, retry, ".concat(e)),!0))),r)}function f$(e,t,n,r){let i,{url:o,areaCode:s,serviceIds:a}=e;ND("debug",["AjaxAPI",t.clientId],"requestMultiUnilbs",{url:o,areaCode:s,serviceIds:a});const c=Date.now(),[u,l]=g$(t,s,a);let d;return rD((async()=>{d&&aG.networkState===Dk.OFFLINE&&aG.onlineWaiter&&await xv.race([aG.onlineWaiter,vj(r&&r.maxRetryTimeout||tD.maxRetryTimeout)]),d=aG.networkState;const{data:e,headers:s}=await oG(o,{data:u,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);i="1"===s.http3?1:-1,mG.reportResourceTiming(o,t.sid),A$(e,o,t,c,a,i);const l=Ej(e,BF.CHOOSE_SERVER),h=Ej(e,"proxy5"===t.cloudProxyServer?BF.CLOUD_PROXY_5:"proxy3"===t.cloudProxyServer||"proxy4"===t.cloudProxyServer?BF.CLOUD_PROXY:BF.CLOUD_PROXY_FALLBACK);return E$(l),{gatewayInfo:dj(l,o),proxyInfo:h,url:o}}),(e=>(e.gatewayInfo&&mG.joinChooseServer(t.sid,{lts:c,succ:!0,csAddr:o,serverList:e.gatewayInfo.gatewayAddrs.map((e=>e.address)),ec:null,opid:l,cid:e.gatewayInfo.cid.toString(),uid:e.gatewayInfo.uid.toString(),csIp:e.gatewayInfo.csIp,unilbsServerIds:a.toString(),isHttp3:i}),e.proxyInfo&&mG.joinWebProxyAP(t.sid,{lts:c,sucess:1,apServerAddr:o,turnServerAddrList:e.proxyInfo.addresses.map((e=>e.ip)).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:a.toString()}),!1)),(e=>e.code!==ZN.OPERATION_ABORTED&&(e.code===ZN.CAN_NOT_GET_GATEWAY_SERVER?e.data.retry:(mG.joinWebProxyAP(t.sid,{lts:c,sucess:0,apServerAddr:o,turnServerAddrList:null,errorCode:e.code,eventType:t.cloudProxyServer,unilbsServerIds:a.toString(),extend:JSON.stringify({networkState:d})}),uD.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),e),CD("warning",["AjaxAPI",t.clientId],"multi unilbs network error, retry, ".concat(e)),!0))),r)}const A$=(e,t,n,r,i,o)=>{const s=[],a=s=>{4096===s.flag?mG.joinChooseServer(n.sid,{lts:r,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:s.error.message,csIp:s.error.data&&s.error.data.csIp,unilbsServerIds:i.toString(),isHttp3:o}):1048576!==s.flag&&4194304!==s.flag&&4194310!==s.flag||mG.joinWebProxyAP(n.sid,{lts:r,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:s.error.code,eventType:n.cloudProxyServer,unilbsServerIds:i.toString()})};if(e.response_body.forEach((t=>{const n=t.buffer.code;if(23===t.uri&&0===n&&!t.buffer.edges_services)if(4194310===t.buffer.flag)uD.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),t.buffer.edges_services=[];else{const n={error:new eD(ZN.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:t.buffer.flag};s.push(n),a(n)}if(0!==n){const r=UK(n),i={error:new eD(ZN.CAN_NOT_GET_GATEWAY_SERVER,r.desc,{desc:r.desc,retry:r.retry,csIp:e.detail[502]}),flag:t.buffer.flag};4194310===t.buffer.flag?uD.warning(i.error.toString()):s.push(i),a(i)}})),s.length)throw uD.warning("[".concat(n.clientId,"] multi unilbs ").concat(t," failed, ").concat(s.map((e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message,", retry: ").concat(e.error.data.retry))).join(" | "))),ND("warning",["AjaxAPI",n.clientId],"checkMultiUnilbsResponseValid",{url:t},s.map((e=>({flag:e.flag,message:e.error.message,retry:e.error.data.retry})))),new eD(ZN.CAN_NOT_GET_GATEWAY_SERVER,s.map((e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message))).join(" | "),{retry:!!s.find((e=>e.error.data.retry)),csIp:e.detail[502],desc:[...new Set(s.map((e=>{var t,n;return null==e||null===(t=e.error)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.desc})).filter((e=>!!e)))]})},E$=e=>{if(e.addresses&&0===e.addresses.length&&0===e.code)throw new eD(ZN.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if($D("GATEWAY_ADDRESS")&&$D("GATEWAY_ADDRESS").length>0){uD.debug("assign gateway address to",$D("GATEWAY_ADDRESS")),CD("debug",["AjaxAPI"],"assign gateway address to ".concat(JSON.stringify($D("GATEWAY_ADDRESS"))));const t=$D("GATEWAY_ADDRESS").map((t=>({ip:t.ip,port:t.port,ticket:e.addresses[0]&&e.addresses[0].ticket})));e.addresses=t}},g$=(e,t,n)=>{const r=Math.floor(Math.random()*10**12),i={appid:e.appId,client_ts:Date.now(),opid:r,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:{6:e.stringUid,11:t,12:$D("USE_NEW_TOKEN")?"1":void 0},key:e.token,service_ids:n,uid:e.uid||0}}]};i.request_bodies.forEach((t=>{e.multiIP&&e.multiIP.gateway_ip&&(t.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))}));const o=new FormData;return o.append("request",JSON.stringify(i)),[o,r]};let _$=0;const m$=()=>{const e=$D("AREAS");return 0===e.length&&e.push(mk.GLOBAL),lh(e).call(e,((e,t,n)=>{const r=I$(t);return r?0===n?r:"".concat(e,",").concat(r):e}),"")},I$=e=>e===mk.OVERSEA?"".concat(vk.ASIA,",").concat(vk.EUROPE,",").concat(vk.AFRICA,",").concat(vk.NORTH_AMERICA,",").concat(vk.SOUTH_AMERICA,",").concat(vk.OCEANIA):vk[e],T$={GLOBAL:{ASIA:[mk.CHINA,mk.JAPAN,mk.INDIA,mk.KOREA,mk.HKMC],EUROPE:[],NORTH_AMERICA:[mk.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},R$=Object.keys(T$[mk.GLOBAL]),v$=[mk.CHINA,mk.NORTH_AMERICA,mk.EUROPE,mk.ASIA,mk.JAPAN,mk.INDIA,mk.OCEANIA,mk.SOUTH_AMERICA,mk.AFRICA,mk.KOREA,mk.HKMC,mk.US];async function y$(e,t,n,r){const i=async function(e,t,n,r){let i=null;const o=[],s=async()=>{const i=$D("WEBCS_DOMAIN").slice(0,$D("AJAX_REQUEST_CONCURRENT")).map((t=>({url:e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:m$()}))),s=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:i.map((e=>e.url))}),a=await Hj({fragementLength:$D("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:r=>(uD.debug("[".concat(e.clientId,"] Connect to choose_server:"),r.url),p$(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},s),e[0]},promisesCollector:o});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},s),a},a=async()=>{if(await vj(1e3),null!==i)return i;const s=$D("WEBCS_DOMAIN_BACKUP_LIST").map((t=>({url:e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:m$()}))),a=r.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:s.map((e=>e.url))}),c=await Hj({fragementLength:$D("FRAGEMENT_LENGTH"),referenceList:s,asyncMapHandler:r=>(uD.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),r.url),p$(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},a),e[0]},promisesCollector:o});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},a),c};try{return i=await wj([s(),a()]),o.length&&o.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),i}catch(e){throw e[0]}}(e,t,n,r);return{gatewayInfo:await i}}async function S$(e,t,n,r,i){const o=e.cloudProxyServer;if("disabled"===o){if(!r)return;if(e.useLocalAccessPoint)return await y$(e,t,n,i);if($D("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:r,proxyInfo:o}=await b$(e,t,n,i);return e.turnServer&&"auto"!==e.turnServer.mode?(CD("debug",["Server",e.clientId],"do not set fallback turn because of already having turnserver"),{gatewayInfo:r}):(e.turnServer={mode:"manual",servers:o.map((e=>({turnServerURL:e.address,tcpport:e.tcpport||BD.tcpport,udpport:e.udpport||BD.udpport,username:e.username||BD.username,password:e.password||BD.password,forceturn:$D("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE"),security:!0})))},{gatewayInfo:r})}return await y$(e,t,n,i)}let s;if(["443only","normal"].includes(o)){let a;r?"normal"!==o?[a,s]=await xv.all([O$(e,t,n),y$(e,t,n,i)]):(a=await O$(e,t,n),e.proxyServer=a.addresses[0],mG.setProxyServer(e.proxyServer),uD.setProxyServer(e.proxyServer),SD(e.proxyServer),s=await y$(e,t,n,i)):(s=void 0,"normal"!==o?a=await O$(e,t,n):(a=await O$(e,t,n),e.proxyServer=a.addresses[0],mG.setProxyServer(e.proxyServer),uD.setProxyServer(e.proxyServer),SD(e.proxyServer))),e.turnServer={mode:"manual",servers:a.addresses.map((e=>({turnServerURL:e,tcpport:a.serverResponse.tcpport?a.serverResponse.tcpport:BD.tcpport,udpport:a.serverResponse.udpport?a.serverResponse.udpport:BD.udpport,username:a.serverResponse.username||BD.username,password:a.serverResponse.password||BD.password,forceturn:!0,security:!1})))}}else{const{proxyInfo:r,gatewayInfo:a}=await b$(e,t,n,i);s={gatewayInfo:a},e.turnServer={mode:"manual",servers:r.map((e=>({turnServerURL:e.address,tcpport:"proxy3"===o?void 0:e.tcpport?e.tcpport:BD.tcpport,udpport:"proxy4"===o?void 0:e.udpport?e.udpport:BD.udpport,username:e.username||BD.username,password:e.password||BD.password,forceturn:"proxy4"!==o,security:"proxy5"===o})))}}return uD.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(o)),ND("debug",["Server",e.clientId],"setCloudProxyServerAndGetServerInfo",{proxyServer:e.proxyServer,mode:e.cloudProxyServer}),s}async function C$(e,t,n,r,i){const o=$D("ACCOUNT_REGISTER").slice(0,$D("AJAX_REQUEST_CONCURRENT"));let s=[];s=t.proxyServer?o.map((e=>"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1"))):o.map((e=>"https://".concat(e,"/api/v1")));const a=null==i?void 0:i.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:s});try{const o=await async function(e,t,n,r,i){const o=Date.now(),s={sid:n.sid,opid:10,appid:n.appId,string_uid:t};let a=e[0];const c=await rD((()=>oG(a+"".concat(-1===a.indexOf("?")?"?":"&","action=stringuid"),{data:s,cancelToken:r,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}})),((n,r)=>{if(0===n.code){if(n.uid<=0||n.uid>=Math.pow(2,32))throw uD.error("Invalid Uint Uid ".concat(t," => ").concat(n.uid),n),ND("error",["AjaxAPI"],"requestUserAccount","Invalid Uint Uid ".concat(t," => ").concat(n.uid,", ").concat(n)),mG.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:n.uid,errorCode:ZN.INVALID_UINT_UID_FROM_STRING_UID,extend:s}),new eD(ZN.INVALID_UINT_UID_FROM_STRING_UID);return mG.reqUserAccount(s.sid,{lts:o,success:!0,serverAddr:a,stringUid:s.string_uid,uid:n.uid,errorCode:null,extend:s}),!1}const i=UK(n.code);return i.retry&&(a=e[(r+1)%e.length]),mG.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:n.uid,errorCode:i.desc,extend:s}),i.retry}),((t,n)=>t.code!==ZN.OPERATION_ABORTED&&(mG.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:null,errorCode:t.code,extend:s}),a=e[(n+1)%e.length],!0)),i);if(0!==c.code){const e=UK(c.code);throw new eD(ZN.UNEXPECTED_RESPONSE,e.desc)}return c}(s,e,t,n,r);return null==i||i.recordJoinChannelService({status:"success",endTs:Date.now()},a),o.uid}catch(e){throw null==i||i.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[e]},a),e}}async function O$(e,t,n){let r=Date.now();const i=e.cloudProxyServer,o=$D("normal"===i?"PROXY_CS":"WEBCS_DOMAIN").map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1"):"https://".concat(t,"/api/v1")));if(["proxy3","proxy4","proxy5"].includes(i)){const r=o.map((e=>({url:e,areaCode:m$()})));let i=null;i=await Hj({fragementLength:$D("FRAGEMENT_LENGTH"),referenceList:r,asyncMapHandler:r=>function(e,t,n,r){let{url:i,areaCode:o}=e;const s=Date.now(),a={opid:133,flag:"proxy5"===t.cloudProxyServer?4194304:1048576,ts:+new Date,key:t.token,cname:t.cname,sid:t.sid,detail:{6:t.stringUid,11:o},uid:t.uid||0};return rD((async()=>await oG(i,{data:a,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":69}})),(e=>{if(0===e.code)return mG.joinWebProxyAP(t.sid,{lts:s,sucess:1,apServerAddr:i,turnServerAddrList:e.addresses.map((e=>e.ip)).join(","),errorCode:null,eventType:t.cloudProxyServer}),!1;const n=UK(e.code);throw new eD(ZN.CAN_NOT_GET_GATEWAY_SERVER,n.desc,{retry:n.retry})}),(e=>e.code!==ZN.OPERATION_ABORTED&&(e.code===ZN.CAN_NOT_GET_GATEWAY_SERVER?(mG.joinWebProxyAP(a.sid,{lts:s,sucess:0,apServerAddr:i,turnServerAddrList:null,errorCode:e.code,eventType:t.cloudProxyServer}),uD.warning("[".concat(t.clientId,"] proxy ap server ").concat(i," failed, message: ").concat(e.message,", retry: ").concat(e.data.retry)),CD("warning",["AjaxAPI",t.clientId],"proxy ap server ".concat(i," failed, message: ").concat(e.message,", retry: ").concat(e.data.retry)),e.data.retry):(mG.joinWebProxyAP(a.sid,{lts:s,sucess:0,apServerAddr:i,turnServerAddrList:null,errorCode:e.code,eventType:t.cloudProxyServer}),!0))),r)}(r,e,t,n),allFailedhandler:()=>{throw uD.error("[".concat(e.clientId,"] can not get proxy server after trying several times")),new eD(ZN.CAN_NOT_GET_PROXY_SERVER)}});const s=i.addresses;if(!s||0===s.length)throw uD.error("[".concat(e.clientId,"] can not get proxy server, empty proxy server list")),new eD(ZN.CAN_NOT_GET_PROXY_SERVER,"empty proxy server list");return{addresses:s.map((e=>e.ip)).map(lj),serverResponse:{tcpport:s[0].port||443,udpport:s[0].port||BD.udpport,username:BD.username,password:BD.password}}}let s=null;s=await Hj({fragementLength:$D("FRAGEMENT_LENGTH"),referenceList:o,asyncMapHandler:r=>function(e,t,n,r){const i=Date.now(),o={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,uid:t.uid,cname:t.cname,ts:Math.floor(Date.now()/1e3),version:MD,seq:0,requestId:1};return rD((async()=>({res:await oG(e,{data:{service_name:"webrtc_proxy",json_body:JSON.stringify(o)},cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}}),url:e})),(e=>{if(!e.res.json_body)throw uD.debug("[".concat(t.clientId,"] Get proxy server failed: no json_body")),ND("error",["AjaxAPI",t.clientId],"requestProxyServerList","Get proxy server failed: no json_body"),new eD(ZN.UNEXPECTED_RESPONSE,JSON.stringify(e.res));const n=JSON.parse(e.res.json_body);if(200!==n.code)throw uD.debug("[".concat(t.clientId,"] Get proxy server failed: response code [").concat(n.code,"], reason [").concat(n.reason,"]")),ND("error",["AjaxAPI",t.clientId],"requestProxyServerList","Get proxy server failed: response code [".concat(n.code,"], reason [").concat(n.reason,"]")),new eD(ZN.UNEXPECTED_RESPONSE,JSON.stringify(e.res));return uD.debug("[".concat(t.clientId,"] App return server length"),n.servers.length),ND("debug",["AjaxAPI",t.clientId],"requestProxyServerList","",{length:n.servers.length}),!1}),(t=>t.code!==ZN.OPERATION_ABORTED&&(mG.requestProxyAppCenter(o.sid,{lts:i,succ:!1,APAddr:e,workerManagerList:null,ec:t.code,response:t.message}),!0)),r)}(r,e,t,n),allFailedhandler:()=>{throw uD.error("[".concat(e.clientId,"] can not get proxy server after trying several times")),new eD(ZN.CAN_NOT_GET_PROXY_SERVER)}});const a=JSON.parse(s.res.json_body).servers.map(uj);if("443only"===e.cloudProxyServer)return{addresses:a,serverResponse:{tcpport:443,udpport:BD.udpport,username:BD.username,password:BD.password}};mG.requestProxyAppCenter(e.sid,{lts:r,succ:!0,APAddr:s.url,workerManagerList:JSON.stringify(a),ec:null,response:JSON.stringify(s.res)}),r=Date.now();const c=a.map((r=>function(e,t,n,r){const i=Date.now();let o=e;e.startsWith("http")||(o="https://".concat(e,":4000/v2/machine"));const s={command:"request",gatewayType:"http",appId:t.appId,cname:t.cname,uid:(t.uid||"").toString(),sdkVersion:"2.3.1",sid:t.sid,seq:1,ts:Date.now(),requestId:3,clientRequest:{appId:t.appId,cname:t.cname,uid:(t.uid||"").toString(),sid:t.sid}};return rD((async()=>({res:await oG(o,{data:s,cancelToken:n}),url:e})),(e=>{if(!e.res.serverResponse)throw new eD(ZN.UNEXPECTED_RESPONSE,"requeet worker manager server failed: serverResponse is undefined");return!1}),(t=>t.code!==ZN.OPERATION_ABORTED&&(mG.requestProxyWorkerManager(s.sid,{lts:i,succ:!1,workerManagerAddr:e,ec:t.code,response:t.message}),!0)),r)}(r,e,t,n)));let u=null;try{u=await wj(c)}catch(t){throw uD.error("[".concat(e.clientId,"] can not get worker manager after trying several times")),new eD(ZN.CAN_NOT_GET_PROXY_SERVER)}return c.forEach((e=>e.cancel())),mG.requestProxyWorkerManager(e.sid,{lts:r,succ:!0,workerManagerAddr:u.url,ec:null,response:JSON.stringify(u.res)}),{addresses:[u.url],serverResponse:u.res.serverResponse}}async function b$(e,t,n,r){const i=$D("PROXY_SERVER_TYPE3"),o=(e,t,n)=>{let r=n||i;return Array.isArray(r)&&(r=t%2==0?i[1]:i[0]),"https://".concat(r,"/ap/?url=").concat(e)};let s=null;const a=[],c=async()=>{const i=$D("WEBCS_DOMAIN").slice(0,$D("AJAX_REQUEST_CONCURRENT")).map(((t,n)=>{let r;return r="disabled"===e.cloudProxyServer&&e.proxyServer?o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(t,"/api/v2/transpond/webrtc?v=2"):o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n),{url:r,areaCode:m$(),serviceIds:[BF.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?BF.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?BF.CLOUD_PROXY:BF.CLOUD_PROXY_FALLBACK]}})),s=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:i.map((e=>e.url))}),c=await Hj({fragementLength:$D("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:r=>(uD.debug("[".concat(e.clientId,"] Connect to choose_server:"),r.url),f$(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},s),e[0]},promisesCollector:a});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},s),c},u=async()=>{if(await vj(1e3),null!==s)return s;const i=$D("WEBCS_DOMAIN_BACKUP_LIST").map(((t,n)=>{let r;return r="disabled"===e.cloudProxyServer&&e.proxyServer?o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(t,"/api/v2/transpond/webrtc?v=2"):o("".concat(t,"/api/v2/transpond/webrtc?v=2"),n),{url:r,areaCode:m$(),serviceIds:[BF.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?BF.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?BF.CLOUD_PROXY:BF.CLOUD_PROXY_FALLBACK]}})),c=r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:i.map((e=>e.url))}),u=await Hj({fragementLength:$D("FRAGEMENT_LENGTH"),referenceList:i,asyncMapHandler:r=>(uD.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),r.url),f$(r,e,t,n)),allFailedhandler:e=>{throw r.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},c),e[0]},promisesCollector:a});return r.recordJoinChannelService({endTs:Date.now(),status:"success"},c),u};let l,d,h;try{({gatewayInfo:l,proxyInfo:d,url:h}=await wj([c(),u()]))}catch(e){throw e[0]}if(a.length&&a.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),!l||!d)throw new eD(ZN.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=h,"disabled"!==e.cloudProxyServer&&Array.isArray(i)&&h){const t=new xK(h).host;i.includes(t)&&(e.proxyServer=t,uD.setProxyServer(t),mG.setProxyServer(t),SD(t))}return s={gatewayInfo:l,proxyInfo:await gj(d,l.uid)},s}async function w$(e,t,n,r){const i=$D("UAP_AP").slice(0,$D("AJAX_REQUEST_CONCURRENT")).map((e=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1?action=uap"):"https://".concat(e,"/api/v1?action=uap")));return await function(e,t,n,r,i){d$+=1;const o={sid:n.sid,command:"convergeAllocateEdge",uid:"666",appId:n.appId,ts:Math.floor(Date.now()/1e3),seq:d$,requestId:d$,version:MD,cname:n.cname},s={service_name:t,json_body:JSON.stringify(o)};let a,c,u=e[0];return rD((async()=>{a=Date.now();const e=await oG(u,{data:s,cancelToken:r,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(c=Date.now()-a,0!==e.code){const t=new eD(ZN.UNEXPECTED_RESPONSE,"live streaming ap error, code"+e.code,{retry:!0,responseTime:c});throw uD.error(t.toString()),ND("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,t.toString()),t}const n=JSON.parse(e.json_body);if(200!==n.code){const e=new eD(ZN.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(n.code,", reason: ").concat(n.reason),{code:n.code,responseTime:c});throw uD.error(e.toString()),ND("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,e.toString()),e}if(!n.servers||0===n.servers.length){const e=new eD(ZN.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:n.code,responseTime:c});throw uD.error(e.toString()),ND("error",["AjaxAPI"],"requestLiveStreamingWorkerManager",void 0,e.toString()),e}const i=function(e,t){return{addressList:e.servers.map((e=>"wss://".concat(e.address.replace(/\./g,"-"),".").concat($D("WORKER_DOMAIN"),":").concat(e.wss,"?serviceName=").concat(encodeURIComponent(t)))),workerToken:e.workerToken,vid:e.vid}}(n,t);return $D("LIVE_STREAMING_ADDRESS")&&(i.addressList=$D("LIVE_STREAMING_ADDRESS")instanceof Array?$D("LIVE_STREAMING_ADDRESS"):[$D("LIVE_STREAMING_ADDRESS")]),l$(l$({},i),{},{responseTime:c})}),((r,i)=>(mG.apworkerEvent(n.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(r.addressList),firstSuccess:0===i,responseTime:c,serverIp:e[i%e.length]}),!1)),((r,i)=>(mG.apworkerEvent(n.sid,{success:!1,sc:r.data&&r.data.code||200,serviceName:t,responseTime:c,serverIp:e[i%e.length]}),!!(r.code!==ZN.OPERATION_ABORTED&&r.code!==ZN.UNEXPECTED_RESPONSE||r.data&&r.data.retry)&&(u=e[(i+1)%e.length],!0))),i)}(i,e,t,n,r)}async function N$(e,t,n){let r=null;const i=[],o=async o=>{const s=$D(o?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2")));return o&&(await vj(1e3),null!==r)?r:await Hj({fragementLength:$D("FRAGEMENT_LENGTH"),referenceList:s,asyncMapHandler:r=>(uD.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(o?"backup":""," choose_server:"),r),function(e,t,n,r){const[i]=((e,t)=>{const n=Math.floor(Math.random()*10**12),r={appid:e.appId,client_ts:Date.now(),opid:n,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:t,uid:e.uid||0,edges_services:e.apResponse.addresses.map((e=>({ip:e.ip,port:e.port})))}}]},i=new FormData;return i.append("request",JSON.stringify(r)),[i,n]})(t,[BF.CHOOSE_SERVER]);let o=aG.networkState;return rD((async()=>{o&&aG.networkState===Dk.OFFLINE&&aG.onlineWaiter&&await xv.race([aG.onlineWaiter,vj(r&&r.maxRetryTimeout||tD.maxRetryTimeout)]),o=aG.networkState;return((e,t)=>{if(e.response_body&&e.response_body.length){const t=e.response_body[0];if(0!==t.buffer.code){const e=UK(t.buffer.code);throw new eD(ZN.UPDATE_TICKET_FAILED,"[".concat(t.buffer.code,"]: ").concat(e.desc),{retry:e.retry})}return t.buffer.ticket}throw uD.debug("update ticket request received ap response without response body:",t),CD("debug",["AjaxAPI"],"update ticket request received ap response without response body: ".concat(t)),new eD(ZN.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})})(await oG(e,{data:i,cancelToken:n,headers:{"Content-Type":"multipart/form-data;"}},!0),e)}),(()=>!1),(e=>e.code!==ZN.OPERATION_ABORTED&&(e.code===ZN.UPDATE_TICKET_FAILED?e.data.retry:(uD.warning("[".concat(t.clientId,"] update ticket network error, retry"),e),CD("warning",["AjaxAPI",t.clientId],"update ticket network error, retry, ".concat(e)),!0))),r)}(r,e,t,n)),allFailedhandler:e=>{throw e[0]},promisesCollector:i})};try{return r=await wj([o(!1),o(!0)]),i.length&&i.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),r}catch(e){throw e[0]}}var D$;function L$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L$(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let k$=PD("ConfigDistributeManager")(D$=class extends JN{constructor(){super(),iw(this,"configs",void 0),iw(this,"joinInfo",void 0),iw(this,"cancelToken",void 0),iw(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),iw(this,"interval",void 0),iw(this,"mutex",new SG("config-distribute")),iw(this,"mutableParamsRead",!1)}startGetConfigDistribute(e,t){this.joinInfo=e,this.cancelToken=t,this.interval&&this.stopGetConfigDistribute(),this.updateConfigDistribute(),this.interval=window.setInterval((()=>{this.updateConfigDistribute()}),$D("CONFIG_DISTRIBUTE_INTERVAL"))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,mG.reportApiInvoke(null,{options:void 0,name:_P.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:mP.TRACER}).onSuccess(JSON.stringify(qD))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return uD.debug("[config-distribute] get config distribute interrupted have no joininfo"),void ND("debug",this,"updateConfigDistribute",void 0,"get config distribute interrupted have no joininfo");let e;const t=await this.mutex.lock();try{e=await async function(e,t,n){const r=$D("CDS_AP").slice(0,$D("AJAX_REQUEST_CONCURRENT")).map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1"):"https://".concat(t,"/api/v1?action=config"))).map((r=>function(e,t,n,r){const i=wb(),o={flag:64,cipher_method:0,features:{device:i.name,system:i.os,system_general:navigator.userAgent,vendor:t.appId,version:MD,cname:t.cname,sid:t.sid,session_id:t.sid,detail:"",proxyServer:t.proxyServer}};return rD((()=>oG(e,{data:o,timeout:1e3,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}})),void 0,(e=>e.code!==ZN.OPERATION_ABORTED),r)}(r,e,t,n)));let i=null,o=null,s={};try{i=await wj(r)}catch(e){if(e.code===ZN.OPERATION_ABORTED)throw e;o=e}if(r.forEach((e=>e.cancel())),mG.reportApiInvoke(e.sid,{name:_P.REQUEST_CONFIG_DISTRIBUTE,options:{error:o,res:i}}).onSuccess(),i&&i.test_tags)try{s=function(e){if(!e.test_tags)return{};const t=e.test_tags,n=Object.keys(t),r={};return n.forEach((e=>{var n;const i=pb(n=e.slice(4)).call(n),o=JSON.parse(t[e])[1];r[i]=o})),r}(i)}catch(e){}return s}(this.joinInfo,this.cancelToken,this.retryConfig),uD.debug("[config-distribute] get config distribute",JSON.stringify(e)),ND("debug",this,"updateConfigDistribute",e),e.limit_bitrate&&this.handleBitrateLimit(e.limit_bitrate),this.cacheGlobalParameterConfig(e),this.configs=e}catch(e){const t=new eD(ZN.NETWORK_RESPONSE_ERROR,e);uD.warning("[config-distribute] ".concat(t.toString())),ND("warning",this,"updateConfigDistribute",void 0,e.toString())}finally{t()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(e){var t;(t=e)&&t.uplink&&t.id&&void 0!==t.uplink.max_bitrate&&void 0!==t.uplink.min_bitrate&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==e.id&&this.emit(Sk.UPDATE_BITRATE_LIMIT,e):this.emit(Sk.UPDATE_BITRATE_LIMIT,e))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&P$({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(e){var t;const n=zL(t=Object.keys(e).filter((e=>/^webrtc_ng_global_parameter/.test(e)))).call(t);for(let t=0;t<n.length;t++)for(let r=n.length-1;r>t;r--){const t=n[r];if("number"==typeof e[t].__priority){const i=e[t].__priority,o=n[r-1];if("number"==typeof e[o].__priority){if(!(i>e[o].__priority))continue;{const e=t;n[r]=n[r-1],n[r-1]=e}}else{const e=t;n[r]=n[r-1],n[r-1]=e}}}const r={};n.forEach((t=>{const n=e[t],i=n.__expires;Object.keys(n).forEach((e=>{"__priority"===e||"__expires"===e||Object.prototype.hasOwnProperty.call(r,e)||(r[e]=P$({value:n[e]},i&&{expires:i}))}))}));try{const e=JSON.stringify(r),t=window.btoa(e);window.localStorage.setItem("websdk_ng_global_parameter",t),uD.debug("Caching global parameters ".concat(e)),ND("debug",this,"cacheGlobalParameterConfig",e)}catch(e){uD.error("Error caching global parameters:",e.message),ND("error",this,"cacheGlobalParameterConfig",void 0,e.message)}}})||D$;function x$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x$(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class U$ extends JN{constructor(e,t,n,r){super(),iw(this,"spec",void 0),iw(this,"token",void 0),iw(this,"websocket",void 0),iw(this,"pingpongTimer",void 0),iw(this,"reconnectMode","retry"),iw(this,"serviceMode",void 0),iw(this,"reqId",0),iw(this,"commandReqId",0),iw(this,"handleWebSocketOpen",(()=>{this.reconnectMode="retry",this.startPingPong()})),iw(this,"handleWebSocketMessage",(e=>{if(!e.data)return;const t=JSON.parse(e.data);t.requestId?this.emit("@".concat(t.requestId,"-").concat(t.sid),t):this.serviceMode===zP.INJECT?this.emit(nk.INJECT_STREAM_STATUS,t):(mG.workerEvent(this.spec.sid,{actionType:"status",serverCode:t.code,workerType:this.serviceMode===zP.TRANSCODE?1:2}),this.emit(nk.PUBLISH_STREAM_STATUS,t))})),this.spec=t,this.token=e,this.serviceMode=r,this.websocket=new e$("live-streaming",n),this.websocket.on($P.CONNECTED,this.handleWebSocketOpen),this.websocket.on($P.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on($P.REQUEST_NEW_URLS,((e,t)=>{Nj(this,nk.REQUEST_NEW_ADDRESS).then(e).catch(t)})),this.websocket.on($P.RECONNECTING,(()=>{this.websocket.reconnectMode=this.reconnectMode}))}init(e){return this.websocket.init(e)}async request(e,t,n,r){this.reqId+=1,"request"===e&&(this.commandReqId+=1);const i=this.commandReqId,o=this.reqId;if(!o||!this.websocket)throw new eD(ZN.UNEXPECTED_ERROR);const s=M$({command:e,sdkVersion:"4.14.2"===MD?"0.0.1":MD,seq:o,requestId:o,allocate:n,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},t);if("closed"===this.websocket.state)throw new eD(ZN.WS_DISCONNECT);const a=()=>new xv(((e,t)=>{this.websocket.once($P.CLOSED,(()=>t(new eD(ZN.WS_ABORT)))),this.websocket.once($P.CONNECTED,e)}));"connected"!==this.websocket.state&&await a(),s.clientRequest&&(s.clientRequest.workerToken=this.token);const c=new xv(((e,t)=>{const n=()=>{t(new eD(ZN.WS_ABORT))};this.websocket.once($P.RECONNECTING,n),this.websocket.once($P.CLOSED,n),this.once("@".concat(o,"-").concat(this.spec.sid),(t=>{e(t)}))}));r&&mG.workerEvent(this.spec.sid,M$(M$({},r),{},{requestId:i,actionType:"request",payload:JSON.stringify(t.clientRequest),serverCode:0,code:0}));const u=Date.now();this.websocket.sendMessage(s);let l=null;try{l=await c}catch(r){if("closed"===this.websocket.state)throw r;return await a(),await this.request(e,t,n)}return r&&mG.workerEvent(this.spec.sid,M$(M$({},r),{},{requestId:i,actionType:"response",payload:JSON.stringify(l.serverResponse),serverCode:l.code,success:200===l.code,responseTime:Date.now()-u})),200!==l.code&&this.handleResponseError(l),l}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const e="4.14.2"===MD?"0.0.1":MD;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(e){switch(e.code){case ik.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void uD.warning("live stream response already exists stream");case ik.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case ik.LIVE_STREAM_RESPONSE_BAD_STREAM:case ik.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new eD(ZN.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw();case ik.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return;throw new eD(ZN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case ik.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new eD(ZN.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw();case ik.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const t=new eD(ZN.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(nk.WARNING,t,e.serverResponse.url)}case ik.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const t=new eD(ZN.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(nk.WARNING,t,e.serverResponse.url)}case ik.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new eD(ZN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case ik.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new eD(ZN.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:e.code}).throw();case ik.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const t=new eD(ZN.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(nk.WARNING,t,e.serverResponse.url)}case ik.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new eD(ZN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw();case ik.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new eD(ZN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case ik.LIVE_STREAM_RESPONSE_WORKER_LOST:case ik.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return;throw new eD(ZN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case ik.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return;if("UpdateTranscoding"===e.serverResponse.command||"ControlStream"===e.serverResponse.command)return new eD(ZN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw();throw new eD(ZN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case ik.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case ik.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case ik.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case ik.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new eD(ZN.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval((()=>{"connected"===this.websocket.state&&this.request("ping",{}).catch(Oj)}),6e3)}}function B$(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F$(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B$(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class V$ extends JN{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tD,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tD;super(),iw(this,"onLiveStreamWarning",void 0),iw(this,"onLiveStreamError",void 0),iw(this,"onInjectStatusChange",void 0),iw(this,"spec",void 0),iw(this,"retryTimeout",1e4),iw(this,"connection",void 0),iw(this,"httpRetryConfig",void 0),iw(this,"wsRetryConfig",void 0),iw(this,"streamingTasks",new Map),iw(this,"isStartingStreamingTask",!1),iw(this,"taskMutex",new SG("live-streaming")),iw(this,"cancelToken",zN.CancelToken.source()),iw(this,"transcodingConfig",void 0),iw(this,"injectConfig",F$({},tk)),iw(this,"injectLoopTimes",0),iw(this,"uapResponse",void 0),iw(this,"lastTaskId",1),iw(this,"statusError",new Map),this.spec=e,this.httpRetryConfig=n,this.wsRetryConfig=t}async setTranscodingConfig(e){const t=F$(F$({},ek),e);66!==t.videoCodecProfile&&77!==t.videoCodecProfile&&100!==t.videoCodecProfile&&(uD.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(t.videoCodecProfile," -> 100")),t.videoCodecProfile=100),t.transcodingUsers||(t.transcodingUsers=t.userConfigs),t.transcodingUsers&&(t.transcodingUsers=t.transcodingUsers.map((e=>F$(F$(F$({},JP),e),{},{zOrder:e.zOrder?e.zOrder+1:1})))),function(e){iP(e.width)||XL(e.width,"config.width",0,1e4),iP(e.height)||XL(e.height,"config.height",0,1e4),iP(e.videoBitrate)||XL(e.videoBitrate,"config.videoBitrate",1,1e6),iP(e.videoFrameRate)||XL(e.videoFrameRate,"config.videoFrameRate"),iP(e.lowLatency)||qL(e.lowLatency,"config.lowLatency"),iP(e.audioSampleRate)||JL(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),iP(e.audioBitrate)||XL(e.audioBitrate,"config.audioBitrate",1,128),iP(e.audioChannels)||JL(e.audioChannels,"config.audioChannels",[1,2,3,4,5]),iP(e.videoGop)||XL(e.videoGop,"config.videoGop"),iP(e.videoCodecProfile)||JL(e.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),iP(e.userCount)||XL(e.userCount,"config.userCount",0,17),iP(e.backgroundColor)||XL(e.backgroundColor,"config.backgroundColor",0,16777215),iP(e.userConfigExtraInfo)||eP(e.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),e.transcodingUsers&&!iP(e.transcodingUsers)&&(tP(e.transcodingUsers,"config.transcodingUsers"),e.transcodingUsers.forEach(((e,t)=>{rP(e.uid),iP(e.x)||XL(e.x,"transcodingUser[".concat(t,"].x"),0,1e4),iP(e.y)||XL(e.y,"transcodingUser[".concat(t,"].y"),0,1e4),iP(e.width)||XL(e.width,"transcodingUser[".concat(t,"].width"),0,1e4),iP(e.height)||XL(e.height,"transcodingUser[".concat(t,"].height"),0,1e4),iP(e.zOrder)||XL(e.zOrder-1,"transcodingUser[".concat(t,"].zOrder"),0,100),iP(e.alpha)||XL(e.alpha,"transcodingUser[".concat(t,"].alpha"),0,1,!1)}))),iP(e.watermark)||ZP(e.watermark,"watermark"),iP(e.backgroundImage)||ZP(e.backgroundImage,"backgroundImage"),e.images&&!iP(e.images)&&(tP(e.images,"config.images"),e.images.forEach(((e,t)=>{ZP(e,"images[".concat(t,"]"))})))}(t);const n=[];t.images&&n.push(...t.images.map((e=>F$(F$(F$({},XP),e),{},{zOrder:255})))),t.backgroundImage&&(n.push(F$(F$(F$({},XP),t.backgroundImage),{},{zOrder:0})),delete t.backgroundImage),t.watermark&&(n.push(F$(F$(F$({},XP),t.watermark),{},{zOrder:255})),delete t.watermark),t.images=n,t.transcodingUsers&&(t.userConfigs=t.transcodingUsers.map((e=>F$({},e))),t.userCount=t.transcodingUsers.length,delete t.transcodingUsers);const r=(t.userConfigs||[]).map((e=>"number"==typeof e.uid?xv.resolve(e.uid):C$(e.uid,this.spec,this.cancelToken.token,this.httpRetryConfig)));if((await xv.all(r)).forEach(((e,n)=>{t.userConfigs&&t.userConfigs[n]&&(t.userConfigs[n].uid=e)})),this.transcodingConfig=t,this.connection)try{var i;const e=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(HQ(i=this.streamingTasks).call(i)).map((e=>e.taskId)).join("#")});uD.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(e.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(e){if(!e.data||!e.data.retry)throw e;e.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach((t=>{uD.warning("[".concat(this.spec.clientId,"] live streaming receive error"),e.toString(),"try to republish",t.url),this.startLiveStreamingTask(t.url,t.mode,e).then((()=>{uD.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(t.url," success"))})).catch((e=>{uD.error("[".concat(this.spec.clientId,"] live streaming republish failed"),t.url,e.toString()),this.onLiveStreamError&&this.onLiveStreamError(t.url,e)}))}))}}setInjectStreamConfig(e,t){this.injectConfig=Object.assign({},this.injectConfig,e),this.injectLoopTimes=t}async startLiveStreamingTask(e,t,n){var r;if(Array.from(HQ(r=this.streamingTasks).call(r)).find((e=>e.mode===zP.INJECT))&&t===zP.INJECT)return new eD(ZN.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&t===zP.TRANSCODE)throw new eD(ZN.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let i={command:"PublishStream",ts:Date.now(),url:e,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};uD.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(e,", mode: ").concat(t));const o=await this.taskMutex.lock();if(!this.connection&&n)return void o();if(this.streamingTasks.get(e)&&!n)return o(),new eD(ZN.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(t))}catch(e){throw o(),e}switch(t){case zP.TRANSCODE:i.transcodingConfig=F$({},this.transcodingConfig);break;case zP.RAW:break;case zP.INJECT:i={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:e,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(i.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const s=this.lastTaskId++;try{const r=new xv(((t,r)=>{vj(this.retryTimeout).then((()=>{if(n)return r(n);const t=this.statusError.get(e);return t?(this.statusError.delete(e),r(t)):void 0}))})),a=await xv.race([this.connection.request("request",{clientRequest:i},!0,{url:e,command:"PublishStream",workerType:t===zP.TRANSCODE?1:2,requestByUser:!n,tid:s.toString()}),r]);this.isStartingStreamingTask=!1,uD.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(a.code)),this.streamingTasks.set(e,{clientRequest:i,mode:t,url:e,taskId:s}),o()}catch(r){if(o(),this.isStartingStreamingTask=!1,!r.data||!r.data.retry||n)throw r;return r.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(e,t,r)):await this.startLiveStreamingTask(e,t,r)}}stopLiveStreamingTask(e){return new xv(((t,n)=>{const r=this.streamingTasks.get(e);if(!r||!this.connection)return new eD(ZN.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const i=r.mode;r.abortTask=()=>{uD.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(e),t()},this.connection.request("request",{clientRequest:{command:i===zP.INJECT?"UninjectStream":"UnpublishStream",url:r.url}},!1,{url:e,command:"UnPublishStream",workerType:i===zP.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then((n=>{uD.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(n.code)),this.streamingTasks.delete(e),0===this.streamingTasks.size&&i!==zP.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),t(),i===zP.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(qP.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,e)})).catch(n)}))}async controlInjectStream(e,t,n,r){const i=this.streamingTasks.get(e);if(!i||!this.connection||i.mode!==zP.INJECT)throw new eD(ZN.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:e,control:t,audioVolume:n,position:r}})).serverResponse}resetAllTask(){var e;const t=Array.from(HQ(e=this.streamingTasks).call(e));this.terminate();for(const e of t)this.startLiveStreamingTask(e.url,e.mode).catch((t=>{this.onLiveStreamError&&this.onLiveStreamError(e.url,t)}))}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=zN.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(e){if(this.connection)throw new eD(ZN.UNEXPECTED_ERROR,"live streaming connection has already connected");const t=await Nj(this,rk.REQUEST_WORKER_MANAGER_LIST,e);return this.uapResponse=t,this.connection=new U$(t.workerToken,this.spec,this.wsRetryConfig,e),this.connection.on(nk.WARNING,((e,t)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e))),this.connection.on(nk.PUBLISH_STREAM_STATUS,(e=>this.handlePublishStreamServer(e))),this.connection.on(nk.INJECT_STREAM_STATUS,(e=>this.handleInjectStreamServerStatus(e))),this.connection.on(nk.REQUEST_NEW_ADDRESS,((t,n)=>{if(!this.connection)return n(new eD(ZN.UNEXPECTED_ERROR,"can not get new live streaming address list"));Nj(this,rk.REQUEST_WORKER_MANAGER_LIST,e).then((e=>{this.uapResponse=e,t(e.addressList)})).catch(n)})),await this.connection.init(t.addressList),this.connection}handlePublishStreamServer(e){const t=e.serverStatus&&e.serverStatus.url||"empty_url",n=this.streamingTasks.get(t),r=e.reason;switch(e.code){case ik.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case ik.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case ik.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case ik.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const r=new eD(ZN.LIVE_STREAMING_CDN_ERROR,"",{code:e.code});if(n)return uD.error(r.toString()),this.onLiveStreamError&&this.onLiveStreamError(t,r);if(!this.isStartingStreamingTask)return;this.statusError.set(t,r)}case ik.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const e=new eD(ZN.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,r);return this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e)}case ik.LIVE_STREAM_RESPONSE_WORKER_LOST:case ik.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var i;if(!this.connection)return;this.connection.tryNextAddress();const t=Array.from(HQ(i=this.streamingTasks).call(i));for(const n of t)n.abortTask?n.abortTask():(uD.warning("[".concat(this.spec.clientId,"] publish stream status code"),e.code,"try to republish",n.url),this.startLiveStreamingTask(n.url,n.mode,new eD(ZN.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then((()=>{uD.debug("[".concat(this.spec.clientId,"] republish live stream success"),n.url)})).catch((e=>{uD.error(e.toString()),this.onLiveStreamError&&this.onLiveStreamError(n.url,e)})));return}}}handleInjectStreamServerStatus(e){const t=Number(e.uid),n=e.serverStatus&&e.serverStatus.url;switch(e.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(qP.INJECT_STREAM_STATUS_START_SUCCESS,t,n));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(qP.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,t,n),void this.streamingTasks.delete(n);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(qP.INJECT_STREAM_STATUS_START_UNAUTHORIZED,t,n),void this.streamingTasks.delete(n);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(qP.INJECT_STREAM_STATUS_BROKEN,t,n),void this.streamingTasks.delete(n);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(qP.INJECT_STREAM_STATUS_START_TIMEOUT,t,n),void this.streamingTasks.delete(n);default:return void uD.debug("inject stream server status",e)}}hasUrl(e){return this.streamingTasks.has(e)}}class G${constructor(){iw(this,"destChannelMediaInfos",new Map),iw(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(e){Ik(e),this.srcChannelMediaInfo=e}addDestChannelInfo(e){Ik(e),this.destChannelMediaInfos.set(e.channelName,e)}removeDestChannelInfo(e){nP(e),this.destChannelMediaInfos.delete(e)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function Q$(e){if(!(e instanceof G$))return new eD(ZN.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=e.getSrcChannelMediaInfo(),n=e.getDestChannelMediaInfo();return t?0===n.size?new eD(ZN.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw():void 0:new eD(ZN.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw()}class j$ extends JN{constructor(e,t,n){super(),iw(this,"ws",void 0),iw(this,"requestId",1),iw(this,"heartBeatTimer",void 0),iw(this,"joinInfo",void 0),iw(this,"clientId",void 0),iw(this,"onOpen",(()=>{this.emit("open"),this.startHeartBeatCheck()})),iw(this,"onClose",(e=>{this.emit("close"),this.dispose()})),iw(this,"onMessage",(e=>{const t=JSON.parse(e.data);if(!t||"serverResponse"!==t.command||!t.requestId)return t&&"serverStatus"===t.command&&t.serverStatus&&t.serverStatus.command?(this.emit("status",t.serverStatus),void this.emit(t.serverStatus.command,t.serverStatus)):void 0;this.emit("req_".concat(t.requestId),t)})),this.joinInfo=e,this.clientId=t,this.ws=new e$("cross-channel-".concat(this.clientId),n),this.ws.on($P.RECONNECTING,(()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")})),this.ws.on($P.CONNECTED,this.onOpen),this.ws.on($P.ON_MESSAGE,this.onMessage),this.ws.on($P.CLOSED,this.onClose)}isConnect(){return"connected"===this.ws.state}sendMessage(e){const t=this.requestId++;return e.requestId=t,e.seq=t,this.ws.sendMessage(e),t}waitStatus(e){return new xv(((t,n)=>{const r=window.setTimeout((()=>{n(new eD(ZN.TIMEOUT,"wait status timeout, status: ".concat(e)))}),5e3);this.once(e,(i=>{window.clearTimeout(r),i.state&&0!==i.state?n(new eD(ZN.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(e))):t(void 0)})),this.once("dispose",(()=>{window.clearTimeout(r),n(new eD(ZN.WS_ABORT))}))}))}async request(e){if("closed"===this.ws.state)throw new eD(ZN.WS_DISCONNECT);"connected"!==this.ws.state&&await(()=>new xv(((e,t)=>{this.ws.once($P.CLOSED,(()=>t(new eD(ZN.WS_ABORT)))),this.ws.once($P.CONNECTED,e)})))();const t=this.sendMessage(e),n=new xv(((e,n)=>{const r=()=>{n(new eD(ZN.WS_ABORT))};this.ws.once($P.RECONNECTING,r),this.ws.once($P.CLOSED,r),this.once("req_".concat(t),e),vj(3e3).then((()=>{this.removeAllListeners("req_".concat(t)),this.ws.off($P.RECONNECTING,r),this.ws.off($P.CLOSED,r),n(new eD(ZN.TIMEOUT,"cross channel ws request timeout"))}))})),r=await n;if(!r||200!==r.code)throw new eD(ZN.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(r)));return r}async connect(e){this.ws.removeAllListeners($P.REQUEST_NEW_URLS),this.ws.on($P.REQUEST_NEW_URLS,(t=>{t(e)})),await this.ws.init(e)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(e){const t=this.requestId++;return e.requestId=t,this.ws.sendMessage(e),t}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval((()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})}),3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class H$ extends JN{set state(e){e!==this._state&&(e!==ck.RELAY_STATE_FAILURE&&(this.errorCode=uk.RELAY_OK),this.emit("state",e,this.errorCode),this._state=e)}get state(){return this._state}constructor(e,t,n,r){super(),iw(this,"joinInfo",void 0),iw(this,"sid",void 0),iw(this,"clientId",void 0),iw(this,"cancelToken",zN.CancelToken.source()),iw(this,"workerToken",void 0),iw(this,"requestId",0),iw(this,"signal",void 0),iw(this,"prevChannelMediaConfig",void 0),iw(this,"httpRetryConfig",void 0),iw(this,"_state",ck.RELAY_STATE_IDLE),iw(this,"errorCode",uk.RELAY_OK),iw(this,"onStatus",(e=>{uD.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(e))),e&&e.command&&("onAudioPacketReceived"===e.command&&this.emit("event",ak.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===e.command&&this.emit("event",ak.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===e.command&&(this.errorCode=uk.SRC_TOKEN_EXPIRED,this.state=ck.RELAY_STATE_FAILURE),"onDestTokenPrivilegeDidExpire"===e.command&&(this.errorCode=uk.DEST_TOKEN_EXPIRED,this.state=ck.RELAY_STATE_FAILURE))})),iw(this,"onReconnect",(async()=>{uD.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",ak.NETWORK_DISCONNECTED),this.state=ck.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch((e=>{this.state!==ck.RELAY_STATE_IDLE&&(uD.error("auto restart channel media relay failed",e.toString()),this.errorCode=uk.SERVER_CONNECTION_LOST,this.state=ck.RELAY_STATE_FAILURE)}))})),this.joinInfo=e,this.clientId=t,this.sid=Cj(),this.signal=new j$(this.joinInfo,this.clientId,n),this.httpRetryConfig=r}async startChannelMediaRelay(e){if(this.state!==ck.RELAY_STATE_IDLE)throw new eD(ZN.INVALID_OPERATION);this.state=ck.RELAY_STATE_CONNECTING,await this.connect(),uD.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(e)}catch(e){if(e.data&&e.data.serverResponse&&"SetSourceChannel"===e.data.serverResponse.command)throw new eD(ZN.CROSS_CHANNEL_FAILED_JOIN_SRC);if(e.data&&e.data.serverResponse&&"SetDestChannelStatus"===e.serverResponse.command)throw new eD(ZN.CROSS_CHANNEL_FAILED_JOIN_DEST);if(e.data&&e.data.serverResponse&&"StartPacketTransfer"===e.serverResponse.command)throw new eD(ZN.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST);throw e}this.prevChannelMediaConfig=e}async updateChannelMediaRelay(e){if(this.state!==ck.RELAY_STATE_RUNNING)throw new eD(ZN.INVALID_OPERATION);await this.sendUpdateMessage(e),this.prevChannelMediaConfig=e}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),uD.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=ck.RELAY_STATE_IDLE,this.dispose()}dispose(){uD.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=zN.CancelToken.source(),this.state=ck.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const e=await async function(e,t,n){const r=$D("UAP_AP").slice(0,$D("AJAX_REQUEST_CONCURRENT")).map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1?action=uap"):"https://".concat(t,"/api/v1?action=uap"))).map((r=>function(e,t,n,r){const i={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,ts:Date.now(),version:MD,cname:t.cname,uid:t.uid.toString(),requestId:h$,seq:h$};h$+=1;const o={service_name:"tele_channel",json_body:JSON.stringify(i)};return rD((async()=>{const t=await oG(e,{data:o,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(0!==t.code){const e=new eD(ZN.UNEXPECTED_RESPONSE,"cross channel ap error, code"+t.code,{retry:!0});throw uD.error(e.toString()),ND("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,e.toString()),e}const r=JSON.parse(t.json_body);if(200!==r.code){const e=new eD(ZN.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(r.code,", reason: ").concat(r.reason));throw uD.error(e.toString()),ND("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,e.toString()),e}if(!r.servers||0===r.servers.length){const e=new eD(ZN.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw uD.error(e.toString()),ND("error",["AjaxAPI"],"requestChannelMediaRelayWorkerManager",void 0,e.toString()),e}return{vid:r.vid,workerToken:r.workerToken,addressList:r.servers.map((e=>"wss://".concat(e.address.replace(/\./g,"-"),".").concat($D("WORKER_DOMAIN"),":").concat(e.wss)))}}),void 0,(e=>!!(e.code!==ZN.OPERATION_ABORTED&&e.code!==ZN.UNEXPECTED_RESPONSE||e.data&&e.data.retry)),r)}(r,e,t,n)));try{const e=await wj(r);return r.forEach((e=>e.cancel())),e}catch(e){throw e[0]}}(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=e.workerToken,await this.signal.connect(e.addressList),this.emit("event",ak.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(e){const t=this.genMessage(sk.StopPacketTransfer);await this.signal.request(t),await this.signal.waitStatus("Normal Quit"),uD.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const n=this.genMessage(sk.SetSdkProfile,e);await this.signal.request(n),uD.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const r=this.genMessage(sk.SetSourceChannel,e);await this.signal.request(r),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",ak.PACKET_JOINED_SRC_CHANNEL),uD.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const i=this.genMessage(sk.SetSourceUserId,e);await this.signal.request(i),uD.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const o=this.genMessage(sk.SetDestChannel,e);await this.signal.request(o),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",ak.PACKET_JOINED_DEST_CHANNEL),uD.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const s=this.genMessage(sk.StartPacketTransfer,e);await this.signal.request(s),this.emit("event",ak.PACKET_SENT_TO_DEST_CHANNEL),this.state=ck.RELAY_STATE_RUNNING,uD.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success"))}async sendUpdateMessage(e){const t=this.genMessage(sk.UpdateDestChannel,e);await this.signal.request(t),this.emit("event",ak.PACKET_UPDATE_DEST_CHANNEL),uD.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const e=this.genMessage(sk.StopPacketTransfer);await this.signal.request(e),uD.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(e,t){const n=[],r=[],i=[];this.requestId+=1;const o={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:MD,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};"4.14.2"===o.sdkVersion&&(o.sdkVersion="0.0.1");let s=null,a=null;switch(e){case sk.SetSdkProfile:return o.clientRequest={command:"SetSdkProfile",type:"multi_channel"},o;case sk.SetSourceChannel:if(a=t&&t.getSrcChannelMediaInfo(),!a)throw new eD(ZN.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceChannel",uid:"0",channelName:a.channelName,token:a.token||this.joinInfo.appId},o;case sk.SetSourceUserId:if(a=t&&t.getSrcChannelMediaInfo(),!a)throw new eD(ZN.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceUserId",uid:a.uid+""},o;case sk.SetDestChannel:if(s=t&&t.getDestChannelMediaInfo(),!s)throw new eD(ZN.UNEXPECTED_ERROR,"can not find dest config");return s.forEach((e=>{n.push(e.channelName),r.push(e.uid+""),i.push(e.token||this.joinInfo.appId)})),o.clientRequest={command:"SetDestChannel",channelName:n,uid:r,token:i},o;case sk.StartPacketTransfer:return o.clientRequest={command:"StartPacketTransfer"},o;case sk.Reconnect:return o.clientRequest={command:"Reconnect"},o;case sk.StopPacketTransfer:return o.clientRequest={command:"StopPacketTransfer"},o;case sk.UpdateDestChannel:if(s=t&&t.getDestChannelMediaInfo(),!s)throw new eD(ZN.UNEXPECTED_ERROR,"can not find dest config");return s.forEach((e=>{n.push(e.channelName),r.push(e.uid+""),i.push(e.token||this.joinInfo.appId)})),o.clientRequest={command:"UpdateDestChannel",channelName:n,uid:r,token:i},o}return o}}const W$=e=>{const t=document.createElement("canvas");return t.width=2,t.height=2,new xv(((n,r)=>{t.toBlob((async e=>{if(t.remove(),e){const r=await Y$(e);n({buffer:r,width:t.width,height:t.height})}else r(new eD(ZN.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))}),e,1)}))},Y$=async e=>{const t=await e.arrayBuffer();return new Uint8Array(t)},K$=new class extends JN{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),iw(this,"_lastHiddenTime",NaN),iw(this,"_lastVisibleTime",NaN),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState?this._lastHiddenTime=Date.now():this._lastVisibleTime=Date.now(),this.emit("VISIBILITY_CHANGE",document.visibilityState)}))}};var $$;let z$=PD("AgoraRTCPlayer","trackId")($$=class{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(e){e!==this._videoElementStatus&&(uD.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(e)),wD("debug",["HTMLVideoElement",this.trackId],"statusChange","".concat(this._videoElementStatus," => ").concat(e)),this._videoElementStatus=e)}constructor(e){iw(this,"trackId",void 0),iw(this,"config",void 0),iw(this,"onFirstVideoFrameDecoded",void 0),iw(this,"freezeTimeCounterList",[]),iw(this,"timeUpdatedCount",0),iw(this,"freezeTime",0),iw(this,"playbackTime",0),iw(this,"lastTimeUpdatedTime",0),iw(this,"autoplayFailed",!1),iw(this,"videoTrack",void 0),iw(this,"container",void 0),iw(this,"videoElement",void 0),iw(this,"videoElementCheckInterval",void 0),iw(this,"_videoElementStatus",lP.NONE),iw(this,"slot",void 0),iw(this,"isGettingVideoDimensions",!1),iw(this,"handleVideoEvents",(e=>{switch(e.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=lP.PLAYING;break;case"loadeddata":this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded();break;case"canplay":this.videoElementStatus=lP.CANPLAY;break;case"stalled":this.videoElementStatus=lP.STALLED;break;case"suspend":this.videoElementStatus=lP.SUSPEND;break;case"pause":this.videoElementStatus=lP.PAUSED,Bb()||Wb()||Mb()&&this.autoplayFailed||!this.videoElement||!this.videoTrack||"live"!==this.videoTrack.readyState||(uD.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),CD("debug",this,"video element paused, auto resume"),this.videoElement.play());break;case"waiting":this.videoElementStatus=lP.WAITING;break;case"abort":this.videoElementStatus=lP.ABORT;break;case"ended":this.videoElementStatus=lP.ENDED;break;case"emptied":this.videoElementStatus=lP.EMPTIED;break;case"timeupdate":{const e=Date.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=e);const t=e-this.lastTimeUpdatedTime;if("hidden"===K$.visibility)return;if(this.lastTimeUpdatedTime<K$.lastHiddenTime&&e>K$.lastVisibleTime)return void(this.lastTimeUpdatedTime=e);for(this.lastTimeUpdatedTime=e,t>500&&(this.freezeTime+=t),this.playbackTime+=t;this.playbackTime>=6e3;)this.playbackTime-=6e3,this.freezeTimeCounterList.push(Math.min(6e3,this.freezeTime)),this.freezeTime=Math.max(0,this.freezeTime-6e3);break}}})),iw(this,"startGetVideoDimensions",(()=>{const e=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement&&this.videoElement.videoWidth*this.videoElement.videoHeight>4)return uD.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),ND("debug",this,"startGetVideoDimensions",{videoWidth:this.videoElement.videoWidth,videoHeight:this.videoElement.videoHeight}),void(this.isGettingVideoDimensions=!1);setTimeout(e,500)};!this.isGettingVideoDimensions&&e()})),iw(this,"autoResumeAfterInterruption",(()=>{this.videoElement&&this.videoTrack&&"live"===this.videoTrack.readyState&&"running"===kG.curState&&(Hb()?(uD.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):jb()?(uD.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):Qb()&&(uD.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))})),iw(this,"autoResumeAfterInterruptionOnIOS15",(()=>{this.videoElement&&this.videoTrack&&"live"===this.videoTrack.readyState&&(Hb()?(uD.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.2")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):jb()?(uD.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.1")),this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):Qb()&&(uD.debug("[track-".concat(this.trackId,"] video element paused, auto resume for iOS 15.0")),this.videoElement.pause(),this.videoElement.play()))})),this.slot=e.element,this.trackId=e.trackId,this.updateConfig(e),kG.on(TG.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),kG.on(TG.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15)}updateConfig(e){this.config=e,this.trackId=e.trackId;const t=e.element;t!==this.slot&&(this.destroy(),this.slot=t),this.createElements()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}play(e){if(this.videoElement){const t=this.videoElement.play();t&&t.catch&&t.catch((t=>{e&&mG.autoplayFailed(e,"video",t.message,this.trackId),ND("warning",this,"play",t.toString(),"error"),"NotAllowedError"===t.name?(uD.warning("detected video element autoplay failed",t),this.autoplayFailed=!0,this.handleAutoPlayFailed()):uD.warning("[".concat(this.trackId,"] play warning: "),t)}));const n=wb();if(("Safari"===n.name&&15===Number(n.version)||Gb())&&t&&t.then&&t.catch){const e=()=>{this.config.mirror&&this.videoElement&&(this.videoElement.style.transform="rotateY(180deg)")};t.then(e).catch(e)}}}getCurrentFrame(){if(!this.videoElement)return new ImageData(2,2);const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const t=e.getContext("2d");if(!t)return uD.error("create canvas context failed!"),ND("error",this,"getCurrentFrame","create canvas context failed!","error"),new ImageData(2,2);t.drawImage(this.videoElement,0,0,e.width,e.height);const n=t.getImageData(0,0,e.width,e.height);return e.remove(),n}async getCurrentFrameToUint8Array(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!this.videoElement)return await W$(e);const n=document.createElement("canvas");n.width=this.videoElement.videoWidth,n.height=this.videoElement.videoHeight;const r=n.getContext("2d");return r?(r.drawImage(this.videoElement,0,0,n.width,n.height),new xv(((r,i)=>{n.toBlob((async e=>{if(n.remove(),e){const t=await Y$(e);r({buffer:t,width:n.width,height:n.height})}else i(new eD(ZN.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))}),e,t<0?.1:t>1?1:t)}))):await W$(e)}destroy(){if(kG.off(TG.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),kG.off(TG.IOS_15_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15),this.videoElement&&(this.videoElement.srcObject=null,this.videoElement.remove(),this.videoElement=void 0),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch(e){}this.container=void 0}this.freezeTimeCounterList=[]}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",this.createVideoElement(),this.container.appendChild(this.videoElement)):this.removeVideoElement(),this.slot.appendChild(this.container)}createVideoElement(){this.videoElement||(this.videoElementStatus=lP.INIT,this.videoElement=document.createElement("video"),this.videoElement.onerror=()=>this.videoElementStatus=lP.ERROR,this.container&&this.container.appendChild(this.videoElement),q$.forEach((e=>{this.videoElement&&this.videoElement.addEventListener(e,this.handleVideoEvents)})),this.videoElementCheckInterval=window.setInterval((()=>{!document.getElementById("video_".concat(this.trackId))&&this.videoElement&&(this.videoElementStatus=lP.DESTROYED)}),1e3)),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),this.videoElement.style.left="0",this.videoElement.style.top="0",zb()&&(this.videoElement.poster="noposter");const e=wb();"Safari"===e.name&&15===Number(e.version)||Gb()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Ub()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Ub()&&this.videoElement.load());const t=this.videoElement.play();void 0!==t&&t.catch((e=>{uD.debug("[".concat(this.trackId,"] playback interrupted"),e.toString()),CD("debug",this,"play back interrupted: ".concat(e.toString()))}))}removeVideoElement(){if(this.videoElement){q$.forEach((e=>{this.videoElement&&this.videoElement.removeEventListener(e,this.handleVideoEvents)})),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0);try{this.container&&this.container.removeChild(this.videoElement)}catch(e){}this.videoElement=void 0,this.videoElementStatus=lP.NONE}}handleAutoPlayFailed(){if(this.videoElement){const e=t=>{t.preventDefault(),this.videoElement&&(this.videoElement.play().then((()=>{uD.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed.")),CD("debug",this,"video element autoplay resumed")})).catch((e=>{uD.error(e)})),this.autoplayFailed=!1,qb()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0)))};qb()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),lG()}}getVideoElement(){return this.videoElement}getContainerElement(){return this.container}})||$$;const q$=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate"];var J$,X$={exports:{}};function Z$(e,t,n){const r=e.createShader(n);if(!r)return new eD(ZN.WEBGL_INTERNAL_ERROR,"can not create shader").throw();if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){const t=e.getShaderInfoLog(r);return e.deleteShader(r),new eD(ZN.WEBGL_INTERNAL_ERROR,"error compiling shader:"+t).throw()}return r}!function(e,t){self,e.exports=(()=>{var e={3476:(e,t,n)=>{e.exports=n(7460)},4341:(e,t,n)=>{e.exports=n(3685)},3536:(e,t,n)=>{var r=n(1910);e.exports=r},8171:(e,t,n)=>{n(6450);var r=n(4058).Object,i=e.exports=function(e,t,n){return r.defineProperty(e,t,n)};r.defineProperty.sham&&(i.sham=!0)},2956:(e,t,n)=>{n(7627),n(6274),n(5967),n(8881),n(4560),n(7206),n(4349),n(7971);var r=n(4058);e.exports=r.Promise},3685:(e,t,n)=>{var r=n(3536);e.exports=r},4883:(e,t,n)=>{var r=n(1899),i=n(7475),o=n(9826),s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not a function")}},174:(e,t,n)=>{var r=n(1899),i=n(4284),o=n(9826),s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not a constructor")}},1851:(e,t,n)=>{var r=n(1899),i=n(7475),o=r.String,s=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw s("Can't set "+o(e)+" as a prototype")}},8479:e=>{e.exports=function(){}},5743:(e,t,n)=>{var r=n(1899),i=n(7046),o=r.TypeError;e.exports=function(e,t){if(i(t,e))return e;throw o("Incorrect invocation")}},6059:(e,t,n)=>{var r=n(1899),i=n(941),o=r.String,s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not an object")}},1692:(e,t,n)=>{var r=n(4529),i=n(9413),o=n(623),s=function(e){return function(t,n,s){var a,c=r(t),u=o(c),l=i(s,u);if(e&&n!=n){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},3765:(e,t,n)=>{var r=n(5329);e.exports=r([].slice)},1385:(e,t,n)=>{var r=n(9813)("iterator"),i=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){i=!0}};s[r]=function(){return this},Array.from(s,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},2532:(e,t,n)=>{var r=n(5329),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},9697:(e,t,n)=>{var r=n(1899),i=n(2885),o=n(7475),s=n(2532),a=n(9813)("toStringTag"),c=r.Object,u="Arguments"==s(function(){return arguments}());e.exports=i?s:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=c(e),a))?n:u?s(t):"Object"==(r=s(t))&&o(t.callee)?"Arguments":r}},8694:(e,t,n)=>{var r=n(5329)("".replace),i=String(Error("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,s=o.test(i);e.exports=function(e,t){if(s&&"string"==typeof e)for(;t--;)e=r(e,o,"");return e}},3489:(e,t,n)=>{var r=n(953),i=n(1136),o=n(9677),s=n(5988);e.exports=function(e,t,n){for(var a=i(t),c=s.f,u=o.f,l=0;l<a.length;l++){var d=a[l];r(e,d)||n&&r(n,d)||c(e,d,u(t,d))}}},4160:(e,t,n)=>{var r=n(5981);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},1046:(e,t,n)=>{var r=n(5143).IteratorPrototype,i=n(9290),o=n(1887),s=n(904),a=n(2077),c=function(){return this};e.exports=function(e,t,n,u){var l=t+" Iterator";return e.prototype=i(r,{next:o(+!u,n)}),s(e,l,!1,!0),a[l]=c,e}},2029:(e,t,n)=>{var r=n(5746),i=n(5988),o=n(1887);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},1887:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},7771:(e,t,n)=>{var r=n(6887),i=n(8834),o=n(2529),s=n(9417),a=n(7475),c=n(1046),u=n(249),l=n(8929),d=n(904),h=n(2029),p=n(9754),f=n(9813),A=n(2077),E=n(5143),g=s.PROPER,_=s.CONFIGURABLE,m=E.IteratorPrototype,I=E.BUGGY_SAFARI_ITERATORS,T=f("iterator"),R="keys",v="values",y="entries",S=function(){return this};e.exports=function(e,t,n,s,f,E,C){c(n,t,s);var O,b,w,N=function(e){if(e===f&&x)return x;if(!I&&e in P)return P[e];switch(e){case R:case v:case y:return function(){return new n(this,e)}}return function(){return new n(this)}},D=t+" Iterator",L=!1,P=e.prototype,k=P[T]||P["@@iterator"]||f&&P[f],x=!I&&k||N(f),M="Array"==t&&P.entries||k;if(M&&(O=u(M.call(new e)))!==Object.prototype&&O.next&&(o||u(O)===m||(l?l(O,m):a(O[T])||p(O,T,S)),d(O,D,!0,!0),o&&(A[D]=S)),g&&f==v&&k&&k.name!==v&&(!o&&_?h(P,"name",v):(L=!0,x=function(){return i(k,this)})),f)if(b={values:N(v),keys:E?x:N(R),entries:N(y)},C)for(w in b)(I||L||!(w in P))&&p(P,w,b[w]);else r({target:t,proto:!0,forced:I||L},b);return o&&!C||P[T]===x||p(P,T,x,{name:f}),A[t]=x,b}},5746:(e,t,n)=>{var r=n(5981);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},1333:(e,t,n)=>{var r=n(1899),i=n(941),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},3281:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3321:e=>{e.exports="object"==typeof window},4470:(e,t,n)=>{var r=n(2861),i=n(1899);e.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==i.Pebble},2749:(e,t,n)=>{var r=n(2861);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},6049:(e,t,n)=>{var r=n(2532),i=n(1899);e.exports="process"==r(i.process)},8045:(e,t,n)=>{var r=n(2861);e.exports=/web0s(?!.*chrome)/i.test(r)},2861:(e,t,n)=>{var r=n(626);e.exports=r("navigator","userAgent")||""},3385:(e,t,n)=>{var r,i,o=n(1899),s=n(2861),a=o.process,c=o.Deno,u=a&&a.versions||c&&c.version,l=u&&u.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},6759:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8780:(e,t,n)=>{var r=n(5981),i=n(1887);e.exports=!r((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))},6887:(e,t,n)=>{var r=n(1899),i=n(9730),o=n(5329),s=n(7475),a=n(9677).f,c=n(7252),u=n(4058),l=n(6843),d=n(2029),h=n(953),p=function(e){var t=function(n,r,o){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,r)}return new e(n,r,o)}return i(e,this,arguments)};return t.prototype=e.prototype,t};e.exports=function(e,t){var n,i,f,A,E,g,_,m,I=e.target,T=e.global,R=e.stat,v=e.proto,y=T?r:R?r[I]:(r[I]||{}).prototype,S=T?u:u[I]||d(u,I,{})[I],C=S.prototype;for(f in t)n=!c(T?f:I+(R?".":"#")+f,e.forced)&&y&&h(y,f),E=S[f],n&&(g=e.noTargetGet?(m=a(y,f))&&m.value:y[f]),A=n&&g?g:t[f],n&&typeof E==typeof A||(_=e.bind&&n?l(A,r):e.wrap&&n?p(A):v&&s(A)?o(A):A,(e.sham||A&&A.sham||E&&E.sham)&&d(_,"sham",!0),d(S,f,_),v&&(h(u,i=I+"Prototype")||d(u,i,{}),d(u[i],f,A),e.real&&C&&!C[f]&&d(C,f,A)))}},5981:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},9730:(e,t,n)=>{var r=n(8285),i=Function.prototype,o=i.apply,s=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},6843:(e,t,n)=>{var r=n(5329),i=n(4883),o=n(8285),s=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?s(e,t):function(){return e.apply(t,arguments)}}},8285:(e,t,n)=>{var r=n(5981);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},8834:(e,t,n)=>{var r=n(8285),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},9417:(e,t,n)=>{var r=n(5746),i=n(953),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),c=a&&"something"===function(){}.name,u=a&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:u}},5329:(e,t,n)=>{var r=n(8285),i=Function.prototype,o=i.bind,s=i.call,a=r&&o.bind(s,s);e.exports=r?function(e){return e&&a(e)}:function(e){return e&&function(){return s.apply(e,arguments)}}},626:(e,t,n)=>{var r=n(4058),i=n(1899),o=n(7475),s=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(r[e])||s(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},2902:(e,t,n)=>{var r=n(9697),i=n(4229),o=n(2077),s=n(9813)("iterator");e.exports=function(e){if(null!=e)return i(e,s)||i(e,"@@iterator")||o[r(e)]}},429:(e,t,n)=>{var r=n(1899),i=n(8834),o=n(4883),s=n(6059),a=n(9826),c=n(2902),u=r.TypeError;e.exports=function(e,t){var n=arguments.length<2?c(e):t;if(o(n))return s(i(n,e));throw u(a(e)+" is not iterable")}},4229:(e,t,n)=>{var r=n(4883);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},1899:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},953:(e,t,n)=>{var r=n(5329),i=n(9678),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},7748:e=>{e.exports={}},4845:(e,t,n)=>{var r=n(1899);e.exports=function(e,t){var n=r.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},5463:(e,t,n)=>{var r=n(626);e.exports=r("document","documentElement")},2840:(e,t,n)=>{var r=n(5746),i=n(5981),o=n(1333);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},7026:(e,t,n)=>{var r=n(1899),i=n(5329),o=n(5981),s=n(2532),a=r.Object,c=i("".split);e.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?c(e,""):a(e)}:a},1302:(e,t,n)=>{var r=n(5329),i=n(7475),o=n(3030),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},3794:(e,t,n)=>{var r=n(941),i=n(2029);e.exports=function(e,t){r(t)&&"cause"in t&&i(e,"cause",t.cause)}},5402:(e,t,n)=>{var r,i,o,s=n(8019),a=n(1899),c=n(5329),u=n(941),l=n(2029),d=n(953),h=n(3030),p=n(4262),f=n(7748),A="Object already initialized",E=a.TypeError,g=a.WeakMap;if(s||h.state){var _=h.state||(h.state=new g),m=c(_.get),I=c(_.has),T=c(_.set);r=function(e,t){if(I(_,e))throw new E(A);return t.facade=e,T(_,e,t),t},i=function(e){return m(_,e)||{}},o=function(e){return I(_,e)}}else{var R=p("state");f[R]=!0,r=function(e,t){if(d(e,R))throw new E(A);return t.facade=e,l(e,R,t),t},i=function(e){return d(e,R)?e[R]:{}},o=function(e){return d(e,R)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!u(t)||(n=i(t)).type!==e)throw E("Incompatible receiver, "+e+" required");return n}}}},6782:(e,t,n)=>{var r=n(9813),i=n(2077),o=r("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||s[o]===e)}},7475:e=>{e.exports=function(e){return"function"==typeof e}},4284:(e,t,n)=>{var r=n(5329),i=n(5981),o=n(7475),s=n(9697),a=n(626),c=n(1302),u=function(){},l=[],d=a("Reflect","construct"),h=/^\s*(?:class|function)\b/,p=r(h.exec),f=!h.exec(u),A=function(e){if(!o(e))return!1;try{return d(u,l,e),!0}catch(e){return!1}},E=function(e){if(!o(e))return!1;switch(s(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!p(h,c(e))}catch(e){return!0}};E.sham=!0,e.exports=!d||i((function(){var e;return A(A.call)||!A(Object)||!A((function(){e=!0}))||e}))?E:A},7252:(e,t,n)=>{var r=n(5981),i=n(7475),o=/#|\.prototype\./,s=function(e,t){var n=c[a(e)];return n==l||n!=u&&(i(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},c=s.data={},u=s.NATIVE="N",l=s.POLYFILL="P";e.exports=s},941:(e,t,n)=>{var r=n(7475);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},2529:e=>{e.exports=!0},6664:(e,t,n)=>{var r=n(1899),i=n(626),o=n(7475),s=n(7046),a=n(2302),c=r.Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&s(t.prototype,c(e))}},3091:(e,t,n)=>{var r=n(1899),i=n(6843),o=n(8834),s=n(6059),a=n(9826),c=n(6782),u=n(623),l=n(7046),d=n(429),h=n(2902),p=n(7609),f=r.TypeError,A=function(e,t){this.stopped=e,this.result=t},E=A.prototype;e.exports=function(e,t,n){var r,g,_,m,I,T,R,v=n&&n.that,y=!(!n||!n.AS_ENTRIES),S=!(!n||!n.IS_ITERATOR),C=!(!n||!n.INTERRUPTED),O=i(t,v),b=function(e){return r&&p(r,"normal",e),new A(!0,e)},w=function(e){return y?(s(e),C?O(e[0],e[1],b):O(e[0],e[1])):C?O(e,b):O(e)};if(S)r=e;else{if(!(g=h(e)))throw f(a(e)+" is not iterable");if(c(g)){for(_=0,m=u(e);m>_;_++)if((I=w(e[_]))&&l(E,I))return I;return new A(!1)}r=d(e,g)}for(T=r.next;!(R=o(T,r)).done;){try{I=w(R.value)}catch(e){p(r,"throw",e)}if("object"==typeof I&&I&&l(E,I))return I}return new A(!1)}},7609:(e,t,n)=>{var r=n(8834),i=n(6059),o=n(4229);e.exports=function(e,t,n){var s,a;i(e);try{if(!(s=o(e,"return"))){if("throw"===t)throw n;return n}s=r(s,e)}catch(e){a=!0,s=e}if("throw"===t)throw n;if(a)throw s;return i(s),n}},5143:(e,t,n)=>{var r,i,o,s=n(5981),a=n(7475),c=n(9290),u=n(249),l=n(9754),d=n(9813),h=n(2529),p=d("iterator"),f=!1;[].keys&&("next"in(o=[].keys())?(i=u(u(o)))!==Object.prototype&&(r=i):f=!0),null==r||s((function(){var e={};return r[p].call(e)!==e}))?r={}:h&&(r=c(r)),a(r[p])||l(r,p,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},2077:e=>{e.exports={}},623:(e,t,n)=>{var r=n(3057);e.exports=function(e){return r(e.length)}},6132:(e,t,n)=>{var r,i,o,s,a,c,u,l,d=n(1899),h=n(6843),p=n(9677).f,f=n(2941).set,A=n(2749),E=n(4470),g=n(8045),_=n(6049),m=d.MutationObserver||d.WebKitMutationObserver,I=d.document,T=d.process,R=d.Promise,v=p(d,"queueMicrotask"),y=v&&v.value;y||(r=function(){var e,t;for(_&&(e=T.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?s():o=void 0,e}}o=void 0,e&&e.enter()},A||_||g||!m||!I?!E&&R&&R.resolve?((u=R.resolve(void 0)).constructor=R,l=h(u.then,u),s=function(){l(r)}):_?s=function(){T.nextTick(r)}:(f=h(f,d),s=function(){f(r)}):(a=!0,c=I.createTextNode(""),new m(r).observe(c,{characterData:!0}),s=function(){c.data=a=!a})),e.exports=y||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,s()),o=t}},9297:(e,t,n)=>{var r=n(1899);e.exports=r.Promise},2497:(e,t,n)=>{var r=n(3385),i=n(5981);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},8019:(e,t,n)=>{var r=n(1899),i=n(7475),o=n(1302),s=r.WeakMap;e.exports=i(s)&&/native code/.test(o(s))},9520:(e,t,n)=>{var r=n(4883),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},4649:(e,t,n)=>{var r=n(5803);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},9290:(e,t,n)=>{var r,i=n(6059),o=n(9938),s=n(6759),a=n(7748),c=n(5463),u=n(1333),l=n(4262)("IE_PROTO"),d=function(){},h=function(e){return"<script>"+e+"<\/script>"},p=function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t},f=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;f="undefined"!=typeof document?document.domain&&r?p(r):((t=u("iframe")).style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F):p(r);for(var n=s.length;n--;)delete f.prototype[s[n]];return f()};a[l]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(d.prototype=i(e),n=new d,d.prototype=null,n[l]=e):n=f(),void 0===t?n:o.f(n,t)}},9938:(e,t,n)=>{var r=n(5746),i=n(3937),o=n(5988),s=n(6059),a=n(4529),c=n(4771);t.f=r&&!i?Object.defineProperties:function(e,t){s(e);for(var n,r=a(t),i=c(t),u=i.length,l=0;u>l;)o.f(e,n=i[l++],r[n]);return e}},5988:(e,t,n)=>{var r=n(1899),i=n(5746),o=n(2840),s=n(3937),a=n(6059),c=n(3894),u=r.TypeError,l=Object.defineProperty,d=Object.getOwnPropertyDescriptor;t.f=i?s?function(e,t,n){if(a(e),t=c(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=d(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=c(t),a(n),o)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},9677:(e,t,n)=>{var r=n(5746),i=n(8834),o=n(6760),s=n(1887),a=n(4529),c=n(3894),u=n(953),l=n(2840),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=c(t),l)try{return d(e,t)}catch(e){}if(u(e,t))return s(!i(o.f,e,t),e[t])}},946:(e,t,n)=>{var r=n(5629),i=n(6759).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},7857:(e,t)=>{t.f=Object.getOwnPropertySymbols},249:(e,t,n)=>{var r=n(1899),i=n(953),o=n(7475),s=n(9678),a=n(4262),c=n(4160),u=a("IE_PROTO"),l=r.Object,d=l.prototype;e.exports=c?l.getPrototypeOf:function(e){var t=s(e);if(i(t,u))return t[u];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof l?d:null}},7046:(e,t,n)=>{var r=n(5329);e.exports=r({}.isPrototypeOf)},5629:(e,t,n)=>{var r=n(5329),i=n(953),o=n(4529),s=n(1692).indexOf,a=n(7748),c=r([].push);e.exports=function(e,t){var n,r=o(e),u=0,l=[];for(n in r)!i(a,n)&&i(r,n)&&c(l,n);for(;t.length>u;)i(r,n=t[u++])&&(~s(l,n)||c(l,n));return l}},4771:(e,t,n)=>{var r=n(5629),i=n(6759);e.exports=Object.keys||function(e){return r(e,i)}},6760:(e,t)=>{var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},8929:(e,t,n)=>{var r=n(5329),i=n(6059),o=n(1851);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},5623:(e,t,n)=>{var r=n(2885),i=n(9697);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},9811:(e,t,n)=>{var r=n(1899),i=n(8834),o=n(7475),s=n(941),a=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!s(r=i(n,e)))return r;if(o(n=e.valueOf)&&!s(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!s(r=i(n,e)))return r;throw a("Can't convert object to primitive value")}},1136:(e,t,n)=>{var r=n(626),i=n(5329),o=n(946),s=n(7857),a=n(6059),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?c(t,n(e)):t}},4058:e=>{e.exports={}},2:e=>{e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},6584:(e,t,n)=>{var r=n(6059),i=n(941),o=n(9520);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},8397:e=>{var t=function(){this.head=null,this.tail=null};t.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=t},7524:(e,t,n)=>{var r=n(9754);e.exports=function(e,t,n){for(var i in t)n&&n.unsafe&&e[i]?e[i]=t[i]:r(e,i,t[i],n);return e}},9754:(e,t,n)=>{var r=n(2029);e.exports=function(e,t,n,i){i&&i.enumerable?e[t]=n:r(e,t,n)}},8219:(e,t,n)=>{var r=n(1899).TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},4911:(e,t,n)=>{var r=n(1899),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},4431:(e,t,n)=>{var r=n(626),i=n(5988),o=n(9813),s=n(5746),a=o("species");e.exports=function(e){var t=r(e),n=i.f;s&&t&&!t[a]&&n(t,a,{configurable:!0,get:function(){return this}})}},904:(e,t,n)=>{var r=n(2885),i=n(5988).f,o=n(2029),s=n(953),a=n(5623),c=n(9813)("toStringTag");e.exports=function(e,t,n,u){if(e){var l=n?e:e.prototype;s(l,c)||i(l,c,{configurable:!0,value:t}),u&&!r&&o(l,"toString",a)}}},4262:(e,t,n)=>{var r=n(8726),i=n(9418),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},3030:(e,t,n)=>{var r=n(1899),i=n(4911),o="__core-js_shared__",s=r[o]||i(o,{});e.exports=s},8726:(e,t,n)=>{var r=n(2529),i=n(3030);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.3",mode:r?"pure":"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},487:(e,t,n)=>{var r=n(6059),i=n(174),o=n(9813)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||null==(n=r(s)[o])?t:i(n)}},4620:(e,t,n)=>{var r=n(5329),i=n(2435),o=n(5803),s=n(8219),a=r("".charAt),c=r("".charCodeAt),u=r("".slice),l=function(e){return function(t,n){var r,l,d=o(s(t)),h=i(n),p=d.length;return h<0||h>=p?e?"":void 0:(r=c(d,h))<55296||r>56319||h+1===p||(l=c(d,h+1))<56320||l>57343?e?a(d,h):r:e?u(d,h,h+2):l-56320+(r-55296<<10)+65536}};e.exports={codeAt:l(!1),charAt:l(!0)}},2941:(e,t,n)=>{var r,i,o,s,a=n(1899),c=n(9730),u=n(6843),l=n(7475),d=n(953),h=n(5981),p=n(5463),f=n(3765),A=n(1333),E=n(2749),g=n(6049),_=a.setImmediate,m=a.clearImmediate,I=a.process,T=a.Dispatch,R=a.Function,v=a.MessageChannel,y=a.String,S=0,C={};try{r=a.location}catch(e){}var O=function(e){if(d(C,e)){var t=C[e];delete C[e],t()}},b=function(e){return function(){O(e)}},w=function(e){O(e.data)},N=function(e){a.postMessage(y(e),r.protocol+"//"+r.host)};_&&m||(_=function(e){var t=f(arguments,1);return C[++S]=function(){c(l(e)?e:R(e),void 0,t)},i(S),S},m=function(e){delete C[e]},g?i=function(e){I.nextTick(b(e))}:T&&T.now?i=function(e){T.now(b(e))}:v&&!E?(s=(o=new v).port2,o.port1.onmessage=w,i=u(s.postMessage,s)):a.addEventListener&&l(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!h(N)?(i=N,a.addEventListener("message",w,!1)):i="onreadystatechange"in A("script")?function(e){p.appendChild(A("script")).onreadystatechange=function(){p.removeChild(this),O(e)}}:function(e){setTimeout(b(e),0)}),e.exports={set:_,clear:m}},9413:(e,t,n)=>{var r=n(2435),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},4529:(e,t,n)=>{var r=n(7026),i=n(8219);e.exports=function(e){return r(i(e))}},2435:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){var r=+e;return r!=r||0===r?0:(r>0?n:t)(r)}},3057:(e,t,n)=>{var r=n(2435),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},9678:(e,t,n)=>{var r=n(1899),i=n(8219),o=r.Object;e.exports=function(e){return o(i(e))}},6935:(e,t,n)=>{var r=n(1899),i=n(8834),o=n(941),s=n(6664),a=n(4229),c=n(9811),u=n(9813),l=r.TypeError,d=u("toPrimitive");e.exports=function(e,t){if(!o(e)||s(e))return e;var n,r=a(e,d);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!o(n)||s(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),c(e,t)}},3894:(e,t,n)=>{var r=n(6935),i=n(6664);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},2885:(e,t,n)=>{var r={};r[n(9813)("toStringTag")]="z",e.exports="[object z]"===String(r)},5803:(e,t,n)=>{var r=n(1899),i=n(9697),o=r.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},9826:(e,t,n)=>{var r=n(1899).String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},9418:(e,t,n)=>{var r=n(5329),i=0,o=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+o,36)}},2302:(e,t,n)=>{var r=n(2497);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3937:(e,t,n)=>{var r=n(5746),i=n(5981);e.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},9813:(e,t,n)=>{var r=n(1899),i=n(8726),o=n(953),s=n(9418),a=n(2497),c=n(2302),u=i("wks"),l=r.Symbol,d=l&&l.for,h=c?l:l&&l.withoutSetter||s;e.exports=function(e){if(!o(u,e)||!a&&"string"!=typeof u[e]){var t="Symbol."+e;a&&o(l,e)?u[e]=l[e]:u[e]=c&&d?d(t):h(t)}return u[e]}},7627:(e,t,n)=>{var r=n(6887),i=n(1899),o=n(7046),s=n(249),a=n(8929),c=n(3489),u=n(9290),l=n(2029),d=n(1887),h=n(8694),p=n(3794),f=n(3091),A=n(4649),E=n(9813),g=n(8780),_=E("toStringTag"),m=i.Error,I=[].push,T=function(e,t){var n,r=arguments.length>2?arguments[2]:void 0,i=o(R,this);a?n=a(new m,i?s(this):R):(n=i?this:u(R),l(n,_,"Error")),void 0!==t&&l(n,"message",A(t)),g&&l(n,"stack",h(n.stack,1)),p(n,r);var c=[];return f(e,I,{that:c}),l(n,"errors",c),n};a?a(T,m):c(T,m,{name:!0});var R=T.prototype=u(m.prototype,{constructor:d(1,T),message:d(1,""),name:d(1,"AggregateError")});r({global:!0},{AggregateError:T})},6274:(e,t,n)=>{var r=n(4529),i=n(8479),o=n(2077),s=n(5402),a=n(5988).f,c=n(7771),u=n(2529),l=n(5746),d="Array Iterator",h=s.set,p=s.getterFor(d);e.exports=c(Array,"Array",(function(e,t){h(this,{type:d,target:r(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var f=o.Arguments=o.Array;if(i("keys"),i("values"),i("entries"),!u&&l&&"values"!==f.name)try{a(f,"name",{value:"values"})}catch(e){}},6450:(e,t,n)=>{var r=n(6887),i=n(5746),o=n(5988).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==o,sham:!i},{defineProperty:o})},5967:()=>{},4560:(e,t,n)=>{var r=n(6887),i=n(8834),o=n(4883),s=n(9520),a=n(2),c=n(3091);r({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=s.f(t),r=n.resolve,u=n.reject,l=a((function(){var n=o(t.resolve),s=[],a=0,u=1;c(e,(function(e){var o=a++,c=!1;u++,i(n,t,e).then((function(e){c||(c=!0,s[o]={status:"fulfilled",value:e},--u||r(s))}),(function(e){c||(c=!0,s[o]={status:"rejected",reason:e},--u||r(s))}))})),--u||r(s)}));return l.error&&u(l.value),n.promise}})},7206:(e,t,n)=>{var r=n(6887),i=n(4883),o=n(626),s=n(8834),a=n(9520),c=n(2),u=n(3091),l="No one promise resolved";r({target:"Promise",stat:!0},{any:function(e){var t=this,n=o("AggregateError"),r=a.f(t),d=r.resolve,h=r.reject,p=c((function(){var r=i(t.resolve),o=[],a=0,c=1,p=!1;u(e,(function(e){var i=a++,u=!1;c++,s(r,t,e).then((function(e){u||p||(p=!0,d(e))}),(function(e){u||p||(u=!0,o[i]=e,--c||h(new n(o,l)))}))})),--c||h(new n(o,l))}));return p.error&&h(p.value),r.promise}})},4349:(e,t,n)=>{var r=n(6887),i=n(2529),o=n(9297),s=n(5981),a=n(626),c=n(7475),u=n(487),l=n(6584),d=n(9754);if(r({target:"Promise",proto:!0,real:!0,forced:!!o&&s((function(){o.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=u(this,a("Promise")),n=c(e);return this.then(n?function(n){return l(t,e()).then((function(){return n}))}:e,n?function(n){return l(t,e()).then((function(){throw n}))}:e)}}),!i&&c(o)){var h=a("Promise").prototype.finally;o.prototype.finally!==h&&d(o.prototype,"finally",h,{unsafe:!0})}},8881:(e,t,n)=>{var r,i,o,s,a=n(6887),c=n(2529),u=n(1899),l=n(626),d=n(8834),h=n(9297),p=n(9754),f=n(7524),A=n(8929),E=n(904),g=n(4431),_=n(4883),m=n(7475),I=n(941),T=n(5743),R=n(1302),v=n(3091),y=n(1385),S=n(487),C=n(2941).set,O=n(6132),b=n(6584),w=n(4845),N=n(9520),D=n(2),L=n(8397),P=n(5402),k=n(7252),x=n(9813),M=n(3321),U=n(6049),B=n(3385),F=x("species"),V="Promise",G=P.getterFor(V),Q=P.set,j=P.getterFor(V),H=h&&h.prototype,W=h,Y=H,K=u.TypeError,$=u.document,z=u.process,q=N.f,J=q,X=!!($&&$.createEvent&&u.dispatchEvent),Z=m(u.PromiseRejectionEvent),ee="unhandledrejection",te=!1,ne=k(V,(function(){var e=R(W),t=e!==String(W);if(!t&&66===B)return!0;if(c&&!Y.finally)return!0;if(B>=51&&/native code/.test(e))return!1;var n=new W((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[F]=r,!(te=n.then((function(){}))instanceof r)||!t&&M&&!Z})),re=ne||!y((function(e){W.all(e).catch((function(){}))})),ie=function(e){var t;return!(!I(e)||!m(t=e.then))&&t},oe=function(e,t){var n,r,i,o=t.value,s=1==t.state,a=s?e.ok:e.fail,c=e.resolve,u=e.reject,l=e.domain;try{a?(s||(2===t.rejection&&le(t),t.rejection=1),!0===a?n=o:(l&&l.enter(),n=a(o),l&&(l.exit(),i=!0)),n===e.promise?u(K("Promise-chain cycle")):(r=ie(n))?d(r,n,c,u):c(n)):u(o)}catch(e){l&&!i&&l.exit(),u(e)}},se=function(e,t){e.notified||(e.notified=!0,O((function(){for(var n,r=e.reactions;n=r.get();)oe(n,e);e.notified=!1,t&&!e.rejection&&ce(e)})))},ae=function(e,t,n){var r,i;X?((r=$.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),u.dispatchEvent(r)):r={promise:t,reason:n},!Z&&(i=u["on"+e])?i(r):e===ee&&w("Unhandled promise rejection",n)},ce=function(e){d(C,u,(function(){var t,n=e.facade,r=e.value;if(ue(e)&&(t=D((function(){U?z.emit("unhandledRejection",r,n):ae(ee,n,r)})),e.rejection=U||ue(e)?2:1,t.error))throw t.value}))},ue=function(e){return 1!==e.rejection&&!e.parent},le=function(e){d(C,u,(function(){var t=e.facade;U?z.emit("rejectionHandled",t):ae("rejectionhandled",t,e.value)}))},de=function(e,t,n){return function(r){e(t,r,n)}},he=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,se(e,!0))},pe=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw K("Promise can't be resolved itself");var r=ie(t);r?O((function(){var n={done:!1};try{d(r,t,de(pe,n,e),de(he,n,e))}catch(t){he(n,t,e)}})):(e.value=t,e.state=1,se(e,!1))}catch(t){he({done:!1},t,e)}}};if(ne&&(Y=(W=function(e){T(this,Y),_(e),d(r,this);var t=G(this);try{e(de(pe,t),de(he,t))}catch(e){he(t,e)}}).prototype,(r=function(e){Q(this,{type:V,done:!1,notified:!1,parent:!1,reactions:new L,rejection:!1,state:0,value:void 0})}).prototype=f(Y,{then:function(e,t){var n=j(this),r=q(S(this,W));return n.parent=!0,r.ok=!m(e)||e,r.fail=m(t)&&t,r.domain=U?z.domain:void 0,0==n.state?n.reactions.add(r):O((function(){oe(r,n)})),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r,t=G(e);this.promise=e,this.resolve=de(pe,t),this.reject=de(he,t)},N.f=q=function(e){return e===W||e===o?new i(e):J(e)},!c&&m(h)&&H!==Object.prototype)){s=H.then,te||(p(H,"then",(function(e,t){var n=this;return new W((function(e,t){d(s,n,e,t)})).then(e,t)}),{unsafe:!0}),p(H,"catch",Y.catch,{unsafe:!0}));try{delete H.constructor}catch(e){}A&&A(H,Y)}a({global:!0,wrap:!0,forced:ne},{Promise:W}),E(W,V,!1,!0),g(V),o=l(V),a({target:V,stat:!0,forced:ne},{reject:function(e){var t=q(this);return d(t.reject,void 0,e),t.promise}}),a({target:V,stat:!0,forced:c||ne},{resolve:function(e){return b(c&&this===o?W:this,e)}}),a({target:V,stat:!0,forced:re},{all:function(e){var t=this,n=q(t),r=n.resolve,i=n.reject,o=D((function(){var n=_(t.resolve),o=[],s=0,a=1;v(e,(function(e){var c=s++,u=!1;a++,d(n,t,e).then((function(e){u||(u=!0,o[c]=e,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=q(t),r=n.reject,i=D((function(){var i=_(t.resolve);v(e,(function(e){d(i,t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},7971:(e,t,n)=>{var r=n(4620).charAt,i=n(5803),o=n(5402),s=n(7771),a="String Iterator",c=o.set,u=o.getterFor(a);s(String,"String",(function(e){c(this,{type:a,string:i(e),index:0})}),(function(){var e,t=u(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},7634:(e,t,n)=>{n(6274);var r=n(3281),i=n(1899),o=n(9697),s=n(2029),a=n(2077),c=n(9813)("toStringTag");for(var u in r){var l=i[u],d=l&&l.prototype;d&&o(d)!==c&&s(d,c,u),a[u]=a.Array}},1910:(e,t,n)=>{var r=n(8171);e.exports=r},7460:(e,t,n)=>{var r=n(2956);n(7634),e.exports=r},9662:(e,t,n)=>{var r=n(7854),i=n(614),o=n(6330),s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not a function")}},6077:(e,t,n)=>{var r=n(7854),i=n(614),o=r.String,s=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw s("Can't set "+o(e)+" as a prototype")}},1223:(e,t,n)=>{var r=n(5112),i=n(30),o=n(3070),s=r("unscopables"),a=Array.prototype;null==a[s]&&o.f(a,s,{configurable:!0,value:i(null)}),e.exports=function(e){a[s][e]=!0}},9670:(e,t,n)=>{var r=n(7854),i=n(111),o=r.String,s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not an object")}},1318:(e,t,n)=>{var r=n(5656),i=n(1400),o=n(6244),s=function(e){return function(t,n,s){var a,c=r(t),u=o(c),l=i(s,u);if(e&&n!=n){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},4326:(e,t,n)=>{var r=n(1702),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},648:(e,t,n)=>{var r=n(7854),i=n(1694),o=n(614),s=n(4326),a=n(5112)("toStringTag"),c=r.Object,u="Arguments"==s(function(){return arguments}());e.exports=i?s:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=c(e),a))?n:u?s(t):"Object"==(r=s(t))&&o(t.callee)?"Arguments":r}},7741:(e,t,n)=>{var r=n(1702)("".replace),i=String(Error("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,s=o.test(i);e.exports=function(e,t){if(s&&"string"==typeof e)for(;t--;)e=r(e,o,"");return e}},9920:(e,t,n)=>{var r=n(2597),i=n(3887),o=n(1236),s=n(3070);e.exports=function(e,t,n){for(var a=i(t),c=s.f,u=o.f,l=0;l<a.length;l++){var d=a[l];r(e,d)||n&&r(n,d)||c(e,d,u(t,d))}}},8544:(e,t,n)=>{var r=n(7293);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},4994:(e,t,n)=>{var r=n(3383).IteratorPrototype,i=n(30),o=n(9114),s=n(8003),a=n(7497),c=function(){return this};e.exports=function(e,t,n,u){var l=t+" Iterator";return e.prototype=i(r,{next:o(+!u,n)}),s(e,l,!1,!0),a[l]=c,e}},8880:(e,t,n)=>{var r=n(9781),i=n(3070),o=n(9114);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},9114:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},654:(e,t,n)=>{var r=n(2109),i=n(6916),o=n(1913),s=n(6530),a=n(614),c=n(4994),u=n(9518),l=n(7674),d=n(8003),h=n(8880),p=n(1320),f=n(5112),A=n(7497),E=n(3383),g=s.PROPER,_=s.CONFIGURABLE,m=E.IteratorPrototype,I=E.BUGGY_SAFARI_ITERATORS,T=f("iterator"),R="keys",v="values",y="entries",S=function(){return this};e.exports=function(e,t,n,s,f,E,C){c(n,t,s);var O,b,w,N=function(e){if(e===f&&x)return x;if(!I&&e in P)return P[e];switch(e){case R:case v:case y:return function(){return new n(this,e)}}return function(){return new n(this)}},D=t+" Iterator",L=!1,P=e.prototype,k=P[T]||P["@@iterator"]||f&&P[f],x=!I&&k||N(f),M="Array"==t&&P.entries||k;if(M&&(O=u(M.call(new e)))!==Object.prototype&&O.next&&(o||u(O)===m||(l?l(O,m):a(O[T])||p(O,T,S)),d(O,D,!0,!0),o&&(A[D]=S)),g&&f==v&&k&&k.name!==v&&(!o&&_?h(P,"name",v):(L=!0,x=function(){return i(k,this)})),f)if(b={values:N(v),keys:E?x:N(R),entries:N(y)},C)for(w in b)(I||L||!(w in P))&&p(P,w,b[w]);else r({target:t,proto:!0,forced:I||L},b);return o&&!C||P[T]===x||p(P,T,x,{name:f}),A[t]=x,b}},9781:(e,t,n)=>{var r=n(7293);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:(e,t,n)=>{var r=n(7854),i=n(111),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},8324:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(e,t,n)=>{var r=n(317)("span").classList,i=r&&r.constructor&&r.constructor.prototype;e.exports=i===Object.prototype?void 0:i},8113:(e,t,n)=>{var r=n(5005);e.exports=r("navigator","userAgent")||""},7392:(e,t,n)=>{var r,i,o=n(7854),s=n(8113),a=o.process,c=o.Deno,u=a&&a.versions||c&&c.version,l=u&&u.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},748:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2914:(e,t,n)=>{var r=n(7293),i=n(9114);e.exports=!r((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))},2109:(e,t,n)=>{var r=n(7854),i=n(1236).f,o=n(8880),s=n(1320),a=n(3505),c=n(9920),u=n(4705);e.exports=function(e,t){var n,l,d,h,p,f=e.target,A=e.global,E=e.stat;if(n=A?r:E?r[f]||a(f,{}):(r[f]||{}).prototype)for(l in t){if(h=t[l],d=e.noTargetGet?(p=i(n,l))&&p.value:n[l],!u(A?l:f+(E?".":"#")+l,e.forced)&&void 0!==d){if(typeof h==typeof d)continue;c(h,d)}(e.sham||d&&d.sham)&&o(h,"sham",!0),s(n,l,h,e)}}},7293:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},2104:(e,t,n)=>{var r=n(4374),i=Function.prototype,o=i.apply,s=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},4374:(e,t,n)=>{var r=n(7293);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},6916:(e,t,n)=>{var r=n(4374),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},6530:(e,t,n)=>{var r=n(9781),i=n(2597),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),c=a&&"something"===function(){}.name,u=a&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:u}},1702:(e,t,n)=>{var r=n(4374),i=Function.prototype,o=i.bind,s=i.call,a=r&&o.bind(s,s);e.exports=r?function(e){return e&&a(e)}:function(e){return e&&function(){return s.apply(e,arguments)}}},5005:(e,t,n)=>{var r=n(7854),i=n(614),o=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e]):r[e]&&r[e][t]}},8173:(e,t,n)=>{var r=n(9662);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},7854:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},2597:(e,t,n)=>{var r=n(1702),i=n(7908),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},3501:e=>{e.exports={}},490:(e,t,n)=>{var r=n(5005);e.exports=r("document","documentElement")},4664:(e,t,n)=>{var r=n(9781),i=n(7293),o=n(317);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},8361:(e,t,n)=>{var r=n(7854),i=n(1702),o=n(7293),s=n(4326),a=r.Object,c=i("".split);e.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?c(e,""):a(e)}:a},9587:(e,t,n)=>{var r=n(614),i=n(111),o=n(7674);e.exports=function(e,t,n){var s,a;return o&&r(s=t.constructor)&&s!==n&&i(a=s.prototype)&&a!==n.prototype&&o(e,a),e}},2788:(e,t,n)=>{var r=n(1702),i=n(614),o=n(5465),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},8340:(e,t,n)=>{var r=n(111),i=n(8880);e.exports=function(e,t){r(t)&&"cause"in t&&i(e,"cause",t.cause)}},9909:(e,t,n)=>{var r,i,o,s=n(8536),a=n(7854),c=n(1702),u=n(111),l=n(8880),d=n(2597),h=n(5465),p=n(6200),f=n(3501),A="Object already initialized",E=a.TypeError,g=a.WeakMap;if(s||h.state){var _=h.state||(h.state=new g),m=c(_.get),I=c(_.has),T=c(_.set);r=function(e,t){if(I(_,e))throw new E(A);return t.facade=e,T(_,e,t),t},i=function(e){return m(_,e)||{}},o=function(e){return I(_,e)}}else{var R=p("state");f[R]=!0,r=function(e,t){if(d(e,R))throw new E(A);return t.facade=e,l(e,R,t),t},i=function(e){return d(e,R)?e[R]:{}},o=function(e){return d(e,R)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!u(t)||(n=i(t)).type!==e)throw E("Incompatible receiver, "+e+" required");return n}}}},614:e=>{e.exports=function(e){return"function"==typeof e}},4705:(e,t,n)=>{var r=n(7293),i=n(614),o=/#|\.prototype\./,s=function(e,t){var n=c[a(e)];return n==l||n!=u&&(i(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},c=s.data={},u=s.NATIVE="N",l=s.POLYFILL="P";e.exports=s},111:(e,t,n)=>{var r=n(614);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},1913:e=>{e.exports=!1},2190:(e,t,n)=>{var r=n(7854),i=n(5005),o=n(614),s=n(7976),a=n(3307),c=r.Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&s(t.prototype,c(e))}},3383:(e,t,n)=>{var r,i,o,s=n(7293),a=n(614),c=n(30),u=n(9518),l=n(1320),d=n(5112),h=n(1913),p=d("iterator"),f=!1;[].keys&&("next"in(o=[].keys())?(i=u(u(o)))!==Object.prototype&&(r=i):f=!0),null==r||s((function(){var e={};return r[p].call(e)!==e}))?r={}:h&&(r=c(r)),a(r[p])||l(r,p,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},7497:e=>{e.exports={}},6244:(e,t,n)=>{var r=n(7466);e.exports=function(e){return r(e.length)}},133:(e,t,n)=>{var r=n(7392),i=n(7293);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},8536:(e,t,n)=>{var r=n(7854),i=n(614),o=n(2788),s=r.WeakMap;e.exports=i(s)&&/native code/.test(o(s))},6277:(e,t,n)=>{var r=n(1340);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},30:(e,t,n)=>{var r,i=n(9670),o=n(6048),s=n(748),a=n(3501),c=n(490),u=n(317),l=n(6200)("IE_PROTO"),d=function(){},h=function(e){return"<script>"+e+"<\/script>"},p=function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t},f=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;f="undefined"!=typeof document?document.domain&&r?p(r):((t=u("iframe")).style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F):p(r);for(var n=s.length;n--;)delete f.prototype[s[n]];return f()};a[l]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(d.prototype=i(e),n=new d,d.prototype=null,n[l]=e):n=f(),void 0===t?n:o.f(n,t)}},6048:(e,t,n)=>{var r=n(9781),i=n(3353),o=n(3070),s=n(9670),a=n(5656),c=n(1956);t.f=r&&!i?Object.defineProperties:function(e,t){s(e);for(var n,r=a(t),i=c(t),u=i.length,l=0;u>l;)o.f(e,n=i[l++],r[n]);return e}},3070:(e,t,n)=>{var r=n(7854),i=n(9781),o=n(4664),s=n(3353),a=n(9670),c=n(4948),u=r.TypeError,l=Object.defineProperty,d=Object.getOwnPropertyDescriptor;t.f=i?s?function(e,t,n){if(a(e),t=c(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=d(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=c(t),a(n),o)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},1236:(e,t,n)=>{var r=n(9781),i=n(6916),o=n(5296),s=n(9114),a=n(5656),c=n(4948),u=n(2597),l=n(4664),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=c(t),l)try{return d(e,t)}catch(e){}if(u(e,t))return s(!i(o.f,e,t),e[t])}},8006:(e,t,n)=>{var r=n(6324),i=n(748).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},5181:(e,t)=>{t.f=Object.getOwnPropertySymbols},9518:(e,t,n)=>{var r=n(7854),i=n(2597),o=n(614),s=n(7908),a=n(6200),c=n(8544),u=a("IE_PROTO"),l=r.Object,d=l.prototype;e.exports=c?l.getPrototypeOf:function(e){var t=s(e);if(i(t,u))return t[u];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof l?d:null}},7976:(e,t,n)=>{var r=n(1702);e.exports=r({}.isPrototypeOf)},6324:(e,t,n)=>{var r=n(1702),i=n(2597),o=n(5656),s=n(1318).indexOf,a=n(3501),c=r([].push);e.exports=function(e,t){var n,r=o(e),u=0,l=[];for(n in r)!i(a,n)&&i(r,n)&&c(l,n);for(;t.length>u;)i(r,n=t[u++])&&(~s(l,n)||c(l,n));return l}},1956:(e,t,n)=>{var r=n(6324),i=n(748);e.exports=Object.keys||function(e){return r(e,i)}},5296:(e,t)=>{var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},7674:(e,t,n)=>{var r=n(1702),i=n(9670),o=n(6077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},2140:(e,t,n)=>{var r=n(7854),i=n(6916),o=n(614),s=n(111),a=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!s(r=i(n,e)))return r;if(o(n=e.valueOf)&&!s(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!s(r=i(n,e)))return r;throw a("Can't convert object to primitive value")}},3887:(e,t,n)=>{var r=n(5005),i=n(1702),o=n(8006),s=n(5181),a=n(9670),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?c(t,n(e)):t}},1320:(e,t,n)=>{var r=n(7854),i=n(614),o=n(2597),s=n(8880),a=n(3505),c=n(2788),u=n(9909),l=n(6530).CONFIGURABLE,d=u.get,h=u.enforce,p=String(String).split("String");(e.exports=function(e,t,n,c){var u,d=!!c&&!!c.unsafe,f=!!c&&!!c.enumerable,A=!!c&&!!c.noTargetGet,E=c&&void 0!==c.name?c.name:t;i(n)&&("Symbol("===String(E).slice(0,7)&&(E="["+String(E).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!o(n,"name")||l&&n.name!==E)&&s(n,"name",E),(u=h(n)).source||(u.source=p.join("string"==typeof E?E:""))),e!==r?(d?!A&&e[t]&&(f=!0):delete e[t],f?e[t]=n:s(e,t,n)):f?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return i(this)&&d(this).source||c(this)}))},2261:(e,t,n)=>{var r,i,o=n(6916),s=n(1702),a=n(1340),c=n(7066),u=n(2999),l=n(2309),d=n(30),h=n(9909).get,p=n(9441),f=n(7168),A=l("native-string-replace",String.prototype.replace),E=RegExp.prototype.exec,g=E,_=s("".charAt),m=s("".indexOf),I=s("".replace),T=s("".slice),R=(i=/b*/g,o(E,r=/a/,"a"),o(E,i,"a"),0!==r.lastIndex||0!==i.lastIndex),v=u.BROKEN_CARET,y=void 0!==/()??/.exec("")[1];(R||y||v||p||f)&&(g=function(e){var t,n,r,i,s,u,l,p=this,f=h(p),S=a(e),C=f.raw;if(C)return C.lastIndex=p.lastIndex,t=o(g,C,S),p.lastIndex=C.lastIndex,t;var O=f.groups,b=v&&p.sticky,w=o(c,p),N=p.source,D=0,L=S;if(b&&(w=I(w,"y",""),-1===m(w,"g")&&(w+="g"),L=T(S,p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==_(S,p.lastIndex-1))&&(N="(?: "+N+")",L=" "+L,D++),n=new RegExp("^(?:"+N+")",w)),y&&(n=new RegExp("^"+N+"$(?!\\s)",w)),R&&(r=p.lastIndex),i=o(E,b?n:p,L),b?i?(i.input=T(i.input,D),i[0]=T(i[0],D),i.index=p.lastIndex,p.lastIndex+=i[0].length):p.lastIndex=0:R&&i&&(p.lastIndex=p.global?i.index+i[0].length:r),y&&i&&i.length>1&&o(A,i[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(i[s]=void 0)})),i&&O)for(i.groups=u=d(null),s=0;s<O.length;s++)u[(l=O[s])[0]]=i[l[1]];return i}),e.exports=g},7066:(e,t,n)=>{var r=n(9670);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},2999:(e,t,n)=>{var r=n(7293),i=n(7854).RegExp,o=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),s=o||r((function(){return!i("a","y").sticky})),a=o||r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:a,MISSED_STICKY:s,UNSUPPORTED_Y:o}},9441:(e,t,n)=>{var r=n(7293),i=n(7854).RegExp;e.exports=r((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},7168:(e,t,n)=>{var r=n(7293),i=n(7854).RegExp;e.exports=r((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},4488:(e,t,n)=>{var r=n(7854).TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},3505:(e,t,n)=>{var r=n(7854),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},8003:(e,t,n)=>{var r=n(3070).f,i=n(2597),o=n(5112)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!i(e,o)&&r(e,o,{configurable:!0,value:t})}},6200:(e,t,n)=>{var r=n(2309),i=n(9711),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},5465:(e,t,n)=>{var r=n(7854),i=n(3505),o="__core-js_shared__",s=r[o]||i(o,{});e.exports=s},2309:(e,t,n)=>{var r=n(1913),i=n(5465);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.3",mode:r?"pure":"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},1400:(e,t,n)=>{var r=n(9303),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},5656:(e,t,n)=>{var r=n(8361),i=n(4488);e.exports=function(e){return r(i(e))}},9303:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){var r=+e;return r!=r||0===r?0:(r>0?n:t)(r)}},7466:(e,t,n)=>{var r=n(9303),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},7908:(e,t,n)=>{var r=n(7854),i=n(4488),o=r.Object;e.exports=function(e){return o(i(e))}},7593:(e,t,n)=>{var r=n(7854),i=n(6916),o=n(111),s=n(2190),a=n(8173),c=n(2140),u=n(5112),l=r.TypeError,d=u("toPrimitive");e.exports=function(e,t){if(!o(e)||s(e))return e;var n,r=a(e,d);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!o(n)||s(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),c(e,t)}},4948:(e,t,n)=>{var r=n(7593),i=n(2190);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},1694:(e,t,n)=>{var r={};r[n(5112)("toStringTag")]="z",e.exports="[object z]"===String(r)},1340:(e,t,n)=>{var r=n(7854),i=n(648),o=r.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},6330:(e,t,n)=>{var r=n(7854).String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},9711:(e,t,n)=>{var r=n(1702),i=0,o=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+o,36)}},3307:(e,t,n)=>{var r=n(133);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:(e,t,n)=>{var r=n(9781),i=n(7293);e.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},5112:(e,t,n)=>{var r=n(7854),i=n(2309),o=n(2597),s=n(9711),a=n(133),c=n(3307),u=i("wks"),l=r.Symbol,d=l&&l.for,h=c?l:l&&l.withoutSetter||s;e.exports=function(e){if(!o(u,e)||!a&&"string"!=typeof u[e]){var t="Symbol."+e;a&&o(l,e)?u[e]=l[e]:u[e]=c&&d?d(t):h(t)}return u[e]}},9191:(e,t,n)=>{var r=n(5005),i=n(2597),o=n(8880),s=n(7976),a=n(7674),c=n(9920),u=n(9587),l=n(6277),d=n(8340),h=n(7741),p=n(2914),f=n(1913);e.exports=function(e,t,n,A){var E=A?2:1,g=e.split("."),_=g[g.length-1],m=r.apply(null,g);if(m){var I=m.prototype;if(!f&&i(I,"cause")&&delete I.cause,!n)return m;var T=r("Error"),R=t((function(e,t){var n=l(A?t:e,void 0),r=A?new m(e):new m;return void 0!==n&&o(r,"message",n),p&&o(r,"stack",h(r.stack,2)),this&&s(I,this)&&u(r,this,R),arguments.length>E&&d(r,arguments[E]),r}));if(R.prototype=I,"Error"!==_&&(a?a(R,T):c(R,T,{name:!0})),c(R,m),!f)try{I.name!==_&&o(I,"name",_),I.constructor=R}catch(e){}return R}}},6992:(e,t,n)=>{var r=n(5656),i=n(1223),o=n(7497),s=n(9909),a=n(3070).f,c=n(654),u=n(1913),l=n(9781),d="Array Iterator",h=s.set,p=s.getterFor(d);e.exports=c(Array,"Array",(function(e,t){h(this,{type:d,target:r(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var f=o.Arguments=o.Array;if(i("keys"),i("values"),i("entries"),!u&&l&&"values"!==f.name)try{a(f,"name",{value:"values"})}catch(e){}},1703:(e,t,n)=>{var r=n(2109),i=n(7854),o=n(2104),s=n(9191),a=i.WebAssembly,c=7!==Error("e",{cause:7}).cause,u=function(e,t){var n={};n[e]=s(e,t,c),r({global:!0,forced:c},n)},l=function(e,t){if(a&&a[e]){var n={};n[e]=s("WebAssembly."+e,t,c),r({target:"WebAssembly",stat:!0,forced:c},n)}};u("Error",(function(e){return function(t){return o(e,this,arguments)}})),u("EvalError",(function(e){return function(t){return o(e,this,arguments)}})),u("RangeError",(function(e){return function(t){return o(e,this,arguments)}})),u("ReferenceError",(function(e){return function(t){return o(e,this,arguments)}})),u("SyntaxError",(function(e){return function(t){return o(e,this,arguments)}})),u("TypeError",(function(e){return function(t){return o(e,this,arguments)}})),u("URIError",(function(e){return function(t){return o(e,this,arguments)}})),l("CompileError",(function(e){return function(t){return o(e,this,arguments)}})),l("LinkError",(function(e){return function(t){return o(e,this,arguments)}})),l("RuntimeError",(function(e){return function(t){return o(e,this,arguments)}}))},4916:(e,t,n)=>{var r=n(2109),i=n(2261);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},3948:(e,t,n)=>{var r=n(7854),i=n(8324),o=n(8509),s=n(6992),a=n(8880),c=n(5112),u=c("iterator"),l=c("toStringTag"),d=s.values,h=function(e,t){if(e){if(e[u]!==d)try{a(e,u,d)}catch(t){e[u]=d}if(e[l]||a(e,l,t),i[t])for(var n in s)if(e[n]!==s[n])try{a(e,n,s[n])}catch(t){e[n]=s[n]}}};for(var p in i)h(r[p]&&r[p].prototype,p);h(o,"DOMTokenList")}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{n.r(r),n.d(r,{AudioExtension:()=>T,AudioProcessor:()=>m,Extension:()=>I,Ticker:()=>v,VideoProcessor:()=>_,logger:()=>d,reporter:()=>f});var e=n(4341);function t(t,n,r){return n in t?e(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}n(1703),n(6992),n(3948);var i=n(3476),o=n.n(i);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const n=Math.random().toString(16).substr(2,e).toLowerCase();return n.length===e?"".concat(t).concat(n):"".concat(t).concat(n)+s(e-n.length,"")}n(4916);const a=Date.now(),c={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4};function u(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const l=e=>{for(const t in c)if(Object.prototype.hasOwnProperty.call(c,t)&&c[t]===e)return t;return"DEFAULT"},d=new class{constructor(){t(this,"logLevel",c.DEBUG),t(this,"hookLog",void 0)}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[c.DEBUG].concat(t);this.log.apply(this,r)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[c.INFO].concat(t);this.log.apply(this,r)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[c.WARNING].concat(t);this.log.apply(this,r)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[c.ERROR].concat(t);this.log.apply(this,r)}log(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(Date.now()-a<100)return void setTimeout((()=>{this.log(...n)}),Date.now()-a);const i=Math.max(0,Math.min(4,n[0]));if(n[0]=u()+" Agora-Extension [".concat(l(i),"]:"),i<this.logLevel)return;const o=u()+" %cAgora-Extension [".concat(l(i),"]:");let s=[];switch(i){case c.DEBUG:s=[o,"color: #64B5F6;"].concat(n.slice(1)),console.log.apply(console,s);break;case c.INFO:s=[o,"color: #1E88E5; font-weight: bold;"].concat(n.slice(1)),console.log.apply(console,s);break;case c.WARNING:s=[o,"color: #FB8C00; font-weight: bold;"].concat(n.slice(1)),console.warn.apply(console,s);break;case c.ERROR:s=[o,"color: #B00020; font-weight: bold;"].concat(n.slice(1)),console.error.apply(console,s)}null===(e=this.hookLog)||void 0===e||e.call(this,i,s)}};function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?h(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const f=new class{constructor(){t(this,"apiInvokeMsgQueue",[]),t(this,"hookApiInvoke",void 0)}reportApiInvoke(e){e.timeout=e.timeout||6e4,e.reportResult=void 0===e.reportResult||e.reportResult;const t=Date.now(),n=()=>({name:e.name,apiInvokeTime:t,options:e.options});let r=!1;var i;(i=e.timeout,new(o())((e=>{window.setTimeout(e,i)}))).then((()=>{r||(this.sendApiInvoke(p(p({},n()),{},{error:"API_INVOKE_TIMEOUT",success:!1})),d.debug("".concat(e.name," timeout")))}));const s=new Error("".concat(e.name,": this api invoke is end"));return{onSuccess:t=>{if(r)throw s;r=!0,this.sendApiInvoke(p(p({},n()),{},{success:!0},e.reportResult&&{result:t}))},onError:e=>{if(r)throw e;r=!0,this.sendApiInvoke(p(p({},n()),{},{success:!1,error:e.toString()}))}}}sendApiInvoke(e){this.hookApiInvoke?(this.hookApiInvoke([...this.apiInvokeMsgQueue,e]),this.apiInvokeMsgQueue=[]):this.apiInvokeMsgQueue.push(e)}};function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?A(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class g extends class{constructor(){t(this,"_events",{}),t(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map((e=>e.listener)):[]}on(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;const n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&n.splice(r,1),0===this._events[e].length&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const t=this._events[e].map((e=>e));for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(let n=0;n<t.length;n+=1){const i=t[n];i.once&&this.off(e,i.listener),i.listener.apply(this,r||[])}}_indexOfListener(e,t){let n=e.length;for(;n--;)if(e[n].listener===t)return n;return-1}emitAsPromise(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return 0===this.getListeners(e).length?o().reject(new Error("No promise event handler.")):new(o())(((t,r)=>{this.emit(e,...n,t,r)}))}emitAsPromiseNoResponse(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return 0===this.getListeners(e).length?o().resolve():new(o())(((t,r)=>{this.emit(e,...n,t,r)}))}}{get enabled(){return this._enabled}output(e,t){if(this.outputTrack===e)return;const n=f.reportApiInvoke({name:"".concat(this.name,".output"),options:{track:null==e?void 0:e.toString()}});this.outputTrack=e,this.destination&&this.destination.updateInput({track:e,context:t}),n.onSuccess()}constructor(){super(),t(this,"inputTrack",void 0),t(this,"outputTrack",void 0),t(this,"_enabled",!0),t(this,"_source",void 0),t(this,"ID",s(6,"")),t(this,"destination",void 0),t(this,"context",void 0),t(this,"name",void 0)}enable(){if(this._enabled)return;const e=f.reportApiInvoke({name:"".concat(this.name,".setEnabled"),options:!0});d.info("".concat(this.name,"-").concat(this.ID," enabled")),this._enabled=!0;try{var t;const n=null===(t=this.onEnableChange)||void 0===t?void 0:t.call(this,this._enabled);if(n instanceof o())return n.then((()=>{e.onSuccess()})).catch((t=>{throw e.onError(t),t}));e.onSuccess()}catch(t){throw e.onError(t),t}}disable(){if(!this._enabled)return;const e=f.reportApiInvoke({name:"".concat(this.name,".setEnabled"),options:!1});d.info("".concat(this.name,"-").concat(this.ID," disabled")),this._enabled=!1;try{var t;const n=null===(t=this.onEnableChange)||void 0===t?void 0:t.call(this,this._enabled);if(n instanceof o())return n.then((()=>{e.onSuccess()})).catch((t=>{throw e.onError(t),t}));e.onSuccess()}catch(t){throw e.onError(t),t}}}class _ extends g{get kind(){return"video"}pipe(e){const t=f.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:e.name}});if(this.destination===e)return t.onSuccess(),e;if(e._source){const n=new Error("Processor ".concat(e.name," already piped, please call unpipe beforehand."));throw t.onError(n),n}return this.destination&&this.unpipe(),this.destination=e,e._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,context:this.context}),t.onSuccess(),e}unpipe(){if(!this.destination)return;const e=f.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});d.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));try{const t=this.destination;this.destination._source=void 0,this.destination=void 0,t.reset()}finally{e.onSuccess()}}updateInput(e){var t,n;e.context!==this.context&&(this.context=e.context,null===(t=this.onPiped)||void 0===t||t.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,context:e.context})),e.track&&this.inputTrack!==e.track&&(this.inputTrack=e.track,null===(n=this.onTrack)||void 0===n||n.call(this,e.track,this.context))}reset(){var e;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.context=void 0,null===(e=this.onUnpiped)||void 0===e||e.call(this),this.destination&&this.destination.reset()}}class m extends g{constructor(){super(...arguments),t(this,"inputNode",void 0),t(this,"outputNode",void 0),t(this,"destination",void 0),t(this,"context",void 0)}get kind(){return"audio"}pipe(e){const t=f.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:e.name}});if(this.destination===e)return t.onSuccess(),e;if(e._source){const n=new Error("Processor ".concat(e.name," already piped, please call unpipe beforehand."));throw t.onError(n),n}return this.destination&&this.unpipe(),this.destination=e,e._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:this.context}),t.onSuccess(),e}unpipe(){if(!this.destination)return;d.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));const e=f.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});try{var t;let n=this.destination;null===(t=this.outputNode)||void 0===t||t.disconnect(),this.destination._source=void 0,this.destination=void 0,n.reset()}finally{e.onSuccess()}}output(e,t){if(e instanceof MediaStreamTrack)super.output(e,t);else if(e instanceof AudioNode){if(this.outputNode===e)return;const n=f.reportApiInvoke({name:"".concat(this.name,".output"),options:E(E({},e instanceof MediaStreamTrack&&{track:e.toString()}),e instanceof AudioNode&&{audioNode:e.toString()})});this.outputNode=e,this.destination&&this.destination.updateInput({node:e,context:t}),n.onSuccess()}}updateInput(e){var t,n,r;e.context!==this.context&&(this.context=e.context,null===(t=this.onPiped)||void 0===t||t.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:e.context})),e.track&&this.inputTrack!==e.track&&(this.inputTrack=e.track,null===(n=this.onTrack)||void 0===n||n.call(this,e.track,this.context)),e.node&&this.inputNode!==e.node&&(this.inputNode=e.node,null===(r=this.onNode)||void 0===r||r.call(this,e.node,this.context))}reset(){var e;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.inputNode=void 0,this.context=void 0,null===(e=this.onUnpiped)||void 0===e||e.call(this),this.destination&&this.destination.reset()}}class I{constructor(){t(this,"__registered__",!1),t(this,"logger",d),t(this,"reporter",f),t(this,"parameters",{})}createProcessor(){if(!this.__registered__)throw new Error("Extension not registered yet!");return this._createProcessor()}}class T extends I{}let R;class v{get running(){return this._running}constructor(e,n){if(t(this,"type",void 0),t(this,"interval",void 0),t(this,"fn",void 0),t(this,"_running",!1),t(this,"_osc",void 0),!e)throw new Error;if(n<=0)throw new Error;this.type=e,this.interval=n}add(e){this.fn=e}remove(){this.fn=void 0}start(){if(!this._running)switch(this._running=!0,this.type){case"Timer":{const e=()=>{setTimeout((()=>{this.fn&&this.fn(),this._running&&e()}),this.interval)};e();break}case"RAF":{const e=t=>{requestAnimationFrame((n=>{n-t<this.interval?this._running&&e(t):(this.fn&&this.fn(),this._running&&e(n))}))};e(performance.now());break}case"Oscillator":{R||(R=new AudioContext);const e=R.createGain();let t;e.gain.value=0,e.connect(R.destination);const n=()=>{this.fn&&this.fn(),t&&t.disconnect(),t=R.createOscillator(),this._osc=t,t.connect(e),this._running&&(t.onended=n,t.start(0),t.stop(R.currentTime+this.interval/1e3))};n();break}}}stop(){this._running=!1,this._osc&&(this._osc.onended=null,this._osc=void 0)}}})(),r})()}(X$),!document.documentMode&&window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(J$=HTMLCanvasElement.prototype.getContext,function(){let e=arguments;return"webgl"===e[0]&&(e=[].slice.call(arguments),e[0]="experimental-webgl"),J$.apply(null,e)}));const ez=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189];function tz(e){const t=new Uint8Array([99,114,121,112,116,105,105]),n=t.length,r=e,i=r.length,o=new Uint8Array(i),s=new Uint8Array(256);for(let e=0;e<256;e++)s[e]=e;let a=0;for(let e=0;e<256;e++)a=(a+s[e]+t[e%n])%256,[s[e],s[a]]=[s[a],s[e]];let c,u=0;a=0;for(let e=0;e<0+i;e++)u=(u+1)%256,a=(a+s[u])%256,[s[u],s[a]]=[s[a],s[u]],c=s[(s[u]+s[a])%256],e>=0&&(o[e-0]=r[e-0]^c);const l=String.fromCharCode.apply(null,Array.from(o));return Function("var winSize = 5; return `"+l+"`")()}const nz=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67];class rz{constructor(e,t){iw(this,"program",void 0),iw(this,"gl",void 0),iw(this,"kernel",void 0),this.gl=e,this.kernel=t||nz,this.program=function(e,t){const n=tz(t),r=function(e,t,n,r){const i=[];for(let n=0;n<t.length;++n){const r=0===n?e.VERTEX_SHADER:e.FRAGMENT_SHADER;i.push(Z$(e,t[n],r))}return function(e,t,n,r){const i=e.createProgram();if(!i)throw new eD(ZN.WEBGL_INTERNAL_ERROR,"can not create webgl program");if(t.forEach((t=>{e.attachShader(i,t)})),n&&n.forEach(((t,n)=>{e.bindAttribLocation(i,r?r[n]:n,t)})),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS)){const t=e.getProgramInfoLog(i);throw e.deleteProgram(i),new eD(ZN.WEBGL_INTERNAL_ERROR,"error in program linking:"+t)}return i}(e,i,n,r)}(e,[tz(ez),n]);{const t=e.getAttribLocation(r,"a_position"),n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(t);const i=2,o=e.FLOAT,s=!1,a=0,c=0;e.vertexAttribPointer(t,i,o,s,a,c)}{const t=e.getAttribLocation(r,"a_texCoord"),n=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(t);const i=2,o=e.FLOAT,s=!1,a=0,c=0;e.vertexAttribPointer(t,i,o,s,a,c)}return r}(this.gl,this.kernel)}setUniforms(){const e=this.gl.getUniformLocation(this.program,"u_flipY");this.gl.uniform1f(e,1)}}class iz extends rz{constructor(e,t,n,r){super(e,t),iw(this,"xOffset",void 0),iw(this,"yOffset",void 0),iw(this,"denoiseLevel",5),this.xOffset=1/n,this.yOffset=1/r}setUniforms(){const e=this.gl.getUniformLocation(this.program,"u_flipY"),t=this.gl.getUniformLocation(this.program,"u_singleStepOffset"),n=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform2f(t,this.xOffset,this.yOffset),this.gl.uniform1f(n,this.denoiseLevel),this.gl.uniform1f(e,1)}setParameters(e){void 0!==e.denoiseLevel&&(this.denoiseLevel=e.denoiseLevel)}setSize(e,t){this.xOffset=1/e,this.yOffset=1/t}}const oz=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11];class sz extends iz{constructor(e,t,n){super(e,oz,t,n)}}const az=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188];class cz extends iz{constructor(e,t,n){super(e,az,t,n)}}const uz=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24];class lz extends iz{constructor(e,t,n){super(e,uz,t,n)}}const dz=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144],hz=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],pz=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],fz=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255];class Az extends iz{constructor(e,t,n,r){super(e,dz,n,r),iw(this,"inputTexture",void 0),iw(this,"lightLevel",.1),iw(this,"rednessLevel",.5),iw(this,"mskin_he_max",175/180*3.141593),iw(this,"mskin_he_min",115/180*3.141593),iw(this,"mskin_hc_max",173/180*3.141593),iw(this,"mskin_hc_min",116/180*3.141593),iw(this,"mskin_hc_axis",2.04203545),iw(this,"mfacts_rotate_c",0),iw(this,"mfacts_rotate_le",0),iw(this,"mfacts_rotate_ge",0),iw(this,"tab_addr",null),iw(this,"lutTextures",[]),this.inputTexture=t,this.init()}setUniforms(){const e=this.gl.getUniformLocation(this.program,"u_flipY"),t=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform1f(t,this.denoiseLevel),this.gl.uniform1f(e,1);const n=this.gl.getUniformLocation(this.program,"light");this.gl.uniform1f(n,this.lightLevel);const r=this.gl.getUniformLocation(this.program,"redness");this.gl.uniform1f(r,this.rednessLevel);const i=this.gl.getUniformLocation(this.program,"skin_he_max"),o=this.gl.getUniformLocation(this.program,"skin_he_min"),s=this.gl.getUniformLocation(this.program,"skin_hc_max"),a=this.gl.getUniformLocation(this.program,"skin_hc_min"),c=this.gl.getUniformLocation(this.program,"skin_hc_axis"),u=this.gl.getUniformLocation(this.program,"facts_rotate_c"),l=this.gl.getUniformLocation(this.program,"facts_rotate_le"),d=this.gl.getUniformLocation(this.program,"facts_rotate_ge");this.gl.uniform1f(i,this.mskin_he_max),this.gl.uniform1f(o,this.mskin_he_min),this.gl.uniform1f(s,this.mskin_hc_max),this.gl.uniform1f(a,this.mskin_hc_min),this.gl.uniform1f(c,this.mskin_hc_axis),this.gl.uniform1f(u,this.mfacts_rotate_c),this.gl.uniform1f(l,this.mfacts_rotate_le),this.gl.uniform1f(d,this.mfacts_rotate_ge);const h=this.gl.getUniformLocation(this.program,"u_originImage");this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.uniform1i(h,2);const p=["lighten_lut"],f=[this.gl.TEXTURE3];for(let e=0;e<p.length;e++){const t=this.gl.getUniformLocation(this.program,p[e]);this.gl.activeTexture(f[e]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[e]),this.gl.uniform1i(t,e+3)}}setParameters(e){void 0!==e.denoiseLevel&&(this.denoiseLevel=e.denoiseLevel),void 0!==e.lightLevel&&(this.lightLevel=e.lightLevel),void 0!==e.rednessLevel&&(this.rednessLevel=e.rednessLevel,this.updateRedness(this.rednessLevel)),e.lighteningContrastLevel&&this.updateLut(e.lighteningContrastLevel)}init(){this.tab_addr=new Uint8Array(pz);const e=[this.tab_addr],t=[256],n=[1];for(let r=0;r<e.length;r++){const i=this.gl.createTexture();if(!i)throw new eD(ZN.WEBGL_INTERNAL_ERROR,"create lut texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,t[r],n[r],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,e[r]),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.lutTextures.push(i)}}updateRedness(e){const t=3.141593;let n,r,i=e,o=i;i>1&&(i=1),i<0&&(i=0),o>1&&(o=1),o<0&&(o=0),this.mfacts_rotate_c=.8*i,o<.8&&(o=0),this.mskin_he_max=175/180*t,this.mskin_hc_max=173/180*t,this.mskin_he_min=(115-4*o)/180*t,this.mskin_hc_min=(116-4*o)/180*t,this.mskin_hc_axis=(117-4*o)/180*t,this.mskin_hc_axis<this.mskin_hc_min&&(this.mskin_hc_axis=this.mskin_hc_min),this.mskin_hc_min<t/2&&(this.mskin_hc_min=t/2),this.mskin_hc_axis<t/2&&(this.mskin_hc_axis=t/2),this.mskin_he_min<t/2&&(this.mskin_he_min=t/2),this.mskin_hc_max>t&&(this.mskin_hc_max=t),this.mskin_hc_axis>t&&(this.mskin_hc_axis=t),this.mskin_he_max>t&&(this.mskin_he_max=t),n=this.mskin_he_max-this.mskin_hc_max,r=this.mskin_hc_max-this.mskin_hc_axis,this.mfacts_rotate_ge=n>.01?this.mfacts_rotate_c*r/n:this.mfacts_rotate_c,n=this.mskin_hc_min-this.mskin_he_min,r=this.mskin_hc_axis-this.mskin_hc_min,this.mfacts_rotate_le=n>.01?this.mfacts_rotate_c*r/n:this.mfacts_rotate_c}updateLut(e){let t=null;if(0===e&&(t=pz),1===e&&(t=fz),2===e&&(t=hz),!t)throw new eD(ZN.WEBGL_INTERNAL_ERROR,"invalid ylut_table value:"+e);this.tab_addr=new Uint8Array(t);const n=[this.tab_addr],r=[256],i=[1];for(let e=0;e<n.length;e++)this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[e]),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,r[e],i[e],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,n[e])}}class Ez{constructor(){iw(this,"gl",null),iw(this,"canvas",null),iw(this,"programs",[]),iw(this,"commonProgram",null),iw(this,"inputTexture",null),iw(this,"outputTextures",[]),iw(this,"fbos",[]),iw(this,"originalFrameWidth",0),iw(this,"originalFrameHeight",0),iw(this,"enableBeauty",!1),iw(this,"denoiseLevel",5),iw(this,"lightLevel",.35),iw(this,"rednessLevel",.5),iw(this,"lighteningContrastLevel",1)}setEnableBeauty(e){this.enableBeauty=!!e}init(e,t,n){if(!Gk().supportWebGL)throw new eD(ZN.NOT_SUPPORTED,"your browser is not support webGL");if(this.gl=n.getContext("webgl"),!this.gl)throw new eD(ZN.WEBGL_INTERNAL_ERROR,"can not get webgl context");if(this.initGL(e,t),!this.inputTexture)throw new eD(ZN.WEBGL_INTERNAL_ERROR,"can not find input texture");this.canvas=n,this.programs.push(new rz(this.gl)),this.programs.push(new sz(this.gl,e,t)),this.programs.push(new cz(this.gl,e,t)),this.programs.push(new lz(this.gl,e,t)),this.programs.push(new Az(this.gl,this.inputTexture,e,t)),this.commonProgram=this.programs[0].program,this.setDenoiseLevel(this.denoiseLevel),this.setLightLevel(this.lightLevel),this.setRednessLevel(this.rednessLevel),this.setContrastLevel(this.lighteningContrastLevel)}render(e){if(!this.gl||!this.commonProgram||!this.canvas)return void uD.warning("video effect manager is not init!");let t=0;if(this.originalFrameHeight===e.videoWidth&&this.originalFrameWidth===e.videoHeight)t=2;else if(this.originalFrameHeight!==e.videoHeight||this.originalFrameWidth!==e.videoWidth){if(uD.debug("beauty effect: resolution changed ".concat(this.originalFrameWidth,"x").concat(this.originalFrameHeight," -> ").concat(e.videoWidth,"x").concat(e.videoHeight)),0===e.videoHeight||0===e.videoWidth)return void uD.debug("beauty effect: skip 0 resolution frame");this.canvas.width=e.videoWidth,this.canvas.height=e.videoHeight,e.setAttribute("width",e.videoWidth.toString()),e.setAttribute("height",e.videoHeight.toString()),this.release(),this.init(e.videoWidth,e.videoHeight,this.canvas)}this.gl.viewport(0,0,e.videoWidth,e.videoHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e);const n=this.enableBeauty?this.programs.length-1:0;for(let e=0;e<=n;e++){const n=this.programs[e].program;this.gl.useProgram(n);const r=this.gl.getUniformLocation(n,"u_image");this.programs[e].setUniforms(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbos[t+e%2]),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.outputTextures[t+e%2]),this.gl.uniform1i(r,0)}this.gl.useProgram(this.commonProgram);const r=this.gl.getUniformLocation(this.commonProgram,"u_flipY");this.gl.uniform1f(r,-1),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}setDenoiseLevel(e){this.programs.forEach((t=>{t instanceof iz&&t.setParameters({denoiseLevel:e})})),this.denoiseLevel=e}setLightLevel(e){this.programs.forEach((t=>{t instanceof iz&&t.setParameters({lightLevel:e})})),this.lightLevel=e}setRednessLevel(e){this.programs.forEach((t=>{t instanceof iz&&t.setParameters({rednessLevel:e})})),this.rednessLevel=e}setContrastLevel(e){this.programs.forEach((t=>{t instanceof iz&&t.setParameters({lighteningContrastLevel:e})})),this.lighteningContrastLevel=e}setSize(e,t){this.programs.forEach((n=>{n instanceof iz&&n.setSize(e,t)}))}release(){this.gl=null,this.commonProgram=null,this.inputTexture=null,this.programs=[],this.outputTextures=[],this.fbos=[]}initGL(e,t){if(!this.gl)throw new eD(ZN.WEBGL_INTERNAL_ERROR,"can not find webgl context");this.inputTexture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);for(let n=0;n<4;n++){const r=this.gl.createTexture();if(!r)throw new eD(ZN.WEBGL_INTERNAL_ERROR,"create texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),n<2?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,t,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,t,e,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);const i=this.gl.createFramebuffer();if(!i)throw new eD(ZN.WEBGL_INTERNAL_ERROR,"create frame buffer failed");this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,i),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,r,0),this.outputTextures.push(r),this.fbos.push(i)}this.gl.viewport(0,0,e,t),this.originalFrameWidth=e,this.originalFrameHeight=t}}class gz{constructor(){iw(this,"targetFrameRate",0),iw(this,"recordedFrameCount",0),iw(this,"recordingTime",2),iw(this,"recordID",void 0)}async startRecordBeautyEffectOutput(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;if(this.recordID)throw new eD(ZN.UNEXPECTED_ERROR,"another beauty effect recording is in progress");const n=Sj(6,"");return this.recordID=n,this.targetFrameRate=e,this.recordedFrameCount=0,this.recordingTime=t,await vj(1e3*this.recordingTime),this.recordID!==n?(this.recordID=void 0,!0):(this.recordID=void 0,this.recordedFrameCount<this.targetFrameRate*this.recordingTime/2?(uD.warning("detect beauty effect overload, current framerate",this.recordedFrameCount/2),!1):(uD.debug("beauty effect current framerate",this.recordedFrameCount/2),!0))}stopRecordBeautyEffectOutput(){this.targetFrameRate=0,this.recordedFrameCount=0,this.recordID=void 0}addFrame(){this.recordID&&(this.recordedFrameCount+=1)}}class _z extends X$.exports.VideoProcessor{constructor(){super(),iw(this,"name","BeautyProcessor"),iw(this,"fps",15),iw(this,"canvas",void 0),iw(this,"video",void 0),iw(this,"manager",void 0),iw(this,"overloadDetector",new gz),iw(this,"stopChromeBackgroundLoop",null),iw(this,"onOverload",void 0),iw(this,"stopLoop",void 0),iw(this,"lastRenderTime",0),this.fps=30,this.manager=new Ez,this._enabled=!1}async onEnableChange(e){this.manager.setEnableBeauty(e),this.context&&this.inputTrack&&(e?await this.startEffect(this.inputTrack,this.context):await this.stopEffect(this.inputTrack,this.context))}async setBeautyEffectOptions(e){if(function(e){void 0!==e.smoothnessLevel&&XL(e.smoothnessLevel,"options.smoothnessLevel",0,1,!1),void 0!==e.lighteningLevel&&XL(e.lighteningLevel,"options.lighteningLevel",0,1,!1),void 0!==e.rednessLevel&&XL(e.rednessLevel,"options.rednessLevel",0,1,!1),void 0!==e.lighteningContrastLevel&&JL(e.lighteningContrastLevel,"options.lighteningContrastLevel",[0,1,2])}(e),void 0!==e.smoothnessLevel){const t=Math.max(.1,10*e.smoothnessLevel);this.manager.setDenoiseLevel(t)}if(void 0!==e.lighteningLevel){const t=Math.max(.1,e.lighteningLevel/2);this.manager.setLightLevel(t)}if(void 0!==e.rednessLevel){const t=Math.max(.01,e.rednessLevel);this.manager.setRednessLevel(t)}if(void 0!==e.lighteningContrastLevel){const t=e.lighteningContrastLevel;this.manager.setContrastLevel(t)}}async onTrack(e,t){var n;this.video&&this.enabled&&(null===(n=this.stopLoop)||void 0===n||n.call(this),await this.stopEffect(e,t)),await this.startEffect(e,t)}async startEffect(e,t){if(!this.enabled)return;const n=wb(),r=await this.renderWithWebGL(e);this.output(r,t),uD.info("start video effect, output:",this.outputTrack),this.overloadDetector.startRecordBeautyEffectOutput(this.fps).then((e=>{e||this.onOverload&&this.onOverload()}));let i=!1;this.stopLoop=()=>{i=!0};const o=()=>{this.enabled&&!i&&requestAnimationFrame(o);const e=Date.now(),t=1e3/this.fps,n=this.lastRenderTime?e-this.lastRenderTime:t;n<t||(this.lastRenderTime=e-(n-t),this.video&&this.video.paused&&this.video.play(),this.enabled&&this.video&&(this.manager.render(this.video),this.outputTrack&&this.outputTrack.requestFrame&&this.outputTrack.requestFrame(),this.overloadDetector.addFrame()))};requestAnimationFrame(o),n.name===Sb.CHROME&&document.addEventListener("visibilitychange",(()=>{document.hidden?this.stopChromeBackgroundLoop=BG((()=>{this.enabled&&this.video&&this.manager.render(this.video),this.outputTrack&&this.outputTrack.requestFrame&&this.outputTrack.requestFrame(),this.overloadDetector.addFrame()}),this.fps):this.stopChromeBackgroundLoop&&(this.stopChromeBackgroundLoop(),this.stopChromeBackgroundLoop=null)}),!1)}async renderWithWebGL(e){this.canvas&&(this.canvas.remove(),this.canvas=void 0),this.video&&(this.video.remove(),this.video=void 0),this.canvas=document.createElement("canvas"),this.video=document.createElement("video"),this.video.setAttribute("autoplay",""),this.video.setAttribute("muted",""),this.video.muted=!0,this.video.setAttribute("playsinline",""),this.video.setAttribute("style","display:none"),this.video.srcObject=new MediaStream([e]);const t=new xv((e=>{const t=()=>{this.video&&this.video.removeEventListener("playing",t),e(void 0)};this.video&&this.video.addEventListener("playing",t)}));this.video.play(),await t;const n=e.getSettings(),r=n.width||this.video.videoWidth,i=n.height||this.video.videoHeight;if(n.frameRate&&this.fps!==n.frameRate&&(this.fps=n.frameRate,uD.debug("beauty video processor: set fps to",this.fps)),uD.debug("beauty video processor: width ".concat(r," height ").concat(i)),!r||!i)throw new eD(ZN.BEAUTY_PROCESSOR_INTERNAL_ERROR,"can not get track resolution");this.canvas.width=r,this.canvas.height=i,this.video.setAttribute("width",r.toString()),this.video.setAttribute("height",i.toString()),this.manager.init(r,i,this.canvas);const o=Gk();return this.canvas.captureStream(o.supportRequestFrame?0:this.fps).getVideoTracks()[0]}async stopEffect(e,t){uD.info("stop video effect"),this.overloadDetector.stopRecordBeautyEffectOutput(),this.manager.release(),this.canvas&&this.canvas.remove(),this.video&&this.video.remove(),this.canvas=void 0,this.video=void 0,this.output(e,t)}}function mz(e){const t={};if(e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId}),!e.encoderConfig)return t;const n=QD(e.encoderConfig);return t.width=n.width,t.height=n.height,!Kb()&&n.frameRate&&(t.frameRate=n.frameRate),wb().name===Sb.EDGE&&"object"==typeof t.frameRate&&(t.frameRate.max=60),Ub()&&(t.frameRate={ideal:30,max:30}),t}function Iz(e){const t={};e.screenSourceType&&(t.mediaSource=e.screenSourceType),e.extensionId&&xb()&&(t.extensionId=e.extensionId),e.electronScreenSourceId&&(t.sourceId=e.electronScreenSourceId);const n=e.encoderConfig?jD(e.encoderConfig):null;return t.mandatory={chromeMediaSource:"desktop",maxWidth:n?n.width:void 0,maxHeight:n?n.height:void 0},n&&n.frameRate&&("number"==typeof n.frameRate?(t.mandatory.maxFrameRate=n.frameRate,t.mandatory.minFrameRate=n.frameRate):(t.mandatory.maxFrameRate=n.frameRate.max||n.frameRate.ideal||n.frameRate.exact||void 0,t.mandatory.minFrameRate=n.frameRate.min||n.frameRate.ideal||n.frameRate.exact||void 0),t.frameRate=n.frameRate),n&&n.width&&(t.width=n.width),n&&n.height&&(t.height=n.height),t}function Tz(e){const t={};if(Kb()||(void 0!==e.AGC&&(t.autoGainControl=e.AGC),void 0!==e.AEC&&(t.echoCancellation=e.AEC),void 0!==e.ANS&&(t.noiseSuppression=e.ANS,xb()&&e.ANS&&(t.googHighpassFilter=e.ANS))),e.encoderConfig){const n=YD(e.encoderConfig);t.channelCount=n.stereo?2:1,t.sampleRate=n.sampleRate,t.sampleSize=n.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),zb()&&(t.sampleRate=void 0),t}var Rz,vz;!function(e){e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE"}(Rz||(Rz={})),function(e){e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(vz||(vz={}));var yz,Sz,Cz,Oz,bz,wz,Nz,Dz,Lz,Pz,kz,xz,Mz,Uz,Bz,Fz,Vz,Gz,Qz,jz,Hz,Wz,Yz,Kz,$z,zz,qz=new class{constructor(){iw(this,"_clientSize",null),iw(this,"getClientWidth",(()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth)),iw(this,"getClientHeight",(()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight)),iw(this,"getStyle",(e=>window.getComputedStyle(e,null))),iw(this,"checkCssVisibleProperty",(e=>{let t=!0;const n=this.getStyle(e),{display:r,visibility:i,opacity:o,filter:s}=n;return("none"===r||["hidden","collapse"].includes(i)||Number(o)<.1)&&(t=!1),!!t&&(s&&s.split(" ").filter((e=>{const t=e.split("(")[0];return["brightness","blur","opacity"].includes(t)})).map((e=>{const[t,n]=e.split(/\(|\)/);return[t,Number(n.match(/^[0-9\.]+/))]})).forEach((e=>{const[n,r]=e;switch(n){case"brightness":(r<.1||r>3)&&(t=!1);break;case"blur":r>3&&(t=!1);break;case"opacity":r<.1&&(t=!1)}})),t)})),iw(this,"checkPropertyUpToAllParentNodes",((e,t)=>{let n=!0,r=!0;const i=e=>t(e);let o=e;for(;o&&r;)i(o)||(n=!1,r=!1),o=o.parentElement,o||(r=!1);return n})),iw(this,"checkActualCssVisibleIncludeInherit",(e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty))),iw(this,"getSizeAboutClient",(e=>{const{width:t,height:n,left:r,right:i,top:o,bottom:s}=e.getBoundingClientRect(),a=this.getClientWidth(),c=this.getClientHeight();return{width:t,height:n,left:r,right:i,top:o,bottom:s,clientWidth:a,clientHeight:c,clientMin:Math.min(a,c)}})),iw(this,"checkActualSize",(()=>{const{width:e,height:t,clientMin:n}=this._clientSize;return this.checkSizeIsVisible(e,t,n)})),iw(this,"elementFromPoint",((e,t)=>document.elementFromPoint?document.elementFromPoint(e,t):null)),iw(this,"checkCoverForAPoint",((e,t,n)=>{const r=this.elementFromPoint(e,t);return null!==r&&r!==n})),iw(this,"getPointPositionList",(()=>{const{width:e,height:t,left:n,top:r}=this._clientSize,i=e/6,o=t/6,s=[],a=10**6;for(let e=0;e<5;e++)for(let t=0;t<5;t++){const c=(n*a+(0===e?.1:4===e?(i*e*a-1e5)/a:i*e)*a)/a,u=(r*a+(0===t?.1:4===t?(o*t*a-1e5)/a:o*t)*a)/a;s.push({x:c,y:u})}return[...s]})),iw(this,"checkElementCover",(e=>this.getPointPositionList().map((t=>this.checkCoverForAPoint(t.x,t.y,e))).filter((e=>!!e)).length>6)),iw(this,"checkSizeIsVisible",((e,t,n)=>(e>50||n/e<=10)&&(t>50||n/t<=10))),iw(this,"checkSizeOfPartInClient",(()=>{const{left:e,right:t,top:n,bottom:r,clientHeight:i,clientWidth:o,clientMin:s}=this._clientSize;let a,c,u,l;if(e<0)a=0;else{if(!(e<o))return!1;a=e}if(t<0)return!1;if(c=t<o?t:o,n<0)u=0;else{if(!(n<i))return!1;u=n}if(r<0)return!1;l=r<i?r:i;const d=c-a,h=l-u;return this.checkSizeIsVisible(d,h,s)})),iw(this,"returnHiddenResult",(e=>(this._clientSize=null,{visible:!1,reason:e}))),iw(this,"checkOneElementVisible",(e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(Rz.COVERED);{const e=this.checkActualSize(),t=this.checkSizeOfPartInClient();return e&&!t?this.returnHiddenResult(Rz.POSITION):e?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(Rz.SIZE)}}return this.returnHiddenResult(Rz.STYLE)}return this.returnHiddenResult(vz.UNMOUNTED)}return this.returnHiddenResult(vz.INVALID_HTML_ELEMENT)})),iw(this,"checkElementIsMountedOnDom",(e=>this.checkPropertyUpToAllParentNodes(e,(e=>"HTML"!==e.nodeName.toUpperCase()?null!==e.parentElement:!!document.documentElement))))}};function Jz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xz(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jz(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jz(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let Zz=(yz=PD("LocalVideoTrack","getTrackId"),Sz=sQ(),Cz=CG("LocalVideoTrack","_enabledMutex"),Oz=_G({className:"LocalVideoTrack"}),bz=sQ(),wz=CG("LocalVideoTrack","_enabledMutex"),Nz=_G({className:"LocalVideoTrack"}),Dz=sQ(),Lz=sQ(),Pz=sQ(),kz=sQ(),xz=sQ(),Mz=sQ(),Uz=sQ(),Bz=sQ(),Fz=sQ(),yz((YV((Gz=class e extends OG{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==lP.PLAYING)}constructor(e,t,n,r,i,o){super(e,i),iw(this,"trackMediaType","video"),iw(this,"_player",void 0),iw(this,"_videoBeautyProcessor",void 0),iw(this,"_videoVisibleTimer",null),iw(this,"_previousVideoVisibleStatus",void 0),iw(this,"_clearPreviousVideoVisibleStatus",(()=>this._previousVideoVisibleStatus=void 0)),iw(this,"_encoderConfig",void 0),iw(this,"_scalabiltyMode",{numSpatialLayers:1,numTemporalLayers:1}),iw(this,"_optimizationMode",void 0),iw(this,"_videoHeight",void 0),iw(this,"_videoWidth",void 0),iw(this,"_forceBitrateLimit",void 0),iw(this,"_enabled",!0),iw(this,"processorDestination",void 0),iw(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this._encoderConfig=t,this._scalabiltyMode=n,this._optimizationMode=r,this._hints=o||[],-1===this._hints.indexOf(fk.SCREEN_TRACK)&&this.updateBitrateFromProfile(),this.processorContext=new YQ(this.getTrackId()),this.processorDestination=new WQ(this.processorContext),this.bindProcessorDestinationEvents()}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.LOCAL_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof e?e:"HTMLElement",t]});if("string"==typeof e){const t=document.getElementById(e);t?e=t:(uD.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),CD("warning",this,'can not find "#'.concat(e,'" element, use document.body')),e=document.body)}uD.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(t)),ND("debug",this,"play",t);const r=Xz(Xz(Xz({},this._getDefaultPlayerConfig()),t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(r):(this._player=new z$(r),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval((()=>{try{const e=this.getVideoElementVisibleStatus();this.emit(gk.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}}),$D("CHECK_VIDEO_VISIBLE_INTERVAL")),n.onSuccess()}stop(){const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.LOCAL_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return e.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,uD.debug("[".concat(this.getTrackId(),"] stop video playback")),ND("debug",this,"stop"),e.onSuccess()}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(uD.info("[".concat(this.getTrackId(),"] start setEnabled"),e),ND("info",this,"setEnabled",e),!e){this._originMediaStreamTrack.enabled=!1;try{await Dj(this,pk.NEED_DISABLE_TRACK,this)}catch(t){throw uD.error("[".concat(this.getTrackId(),"] setEnabled to false error"),t.toString()),ND("error",this,"setEnabled",e,t.toString()),t}return t||(this._enabled=!1),uD.info("[".concat(this.getTrackId(),"] setEnabled to false success")),void ND("info",this,"setEnabled",e,"success")}this._originMediaStreamTrack.enabled=!0;try{await Dj(this,pk.NEED_ENABLE_TRACK,this)}catch(t){throw uD.error("[".concat(this.getTrackId(),"] setEnabled to true error"),t.toString()),ND("error",this,"setEnabled",e,t.toString()),t}uD.info("[".concat(this.getTrackId(),"] setEnabled to true success")),ND("info",this,"setEnabled",e,"success"),t||(this._enabled=!0)}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,uD.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),ND("debug",this,"setMuted",e),e?await Dj(this,pk.NEED_MUTE_TRACK,this):await Dj(this,pk.NEED_UNMUTE_TRACK,this))}getStats(){return Fj((()=>{uD.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead"),CD("warning",this,"[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")}),"localVideoTrackGetStatsWarning"),Lj(this,pk.GET_STATS)||Xz({},HP)}async setBeautyEffect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.LOCAL_VIDEO_TRACK_BEAUTY,options:[this.getTrackId(),e,t]});if(e||this._videoBeautyProcessor){if(Pb()===yb.IOS||Pb()===yb.ANDROID){const e=new eD(ZN.INVALID_OPERATION,"can not enable beauty effect on mobile device");throw n.onError(e),e}if(!this._enabled&&e){const e=new eD(ZN.TRACK_IS_DISABLED,"can not enable beauty effect when track is disabled");throw n.onError(e),e}if(uD.info("[".concat(this.getTrackId(),"] start setBeautyEffect"),e,JSON.stringify(t)),ND("info",this,"setBeautyEffect",[e,t]),this._videoBeautyProcessor||e){try{if(!this._videoBeautyProcessor)if(this._videoBeautyProcessor=new _z,this.processor){const e=this.processor;this.pipe(this._videoBeautyProcessor).pipe(e)}else this.pipe(this._videoBeautyProcessor).pipe(this.processorDestination);await this._videoBeautyProcessor.setBeautyEffectOptions(t),e?await this._videoBeautyProcessor.enable():await this._videoBeautyProcessor.disable()}catch(r){throw uD.error("[".concat(this.getTrackId(),"] setBeautyEffect error"),r.toString()),ND("info",this,"setBeautyEffect",[e,t]),n.onError(r),r}uD.info("[".concat(this.getTrackId(),"] setBeautyEffect success")),ND("info",this,"setBeautyEffect",[e,t],"success"),n.onSuccess()}else n.onSuccess()}}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(e,t):await W$(e)}clone(t,n,r,i){const o=this._mediaStreamTrack.clone();return new e(o,t,n,r,i)}async setBitrateLimit(e){if(uD.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(e))),ND("debug",this,"setBitrateLimit",e),e){this._forceBitrateLimit=e,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<e.max_bitrate?this._encoderConfig.bitrateMax:e.max_bitrate:this._encoderConfig.bitrateMax=e.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=e.min_bitrate);try{await Dj(this,pk.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw()}}}async setOptimizationMode(e){if("motion"!==e&&"detail"!==e&&"balanced"!==e)return uD.error(ZN.INVALID_PARAMS,"optimization mode must be motion, detail or balanced"),void ND("error",this,"setOptimizationMode",e,ZN.INVALID_PARAMS);const t=this._optimizationMode;try{this._optimizationMode=e,await Dj(this,pk.SET_OPTIMIZATION_MODE,this)}catch(n){throw this._optimizationMode=t,uD.error("[".concat(this.getTrackId(),"] set optimization mode failed"),n.toString()),ND("error",this,"setOptimizationMode",e,n.toString()),n}uD.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(e,")")),ND("info",this,"setOptimizationMode",e,"success")}setScalabiltyMode(e){if(1===e.numSpatialLayers&&1!==e.numTemporalLayers)return uD.error(ZN.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),ND("error",this,"setScalabiltyMode",e,ZN.INVALID_PARAMS),void(this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabiltyMode=e,uD.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(e,")")),ND("info",this,"setScalabiltyMode",e,"success")}updateMediaStreamTrackResolution(){bj(this._originMediaStreamTrack).then((e=>{let[t,n]=e;this._videoHeight=n,this._videoWidth=t})).catch(Oj)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:e,height:t,frameRate:n}=this.getMediaStreamTrackSettings();if(!e||!t||!n)return;const[r,i]=function(e,t,n){const r=$D("BITRATE_ADAPTER_TYPE");let i;const o=200*Math.pow(n/15,.6)*Math.pow(e*t/640/360,.75),s=o;if("STANDARD_BITRATE"===r)i=4*o;else{if("COMPATIABLE_BITRATE"!==r)return;i=2*o}return[Math.floor(i),Math.floor(s)]}(e,t,n)||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=i,this._encoderConfig.bitrateMax=r,uD.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(e,", h: ").concat(t,", fps: ").concat(n,"] => [brMax: ").concat(r,", brMin: ").concat(i,"]")),ND("debug",this,"updateBitrateFromProfile",void 0,"[w: ".concat(e,", h: ").concat(t,", fps: ").concat(n,"] => [brMax: ").concat(r,", brMin: ").concat(i,"]")))}getVideoElementVisibleStatus(){try{var e,t;const n=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),r={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==n?void 0:n.parentElement},{element:i,slot:o}=r;if(this.isPlaying&&i instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=qz.checkOneElementVisible(i),t=Object.assign({},e);if(t.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=t.visible;const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});t.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(t.reason))}return t}return}catch(e){throw new eD(ZN.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}async renewMediaStreamTrack(e){}pipe(e){if(this._videoBeautyProcessor&&e!==this._videoBeautyProcessor)return this._videoBeautyProcessor.pipe(e);if(this.processor===e)return e;if(e._source)throw new eD(ZN.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;if(this._videoBeautyProcessor&&this.processor===this._videoBeautyProcessor)return void this._videoBeautyProcessor.unpipe();const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}bindProcessorDestinationEvents(){this.processorDestination.on(xk.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(),await Dj(this,pk.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await Dj(this,pk.NEED_REPLACE_TRACK,this))}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(xk.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(Mk.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(Mk.REQUEST_CONSTRAINTS)}}).prototype,"play",[Sz],Object.getOwnPropertyDescriptor(Gz.prototype,"play"),Gz.prototype),YV(Gz.prototype,"setEnabled",[Cz,Oz,bz],Object.getOwnPropertyDescriptor(Gz.prototype,"setEnabled"),Gz.prototype),YV(Gz.prototype,"setMuted",[wz,Nz,Dz],Object.getOwnPropertyDescriptor(Gz.prototype,"setMuted"),Gz.prototype),YV(Gz.prototype,"getStats",[Lz],Object.getOwnPropertyDescriptor(Gz.prototype,"getStats"),Gz.prototype),YV(Gz.prototype,"setBeautyEffect",[Pz],Object.getOwnPropertyDescriptor(Gz.prototype,"setBeautyEffect"),Gz.prototype),YV(Gz.prototype,"getCurrentFrameData",[kz],Object.getOwnPropertyDescriptor(Gz.prototype,"getCurrentFrameData"),Gz.prototype),YV(Gz.prototype,"getCurrentFrameImage",[xz],Object.getOwnPropertyDescriptor(Gz.prototype,"getCurrentFrameImage"),Gz.prototype),YV(Gz.prototype,"setBitrateLimit",[Mz],Object.getOwnPropertyDescriptor(Gz.prototype,"setBitrateLimit"),Gz.prototype),YV(Gz.prototype,"setOptimizationMode",[Uz],Object.getOwnPropertyDescriptor(Gz.prototype,"setOptimizationMode"),Gz.prototype),YV(Gz.prototype,"setScalabiltyMode",[Bz],Object.getOwnPropertyDescriptor(Gz.prototype,"setScalabiltyMode"),Gz.prototype),YV(Gz.prototype,"updateMediaStreamTrackResolution",[Fz],Object.getOwnPropertyDescriptor(Gz.prototype,"updateMediaStreamTrackResolution"),Gz.prototype),Vz=Gz))||Vz),eq=(Qz=PD("CameraVideoTrack","getTrackId"),jz=sQ(),Hz=CG("CameraVideoTrack","_enabledMutex"),Wz=_G({className:"CameraVideoTrack"}),Yz=sQ(),Kz=sQ(),Qz((YV((zz=class extends Zz{constructor(e,t,n,r,i,o){super(e,t.encoderConfig?QD(t.encoderConfig):{},r,i,o),iw(this,"_config",void 0),iw(this,"_originalConstraints",void 0),iw(this,"_constraints",void 0),iw(this,"_enabled",!0),iw(this,"_deviceName","default"),iw(this,"tryResumeVideoForIOS15WeChat",(async()=>{Gb()&&!Hb()&&Yb()&&this._enabled&&!this._isClosed&&(uD.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())})),LD("info",this,"constructor",{trackId:o,deviceId:e.label,constraints:n,config:t}),this._config=t,this._originalConstraints=n,this._constraints=n,this._deviceName=e.label,this._config.encoderConfig&&(this._encoderConfig=QD(this._config.encoderConfig)),kG.on(TG.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),kG.on(TG.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),this.bindProcessorContextEvents()}async setDevice(e){const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CAM_VIDEO_TRACK_SET_DEVICE,options:[this.getTrackId(),e]});if(uD.info("[".concat(this.getTrackId(),"] set device to ").concat(e)),ND("info",this,"setDevice",e),this._enabled)try{const n=await tQ.getDeviceById(e),r={};r.video=Xz({},this._constraints),r.video.deviceId={exact:e},r.video.facingMode=void 0,this._originMediaStreamTrack.stop();let i=null;try{i=await JG(r,this.getTrackId())}catch(t){throw uD.error("[".concat(this.getTrackId(),"] setDevice failed"),t.toString()),ND("error",this,"setDevice",e,t.toString()),i=await JG({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1),t}await this._updateOriginMediaStreamTrack(i.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=n.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(n){throw t.onError(n),uD.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),ND("error",this,"setDevice",e,n.toString()),n}else try{const t=await tQ.getDeviceById(e);this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(n){throw t.onError(n),uD.error("[".concat(this.getTrackId(),"] setDevice error"),n.toString()),ND("error",this,"setDevice",e,n.toString()),n}uD.info("[".concat(this.getTrackId(),"] setDevice success")),ND("info",this,"setDevice",e,"success"),t.onSuccess()}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(uD.info("[".concat(this.getTrackId(),"] start setEnabled"),e),ND("info",this,"setEnabled",e),!e){this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),t||(this._enabled=!1);try{await Dj(this,pk.NEED_DISABLE_TRACK,this)}catch(t){throw uD.error("[".concat(this.getTrackId(),"] setEnabled to false error"),t.toString()),ND("error",this,"setEnabled",e,t.toString()),t}return uD.info("[".concat(this.getTrackId(),"] setEnabled to false success")),void ND("info",this,"setEnabled",e,"success")}const n=Xz({},this._constraints),r=tQ.searchDeviceIdByName(this._deviceName);r&&!n.deviceId&&(n.deviceId={exact:r});try{const e=await JG({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),await Dj(this,pk.NEED_ENABLE_TRACK,this)}catch(t){throw uD.error("[".concat(this.getTrackId(),"] setEnabled true error"),t.toString()),ND("error",this,"setEnabled",e,t.toString()),t}this.updateMediaStreamTrackResolution(),uD.info("[".concat(this.getTrackId(),"] setEnabled to true success")),ND("info",this,"setEnabled",e,"success"),t||(this._enabled=!0)}async setEncoderConfiguration(e,t){const n=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG,options:[this.getTrackId(),e]});if(!this._enabled){const e=new eD(ZN.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");throw n.onError(e),e}e=QD(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin);const r=Uj(this._config);r.encoderConfig=e;const i=mz(r);(Mb()||Bb()||Wb())&&(i.deviceId=void 0),uD.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(i)),ND("debug",this,"setEncoderConfiguration",e);try{await this._originMediaStreamTrack.applyConstraints(i),this.updateMediaStreamTrackResolution()}catch(e){const t=new eD(ZN.UNEXPECTED_ERROR,e.toString());throw uD.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),ND("error",this,"setEncoderConfiguration",e.toString()),n.onError(t),t}this._config=r,this._constraints=i,this._originalConstraints=i,this._encoderConfig=e,-1===this._hints.indexOf(fk.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await Dj(this,pk.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return n.onError(e),e.throw()}n.onSuccess()}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((Bb()||Wb())&&this._enabled&&!this._isClosed&&kG.duringInterruption){const e=async()=>{kG.off(TG.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(uD.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),CD("debug",this,"try capture camera media device for interrupted iOS device."),await this.setEnabled(!1),await this.setEnabled(!0))};kG.on(TG.IOS_INTERRUPTION_END,e)}else uD.debug("[".concat(this.getTrackId(),"] track ended")),wD("debug",["MediaStreamTrack",this.getTrackId()],"ended"),this.emit(gk.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,n=tQ.searchDeviceIdByName(this._deviceName);n&&!t.deviceId&&(t.deviceId={exact:n});const r=await JG({video:t},this.getTrackId());this._constraints=t,await this._updateOriginMediaStreamTrack(r.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}close(){super.close(),kG.off(TG.IOS_15_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat),kG.off(TG.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15WeChat)}bindProcessorContextEvents(){this.processorContext.on(Mk.REQUEST_UPDATE_CONSTRAINTS,(async(e,t,n)=>{try{const n=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(n),t()}catch(e){n(e)}})),this.processorContext.on(Mk.REQUEST_CONSTRAINTS,(async e=>{e(this._originMediaStreamTrack.getSettings())}))}}).prototype,"setDevice",[jz],Object.getOwnPropertyDescriptor(zz.prototype,"setDevice"),zz.prototype),YV(zz.prototype,"setEnabled",[Hz,Wz,Yz],Object.getOwnPropertyDescriptor(zz.prototype,"setEnabled"),zz.prototype),YV(zz.prototype,"setEncoderConfiguration",[Kz],Object.getOwnPropertyDescriptor(zz.prototype,"setEncoderConfiguration"),zz.prototype),$z=zz))||$z);class tq{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio)return this._audioTrack}get videoTrack(){if(this.hasVideo)return this._videoTrack}constructor(e,t){iw(this,"uid",void 0),iw(this,"_uintid",void 0),iw(this,"_trust_in_room_",!0),iw(this,"_trust_audio_enabled_state_",!0),iw(this,"_trust_video_enabled_state_",!0),iw(this,"_trust_audio_mute_state_",!0),iw(this,"_trust_video_mute_state_",!0),iw(this,"_audio_muted_",!1),iw(this,"_video_muted_",!1),iw(this,"_audio_enabled_",!0),iw(this,"_video_enabled_",!0),iw(this,"_audio_added_",!1),iw(this,"_video_added_",!1),iw(this,"_trust_video_stream_added_state_",!0),iw(this,"_trust_audio_stream_added_state_",!0),iw(this,"_audioTrack",void 0),iw(this,"_videoTrack",void 0),iw(this,"_audioSSRC",void 0),iw(this,"_videoSSRC",void 0),iw(this,"_audioOrtc",void 0),iw(this,"_videoOrtc",void 0),iw(this,"_cname",void 0),iw(this,"_rtxSsrcId",void 0),this.uid=e,this._uintid=t}}var nq=kv,rq=PT,iq=GT;Ud({target:"Promise",stat:!0},{try:function(e){var t=rq.f(this),n=iq(e);return(n.error?t.reject:t.resolve)(n.value),t.promise}});var oq=nq,sq=Ud,aq=Lc,cq=Rc,uq=VF,lq=pu,dq=il,hq=jd,pq=aL,fq=KF,Aq=CV,Eq=Ou,gq=vl("isConcatSpreadable"),_q=9007199254740991,mq="Maximum allowed index exceeded",Iq=aq.TypeError,Tq=Eq>=51||!cq((function(){var e=[];return e[gq]=!1,e.concat()[0]!==e})),Rq=Aq("concat"),vq=function(e){if(!lq(e))return!1;var t=e[gq];return void 0!==t?!!t:uq(e)};sq({target:"Array",proto:!0,forced:!Tq||!Rq},{concat:function(e){var t,n,r,i,o,s=dq(this),a=fq(s,0),c=0;for(t=-1,r=arguments.length;t<r;t++)if(vq(o=-1===t?s:arguments[t])){if(c+(i=hq(o))>_q)throw Iq(mq);for(n=0;n<i;n++,c++)n in o&&pq(a,c,o[n])}else{if(c>=_q)throw Iq(mq);pq(a,c++,o)}return a.length=c,a}});var yq={},Sq=eu,Cq=du,Oq=qA.f,bq=pL,wq="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];yq.f=function(e){return wq&&"Window"==Sq(e)?function(e){try{return Oq(e)}catch(e){return bq(wq)}}(e):Oq(Cq(e))};var Nq={},Dq=vl;Nq.f=Dq;var Lq=fu,Pq=al,kq=Nq,xq=cd.f,Mq=function(e){var t=Lq.Symbol||(Lq.Symbol={});Pq(t,e)||xq(t,e,{value:kq.f(e)})},Uq=Ud,Bq=Lc,Fq=mu,Vq=Uc,Gq=jc,Qq=wc,jq=Vc,Hq=Nu,Wq=Rc,Yq=al,Kq=VF,$q=Bc,zq=pu,qq=Nc,Jq=Uu,Xq=fd,Zq=il,eJ=du,tJ=Pl,nJ=qg,rJ=qc,iJ=qE,oJ=NE,sJ=qA,aJ=yq,cJ=EE,uJ=Fc,lJ=cd,dJ=OE,hJ=Hc,pJ=kI,fJ=nm,AJ=qu.exports,EJ=sE,gJ=hl,_J=vl,mJ=Nq,IJ=Mq,TJ=Im,RJ=$_,vJ=tV.forEach,yJ=LA("hidden"),SJ="Symbol",CJ=_J("toPrimitive"),OJ=RJ.set,bJ=RJ.getterFor(SJ),wJ=Object.prototype,NJ=Bq.Symbol,DJ=NJ&&NJ.prototype,LJ=Bq.TypeError,PJ=Bq.QObject,kJ=Fq("JSON","stringify"),xJ=uJ.f,MJ=lJ.f,UJ=aJ.f,BJ=hJ.f,FJ=Qq([].push),VJ=AJ("symbols"),GJ=AJ("op-symbols"),QJ=AJ("string-to-symbol-registry"),jJ=AJ("symbol-to-string-registry"),HJ=AJ("wks"),WJ=!PJ||!PJ.prototype||!PJ.prototype.findChild,YJ=jq&&Wq((function(){return 7!=iJ(MJ({},"a",{get:function(){return MJ(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=xJ(wJ,t);r&&delete wJ[t],MJ(e,t,n),r&&e!==wJ&&MJ(wJ,t,r)}:MJ,KJ=function(e,t){var n=VJ[e]=iJ(DJ);return OJ(n,{type:SJ,tag:e,description:t}),jq||(n.description=t),n},$J=function(e,t,n){e===wJ&&$J(GJ,t,n),Xq(e);var r=tJ(t);return Xq(n),Yq(VJ,r)?(n.enumerable?(Yq(e,yJ)&&e[yJ][r]&&(e[yJ][r]=!1),n=iJ(n,{enumerable:rJ(0,!1)})):(Yq(e,yJ)||MJ(e,yJ,rJ(1,{})),e[yJ][r]=!0),YJ(e,r,n)):MJ(e,r,n)},zJ=function(e,t){Xq(e);var n=eJ(t),r=oJ(n).concat(ZJ(n));return vJ(r,(function(t){jq&&!Gq(qJ,n,t)||$J(e,t,n[t])})),e},qJ=function(e){var t=tJ(e),n=Gq(BJ,this,t);return!(this===wJ&&Yq(VJ,t)&&!Yq(GJ,t))&&(!(n||!Yq(this,t)||!Yq(VJ,t)||Yq(this,yJ)&&this[yJ][t])||n)},JJ=function(e,t){var n=eJ(e),r=tJ(t);if(n!==wJ||!Yq(VJ,r)||Yq(GJ,r)){var i=xJ(n,r);return!i||!Yq(VJ,r)||Yq(n,yJ)&&n[yJ][r]||(i.enumerable=!0),i}},XJ=function(e){var t=UJ(eJ(e)),n=[];return vJ(t,(function(e){Yq(VJ,e)||Yq(EJ,e)||FJ(n,e)})),n},ZJ=function(e){var t=e===wJ,n=UJ(t?GJ:eJ(e)),r=[];return vJ(n,(function(e){!Yq(VJ,e)||t&&!Yq(wJ,e)||FJ(r,VJ[e])})),r};if(Hq||(fJ(DJ=(NJ=function(){if(qq(DJ,this))throw LJ("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?nJ(arguments[0]):void 0,t=gJ(e),n=function(e){this===wJ&&Gq(n,GJ,e),Yq(this,yJ)&&Yq(this[yJ],t)&&(this[yJ][t]=!1),YJ(this,t,rJ(1,e))};return jq&&WJ&&YJ(wJ,t,{configurable:!0,set:n}),KJ(t,e)}).prototype,"toString",(function(){return bJ(this).tag})),fJ(NJ,"withoutSetter",(function(e){return KJ(gJ(e),e)})),hJ.f=qJ,lJ.f=$J,dJ.f=zJ,uJ.f=JJ,sJ.f=aJ.f=XJ,cJ.f=ZJ,mJ.f=function(e){return KJ(_J(e),e)},jq&&MJ(DJ,"description",{configurable:!0,get:function(){return bJ(this).description}})),Uq({global:!0,wrap:!0,forced:!Hq,sham:!Hq},{Symbol:NJ}),vJ(oJ(HJ),(function(e){IJ(e)})),Uq({target:SJ,stat:!0,forced:!Hq},{for:function(e){var t=nJ(e);if(Yq(QJ,t))return QJ[t];var n=NJ(t);return QJ[t]=n,jJ[n]=t,n},keyFor:function(e){if(!Jq(e))throw LJ(e+" is not a symbol");if(Yq(jJ,e))return jJ[e]},useSetter:function(){WJ=!0},useSimple:function(){WJ=!1}}),Uq({target:"Object",stat:!0,forced:!Hq,sham:!jq},{create:function(e,t){return void 0===t?iJ(e):zJ(iJ(e),t)},defineProperty:$J,defineProperties:zJ,getOwnPropertyDescriptor:JJ}),Uq({target:"Object",stat:!0,forced:!Hq},{getOwnPropertyNames:XJ,getOwnPropertySymbols:ZJ}),Uq({target:"Object",stat:!0,forced:Wq((function(){cJ.f(1)}))},{getOwnPropertySymbols:function(e){return cJ.f(Zq(e))}}),kJ&&Uq({target:"JSON",stat:!0,forced:!Hq||Wq((function(){var e=NJ();return"[null]"!=kJ([e])||"{}"!=kJ({a:e})||"{}"!=kJ(Object(e))}))},{stringify:function(e,t,n){var r=pJ(arguments),i=t;if((zq(t)||void 0!==e)&&!Jq(e))return Kq(t)||(t=function(e,t){if($q(i)&&(t=Gq(i,this,e,t)),!Jq(t))return t}),r[1]=t,Vq(kJ,null,r)}}),!DJ[CJ]){var eX=DJ.valueOf;fJ(DJ,CJ,(function(e){return Gq(eX,this)}))}TJ(NJ,SJ),EJ[yJ]=!0,Mq("asyncIterator"),Mq("hasInstance"),Mq("isConcatSpreadable"),Mq("iterator"),Mq("match"),Mq("matchAll"),Mq("replace"),Mq("search"),Mq("species"),Mq("split"),Mq("toPrimitive"),Mq("toStringTag"),Mq("unscopables"),Im(Lc.JSON,"JSON",!0);var tX=fu.Symbol;Mq("asyncDispose"),Mq("dispose"),Mq("matcher"),Mq("metadata"),Mq("observable"),Mq("patternMatch"),Mq("replaceAll");var nX=tX,rX=Nq.f("asyncIterator"),iX=rX;function oX(e){this.wrapped=e}function sX(e){var t,n;function r(t,n){try{var o=e[t](n),s=o.value,a=s instanceof oX;oq.resolve(a?s.wrapped:s).then((function(e){a?r("return"===t?"return":"next",e):i(o.done?"return":"normal",e)}),(function(e){r("throw",e)}))}catch(e){i("throw",e)}}function i(e,i){switch(e){case"return":t.resolve({value:i,done:!0});break;case"throw":t.reject(i);break;default:t.resolve({value:i,done:!1})}(t=t.next)?r(t.key,t.arg):n=null}this._invoke=function(e,i){return new oq((function(o,s){var a={key:e,arg:i,resolve:o,reject:s,next:null};n?n=n.next=a:(t=n=a,r(e,i))}))},"function"!=typeof e.return&&(this.return=void 0)}function aX(e){return function(){return new sX(e.apply(this,arguments))}}function cX(e){return new oX(e)}sX.prototype["function"==typeof nX&&iX||"@@asyncIterator"]=function(){return this},sX.prototype.next=function(e){return this._invoke("next",e)},sX.prototype.throw=function(e){return this._invoke("throw",e)},sX.prototype.return=function(e){return this._invoke("return",e)};var uX=Nq.f("iterator");function lX(e,t){var n={},r=!1;function i(n,i){return r=!0,i=new oq((function(t){t(e[n](i))})),{done:!1,value:t(i)}}return n[void 0!==nX&&uX||"@@iterator"]=function(){return this},n.next=function(e){return r?(r=!1,e):i("next",e)},"function"==typeof e.throw&&(n.throw=function(e){if(r)throw r=!1,e;return i("throw",e)}),"function"==typeof e.return&&(n.return=function(e){return r?(r=!1,e):i("return",e)}),n}var dX=rX,hX=Gr,pX=s,fX=r,AX=v,EX=Me,gX=F,_X=Y,mX=ph,IX=yt.f,TX=yr,RX=fX.Symbol,vX=RX&&RX.prototype;if(pX&&gX(RX)&&(!("description"in vX)||void 0!==RX().description)){var yX={},SX=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:mX(arguments[0]),t=_X(vX,this)?new RX(e):void 0===e?RX():RX(e);return""===e&&(yX[t]=!0),t};TX(SX,RX),SX.prototype=vX,vX.constructor=SX;var CX="Symbol(test)"==String(RX("test")),OX=AX(vX.toString),bX=AX(vX.valueOf),wX=/^Symbol\((.*)\)[^)]+$/,NX=AX("".replace),DX=AX("".slice);IX(vX,"description",{configurable:!0,get:function(){var e=bX(this),t=OX(e);if(EX(yX,e))return"";var n=CX?DX(t,7,-1):NX(t,wX,"$1");return""===n?void 0:n}}),hX({global:!0,forced:!0},{Symbol:SX})}var LX={exports:{}};function PX(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PX(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PX(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xX(e,t,n,r,i,o,s){let a=[],c=[],u=[],l=[],d=!1,h=!1;if(LX.exports.parse(e).mediaDescriptions.forEach((e=>{s&&s!==e.attributes.direction||("video"!==e.media.mediaType||d||(c=e.attributes.payloads,l=e.attributes.extmaps,d=!0),"audio"!==e.media.mediaType||h||(a=e.attributes.payloads,u=e.attributes.extmaps,h=!0))})),!l||0===c.length)throw new Error("Cannot get video capabilities from SDP.");if(!u||0===a.length)throw new Error("Cannot get audio capabilities from SDP.");return c.forEach((e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=parseInt(e.rtpMap.clockRate))})),a.forEach((e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=parseInt(e.rtpMap.clockRate))})),t&&(a=a.filter((e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())})),c=c.filter((e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())}))),n&&(c=c.filter((e=>{var t;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")}))),r&&(a=a.filter((e=>{var t;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")}))),i&&(null==i?void 0:i.length)>0&&(a=a.filter((e=>{var t;return i.includes((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")}))),o&&(null==o?void 0:o.length)>0&&(c=c.filter((e=>{var t;return o.includes((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")}))),{audioCodecs:a,videoCodecs:c,audioExtensions:u,videoExtensions:l}}function MX(e){const t=LX.exports.parse(e);let n,r;for(const e of t.mediaDescriptions){if(!n){const t=e.attributes.iceUfrag,r=e.attributes.icePwd;if(!t||!r)throw new Error("Cannot get iceUfrag or icePwd from SDP.");n={iceUfrag:t,icePwd:r}}if(!r){const t=e.attributes.fingerprints;t.length>0&&(r={fingerprints:t})}}if(!r&&t.attributes.fingerprints.length>0&&(r={fingerprints:t.attributes.fingerprints}),!r||!n)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:n,dtlsParameters:r}}function UX(e,t){const{cname:n}=e;let r;t&&t.ip&&"number"==typeof t.port?(r=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip,port:t.port.toString(),type:"host",extension:{}}],uD.debug("Using remote candidate from AP ".concat(t.ip,":").concat(t.port)),CD("debug",[],"Using remote candidate from AP ".concat(t.ip,":").concat(t.port)),t.ip6&&(r.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip6,port:t.port.toString(),type:"host",extension:{}}),uD.debug("Using IPV6 remote candidate from AP ".concat(t.ip6,":").concat(t.port)),CD("debug",[],"Using IPV6 remote candidate from AP ".concat(t.ip6,":").concat(t.port)))):r=e.iceParameters.candidates.map((e=>({foundation:e.foundation,componentId:"1",transport:e.protocol,priority:e.priority.toString(),connectionAddress:e.ip,port:e.port.toString(),type:e.type,extension:{}})));const i={fingerprints:e.dtlsParameters.fingerprints.map((e=>({hashFunction:e.algorithm,fingerprint:e.fingerprint})))},o={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let s;switch(e.dtlsParameters.role){case"server":s="passive";break;case"client":s="active";break;case"auto":s="actpass"}return{dtlsParameters:i,iceParameters:o,candidates:r,rtpCapabilities:HX(e.rtpCapabilities),setup:s,cname:n}}function BX(e,t,n){const r=[],i=[];return e.forEach((e=>{let{ssrcId:o,rtx:s}=e;const a=Sj(8,"track-"),c={ssrcId:o,attributes:kX({label:a,mslabel:n=n||Sj(10,""),msid:"".concat(n," ").concat(a)},t&&{cname:t})};if(r.push(c),void 0!==s){const e={ssrcId:s,attributes:kX({label:a,mslabel:n,msid:"".concat(n," ").concat(a)},t&&{cname:t})};r.push(e),i.push({semantic:"FID",ssrcIds:[o,s]})}})),e.length>1&&i.push({semantic:"SIM",ssrcIds:e.map((e=>{let{ssrcId:t}=e;return t}))}),{ssrcs:r,ssrcGroups:i}}function FX(e,t){t instanceof JQ&&e.attributes.payloads.forEach((e=>{var n;const r=null===(n=e.rtpMap)||void 0===n?void 0:n.encodingName.toLowerCase();if(!r||-1===["opus","pcmu","pcma","g722"].indexOf(r))return;e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.minptime="10",e.fmtp.parameters.useinbandfec="1";const i=t._encoderConfig;i&&"pcmu"!==r&&"pcma"!==r&&"g722"!==r&&(i.bitrate&&!Ub()&&(e.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*i.bitrate))),i.sampleRate&&(e.fmtp.parameters.maxplaybackrate="".concat(i.sampleRate),e.fmtp.parameters["sprop-maxcapturerate"]="".concat(i.sampleRate)),i.stereo&&(e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"))}))}function VX(e){const t=e.attributes.unrecognized.findIndex((e=>"x-google-flag"===e.attField&&"conference"===e.attValue));-1!==t&&e.attributes.unrecognized.splice(t,1)}function GX(e,t){if(!(t instanceof Zz&&t._encoderConfig&&-1===t._hints.indexOf(fk.SCREEN_TRACK)))return;const n=t._encoderConfig;Gk().supportMinBitrate&&n.bitrateMin&&e.attributes.payloads.forEach((e=>{var t;["h264","vp8","vp9","av1"].includes((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-min-bitrate"]="".concat(n.bitrateMin))})),Gk().supportMinBitrate&&!t._hints.includes(fk.LOW_STREAM)&&n.bitrateMax&&e.attributes.payloads.forEach((e=>{var t;["h264","vp8","vp9","av1"].includes((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-start-bitrate"]="".concat($D("X_GOOGLE_START_BITRATE")||Math.floor(n.bitrateMax)))}))}function QX(e,t,n){if(!t)return;let r,i;if("video"===e.media.mediaType?(r=n.videoExtensions,i=n.videoCodecs):(r=n.audioExtensions,i=n.audioCodecs),!0===t.tcc){const t=r.find((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName));t&&(e.attributes.extmaps.find((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName))||e.attributes.extmaps.push({entry:t.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"}),function(e,t){return t.filter((t=>!!e.find((e=>e.payloadType===t.payloadType&&!!e.rtcpFeedbacks.find((e=>"transport-cc"===e.type))))))}(i,e.attributes.payloads).forEach((e=>{e.rtcpFeedbacks.find((e=>"transport-cc"===e.type))||e.rtcpFeedbacks.push({type:"transport-cc"})})))}else if(!1===t.tcc){const t=e.attributes.extmaps.findIndex((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName));-1!==t&&e.attributes.extmaps.splice(t,1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"transport-cc"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}if(!0===t.remb){const t=r.find((e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName));t&&(e.attributes.extmaps.find((e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName))||e.attributes.extmaps.push({entry:t.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"}),function(e,t){return t.filter((t=>!!e.find((e=>e.payloadType===t.payloadType&&!!e.rtcpFeedbacks.find((e=>"goog-remb"===e.type))))))}(i,e.attributes.payloads).forEach((e=>{e.rtcpFeedbacks.find((e=>"goog-remb"===e.type))||e.rtcpFeedbacks.push({type:"goog-remb"})})))}else if(!1===t.remb){const t=e.attributes.extmaps.findIndex((e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName));-1!==t&&e.attributes.extmaps.splice(t,1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"goog-remb"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}}function jX(e,t,n,r,i,o){if("videoExtensions"===n||"audioExtensions"===n){const s=[];return e[n].forEach((e=>{t[n].some(((t,n)=>{if(e.entry===t.entry&&e.extensionName===t.extensionName)return s.push(n),!0}))?o[n].push(e):r[n].push(e)})),void t[n].forEach(((e,t)=>{-1===s.indexOf(t)&&i[n].push(e)}))}if("videoCodecs"===n||"audioCodecs"===n){const s=[];return e[n].forEach((e=>{t[n].some(((t,n)=>{if(e.payloadType===t.payloadType&&JSON.stringify(e)===JSON.stringify(t))return s.push(n),!0}))?o[n].push(e):r[n].push(e)})),void t[n].forEach(((e,t)=>{-1===s.indexOf(t)&&i[n].push(e)}))}}function HX(e){const{send:t,recv:n,sendrecv:r}=e;if(!r){if(!t||!n)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:n}}let i,o;return t?(i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},i.audioCodecs=[...t.audioCodecs,...r.audioCodecs],i.videoCodecs=[...t.videoCodecs,...r.videoCodecs],i.audioExtensions=[...t.audioExtensions,...r.audioExtensions],i.videoExtensions=[...t.videoExtensions,...r.videoExtensions]):i=r,n?(o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},o.audioCodecs=[...n.audioCodecs,...r.audioCodecs],o.videoCodecs=[...n.videoCodecs,...r.videoCodecs],o.audioExtensions=[...n.audioExtensions,...r.audioExtensions],o.videoExtensions=[...n.videoExtensions,...r.videoExtensions]):o=r,{send:i,recv:o}}function WX(e){"audio"===e.media.mediaType&&e.attributes.payloads.filter((e=>{var t;return"opus"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())})).forEach((e=>{e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"}))}!function(e,t){e.exports=(()=>{var e={8:(e,t,n)=>{n.r(t),n.d(t,{Parser:()=>R,Printer:()=>O,parse:()=>D,print:()=>L});const r="\n",i="".concat("\r").concat(r),o=" ";let s;function a(e){return e>="0"&&e<="9"}function c(e){return e>="!"&&e<="~"}function u(e){return c(e)||e>="Â"&&e<="Ã¿"}function l(e){return"!"===e||e>="#"&&e<="'"||e>="*"&&e<="+"||e>="-"&&e<="."||e>="0"&&e<="9"||e>="A"&&e<="Z"||e>="^"&&e<="~"}function d(e){return e>="1"&&e<="9"}function h(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function p(e){return"d"===e||"h"===e||"m"===e||"s"===e}function f(e){return e>""&&e<"\t"||e>"\v"&&e<"\f"||e>""&&e<"Ã¿"}function A(e){return h(e)||a(e)||"+"===e||"/"===e}function E(e){return a(e)||h(e)||"+"===e||"/"===e||"-"===e||"_"===e}function g(e){return h(e)||a(e)||"+"===e||"/"===e}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){I(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}!function(e){e.VERSION="v",e.ORIGIN="o",e.SESSION_NAME="s",e.INFORMATION="i",e.URI="u",e.EMAIL="e",e.PHONE="p",e.CONNECTION="c",e.BANDWIDTH="b",e.TIME="t",e.REPEAT="r",e.ZONE_ADJUSTMENTS="z",e.KEY="k",e.ATTRIBUTE="a",e.MEDIA="m"}(s||(s={}));class T{consumeText(e,t){let n=t;for(;n<e.length;){const t=e[n];if("\0"===t||"\r"===t||t===r)break;n+=1}if(n-t==0)throw new Error("Invalid text, at ".concat(e));return n}consumeUnicastAddress(e,t,n){return this.consumeTill(e,t,o)}consumeOneOrMore(e,t,n){let r=t;for(;n(e[r]);)r++;if(r-t==0)throw new Error("Invalid rule at ".concat(t,"."));return r}consumeSpace(e,t){if(e[t]===o)return t+1;throw new Error("Invalid space at ".concat(t,"."))}consumeIP4Address(e,t){let n=t;for(let t=0;t<4;t++)if(n=this.consumeDecimalUChar(e,n),3!==t){if("."!==e[n])throw new Error("Invalid IP4 address.");n++}return n}consumeDecimalUChar(e,t){let n=t;for(let t=0;t<3&&a(e[n]);t++,n++);if(n-t==0)throw new Error("Invalid decimal uchar.");const r=parseInt(e.slice(t,n));if(r>=0&&r<=255)return n;throw new Error("Invalid decimal uchar")}consumeIP6Address(e,t){let n=this.consumeHexpart(e,t);return":"===e[n]?(n+=1,n=this.consumeIP4Address(e,n),n):n}consumeHexpart(e,t){let n=t;if(":"===e[n]&&":"===e[n+1]){n+=2;try{n=this.consumeHexseq(e,n)}catch(e){}return n}if(n=this.consumeHexseq(e,n),":"===e[n]&&":"===e[n+1]){n+=2;try{n=this.consumeHexseq(e,n)}catch(e){}return n}return n}consumeHexseq(e,t){let n=t;for(;n=this.consumeHex4(e,n),":"===e[n]&&":"!==e[n+1];)n+=1;return n}consumeHex4(e,t){let n=0;for(;n<4;n++)if(!((r=e[t+n])>="0"&&r<="9"||r>="a"&&r<="f"||r>="A"&&r<="F")){if(0===n)throw new Error("Invalid hex 4");break}var r;return t+n}consumeFQDN(e,t){let n=t;for(;a(e[n])||h(e[n])||"-"===e[n]||"."===e[n];)n+=1;if(n-t<4)throw new Error("Invalid FQDN");return n}consumeExtnAddr(e,t){return this.consumeOneOrMore(e,t,u)}consumeMulticastAddress(e,t,n){switch(n){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(e,t);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(e,t);default:try{return this.consumeFQDN(e,t)}catch(n){return this.consumeExtnAddr(e,t)}}}consumeIP6MulticastAddress(e,t){const n=this.consumeHexpart(e,t);return"/"===e[n]?this.consumeInteger(e,n+1):n}consumeIP4MulticastAddress(e,t){let n=t+3;const r=e.slice(t,n),i=parseInt(r);if(i<224||i>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let t=0;t<3;t++){if("."!==e[n])throw new Error("Invalid IP4 multicast address.");n+=1,n=this.consumeDecimalUChar(e,n)}return"/"===e[n]&&(n+=1),n=this.consumeTTL(e,n),"/"===e[n]&&(n=this.consumeInteger(e,n)),n}consumeInteger(e,t){if(!d(e[t]))throw new Error("Invalid integer.");for(t+=1;a(e[t]);)t+=1;return t}consumeTTL(e,t){if("0"===e[t])return t+1;if(!d(e[t]))throw new Error("Invalid TTL.");t+=1;for(let n=0;n<2&&a(e[t]);n++)t+=1;return t}consumeToken(e,t){return this.consumeOneOrMore(e,t,l)}consumeTime(e,t){let n=t;if("0"===e[n])return n+1;for(d(e[n])&&(n+=1);a(e[n]);)n++;if(n-t<10)throw new Error("Invalid time");return n}consumeAddress(e,t){return this.consumeTill(e,t,o)}consumeTypedTime(e,t){let n=t;return n=this.consumeOneOrMore(e,n,a),p(e[n])?n+1:n}consumeRepeatInterval(e,t){if(!d(e[t]))throw new Error("Invalid repeat interval");for(t+=1;a(e[t]);)t+=1;return p(e[t])&&(t+=1),t}consumePort(e,t){return this.consumeOneOrMore(e,t,a)}consume(e,t,n){for(let r=0;r<n.length;r++){if(t+r>=e.length)throw new Error("consume exceeding value length");if(e[t+r]!==n[r])throw new Error("consume ".concat(n," failed at ").concat(r))}return t+n.length}consumeTill(e,t,n){let r=t;for(;r<e.length&&("string"!=typeof n||e[r]!==n)&&("function"!=typeof n||!n(e[r]));)r++;return r}}class R extends T{constructor(){super(),I(this,"records",[]),I(this,"currentLine",0)}parse(e){const t=this.probeEOL(e);this.records=e.split(t).filter((e=>!!e.trim())).map(this.parseLine),this.currentLine=0;const n=this.parseVersion(),r=this.parseOrigin(),i=this.parseSessionName(),o=this.parseInformation(),s=this.parseUri(),a=this.parseEmail(),c=this.parsePhone(),u=this.parseConnection(),l=this.parseBandWidth(),d=this.parseTimeFields(),h=this.parseKey(),p=this.parseSessionAttribute(),f=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:n,origin:r,sessionName:i,information:o,uri:s,emails:a,phones:c,connection:u,bandwidths:l,timeFields:d,key:h,attributes:p,mediaDescriptions:f}}getCurrentRecord(){const e=this.records[this.currentLine];if(!e)throw new Error("Record doesn't exit.");return e}probeEOL(e){for(let t=0;t<e.length;t++)if(e[t]===r)return"\r"===e[t-1]?i:r;throw new Error("Invalid newline character.")}parseLine(e,t){if(e.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const n=e[0];if("="!==e[1])throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:n,value:e.slice(2),line:t,cur:0}}parseSessionAttribute(){const e=new y;for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==s.ATTRIBUTE)break;const n={attField:this.extractOneOrMore(t,(e=>l(e)&&":"!==e)),_cur:0};":"===t.value[t.cur]&&(t.cur+=1,n.attValue=this.extractOneOrMore(t,f)),e.parse(n),this.currentLine++}return e.digest()}parseMediaAttributes(e){const t=new S(e);for(;this.currentLine<this.records.length;){const e=this.getCurrentRecord();if(e.type!==s.ATTRIBUTE)break;const n={attField:this.extractOneOrMore(e,(e=>l(e)&&":"!==e)),_cur:0};":"===e.value[e.cur]&&(e.cur+=1,n.attValue=this.extractOneOrMore(e,f)),t.parse(n),this.currentLine++}return t.digest()}parseKey(){const e=this.getCurrentRecord();if(e.type===s.KEY){if("prompt"===e.value||"clear:"===e.value||"base64:"===e.value||"uri:"===e.value)return e.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const e=this.getCurrentRecord();if(e.type===s.ZONE_ADJUSTMENTS){const t=[];for(;;)try{const n=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);let r=!1;"-"===e.value[e.cur]&&(r=!0,e.cur+=1);const i=this.extract(e,this.consumeTypedTime);t.push({time:n,typedTime:i,back:r})}catch(e){break}if(0===t.length)throw new Error("Invalid zone adjustments");return this.currentLine++,t}return[]}parseRepeat(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==s.REPEAT)break;{const n=this.extract(t,this.consumeRepeatInterval),r=this.parseTypedTime(t);e.push({repeatInterval:n,typedTimes:r}),this.currentLine++}}return e}parseTypedTime(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeTypedTime))}catch(e){break}if(0===t.length)throw new Error("Invalid typed time.");return t}parseTime(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);const n=this.extract(e,this.consumeTime);return this.currentLine++,{startTime:t,stopTime:n}}parseBandWidth(){const e=[];for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==s.BANDWIDTH)break;{const n=this.extractOneOrMore(t,l);if(":"!==t.value[t.cur])throw new Error("Invalid bandwidth field.");t.cur++;const r=this.extractOneOrMore(t,a);e.push({bwtype:n,bandwidth:r}),this.currentLine++}}return e}parseVersion(){const e=this.getCurrentRecord();if(e.type!==s.VERSION)throw new Error("first sdp record must be version");const t=e.value.slice(0,this.consumeOneOrMore(e.value,0,a));if(t.length!==e.value.length)throw new Error('invalid proto version, "v='.concat(e.value,'"'));return this.currentLine++,t}parseOrigin(){const e=this.getCurrentRecord();if(e.type!==s.ORIGIN)throw new Error("second line of sdp must be origin");const t=this.extractOneOrMore(e,u);this.consumeSpaceForRecord(e);const n=this.extractOneOrMore(e,a);this.consumeSpaceForRecord(e);const r=this.extractOneOrMore(e,a);this.consumeSpaceForRecord(e);const i=this.extractOneOrMore(e,l);this.consumeSpaceForRecord(e);const o=this.extractOneOrMore(e,l);this.consumeSpaceForRecord(e);const c=this.extract(e,this.consumeUnicastAddress);return this.currentLine++,{username:t,sessId:n,sessVersion:r,nettype:i,addrtype:o,unicastAddress:c}}parseSessionName(){const e=this.getCurrentRecord();if(e.type===s.SESSION_NAME){const t=this.extract(e,this.consumeText);return this.currentLine++,t}}parseInformation(){const e=this.getCurrentRecord();if(e.type!==s.INFORMATION)return;const t=this.extract(e,this.consumeText);return this.currentLine++,t}parseUri(){const e=this.getCurrentRecord();if(e.type===s.URI)return this.currentLine++,e.value}parseEmail(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==s.EMAIL)break;e.push(t.value),this.currentLine++}return e}parsePhone(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==s.PHONE)break;e.push(t.value),this.currentLine++}return e}parseConnection(){const e=this.getCurrentRecord();if(e.type===s.CONNECTION){const t=this.extractOneOrMore(e,l);this.consumeSpaceForRecord(e);const n=this.extractOneOrMore(e,l);this.consumeSpaceForRecord(e);const r=this.extract(e,this.consumeAddress);return this.currentLine++,{nettype:t,addrtype:n,address:r}}}parseMedia(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeToken);this.consumeSpaceForRecord(e);let n=this.extract(e,this.consumePort);"/"===e.value[e.cur]&&(e.cur+=1,n+=this.extract(e,this.consumeInteger)),this.consumeSpaceForRecord(e);const r=[];for(r.push(this.extract(e,this.consumeToken));"/"===e.value[e.cur];)e.cur+=1,r.push(this.extract(e,this.consumeToken));if(0===r.length)throw new Error("Invalid proto");const i=this.parseFmt(e);return this.currentLine++,{mediaType:t,port:n,protos:r,fmts:i}}parseTimeFields(){const e=[];for(;this.getCurrentRecord().type===s.TIME;){const t=this.parseTime(),n=this.parseRepeat(),r=this.parseZone();e.push({time:t,repeats:n,zones:r})}return e}parseMediaDescription(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===s.MEDIA;){const t=this.parseMedia(),n=this.parseInformation(),r=this.parseConnections(),i=this.parseBandWidth(),o=this.parseKey(),s=this.parseMediaAttributes(t);e.push({media:t,information:n,connections:r,bandwidths:i,key:o,attributes:s})}return e}parseConnections(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===s.CONNECTION;)e.push(this.parseConnection());return e}parseFmt(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeToken))}catch(e){break}if(0===t.length)throw new Error("Invalid fmts");return t}extract(e,t,...n){const r=t.call(this,e.value,e.cur,...n),i=e.value.slice(e.cur,r);return e.cur=r,i}extractOneOrMore(e,t){const n=this.consumeOneOrMore(e.value,e.cur,t),r=e.value.slice(e.cur,n);return e.cur=n,r}consumeSpaceForRecord(e){if(e.value[e.cur]!==o)throw new Error("Invalid space at ".concat(e.cur,"."));e.cur+=1}}class v extends T{constructor(...e){super(...e),I(this,"attributes",void 0),I(this,"digested",!1)}extractOneOrMore(e,t,n){const r=this.consumeOneOrMore(e.attValue,e._cur,t),i=e.attValue.slice(e._cur,r),[o,s]=n||[];if("number"==typeof o&&i.length<o)throw new Error("error in length, should be more or equal than ".concat(o," characters."));if("number"==typeof s&&i.length>s)throw new Error("error in length, should be less or equal than ".concat(s," characters."));return e._cur=r,i}consumeAttributeSpace(e){if(e.attValue[e._cur]!==o)throw new Error("Invalid space at ".concat(e._cur,"."));e._cur+=1}extract(e,t,...n){if(!e.attValue)throw new Error("Nothing to extract from attValue.");const r=t.call(this,e.attValue,e._cur,...n),i=e.attValue.slice(e._cur,r);return e._cur=r,i}atEnd(e){if(!e.attValue)throw new Error;return e._cur>=e.attValue.length}peekChar(e){if(!e.attValue)throw new Error;return e.attValue[e._cur]}peek(e,t){if(!e.attValue)throw new Error;for(let n=0;n<t.length;n++)if(t[n]!==e.attValue[e._cur+n])return!1;return!0}parseIceUfrag(e){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(e,A,[4,256])}parseIcePwd(e){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(e,A,[22,256])}parseIceOptions(e){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const t=[];for(;!this.atEnd(e);){t.push(this.extractOneOrMore(e,A));try{this.consumeAttributeSpace(e)}catch(t){if(this.atEnd(e))break;throw t}}this.attributes.iceOptions=t}parseFingerprint(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill);this.attributes.fingerprints.push({hashFunction:t,fingerprint:n})}parseExtmap(e){const t=this.extractOneOrMore(e,a);let n;"/"===this.peekChar(e)&&(this.extract(e,this.consume,"/"),n=this.extract(e,this.consumeToken)),this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeTill,o),i=m(m({entry:parseInt(t,10)},n&&{direction:n}),{},{extensionName:r});this.peekChar(e)===o&&(this.consumeAttributeSpace(e),i.extensionAttributes=this.extract(e,this.consumeTill)),this.attributes.extmaps.push(i)}parseSetup(e){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const t=this.extract(e,this.consumeTill);if("active"!==t&&"passive"!==t&&"actpass"!==t&&"holdconn"!==t)throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=t}}class y extends v{constructor(...e){super(...e),I(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"group":this.parseGroup(e);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"fingerprint":this.parseFingerprint(e);break;case"setup":this.parseSetup(e);break;case"tls-id":this.parseTlsId(e);break;case"identity":this.parseIdentity(e);break;case"extmap":this.parseExtmap(e);break;case"msid-semantic":this.parseMsidSemantic(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing session attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(e){const t=this.extract(e,this.consumeToken),n=[];for(;!this.atEnd(e)&&this.peekChar(e)===o;)this.consumeAttributeSpace(e),n.push(this.extract(e,this.consumeToken));this.attributes.groups.push({semantic:t,identificationTag:n})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(e){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(e,E)}parseIdentity(e){const t=this.extractOneOrMore(e,g),n=[];for(;!this.atEnd(e)&&this.peekChar(e)===o;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.extract(e,this.consume,"=");const r=this.extractOneOrMore(e,(e=>e!==o&&f(e)));n.push({name:t,value:r})}this.attributes.identities.push({assertionValue:t,extensions:n})}parseMsidSemantic(e){this.peekChar(e)===o&&this.consumeAttributeSpace(e);const t={semantic:this.extract(e,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(e)}catch(e){break}if("*"===this.peekChar(e)){this.extract(e,this.consume,"*"),t.applyForAll=!0;break}{const n=this.extract(e,this.consumeTill,o);t.identifierList.push(n)}}this.attributes.msidSemantic=t}}class S extends v{constructor(e){super(),I(this,"attributes",void 0),-1!==e.protos.indexOf("RTP")||e.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"extmap":this.parseExtmap(e);break;case"setup":this.parseSetup(e);break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"candidate":this.parseCandidate(e);break;case"remote-candidate":this.parseRemoteCandidate(e);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(e);break;case"rtpmap":this.parseRtpmap(e);break;case"ptime":this.parsePtime(e);break;case"maxptime":this.parseMaxPtime(e);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(e);break;case"ssrc":this.parseSSRC(e);break;case"fmtp":this.parseFmtp(e);break;case"rtcp-fb":this.parseRtcpFb(e);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(e);break;case"mid":this.parseMid(e);break;case"msid":this.parseMsid(e);break;case"imageattr":this.parseImageAttr(e);break;case"rid":this.parseRid(e);break;case"simulcast":this.parseSimulcast(e);break;case"sctp-port":this.parseSctpPort(e);break;case"max-message-size":this.parseMaxMessageSize(e);break;case"ssrc-group":this.parseSSRCGroup(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing media attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}parseCandidate(e){const t=this.extractOneOrMore(e,A,[1,32]);this.consumeAttributeSpace(e);const n=this.extractOneOrMore(e,a,[1,5]);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const i=this.extractOneOrMore(e,a,[1,10]);this.consumeAttributeSpace(e);const s=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const u=this.extract(e,this.consumePort);this.consumeAttributeSpace(e),this.extract(e,this.consume,"typ"),this.consumeAttributeSpace(e);const l={foundation:t,componentId:n,transport:r,priority:i,connectionAddress:s,port:u,type:this.extract(e,this.consumeToken),extension:{}};for(this.peek(e," raddr")&&(this.extract(e,this.consume," raddr"),this.consumeAttributeSpace(e),l.relAddr=this.extract(e,this.consumeAddress)),this.peek(e," rport")&&(this.extract(e,this.consume," rport"),this.consumeAttributeSpace(e),l.relPort=this.extract(e,this.consumePort));this.peekChar(e)===o;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e),l.extension[t]=this.extractOneOrMore(e,c)}this.attributes.candidates.push(l)}parseRemoteCandidate(e){const t=[];for(;;){const n=this.extractOneOrMore(e,a,[1,5]);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const i=this.extract(e,this.consumePort);t.push({componentId:n,connectionAddress:r,port:i});try{this.consumeAttributeSpace(e)}catch(e){break}}this.attributes.remoteCandidatesList.push(t)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,"/");this.extract(e,this.consume,"/");const r={encodingName:n,clockRate:this.extractOneOrMore(e,a)};this.atEnd(e)||"/"!==this.peekChar(e)||(this.extract(e,this.consume,"/"),r.encodingParameters=parseInt(this.extract(e,this.consumeTill),10));const i=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));i?i.rtpMap=r:this.attributes.payloads.push({payloadType:parseInt(t,10),rtpMap:r,rtcpFeedbacks:[]})}parsePtime(e){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(e,this.consumeTill)}parseMaxPtime(e){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(e,this.consumeTill)}parseDirection(e){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=e.attField}parseSSRC(e){const t=this.extractOneOrMore(e,a);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,":");let r;":"===this.peekChar(e)&&(this.extract(e,this.consume,":"),r=this.extract(e,this.consumeTill));const i=this.attributes.ssrcs.find((e=>e.ssrcId===parseInt(t,10)));i?i.attributes[n]=r:this.attributes.ssrcs.push({ssrcId:parseInt(t,10),attributes:{[n]:r}})}parseFmtp(e){const t=this.extract(e,this.consumeTill,o);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill),r={};n.split(";").forEach((e=>{let[t,n]=e.split("=");t=t.trim(),n="string"==typeof n?n.trim():n,"string"==typeof t&&t.length>0&&(r[t]=n)}));const i=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));i?i.fmtp={parameters:r}:this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[],fmtp:{parameters:r}})}parseFmtParameters(e){const t={},n=this.extract(e,this.consumeTill,"=");e._cur++;const r=this.extract(e,this.consumeTill,";");for(t[n]=r;";"===e.attValue[e._cur];){const n=this.extract(e,this.consumeTill,"=");e._cur++;const r=this.extract(e,this.consumeTill,";");t[n]=r}return t}parseRtcpFb(e){let t="";t="*"===this.peekChar(e)?this.extract(e,this.consume,"*"):this.extract(e,this.consumeTill,o),this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,o);let r;if("trr-int"===n)r={type:n,interval:this.extract(e,this.consumeTill)};else{const t={type:n};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.parameter=this.extract(e,this.consumeToken),this.peekChar(e)===o&&(t.additional=this.extract(e,this.consumeTill))),r=t}if("*"===t)this.attributes.rtcpFeedbackWildcards.push(r);else{const e=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));e?e.rtcpFeedbacks.push(r):this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[r]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(e){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const t={port:this.extract(e,this.consumePort)};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.netType=this.extractOneOrMore(e,l),this.consumeAttributeSpace(e),t.addressType=this.extractOneOrMore(e,l),this.consumeAttributeSpace(e),t.address=this.extract(e,this.consumeAddress)),this.attributes.rtcp=t}parseMsid(e){const t={id:this.extractOneOrMore(e,l,[1,64])};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.appdata=this.extractOneOrMore(e,l,[1,64])),this.attributes.msids.push(t)}parseImageAttr(e){this.attributes.imageattr.push(e.attValue)}parseRid(e){const t=this.extractOneOrMore(e,(e=>h(e)||a(e)||"_"===e||"-"===e));this.consumeAttributeSpace(e);const n={id:t,direction:this.extract(e,this.consumeToken),params:[]};if(this.peekChar(e)===o){if(this.consumeAttributeSpace(e),this.peek(e,"pt=")){this.extract(e,this.consume,"pt=");const t=[];for(;;){const n=this.extract(e,this.consumeToken);t.push(n);try{this.extract(e,this.consume,",")}catch(e){break}}n.payloads=t,this.peekChar(e)===o&&this.extract(e,this.consume,o)}for(;;){const t=this.extract(e,this.consumeToken);switch(t){case"depend":{const r={type:t,rids:this.extract(e,this.consume,"=").split(",")};n.params.push(r);break}default:{const r={type:t};"="===this.peekChar(e)&&(this.extract(e,this.consume,"="),r.val=this.extract(e,this.consumeTill,";")),n.params.push(r)}}try{this.extract(e,this.consume,";")}catch(e){break}}}this.attributes.rids.push(n)}parseSimulcast(e){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=e.attValue,this.extract(e,this.consumeTill)}parseSctpPort(e){this.attributes.sctpPort=this.extractOneOrMore(e,a,[1,5])}parseMaxMessageSize(e){this.attributes.maxMessageSize=this.extractOneOrMore(e,a,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(e){this.attributes.mid=this.extract(e,this.consumeToken)}parseSSRCGroup(e){const t=this.extract(e,this.consumeToken),n=[];for(;;)try{this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeInteger);n.push(parseInt(t,10))}catch(e){break}this.attributes.ssrcGroups.push({semantic:t,ssrcIds:n})}}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class O{constructor(){C(this,"eol",i)}print(e,t){let n="";return t&&(this.eol=t),n+=this.printVersion(e.version),n+=this.printOrigin(e.origin),n+=this.printSessionName(e.sessionName),n+=this.printInformation(e.information),n+=this.printUri(e.uri),n+=this.printEmail(e.emails),n+=this.printPhone(e.phones),n+=this.printConnection(e.connection),n+=this.printBandwidth(e.bandwidths),n+=this.printTimeFields(e.timeFields),n+=this.printKey(e.key),n+=this.printSessionAttributes(e.attributes),n+=this.printMediaDescription(e.mediaDescriptions),n}printVersion(e){return"v=".concat(e).concat(this.eol)}printOrigin(e){return"o=".concat(e.username," ").concat(e.sessId," ").concat(e.sessVersion," ").concat(e.nettype," ").concat(e.addrtype," ").concat(e.unicastAddress).concat(this.eol)}printSessionName(e){return e?"s=".concat(e).concat(this.eol):""}printInformation(e){return e?"i=".concat(e).concat(this.eol):""}printUri(e){return e?"u=".concat(e).concat(this.eol):""}printEmail(e){let t="";for(const n of e)t+="e=".concat(n).concat(this.eol);return t}printPhone(e){let t="";for(const n of e)t+="e=".concat(n).concat(this.eol);return t}printConnection(e){return e?"c=".concat(e.nettype," ").concat(e.addrtype," ").concat(e.address).concat(this.eol):""}printBandwidth(e){let t="";for(const n of e)t+="b=".concat(n.bwtype,":").concat(n.bandwidth).concat(this.eol);return t}printTimeFields(e){let t="";for(const n of e){t+="t=".concat(n.time.startTime," ").concat(n.time.startTime).concat(this.eol);for(const e of n.repeats)t+="r=".concat(e.repeatInterval," ").concat(e.typedTimes.join(" ")).concat(this.eol);n.zoneAdjustments&&(t+="z=",t+="z=".concat(n.zoneAdjustments.map((e=>"".concat(e.time," ").concat(e.back?"-":""," ").concat(e.typedTime))).join(" ")).concat(this.eol),t+=this.eol)}return t}printKey(e){return e?"k=".concat(e).concat(this.eol):""}printAttributes(e){let t="";for(const n of e)t+="a=".concat(n.attField).concat(n.attValue?":".concat(n.attValue):"").concat(this.eol);return t}printMediaDescription(e){let t="";for(const n of e)t+=this.printMedia(n.media),t+=this.printInformation(n.information),t+=this.printConnections(n.connections),t+=this.printBandwidth(n.bandwidths),t+=this.printKey(n.key),t+=this.printMediaAttributes(n);return t}printConnections(e){let t="";for(const n of e)t+=this.printConnection(n);return t}printMedia(e){return"m=".concat(e.mediaType," ").concat(e.port," ").concat(e.protos.join("/")," ").concat(e.fmts.join(" ")).concat(this.eol)}printSessionAttributes(e){return new w(this.eol).print(e)}printMediaAttributes(e){return new N(this.eol).print(e)}}class b{constructor(e){C(this,"eol",void 0),this.eol=e}printIceUfrag(e){return void 0===e?"":"a=ice-ufrag:".concat(e).concat(this.eol)}printIcePwd(e){return void 0===e?"":"a=ice-pwd:".concat(e).concat(this.eol)}printIceOptions(e){return void 0===e?"":"a=ice-options:".concat(e.join(o)).concat(this.eol)}printFingerprints(e){return e.length>0?e.map((e=>"a=fingerprint:".concat(e.hashFunction).concat(o).concat(e.fingerprint))).join(this.eol)+this.eol:""}printExtmap(e){return e.map((e=>"a=extmap:".concat(e.entry).concat(e.direction?"/".concat(e.direction):"").concat(o).concat(e.extensionName).concat(e.extensionAttributes?"".concat(o).concat(e.extensionAttributes):"").concat(this.eol))).join("")}printSetup(e){return void 0===e?"":"a=setup:".concat(e).concat(this.eol)}printUnrecognized(e){return e.map((e=>"a=".concat(e.attField).concat(e.attValue?":".concat(e.attValue):"").concat(this.eol))).join("")}}class w extends b{print(e){let t="";return t+=this.printGroups(e.groups),t+=this.printMsidSemantic(e.msidSemantic),t+=this.printIceLite(e.iceLite),t+=this.printIceUfrag(e.iceUfrag),t+=this.printIcePwd(e.icePwd),t+=this.printIceOptions(e.iceOptions),t+=this.printFingerprints(e.fingerprints),t+=this.printSetup(e.setup),t+=this.printTlsId(e.tlsId),t+=this.printIdentity(e.identities),t+=this.printExtmap(e.extmaps),t+=this.printUnrecognized(e.unrecognized),t}printGroups(e){let t="";return e.length>0&&(t+=e.map((e=>"a=group:".concat(e.semantic).concat(e.identificationTag.map((e=>"".concat(o).concat(e))).join("")).concat(this.eol))).join("")),t}printIceLite(e){return void 0===e?"":"a=ice-lite"+this.eol}printTlsId(e){return e?"a=tls-id:".concat(e).concat(this.eol):""}printIdentity(e){return 0===e.length?"":e.map((e=>"a=identity:".concat(e.assertionValue).concat(e.extensions.map((e=>"".concat(o).concat(e.name).concat(e.value?"=".concat(e.value):"")))))).join(this.eol)+this.eol}printMsidSemantic(e){if(!e)return"";let t="a=msid-semantic:".concat(e.semantic);return e.applyForAll?t+="".concat(o,"*"):e.identifierList.length>0&&(t+=e.identifierList.map((e=>"".concat(o).concat(e)))),t+this.eol}}class N extends b{print(e){const t=e.attributes;let n="";return n+=this.printRTCP(t.rtcp),n+=this.printIceUfrag(t.iceUfrag),n+=this.printIcePwd(t.icePwd),n+=this.printIceOptions(t.iceOptions),n+=this.printCandidates(t.candidates),n+=this.printRemoteCandidatesList(t.remoteCandidatesList),n+=this.printEndOfCandidates(t.endOfCandidates),n+=this.printFingerprints(t.fingerprints),n+=this.printSetup(t.setup),n+=this.printMid(t.mid),n+=this.printExtmap(t.extmaps),n+=this.printRTPRelated(t),n+=this.printPtime(t.ptime),n+=this.printMaxPtime(t.maxPtime),n+=this.printDirection(t.direction),n+=this.printSSRCGroups(t.ssrcGroups),n+=this.printSSRC(t.ssrcs),n+=this.printRTCPMux(t.rtcpMux),n+=this.printRTCPMuxOnly(t.rtcpMuxOnly),n+=this.printRTCPRsize(t.rtcpRsize),n+=this.printMSId(t.msids),n+=this.printImageattr(t.imageattr),n+=this.printRid(t.rids),n+=this.printSimulcast(t.simulcast),n+=this.printSCRPPort(t.sctpPort),n+=this.printMaxMessageSize(t.maxMessageSize),n+=this.printUnrecognized(t.unrecognized),n}printCandidates(e){return e.map((e=>"a=candidate:".concat(e.foundation).concat(o).concat(e.componentId).concat(o).concat(e.transport).concat(o).concat(e.priority).concat(o).concat(e.connectionAddress).concat(o).concat(e.port).concat(o,"typ").concat(o).concat(e.type).concat(e.relAddr?"".concat(o,"raddr").concat(o).concat(e.relAddr):"").concat(e.relPort?"".concat(o,"rport").concat(o).concat(e.relPort):"").concat(Object.keys(e.extension).map((t=>"".concat(o).concat(t).concat(o).concat(e.extension[t]))).join("")).concat(this.eol))).join("")}printRemoteCandidatesList(e){return e.map((e=>"a=remote-candidates:".concat(e.join(o)).concat(this.eol))).join("")}printEndOfCandidates(e){return void 0===e?"":"a=end-of-candidates"+this.eol}printRTPRelated(e){if(!e.payloads)return"";const t=e.payloads;let n="";n+=e.rtcpFeedbackWildcards.map((e=>this.printRTCPFeedback("*",e))).join("");for(const e of t)n+=this.printRtpMap(e.payloadType,e.rtpMap),n+=this.printFmtp(e.payloadType,e.fmtp),n+=e.rtcpFeedbacks.map((t=>this.printRTCPFeedback(e.payloadType,t))).join("");return n}printFmtp(e,t){if(!t)return"";const n=Object.keys(t.parameters);return 1===n.length&&void 0===t.parameters[n[0]]?"a=fmtp:".concat(e).concat(o).concat(n[0]).concat(this.eol):"a=fmtp:".concat(e).concat(o).concat(Object.keys(t.parameters).map((e=>"".concat(e,"=").concat(t.parameters[e]))).join(";")).concat(this.eol)}printRtpMap(e,t){return t?"a=rtpmap:".concat(e).concat(o).concat(t.encodingName,"/").concat(t.clockRate).concat(t.encodingParameters?"/".concat(t.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(e,t){let n="a=rtcp-fb:".concat(e).concat(o),r=t;return"trr-int"===r.type?n+="ttr-int".concat(o).concat(r.interval):(n+="".concat(r.type),r.parameter&&(n+="".concat(o).concat(r.parameter),r.additional&&(n+="".concat(o).concat(r.additional)))),n+this.eol}printPtime(e){return void 0===e?"":"a=ptime:".concat(e).concat(this.eol)}printMaxPtime(e){return void 0===e?"":"a=maxptime:".concat(e).concat(this.eol)}printDirection(e){return void 0===e?"":"a=".concat(e).concat(this.eol)}printSSRC(e){return e.map((e=>Object.keys(e.attributes).map((t=>"a=ssrc:".concat(e.ssrcId.toString(10)).concat(o).concat(t).concat(e.attributes[t]?":".concat(e.attributes[t]):"").concat(this.eol))).join(""))).join("")}printRTCPMux(e){return void 0===e?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(e){return void 0===e?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(e){return void 0===e?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(e){if(void 0===e)return"";let t="a=rtcp:".concat(e.port);return e.netType&&(t+="".concat(o).concat(e.netType)),e.addressType&&(t+="".concat(o).concat(e.addressType)),e.address&&(t+="".concat(o).concat(e.address)),t+this.eol}printMSId(e){return e.map((e=>"a=msid:".concat(e.id).concat(e.appdata?"".concat(o).concat(e.appdata):"").concat(this.eol))).join("")}printImageattr(e){return e.map((e=>"a=imageattr:".concat(e).concat(this.eol))).join("")}printRid(e){return e.map((e=>{let t="a=rid:".concat(e.id).concat(o).concat(e.direction);return e.payloads&&(t+="".concat(o,"pt=").concat(e.payloads.join(","))),e.params.length>0&&(t+="".concat(o).concat(e.params.map((e=>"depend"===e.type?"depend=".concat(e.rids.join(",")):"".concat(e.type,"=").concat(e.val))).join(";"))),t+this.eol})).join("")}printSimulcast(e){return void 0===e?"":"a=simulcast:".concat(e).concat(this.eol)}printSCRPPort(e){return void 0===e?"":"a=sctp-port:".concat(e).concat(this.eol)}printMaxMessageSize(e){return void 0===e?"":"a=max-message-size:".concat(e)}printMid(e){return void 0===e?"":"a=mid:".concat(e).concat(this.eol)}printSSRCGroups(e){return e.map((e=>"a=ssrc-group:".concat(e.semantic).concat(e.ssrcIds.map((e=>"".concat(o).concat(e.toString(10)))).join("")).concat(this.eol))).join("")}}function D(e){return(new R).parse(e)}function L(e,t){return(new O).print(e,t)}}},t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(8)})()}(LX);class YX{constructor(e){iw(this,"sessionDesc",void 0),iw(this,"localCapabilities",void 0),iw(this,"rtpCapabilities",void 0),iw(this,"candidates",void 0),iw(this,"iceParameters",void 0),iw(this,"dtlsParameters",void 0),iw(this,"setup",void 0),iw(this,"currentMidIndex",void 0),iw(this,"cname",void 0),e=Uj(e);const{remoteIceParameters:t,remoteDtlsParameters:n,candidates:r,remoteRTPCapabilities:i,remoteSetup:o,localCapabilities:s,sdkCodec:a,cname:c}=e,u=LX.exports.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE audio video\na=msid-semantic: WMS\na=ice-lite\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:audio\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:video\n");this.rtpCapabilities=i,this.candidates=r,this.iceParameters=t,this.dtlsParameters=n,this.setup=o,this.localCapabilities=s,this.cname=c;for(let e=0;e<u.mediaDescriptions.length;e++){const s=u.mediaDescriptions[e];if(s.attributes.iceUfrag=t.iceUfrag,s.attributes.icePwd=t.icePwd,s.attributes.fingerprints=n.fingerprints,s.attributes.candidates=r,s.attributes.setup=o,"video"===s.media.mediaType){s.media.fmts=i.videoCodecs.map((e=>e.payloadType.toString(10)));const e=i.videoCodecs.filter((e=>{var t;return null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase().includes(a)}));if(0===e.length)throw new Error("Codec ".concat(a," not supported by remote SDP."));s.attributes.payloads=e,s.attributes.extmaps=i.videoExtensions}"audio"===s.media.mediaType&&(s.media.fmts=i.audioCodecs.map((e=>e.payloadType.toString(10))),s.attributes.payloads=i.audioCodecs,s.attributes.extmaps=i.audioExtensions),u.mediaDescriptions[e]=this.mungMediaDesc(s)}this.sessionDesc=u,this.currentMidIndex=u.mediaDescriptions.length-1}toString(){return LX.exports.print(this.sessionDesc)}send(e,t,n){const{ssrcs:r,ssrcGroups:i}=BX(t,this.cname),o=this.sessionDesc.mediaDescriptions.find((t=>e===Ok.VIDEO?"video"===t.media.mediaType:"audio"===t.media.mediaType)),s=r[0].attributes.label,a=r[0].attributes.mslabel;return o.attributes.ssrcs=o.attributes.ssrcs.concat(r),o.attributes.ssrcGroups=o.attributes.ssrcGroups.concat(i),{id:s,mslabel:a}}batchSend(e){return e.map((e=>{let{kind:t,ssrcMsg:n}=e;return this.send(t,n,void 0)}))}stopSending(e){this.sessionDesc.mediaDescriptions.forEach((t=>{const n=[],r=[],i=[];t.attributes.ssrcs.forEach((t=>{e.includes(t.attributes.label||"")?i.push(t):n.push(t)})),t.attributes.ssrcGroups.forEach((e=>{i.map((e=>e.ssrcId)).includes(e.ssrcIds[0])||r.push(e)})),t.attributes.ssrcs=n,t.attributes.ssrcGroups=r}))}mute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}receive(e,t,n){e.forEach(((e,t)=>{const n=e._mediaStreamTrack,r=this.sessionDesc.mediaDescriptions.findIndex((e=>e.attributes.mid===n.kind)),i=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[r],e);this.sessionDesc.mediaDescriptions[r]=i}))}stopReceiving(e){}restartICE(e,t){e=Uj(e),t=Uj(t),this.iceParameters=e,this.candidates=t,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd,t.attributes.candidates=this.candidates}))}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}mungRecvMediaDsec(e,t){const n=Uj(e);return FX(n,t),GX(n,t),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}bumpMid(e){this.currentMidIndex+=e}updateTrackLabel(e,t,n){const r=this.sessionDesc.mediaDescriptions.find((t=>e===Ok.VIDEO?"video"===t.attributes.mid:"audio"===t.attributes.mid));if(r){const e=r.attributes.ssrcs.find((e=>e.attributes.label===t));var i;e&&(e.attributes.label=n,null===(i=e.attributes.msid)||void 0===i||i.replace(t,n))}}mungMediaDesc(e){const t=Uj(e);return VX(t),function(e){const t=e.attributes.extmaps.find((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName));t&&e.attributes.extmaps.splice(e.attributes.extmaps.indexOf(t),1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"transport-cc"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}(t),t}getSSRC(e){for(const t of this.sessionDesc.mediaDescriptions)for(const n of t.attributes.ssrcs)if(n.attributes.label===e)return[n]}}function KX(e){if(Array.isArray(e))return e.map((function(e){return e}));if(!$X(e))return e;var t={};for(var n in e)$X(e[n])||Array.isArray(e[n])?t[n]=KX(e[n]):t[n]=e[n];return t}function $X(e){return!("object"!=typeof e||Array.isArray(e)||!e)}var zX=function(){function e(e){this.input=[],this.size=e}return e.prototype.add=function(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)},e.prototype.diffMean=function(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length},e}(),qX=function(e,t){return(qX=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function JX(e,t){function n(){this.constructor=e}qX(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var XX=function(){return(XX=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function ZX(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function eZ(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}var tZ,nZ={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},rZ={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:nZ,remoteCandidate:nZ}},iZ={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},oZ={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,qpSumPerFrame:0},sZ={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},aZ={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0},cZ=function(){function e(e,t){var n=this;this.videoIsReady=!1,this.videoIsReady2={},this.stats=KX(rZ),this.isFirstVideoReceived={},this.isFirstVideoDecoded={},this.isFirstAudioReceived={},this.isFirstAudioDecoded={},this.lossRateWindowStats=[],this.pc=e,this.options=t,this.intervalTimer=window.setInterval((function(){return ZX(n,void 0,void 0,(function(){return eZ(this,(function(e){return this.updateStats(),[2]}))}))}),this.options.updateInterval)}return e.prototype.getStats=function(){return this.stats},e.prototype.setVideoIsReady=function(e){this.videoIsReady=e},e.prototype.setVideoIsReady2=function(e,t){this.videoIsReady2[e]=t},e.prototype.getVideoIsReady=function(e){return this.videoIsReady2[e]||!1},e.prototype.setIsFirstAudioDecoded=function(e){},e.prototype.destroy=function(){window.clearInterval(this.intervalTimer),this.pc=void 0},e.prototype.calcLossRate=function(e){var t=this;this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);for(var n=this.lossRateWindowStats.length,r=0,i=0,o=0,s=0,a=function(a){e[a].forEach((function(e,c){if(t.lossRateWindowStats[n-1][a][c]&&t.lossRateWindowStats[0][a][c]){var u=t.lossRateWindowStats[n-1][a][c].packets-t.lossRateWindowStats[0][a][c].packets,l=t.lossRateWindowStats[n-1][a][c].packetsLost-t.lossRateWindowStats[0][a][c].packetsLost;"videoSend"===a||"audioSend"===a?(r+=u,o+=l):(i+=u,s+=l),Number.isNaN(u)||Number.isNaN(u)?e.packetLostRate=0:e.packetLostRate=u<=0||l<=0?0:l/(u+l)}}))},c=0,u=["videoSend","audioSend","videoRecv","audioRecv"];c<u.length;c++)a(u[c]);e.sendPacketLossRate=r<=0||o<=0?0:o/(r+o),e.recvPacketLossRate=i<=0||s<=0?0:s/(i+s)},e}(),uZ=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._stats=rZ,t.lastDecodeVideoReceiverStats=new Map,t}return JX(t,e),t.prototype.updateStats=function(){return ZX(this,void 0,void 0,(function(){var e,t,n,r;return eZ(this,(function(i){switch(i.label){case 0:return[4,this._getStats()];case 1:return e=i.sent(),t=this.statsResponsesToObjects(e),this._stats=KX(rZ),n=t.filter((function(e){return"ssrc"===e.type})),this.processSSRCStats(n),(r=t.find((function(e){return"VideoBwe"===e.type})))&&this.processBandwidthStats(r),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}}))}))},t.prototype.processBandwidthStats=function(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)},t.prototype.processSSRCStats=function(e){var t=this;e.forEach((function(e){var n=e.id.includes("send");switch(e.mediaType+"_"+(n?"send":"recv")){case"video_send":var r=KX(oZ);r.codec=e.googCodecName,r.adaptionChangeReason="none",e.googCpuLimitedResolution&&(r.adaptionChangeReason="cpu"),e.googBandwidthLimitedResolution&&(r.adaptionChangeReason="bandwidth"),r.avgEncodeMs=Number(e.googAvgEncodeMs),r.inputFrame={width:Number(e.googFrameWidthInput)||Number(e.googFrameWidthSent),height:Number(e.googFrameHeightInput)||Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},r.sentFrame={width:Number(e.googFrameWidthSent),height:Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},r.firsCount=Number(e.googFirReceived),r.nacksCount=Number(e.googNacksReceived),r.plisCount=Number(e.googPlisReceived),r.frameCount=Number(e.framesEncoded),r.bytes=Number(e.bytesSent),r.packets=Number(e.packetsSent),r.packetsLost=Number(e.packetsLost),r.ssrc=Number(e.ssrc),r.rttMs=Number(e.googRtt||0),t._stats.videoSend.push(r),t._stats.rtt=r.rttMs;break;case"video_recv":var i=KX(iZ),o=t.lastDecodeVideoReceiverStats.get(Number(e.ssrc));if(i.codec=e.googCodecName,i.targetDelayMs=Number(e.googTargetDelayMs),i.renderDelayMs=Number(e.googRenderDelayMs),i.currentDelayMs=Number(e.googCurrentDelayMs),i.minPlayoutDelayMs=Number(e.googMinPlayoutDelayMs),i.decodeMs=Number(e.googDecodeMs),i.maxDecodeMs=Number(e.googMaxDecodeMs),i.receivedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateReceived)},i.decodedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateDecoded)},i.decodeFrameRate=Number(e.googFrameRateDecoded),i.outputFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateOutput)},i.jitterBufferMs=Number(e.googJitterBufferMs),i.firsCount=Number(e.googFirsSent),i.nacksCount=Number(e.googNacksSent),i.plisCount=Number(e.googPlisSent),i.framesDecodeCount=Number(e.framesDecoded),i.bytes=Number(e.bytesReceived),i.packets=Number(e.packetsReceived),i.packetsLost=Number(e.packetsLost),i.ssrc=Number(e.ssrc),i.packets>0&&!t.isFirstVideoReceived[i.ssrc]&&(t.onFirstVideoReceived&&t.onFirstVideoReceived(i.ssrc),t.isFirstVideoReceived[i.ssrc]=!0),i.framesDecodeCount>0&&!t.isFirstVideoDecoded[i.ssrc]&&(t.onFirstVideoDecoded&&t.onFirstVideoDecoded(i.ssrc,i.decodedFrame.width,i.decodedFrame.height),t.isFirstVideoDecoded[i.ssrc]=!0),o){var s=o.stats,a=Date.now()-o.lts;i.framesDecodeFreezeTime=s.framesDecodeFreezeTime,i.framesDecodeInterval=s.framesDecodeInterval,i.framesDecodeCount>s.framesDecodeCount&&t.isFirstVideoDecoded[i.ssrc]?(o.lts=Date.now(),i.framesDecodeInterval=a,i.framesDecodeInterval>=t.options.freezeRateLimit&&(t.getVideoIsReady(parseInt(e.ssrc,10))?i.framesDecodeFreezeTime+=i.framesDecodeInterval:t.setVideoIsReady2(parseInt(e.ssrc,10),!0))):i.framesDecodeCount<o.stats.framesDecodeCount&&(i.framesDecodeInterval=0)}t.lastDecodeVideoReceiverStats.set(i.ssrc,{stats:XX({},i),lts:Date.now()}),t._stats.videoRecv.push(i);break;case"audio_recv":var c=KX(aZ);c.codec=e.googCodecName,c.outputLevel=Math.abs(Number(e.audioOutputLevel))/32767,c.decodingCNG=Number(e.googDecodingCNG),c.decodingCTN=Number(e.googDecodingCTN),c.decodingCTSG=Number(e.googDecodingCTSG),c.decodingNormal=Number(e.googDecodingNormal),c.decodingPLC=Number(e.googDecodingPLC),c.decodingPLCCNG=Number(e.googDecodingPLCCNG),c.expandRate=Number(e.googExpandRate),c.accelerateRate=Number(e.googAccelerateRate),c.preemptiveExpandRate=Number(e.googPreemptiveExpandRate),c.secondaryDecodedRate=Number(e.googSecondaryDecodedRate),c.speechExpandRate=Number(e.googSpeechExpandRate),c.preferredJitterBufferMs=Number(e.googPreferredJitterBufferMs),c.jitterBufferMs=Number(e.googJitterBufferMs),c.jitterMs=Number(e.googJitterReceived),c.bytes=Number(e.bytesReceived),c.packets=Number(e.packetsReceived),c.packetsLost=Number(e.packetsLost),c.ssrc=Number(e.ssrc),c.receivedFrames=Number(e.googDecodingCTN)||Number(e.packetsReceived),c.droppedFrames=Number(e.googDecodingPLC)+Number(e.googDecodingPLCCNG)||Number(e.packetsLost),c.receivedFrames>0&&!t.isFirstAudioReceived[c.ssrc]&&(t.onFirstAudioReceived&&t.onFirstAudioReceived(c.ssrc),t.isFirstAudioReceived[c.ssrc]=!0),c.decodingNormal>0&&!t.isFirstAudioDecoded[c.ssrc]&&(t.onFirstAudioDecoded&&t.onFirstAudioDecoded(c.ssrc),t.isFirstAudioDecoded[c.ssrc]=!0),t._stats.audioRecv.push(c);break;case"audio_send":var u=KX(sZ);u.codec=e.googCodecName,u.inputLevel=Math.abs(Number(e.audioInputLevel))/32767,u.aecReturnLoss=Number(e.googEchoCancellationReturnLoss||0),u.aecReturnLossEnhancement=Number(e.googEchoCancellationReturnLossEnhancement||0),u.residualEchoLikelihood=Number(e.googResidualEchoLikelihood||0),u.residualEchoLikelihoodRecentMax=Number(e.googResidualEchoLikelihoodRecentMax||0),u.bytes=Number(e.bytesSent),u.packets=Number(e.packetsSent),u.packetsLost=Number(e.packetsLost),u.ssrc=Number(e.ssrc),u.rttMs=Number(e.googRtt||0),t._stats.rtt=u.rttMs,t._stats.audioSend.push(u)}}))},t.prototype._getStats=function(){var e=this;return new Promise((function(t,n){e.pc.getStats(t,n)}))},t.prototype.statsResponsesToObjects=function(e){var t=[];return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp.valueOf().toString(),type:e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t.push(n)})),t},t}(cZ);!function(e){e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver"}(tZ||(tZ={}));var lZ,dZ=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._stats=rZ,t.lastDecodeVideoReceiverStats=new Map,t.lastVideoFramesRecv=new Map,t.lastVideoFramesSent=new Map,t.lastVideoFramesDecode=new Map,t.lastVideoJBDelay=new Map,t.lastAudioJBDelay=new Map,t.mediaBytesSent=new Map,t.mediaBytesRetransmit=new Map,t.mediaBytesTargetEncode=new Map,t.lastEncoderMs=new Map,t}return JX(t,e),t.prototype.updateStats=function(){return ZX(this,void 0,void 0,(function(){var e,t=this;return eZ(this,(function(n){switch(n.label){case 0:return e=this,[4,this.pc.getStats()];case 1:return e.report=n.sent(),this._stats=KX(rZ),this.report.forEach((function(e){switch(e.type){case tZ.OUTBOUND:"audio"===e.mediaType?t.processAudioOutboundStats(e):"video"===e.mediaType&&t.processVideoOutboundStats(e);break;case tZ.INBOUND:"audio"===e.mediaType?t.processAudioInboundStats(e):"video"===e.mediaType&&t.processVideoInboundStats(e);break;case tZ.TRANSPORT:var n=t.report.get(e.selectedCandidatePairId);n&&t.processCandidatePairStats(n);break;case tZ.CANDIDATE_PAIR:e.selected&&t.processCandidatePairStats(e)}})),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}}))}))},t.prototype.processCandidatePairStats=function(e){if(this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach((function(t){!t.rttMs&&e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),this._stats.audioSend.forEach((function(t){!t.rttMs&&e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),this._stats.selectedCandidatePair.id=e.id,e.localCandidateId){var t=this.report.get(e.localCandidateId);t&&this.processCandidateStats(t)}if(e.remoteCandidateId){var n=this.report.get(e.remoteCandidateId);n&&this.processCandidateStats(n)}},t.prototype.processCandidateStats=function(e){var t;e.type===tZ.LOCAL_CANDIDATE&&(t=this._stats.selectedCandidatePair.localCandidate),e.type===tZ.REMOTE_CANDIDATE&&(t=this._stats.selectedCandidatePair.remoteCandidate),t&&(t.type=e.type,t.id=e.id,e.address&&(t.address=e.address),e.candidateType&&(t.candidateType=e.candidateType),e.port&&(t.port=e.port),e.priority&&(t.priority=e.priority),e.protocol&&(t.protocol=e.protocol),e.relayProtocol&&(t.relayProtocol=e.relayProtocol),e.type===tZ.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==t.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(XX({},t),XX({},this.stats.selectedCandidatePair.localCandidate)),e.type===tZ.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==t.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(XX({},t),XX({},this.stats.selectedCandidatePair.remoteCandidate)))},t.prototype.processAudioInboundStats=function(e){var t=this._stats.audioRecv.find((function(t){return t.ssrc===e.ssrc}));t||(t=KX(aZ),this._stats.audioRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.jitterMs=1e3*e.jitter,e.trackId&&this.processAudioTrackReceiverStats(e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),t.receivedFrames||(t.receivedFrames=e.packetsReceived),t.droppedFrames||(t.droppedFrames=e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.outputLevel&&t.outputLevel>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0)},t.prototype.processVideoInboundStats=function(e){var t=this._stats.videoRecv.find((function(t){return t.ssrc===e.ssrc}));t||(t=KX(iZ),this._stats.videoRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.framesDecodeCount=e.framesDecoded;var n=this.lastDecodeVideoReceiverStats.get(t.ssrc),r=this.lastVideoFramesDecode.get(t.ssrc),i=Date.now();if(t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]){var o=t.decodedFrame?t.decodedFrame.width:0,s=t.decodedFrame?t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,o,s),this.isFirstVideoDecoded[t.ssrc]=!0}if(n){var a=n.stats,c=i-n.lts;t.framesDecodeFreezeTime=a.framesDecodeFreezeTime,t.framesDecodeInterval=a.framesDecodeInterval,!this.isFirstVideoDecoded[t.ssrc]&&c>this.options.firstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(t.ssrc),t.framesDecodeCount>a.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(n.lts=Date.now(),t.framesDecodeInterval=c,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<a.framesDecodeCount&&(t.framesDecodeInterval=0),e.framesDecoded&&e.qpSum&&(n.stats.framesDecodeCount>e.framesDecoded?t.qpSumPerFrame=e.qpSum/e.framesDecoded:t.qpSumPerFrame=(e.qpSum-n.qpSum)/(e.framesDecoded-n.stats.framesDecodeCount))}r&&i-r.lts>=800?(t.decodeFrameRate=Math.round((t.framesDecodeCount-r.count)/((i-r.lts)/1e3)),this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:i,rate:t.decodeFrameRate})):r?t.decodeFrameRate=r.rate:this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:i,rate:0}),e.totalDecodeTime&&(t.decodeMs=1e3*e.totalDecodeTime),e.trackId&&this.processVideoTrackReceiverStats(e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(t.framesRateFirefox=e.framerateMean),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:XX({},t),lts:n?n.lts:Date.now(),qpSum:e.qpSum})},t.prototype.processVideoOutboundStats=function(e){var t=this._stats.videoSend.find((function(t){return t.ssrc===e.ssrc}));t||(t=KX(oZ),this._stats.videoSend.push(t));var n,r=this.mediaBytesSent.get(e.ssrc);if(r?r.add(e.bytesSent):((o=new zX(10)).add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,o)),void 0!==e.retransmittedBytesSent){var i=this.mediaBytesRetransmit.get(e.ssrc);i?i.add(e.retransmittedBytesSent):((o=new zX(10)).add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,o))}if(e.totalEncodedBytesTarget){var o,s=this.mediaBytesTargetEncode.get(e.ssrc);s?s.add(e.totalEncodedBytesTarget):((o=new zX(10)).add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,o))}if(t.ssrc=e.ssrc,t.bytes=e.bytesSent,t.packets=e.packetsSent,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.frameCount=e.framesEncoded,t.adaptionChangeReason=e.qualityLimitationReason,e.totalEncodeTime&&e.framesEncoded)if(!(n=this.lastEncoderMs.get(e.ssrc))||n.lastFrameCount>e.framesEncoded)t.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{var a=e.framesEncoded-n.lastFrameCount,c=e.totalEncodeTime-n.lastEncoderTime;t.avgEncodeMs=1e3*c/a}if(e.framesEncoded&&e.qpSum&&(!(n=this.lastEncoderMs.get(e.ssrc))||n.lastFrameCount>e.framesEncoded?t.qpSumPerFrame=e.qpSum/e.framesEncoded:t.qpSumPerFrame=(e.qpSum-n.lastQpSum)/(e.framesEncoded-n.lastFrameCount)),this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lastQpSum:e.qpSum,lts:Date.now()}),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,t),e.trackId&&this.processVideoTrackSenderStats(e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{var u=this.findRemoteStatsId(e.ssrc,tZ.REMOTE_INBOUND);u&&this.processRemoteInboundStats(u,t)}},t.prototype.processAudioOutboundStats=function(e){var t=this._stats.audioSend.find((function(t){return t.ssrc===e.ssrc}));if(t||(t=KX(sZ),this._stats.audioSend.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsSent,t.bytes=e.bytesSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.trackId&&this.processAudioTrackSenderStats(e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{var n=this.findRemoteStatsId(e.ssrc,tZ.REMOTE_INBOUND);n&&this.processRemoteInboundStats(n,t)}},t.prototype.findRemoteStatsId=function(e,t){var n=Array.from(this.report.values()).find((function(n){return n.type===t&&n.ssrc===e}));return n?n.id:null},t.prototype.processVideoMediaSource=function(e,t){var n=this.report.get(e);n&&n.width&&n.height&&n.framesPerSecond&&(t.inputFrame={width:n.width,height:n.height,frameRate:n.framesPerSecond})},t.prototype.processAudioMediaSource=function(e,t){var n=this.report.get(e);n&&(t.inputLevel=n.audioLevel)},t.prototype.processVideoTrackSenderStats=function(e,t){var n=this.report.get(e);if(n){var r=0,i=Date.now(),o=this.lastVideoFramesSent.get(t.ssrc);o&&i-o.lts>=800?(r=Math.round((n.framesSent-o.count)/((i-o.lts)/1e3)),this.lastVideoFramesSent.set(t.ssrc,{count:n.framesSent,lts:i,rate:r})):o?r=o.rate:this.lastVideoFramesSent.set(t.ssrc,{count:n.framesSent,lts:i,rate:0}),t.sentFrame={width:n.frameWidth,height:n.frameHeight,frameRate:r}}},t.prototype.processVideoTrackReceiverStats=function(e,t){var n=this.report.get(e);if(n){var r=this.lastVideoFramesRecv.get(t.ssrc),i=Date.now();t.framesReceivedCount=n.framesReceived;var o=0;if(r&&i-r.lts>=800?(o=Math.round((n.framesReceived-r.count)/((i-r.lts)/1e3)),this.lastVideoFramesRecv.set(t.ssrc,{count:n.framesReceived,lts:i,rate:o})):r?o=r.rate:this.lastVideoFramesRecv.set(t.ssrc,{count:n.framesReceived,lts:i,rate:0}),t.receivedFrame={width:n.frameWidth||0,height:n.frameHeight||0,frameRate:o||0},t.decodedFrame={width:n.frameWidth||0,height:n.frameHeight||0,frameRate:t.decodeFrameRate||0},t.outputFrame={width:n.frameWidth||0,height:n.frameHeight||0,frameRate:t.decodeFrameRate||0},n.jitterBufferDelay&&n.jitterBufferEmittedCount){var s=this.lastVideoJBDelay.get(t.ssrc);this.lastVideoJBDelay.set(t.ssrc,{jitterBufferDelay:n.jitterBufferDelay,jitterBufferEmittedCount:n.jitterBufferEmittedCount}),s||(s={jitterBufferDelay:0,jitterBufferEmittedCount:0});var a=1e3*(n.jitterBufferDelay-s.jitterBufferDelay)/(n.jitterBufferEmittedCount-s.jitterBufferEmittedCount);t.jitterBufferMs=a,t.currentDelayMs=Math.round(a)}}},t.prototype.processAudioTrackSenderStats=function(e,t){var n=this.report.get(e);n&&(t.aecReturnLoss=n.echoReturnLoss||0,t.aecReturnLossEnhancement=n.echoReturnLossEnhancement||0)},t.prototype.processAudioTrackReceiverStats=function(e,t){var n=this.report.get(e);if(n){if(n.removedSamplesForAcceleration&&n.totalSamplesReceived&&(t.accelerateRate=n.removedSamplesForAcceleration/n.totalSamplesReceived),n.jitterBufferDelay&&n.jitterBufferEmittedCount){var r=this.lastAudioJBDelay.get(t.ssrc);this.lastAudioJBDelay.set(t.ssrc,{jitterBufferDelay:n.jitterBufferDelay,jitterBufferEmittedCount:n.jitterBufferEmittedCount}),r||(r={jitterBufferDelay:0,jitterBufferEmittedCount:0});var i=1e3*(n.jitterBufferDelay-r.jitterBufferDelay)/(n.jitterBufferEmittedCount-r.jitterBufferEmittedCount);t.jitterBufferMs=Math.round(i)}t.outputLevel=n.audioLevel;var o=1920;n.totalSamplesDuration&&n.totalSamplesReceived&&(o=n.totalSamplesReceived/n.totalSamplesDuration/50,t.receivedFrames=Math.round(n.totalSamplesReceived/o)),n.concealedSamples&&(t.droppedFrames=Math.round(n.concealedSamples/o))}},t.prototype.processRemoteInboundStats=function(e,t){var n=this.report.get(e);n&&(t.packetsLost=n.packetsLost,n.roundTripTime&&(t.rttMs=1e3*n.roundTripTime))},t.prototype.getCodecFromCodecStats=function(e){var t=this.report.get(e);if(!t)return"";var n=t.mimeType.match(/\/(.*)$/);return n&&n[1]?n[1]:""},t.prototype.updateSendBitrate=function(){var e=0,t=null,n=null;this.mediaBytesSent.forEach((function(t){e+=t.diffMean()})),this.mediaBytesRetransmit.forEach((function(e){t=null===t?e.diffMean():t+e.diffMean()})),this.mediaBytesTargetEncode.forEach((function(e){n=null===n?e.diffMean():n+e.diffMean()}));var r=null!==t?e-t:e;this._stats.bitrate={actualEncoded:8*r/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},null!==t&&(this._stats.bitrate.retransmit=8*t/(this.options.updateInterval/1e3)),null!==n&&(this._stats.bitrate.targetEncoded=8*n/(this.options.updateInterval/1e3))},t}(cZ),hZ=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return JX(t,e),t.prototype.updateStats=function(){return Promise.resolve()},t}(cZ);function pZ(e,t,n,r,i){void 0===t&&(t=250),void 0===n&&(n=8),void 0===r&&(r=500),void 0===i&&(i=1e4);var o,s=(o=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i))&&o[0]?Number(o[0].split("/")[1]):null;return s?s<76?new uZ(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i}):new dZ(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i}):function(e){return!!window.RTCStatsReport&&e.getStats()instanceof Promise}(e)?new dZ(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i}):new hZ(e,{updateInterval:t,lossRateInterval:n,freezeRateLimit:r,firstVideoDecodedTimeout:i})}function fZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function AZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fZ(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fZ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let EZ=(YV((lZ=class e extends Pk{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}constructor(t,n){super(t,n),iw(this,"store",void 0),iw(this,"peerConnection",void 0),iw(this,"remoteSDP",void 0),iw(this,"initialOffer",void 0),iw(this,"statsFilter",void 0),iw(this,"useRTX",!1),iw(this,"localCapabilities",void 0),iw(this,"localCandidateCount",0),iw(this,"allCandidatesReceived",!1),iw(this,"mutex",new SG("P2PConnection-mutex")),this.store=n,this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=pZ(this.peerConnection,void 0,void 0,Ub()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(){try{const e=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=MX(e.sdp),n=xX(e.sdp,!this.useRTX,$D("FILTER_VIDEO_FEC"),$D("FILTER_AUDIO_FEC"),["opus"]);return this.localCapabilities=n,this.initialOffer=e,AZ(AZ({},t),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:n},offerSDP:e.sdp})}catch(e){throw new eD(ZN.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e,t,n,r,i,o){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new YX({remoteIceParameters:e,remoteDtlsParameters:t,candidates:n,remoteRTPCapabilities:r.send,remoteSetup:i,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:o});const s=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}send(e,t){var n=this;return aX((function*(){const r=yield cX(n.mutex.lock());try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const i=e.map((e=>n.peerConnection.addTrack(e._mediaStreamTrack))),o=yield cX(n.peerConnection.createOffer()),s=LX.exports.parse(o.sdp),a=e.map((e=>{const t=e._mediaStreamTrack,r=s.mediaDescriptions.find((e=>e.attributes.mid===t.kind));if(!r)throw new Error("Cannot extract ssrc from mediaDescription.");return function(e,t,n){const r=e.attributes.ssrcs.filter((e=>e.attributes.label===t)),i=e.attributes.ssrcGroups;if(0===r.length)throw new Error("Cannot extract ssrc from plan-b SDP.");if(i&&r.length>1){const e=i.find((e=>-1!==e.ssrcIds.indexOf(r[0].ssrcId)));return e?[{ssrcId:e.ssrcIds[0],rtx:n?e.ssrcIds[1]:void 0}]:[{ssrcId:r[0].ssrcId}]}return[{ssrcId:r[0].ssrcId}]}(r,t.id,n.useRTX)}));let c;try{c=yield a}catch(e){throw i.forEach((e=>{Mb()&&e.replaceTrack(null),n.peerConnection.removeTrack(e)})),e}const u=n.mungSendOfferSDP(o.sdp,e);n.remoteSDP.receive(e,t,c);const l=n.remoteSDP.toString();return yield cX(n.peerConnection.setLocalDescription({type:"offer",sdp:u})),yield cX(n.applySendEncodings(i,e)),yield cX(n.peerConnection.setRemoteDescription({type:"answer",sdp:l})),e.map(((e,t)=>{const n=e._mediaStreamTrack.id;return{localSSRC:a[t],id:n}}))}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{r()}}))()}async stopSending(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getSenders().filter((t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")}));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");t.map((e=>{Mb()&&e.replaceTrack(null),this.peerConnection.removeTrack(e)}));const n=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(n),this.remoteSDP.stopReceiving(e);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{id:n,mslabel:i}=this.remoteSDP.send(e,t,r),o=new xv(((t,r)=>{const o=setTimeout((()=>{r(new Error("Cannot receive track, id: ".concat(n)))}),1e4),s=r=>{const a=wb();if(("Safari"===a.name&&11===Number(a.version)||Bb())&&r.track.id!==n&&r.streams[0].id===i){var c;const i=r.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(e,n,r.track.id),this.peerConnection.removeEventListener("track",s),clearTimeout(o),void t(i)}if(r.track.id===n)return this.peerConnection.removeEventListener("track",s),clearTimeout(o),void t(r.track)};this.peerConnection.addEventListener("track",s)})),s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const a=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(a),{track:await o,id:n}}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(n)}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){}async unmuteRemote(e){}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getSenders().filter((t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")}));if(t.length!==e.length)throw new Error("sender' length doesn't match mids' length.");t.map((e=>{if(Mb()&&e.track)e.track.enabled=!1;else{const t=e.getParameters();t.encodings.forEach((e=>e.active=!1)),e.setParameters(t)}}))}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getSenders().filter((t=>{var n;return-1!==e.indexOf((null===(n=t.track)||void 0===n?void 0:n.id)||"")}));if(t.length!==e.length)throw new Error("Senders' length doesn't match mids' length.");t.map((async e=>{if(Mb()&&e.track)e.track.enabled=!0;else{const t=e.getParameters();t.encodings.forEach((e=>e.active=!0)),await e.setParameters(t)}}));const n=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(n);const r=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}async reEstablish(){const e=await this.peerConnection.createOffer({iceRestart:!0});if(!e.sdp)throw new Error("Cannot get SDP from restart offer.");return{iceParameters:MX(e.sdp).iceParameters,restartICE:async(t,n)=>this.restartICE(e,t,n),restartOfferSDP:e.sdp}}close(){var e;this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const e=await this.peerConnection.createOffer(),n=this.mungSendOfferSDP(e.sdp,[t]);this.remoteSDP.updateRecvMedia(t._mediaStreamTrack.kind,t);const r=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getSenders().filter((t=>{var n;return(null===(n=t.track)||void 0===n?void 0:n.id)===e}));1===n.length&&await this.applySendEncodings(n,[t])}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getSenders().find((e=>{var n;return(null===(n=e.track)||void 0===n?void 0:n.id)===t}));n&&await n.replaceTrack(e._mediaStreamTrack)}async restartICE(e,t,n){try{if(!this.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");this.remoteSDP.restartICE(t,n);const r=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(e),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.restartICE failed; ".concat(e.toString()))}}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,uD.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout((()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,uD.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))}),$D("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[],sdpSemantics:"plan-b"};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(VP(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers)),$D("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(n.iceTransportPolicy="relay")})))),n}static turnServerConfigToIceServers(e){const t=[];return e.forEach((e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))})),t}async applySendEncodings(e,t){try{if(!Gk().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let r=0;r<e.length;r++){var n;const i=e[r],o=t[r];if(!o)continue;const s={},a={};if(o instanceof Zz)switch(o._optimizationMode){case"motion":s.degradationPreference="maintain-framerate";break;case"detail":s.degradationPreference="maintain-resolution";break;default:s.degradationPreference="balanced"}if($D("DSCP_TYPE")&&$b()){const e=$D("DSCP_TYPE");["very-low","low","medium","high"].includes(e)&&(a.networkPriority=e)}const c=i.getParameters(),u=null===(n=c.encodings)||void 0===n?void 0:n[0];u&&Object.assign(u,a),Object.assign(c,s),await i.setParameters(c)}}catch(e){uD.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(e,t){const n=LX.exports.parse(e);return t.forEach(((e,t)=>{const r=e._mediaStreamTrack,i=n.mediaDescriptions.find((e=>e.attributes.mid===r.kind));i&&FX(i,e)})),LX.exports.print(n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const t=this.remoteSDP.batchSend(e).map(((t,n)=>{let{id:r,mslabel:i}=t;const{kind:o}=e[n];return new xv(((e,t)=>{const n=setTimeout((()=>{t(new Error("Cannot receive track, id: ".concat(r)))}),1e4),s=t=>{const a=wb();if("Safari"===a.name&&11===Number(a.version)&&t.track.id!==r&&t.streams[0].id===i){var c;const i=t.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(o,r,t.track.id),this.peerConnection.removeEventListener("track",s),clearTimeout(n),void e({track:i,id:r})}if(t.track.id===r)return this.peerConnection.removeEventListener("track",s),clearTimeout(n),void e({track:t.track,id:r})};this.peerConnection.addEventListener("track",s)}))})),n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:n});const r=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(r),await xv.all(t)}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return null==t?void 0:t[0].ssrcId}}).prototype,"connect",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"connect"),lZ.prototype),YV(lZ.prototype,"stopSending",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"stopSending"),lZ.prototype),YV(lZ.prototype,"receive",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"receive"),lZ.prototype),YV(lZ.prototype,"stopReceiving",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"stopReceiving"),lZ.prototype),YV(lZ.prototype,"muteRemote",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"muteRemote"),lZ.prototype),YV(lZ.prototype,"unmuteRemote",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"unmuteRemote"),lZ.prototype),YV(lZ.prototype,"muteLocal",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"muteLocal"),lZ.prototype),YV(lZ.prototype,"unmuteLocal",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"unmuteLocal"),lZ.prototype),YV(lZ.prototype,"reEstablish",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"reEstablish"),lZ.prototype),YV(lZ.prototype,"close",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"close"),lZ.prototype),YV(lZ.prototype,"updateEncoderConfig",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"updateEncoderConfig"),lZ.prototype),YV(lZ.prototype,"updateSendParameters",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"updateSendParameters"),lZ.prototype),YV(lZ.prototype,"replaceTrack",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"replaceTrack"),lZ.prototype),YV(lZ.prototype,"restartICE",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"restartICE"),lZ.prototype),YV(lZ.prototype,"getRemoteSSRC",[gZ],Object.getOwnPropertyDescriptor(lZ.prototype,"getRemoteSSRC"),lZ.prototype),lZ);function gZ(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("Locking from P2PConnection.".concat(t));try{for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return await r.apply(this,o)}finally{n()}},n}var _Z;const mZ="9";let IZ=PD("RemoteSDP")(_Z=class{get localCapabilities(){return Uj(this._localCapabilities)}get rtpCapabilities(){return Uj(this._rtpCapabilities)}get candidates(){return Uj(this._candidates)}get iceParameters(){return Uj(this._iceParameters)}get dtlsParameters(){return Uj(this._dtlsParameters)}constructor(e){iw(this,"sessionDesc",void 0),iw(this,"_localCapabilities",void 0),iw(this,"_rtpCapabilities",void 0),iw(this,"_candidates",void 0),iw(this,"_iceParameters",void 0),iw(this,"_dtlsParameters",void 0),iw(this,"setup",void 0),iw(this,"currentMidIndex",void 0),iw(this,"cname",void 0),iw(this,"firefoxSsrcMidMap",new Map),e=Uj(e);const{remoteIceParameters:t,remoteDtlsParameters:n,candidates:r,remoteRTPCapabilities:i,remoteSetup:o,localCapabilities:s,cname:a}=e,c=LX.exports.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=ice-lite\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n");this._rtpCapabilities=i,this._candidates=r,this._iceParameters=t,this._dtlsParameters=n,this._localCapabilities=s,this.setup=o,this.cname=a;const u=this.rtpCapabilities.send;for(const e of c.mediaDescriptions){if(e.attributes.iceUfrag=t.iceUfrag,e.attributes.icePwd=t.icePwd,e.attributes.fingerprints=n.fingerprints,e.attributes.candidates=r,e.attributes.setup=o,"video"===e.media.mediaType&&(e.media.fmts=u.videoCodecs.map((e=>e.payloadType.toString(10))),e.attributes.payloads=u.videoCodecs,e.attributes.extmaps=u.videoExtensions,$D("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:t,ssrcGroups:n}=BX([{ssrcId:4e4,rtx:$D("USE_RTX")?40001:void 0}],this.cname);e.attributes.ssrcs=t,e.attributes.ssrcGroups=n}if("audio"===e.media.mediaType&&(e.media.fmts=u.audioCodecs.map((e=>e.payloadType.toString(10))),e.attributes.payloads=u.audioCodecs,e.attributes.extmaps=u.audioExtensions,WX(e),$D("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:t,ssrcGroups:n}=BX([{ssrcId:2e4}],this.cname);e.attributes.ssrcs=t,e.attributes.ssrcGroups=n}}this.sessionDesc=c,this.currentMidIndex=c.mediaDescriptions.length-1}preloadRemoteMedia(){const e=$D("PRELOAD_MEDIA_COUNT");ND("debug",this,"preloadRemoteMedia",e),this.rtpCapabilities;const t=this.candidates,n=this.dtlsParameters,r=this.iceParameters,i=this.rtpCapabilities.send;for(let o=1;o<e;o++){const e=2*o+2e4,s=2*o+4e4,{ssrcs:a,ssrcGroups:c}=BX([{ssrcId:e}],this.cname),{ssrcs:u,ssrcGroups:l}=BX([{ssrcId:s,rtx:$D("USE_RTX")?s+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:mZ,protos:["UDP","TLS","RTP","SAVPF"],fmts:i.videoCodecs.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:r.iceUfrag,icePwd:r.icePwd,unrecognized:[],candidates:t,extmaps:i.videoExtensions,fingerprints:n.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:u,ssrcGroups:l,rtcpFeedbackWildcards:[],payloads:i.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*o)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:mZ,protos:["UDP","TLS","RTP","SAVPF"],fmts:i.audioCodecs.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:r.iceUfrag,icePwd:r.icePwd,unrecognized:[],candidates:t,extmaps:i.audioExtensions,fingerprints:n.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:a,ssrcGroups:c,rtcpFeedbackWildcards:[],payloads:i.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*o+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return LX.exports.print(this.sessionDesc)}send(e,t,n,r){const{ssrcs:i,ssrcGroups:o}=BX(t,this.cname,n),s=this.findPreloadMediaDesc(i);if(s){if(Ub()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,s.attributes.mid),r&&(r.tcc||r.remb)){const e=this.sessionDesc.mediaDescriptions.indexOf(s);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(s,r),{mid:s.attributes.mid,needExchangeSDP:!0}}return{mid:s.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e,i);if(Mb()||Vb()||Fb()){if(-1!==t&&1!==t){const e=Uj(this.sessionDesc.mediaDescriptions[t]);return e.attributes.direction="sendonly",e.attributes.ssrcs=i,e.attributes.ssrcGroups=o,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(e,r),{mid:e.attributes.mid,needExchangeSDP:!0}}{const t=this.createOrRecycleSendMedia(e,i,o,"sendonly",r);return this.updateBundleMids(),{mid:t.attributes.mid,needExchangeSDP:!0}}}if(-1!==t){const e=Uj(this.sessionDesc.mediaDescriptions[t]);return e.attributes.direction="sendonly",e.attributes.ssrcs=i,e.attributes.ssrcGroups=o,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(e,r),Ub()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,e.attributes.mid),{mid:e.attributes.mid,needExchangeSDP:!0}}{const t=this.createOrRecycleSendMedia(e,i,o,"sendonly",r);return this.updateBundleMids(),Ub()&&this.firefoxSsrcMidMap.set(i[0].ssrcId,t.attributes.mid),{mid:t.attributes.mid,needExchangeSDP:!0}}}}batchSend(e){const t=e.map((e=>{let{kind:t,ssrcMsg:n,mslabel:r}=e;return this.send(t,n,r)})),n=[];let r=!1;return t.forEach((e=>{let{mid:t,needExchangeSDP:i}=e;i&&(r=!0),n.push(t)})),{mids:n,needExchangeSDP:r}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach((e=>{"0"===e.attributes.mid||Ub()||Mb()||Vb()||Fb()?e.attributes.ssrcs=[]:(e.attributes.ssrcs=[],e.attributes.direction="inactive",e.media.port="0")})),this.updateBundleMids()}mute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>e.includes(t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="inactive"}))}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>e.includes(t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="recvonly"}))}receive(e,t,n,r){e.forEach(((e,i)=>{this.createOrRecycleRecvMedia(e,[],"recvonly",t,n,r[i])})),this.updateBundleMids()}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach((e=>{e.media.port="0",e.attributes.direction="inactive"})),this.updateBundleMids()}restartICE(e,t){e=Uj(e),t=Uj(t),this._iceParameters=e,this._candidates=t,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd,t.attributes.candidates=this.candidates}))}predictReceivingMids(e){const t=[];for(let n=0;n<e;n++)t.push((this.currentMidIndex+n+1).toString(10));return t}findAvailableMediaIndex(e,t){return this.sessionDesc.mediaDescriptions.findIndex((n=>{const r=n.media.mediaType===e&&"0"!==n.media.port&&("sendonly"===n.attributes.direction||"sendrecv"===n.attributes.direction)&&0===n.attributes.ssrcs.length;if(Ub()){if(r){const e=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(e||"0"!==n.attributes.mid&&"1"!==n.attributes.mid)||!(!e||e!==n.attributes.mid)}return!1}return r}))}createOrRecycleRecvMedia(e,t,n,r,i,o){const s=e._mediaStreamTrack.kind,a=this.rtpCapabilities.recv,c=this.localCapabilities.send;let u=[];if(s===Ok.VIDEO){var l,d;if($D("H264_PROFILE_LEVEL_ID")&&"h264"===r&&(u=a.videoCodecs.filter((e=>{var t,n;return((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"").includes(r)&&(null==e||null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"])===$D("H264_PROFILE_LEVEL_ID")}))),!u||0===(null===(l=u)||void 0===l?void 0:l.length)){const e=c.videoCodecs.filter((e=>{var t;return((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"").includes(r)}));0!==e.length&&(u=a.videoCodecs.filter((t=>e.some((e=>e.payloadType===t.payloadType)))))}if($D("USE_RTX")){const e=u.map((e=>e.payloadType.toString())),t=a.videoCodecs.filter((t=>{var n,r;return"rtx"===(null===(n=t.rtpMap)||void 0===n?void 0:n.encodingName)&&e.includes((null===(r=t.fmtp)||void 0===r?void 0:r.parameters.apt)||"")}));u=[...u,...t]}0===u.length&&(uD.warning("codec ".concat(r," not included in rtpCapabilities, fallback to default payloads: ").concat(null===(d=a.videoCodecs[0].rtpMap)||void 0===d?void 0:d.encodingName)),u=a.videoCodecs)}else u=a.audioCodecs.filter((e=>{var t;return((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"").includes(i)})),0===u.length&&(uD.warning("codec ".concat(i," not included in rtpCapabilities, fallback to opus")),u=a.audioCodecs.filter((e=>{var t;return((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"").includes("opus")})));const h=s===Ok.VIDEO?a.videoExtensions:a.audioExtensions;this.currentMidIndex+=1;const p="".concat(this.currentMidIndex);let f={media:{mediaType:s,port:mZ,protos:["UDP","TLS","RTP","SAVPF"],fmts:u.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:h,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:u,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(p)}};f=this.mungRecvMediaDsec(f,e,o);const A=this.findFirstClosedMedia(s);if(A){const e=this.sessionDesc.mediaDescriptions.indexOf(A);this.sessionDesc.mediaDescriptions[e]=f}else this.sessionDesc.mediaDescriptions.push(f);return f}createOrRecycleSendMedia(e,t,n,r,i){const o=this.rtpCapabilities.send,s=e===Ok.VIDEO?o.videoCodecs:o.audioCodecs,a=e===Ok.VIDEO?o.videoExtensions:o.audioExtensions;this.currentMidIndex+=1;const c="".concat(this.currentMidIndex);let u={media:{mediaType:e,port:mZ,protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:a,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:n,rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:r,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(c)}};u=this.mungSendMediaDesc(u,i);const l=this.findFirstClosedMedia(e);if(l){const e=this.sessionDesc.mediaDescriptions.indexOf(l);this.sessionDesc.mediaDescriptions[e]=u}else this.sessionDesc.mediaDescriptions.push(u);return u}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter((e=>"0"!==e.media.port)).map((e=>e.attributes.mid))}mungRecvMediaDsec(e,t,n){const r=Uj(e);return VX(r),FX(r,t),GX(r,t),function(e){if("video"!==e.media.mediaType)return;const t=wb();if(t.name!==Sb.SAFARI&&t.os!==yb.IOS)return;const n=e.attributes.extmaps.findIndex((e=>/video-orientation/g.test(e.extensionName)));-1!==n&&e.attributes.extmaps.splice(n,1)}(r),QX(r,n,this.localCapabilities.send),r}mungSendMediaDesc(e,t){const n=Uj(e);return QX(n,t,this.localCapabilities.recv),WX(n),n}updateRecvMedia(e,t){const n=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==n){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],t);this.sessionDesc.mediaDescriptions[n]=e}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find((t=>Ub()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port))}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find((t=>{var n,r;return(null===(n=t.attributes)||void 0===n||null===(r=n.ssrcs[0])||void 0===r?void 0:r.ssrcId)===e[0].ssrcId}))}getSSRC(e){var t;return null===(t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e)))||void 0===t?void 0:t.attributes.ssrcs}})||_Z;var TZ,RZ;function vZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vZ(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vZ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let SZ=PD("P2PConnection","store.p2pId")((YV((RZ=class e extends Pk{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}constructor(t,n){super(t,n),iw(this,"store",void 0),iw(this,"peerConnection",void 0),iw(this,"remoteSDP",void 0),iw(this,"initialOffer",void 0),iw(this,"transportEventReceiver",void 0),iw(this,"statsFilter",void 0),iw(this,"useRTX",$D("USE_RTX")),iw(this,"localCapabilities",void 0),iw(this,"localCandidateCount",0),iw(this,"allCandidatesReceived",!1),iw(this,"mutex",new SG("P2PConnection-mutex")),this.store=n,this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t),{optional:[{googDscp:!0}]}),this.statsFilter=pZ(this.peerConnection,void 0,void 0,Ub()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const e=await this.peerConnection.createOffer();if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=MX(e.sdp),n=await async function(e,t,n,r,i){const o=new RTCPeerConnection;o.addTransceiver("video",{direction:"sendonly"}),o.addTransceiver("audio",{direction:"sendonly"}),o.addTransceiver("video",{direction:"recvonly"}),o.addTransceiver("audio",{direction:"recvonly"});const s=(await o.createOffer()).sdp,a=xX(s,e,t,n,r,i,"sendonly"),c=xX(s,e,t,n,r,i,"recvonly"),u={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},l={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},d={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(jX(a,c,"videoExtensions",u,l,d),jX(a,c,"videoCodecs",u,l,d),jX(a,c,"audioExtensions",u,l,d),jX(a,c,"audioCodecs",u,l,d),$D("RAISE_H264_BASELINE_PRIORITY")){const e=d.videoCodecs.findIndex((e=>{var t,n;return"h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&"42001f"===(null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"])}));if(-1!==e){const t=d.videoCodecs.findIndex((e=>{var t;return"h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())}));if(t<e){uD.debug("raising H264 baseline profile priority");const n=d.videoCodecs[e];d.videoCodecs.splice(e,1),d.videoCodecs.splice(t,0,n)}-1!==t&&(l.videoCodecs=l.videoCodecs.filter((e=>{var t,n;return!("h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"]))}))),-1!==t&&$D("FILTER_SEND_H264_BASELINE")&&(u.videoCodecs=u.videoCodecs.filter((e=>{var t,n;return!("h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(n=e.fmtp)||void 0===n?void 0:n.parameters["profile-level-id"]))})))}}try{o.close()}catch(e){}return{send:u,recv:l,sendrecv:d}}(!this.useRTX,$D("FILTER_VIDEO_FEC"),$D("FILTER_AUDIO_FEC"));return this.localCapabilities=HX(n),this.initialOffer=e,yZ(yZ({},t),{},{rtpCapabilities:n,offerSDP:e.sdp})}catch(e){throw new eD(ZN.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e,t,n,r,i,o){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new IZ({remoteIceParameters:e,remoteDtlsParameters:t,candidates:n,remoteRTPCapabilities:r,remoteSetup:i,localCapabilities:this.localCapabilities,cname:o});const s=this.remoteSDP.toString(),a=LX.exports.parse(this.initialOffer.sdp),c=a.mediaDescriptions.find((e=>"audio"===e.media.mediaType));c&&WX(c);const u=LX.exports.print(a),l=this.logSDPExchange(u||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),null==l||l(s),await this.peerConnection.setRemoteDescription({type:"answer",sdp:s});const d=this.peerConnection.getTransceivers()[0];if(null!=d&&d.receiver&&this.tryBindTransportEvents(d.receiver),$D("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t)}}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}send(e,t,n){var r=this;return aX((function*(){const i=yield cX(r.mutex.lock());try{if(!r.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const o=[];e.forEach((e=>{const t=r.peerConnection.addTransceiver(e._mediaStreamTrack,{direction:"sendonly"});o.push(t)})),Ub()&&!0===$D("SIMULCAST")&&(CD("debug",r,"apply simulcast for firefox"),yield cX(r.applySimulcastForFirefox(o,e)));const s=yield cX(r.peerConnection.createOffer()),a=r.remoteSDP.predictReceivingMids(e.length),c=r.mungSendOfferSDP(s.sdp,e,a),u=LX.exports.parse(c),l=a.map((e=>{const t=u.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return function(e,t){const n=[],r=e.attributes.ssrcGroups.filter((e=>"FID"===e.semantic)),i=e.attributes.ssrcGroups.find((e=>"SIM"===e.semantic)),o=e.attributes.ssrcs;if(i)i.ssrcIds.forEach((e=>{var i;const o=null===(i=r.find((t=>t.ssrcIds[0]===e)))||void 0===i?void 0:i.ssrcIds[1];n.push({ssrcId:e,rtx:t?o:void 0})}));else if(r.length>0){const e=r[0].ssrcIds[0],i=r[0].ssrcIds[1];n.push({ssrcId:e,rtx:t?i:void 0})}else{if(0===o.length)throw new Error("No ssrcs found on local media description.");n.push({ssrcId:o[0].ssrcId})}return n}(t,r.useRTX)}));let d;try{d=yield l}catch(i){d=[],r.remoteSDP.receive(e,t,n,d);const o=r.remoteSDP.toString();throw yield cX(r.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield cX(r.peerConnection.setRemoteDescription({type:"answer",sdp:o})),yield cX(r.stopSending(a,!0)),i}r.remoteSDP.receive(e,t,n,d);const h=r.remoteSDP.toString(),p=r.logSDPExchange(c,"offer","local","send");return yield cX(r.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield cX(r.applySimulcastEncodings(o,e)),yield cX(r.applySendEncodings(o,e)),null==p||p(h),yield cX(r.peerConnection.setRemoteDescription({type:"answer",sdp:h})),o.map(((e,t)=>{const n=a[t];return{localSSRC:l[t],id:n,transceiver:e}}))}catch(e){throw e instanceof eD?e:new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{i()}}))()}async stopSending(e,t){const n=t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter((t=>-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");t.map((e=>{var t;e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)}));const r=await this.peerConnection.createOffer(),i=this.logSDPExchange(r.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(r),this.remoteSDP.stopReceiving(e);const o=this.remoteSDP.toString();null==i||i(o),await this.peerConnection.setRemoteDescription({type:"answer",sdp:o})}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}finally{n&&n()}}async receive(e,t,n,r){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:i,needExchangeSDP:o}=this.remoteSDP.send(e,t,n,r);if(o){const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer(),o=this.mungReceiveAnswerSDP(r.sdp,i,e);null==n||n(o||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:o}),uD.debug("[P2PConnection] receive ".concat(e," by exchanging SDP."))}else uD.debug("[P2PConnection] receive ".concat(e," no need to exchange SDP."));const s=this.peerConnection.getTransceivers().find((e=>e.mid===i));if(!s)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:s.receiver.track,id:i}}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:t,needExchangeSDP:n}=this.remoteSDP.batchSend(e);if(n){const e=this.remoteSDP.toString(),t=this.logSDPExchange(e,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const n=await this.peerConnection.createAnswer();null==t||t(n.sdp||""),await this.peerConnection.setLocalDescription(n),uD.debug("[P2PConnection] batchReceive by exchanging SDP.")}else uD.debug("[P2PConnection] batchReceive no need to exchange SDP.");return t.map((e=>{const t=this.peerConnection.getTransceivers().find((t=>t.mid===e));if(!t)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:t.receiver.track,id:e}}))}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.mute(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(e.toString()))}}async unmuteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.unmute(e);const t=this.remoteSDP.toString(),n=this.logSDPExchange(t,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const r=await this.peerConnection.createAnswer();null==n||n(r.sdp||""),await this.peerConnection.setLocalDescription(r)}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(e.toString()))}}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((e=>{e.direction="inactive"}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.muteRemote(e);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((async(e,t)=>{e.direction="sendonly"}));const n=await this.peerConnection.createOffer(),r=this.logSDPExchange(n.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(n),this.remoteSDP.unmuteRemote(e);const i=this.remoteSDP.toString();null==r||r(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}async reEstablish(){const e=await this.peerConnection.createOffer({iceRestart:!0});if(!e.sdp)throw new Error("Cannot get SDP from restart offer.");return{iceParameters:MX(e.sdp).iceParameters,restartICE:async(t,n)=>this.restartICE(e,t,n),restartOfferSDP:e.sdp}}close(){var e;this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const n=await this.peerConnection.createOffer(),r=this.mungSendOfferSDP(n.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const i=this.remoteSDP.toString(),o=this.logSDPExchange(r,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:r}),null==o||o(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const n=this.peerConnection.getTransceivers().filter((t=>t.mid===e));1===n.length&&(this.isVP8Simulcast(t)?Ub()||await this.applySimulcastEncodings(n,[t]):await this.applySendEncodings(n,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const n=this.peerConnection.getTransceivers().find((e=>e.mid===t));n&&await n.sender.replaceTrack(e._mediaStreamTrack)}async restartICE(e,t,n){try{if(!this.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");this.remoteSDP.restartICE(t,n);const r=this.remoteSDP.toString(),i=this.logSDPExchange(e.sdp||"","offer","local","restartICE");await this.peerConnection.setLocalDescription(e),null==i||i(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new eD(ZN.EXCHANGE_SDP_FAILED,"P2PConnection.restartICE failed; ".concat(e.toString()))}}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,uD.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout((()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,uD.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))}),$D("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t){const n={iceServers:[]};return t.iceServers?n.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(VP(t.turnServer.servers)?n.iceServers=t.turnServer.servers:(n.iceServers&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers)),$D("USE_TURN_SERVER_OF_GATEWAY")&&n.iceServers&&t.turnServer.serversFromGateway&&n.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway)),$D("FORCE_TURN_TCP")?n.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(n.iceTransportPolicy="relay")})))),n}static turnServerConfigToIceServers(e){const t=[];return e.forEach((e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(lj(e.turnServerURL),":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&!$D("FORCE_TURN_TCP")&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))})),t}tryBindTransportEvents(e){e.transport&&(this.transportEventReceiver=e,e.transport.onstatechange=()=>{var t,n;null!==(t=e.transport)&&void 0!==t&&t.state&&(null===(n=this.onDTLSTransportStateChange)||void 0===n||n.call(this,e.transport.state))},e.transport.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,e.error)},e.transport.iceTransport&&(e.transport.iceTransport.onstatechange=()=>{var t,n,r;null!==(t=e.transport)&&void 0!==t&&t.iceTransport.state&&(null===(n=this.onICETransportStateChange)||void 0===n||n.call(this,null===(r=e.transport)||void 0===r?void 0:r.iceTransport.state))}))}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async applySendEncodings(e,t){try{if(!Gk().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let c=0;c<e.length;c++){const u=e[c],l=t[c];if(l&&l instanceof Zz){var n,r;if(this.isVP8Simulcast(l))continue;const e={},t={};switch(l._optimizationMode){case"motion":e.degradationPreference="maintain-framerate";break;case"detail":e.degradationPreference="maintain-resolution";break;default:e.degradationPreference="balanced"}var i,o,s,a;if(null!==(n=l._encoderConfig)&&void 0!==n&&n.bitrateMax&&(t.maxBitrate=1e3*(null===(i=l._encoderConfig)||void 0===i?void 0:i.bitrateMax)),l._hints.includes(fk.LOW_STREAM)&&(null!==(o=l._encoderConfig)&&void 0!==o&&o.frameRate&&(t.maxFramerate=hj(l._encoderConfig.frameRate)),null!==(s=l._encoderConfig)&&void 0!==s&&s.scaleResolutionDownBy&&(null===(a=l._encoderConfig)||void 0===a?void 0:a.scaleResolutionDownBy)>1&&(t.scaleResolutionDownBy=l._encoderConfig.scaleResolutionDownBy)),$D("DSCP_TYPE")&&$b()){const e=$D("DSCP_TYPE");["very-low","low","medium","high"].includes(e)&&(t.networkPriority=e)}const c=u.sender.getParameters(),d=null===(r=c.encodings)||void 0===r?void 0:r[0];Ub()&&!d&&(e.encodings=[t]),d&&Object.assign(d,t),Object.assign(c,e),await u.sender.setParameters(c)}}}catch(e){uD.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(e,t,n){const r=LX.exports.parse(e);return t.forEach(((e,t)=>{const i=n[t],o=r.mediaDescriptions.find((e=>e.attributes.mid===i));o&&(FX(o,e),function(e,t,n){if(Ub())return;if("video"!==e.media.mediaType)return;if(!(t instanceof Zz))return;if("vp9"!==n&&"vp8"!==n)return;if("vp8"===n&&!$D("SIMULCAST"))return;if(void 0===t._scalabiltyMode||t._scalabiltyMode.numSpatialLayers<=1)return;const r="vp8"===n?2:t._scalabiltyMode.numSpatialLayers,i=e.attributes.ssrcs[0],o=e.attributes.ssrcGroups.find((e=>"FID"===e.semantic&&e.ssrcIds[0]===i.ssrcId)),s={semantic:"SIM",ssrcIds:[i.ssrcId]};for(let t=1;t<r;t++)e.attributes.ssrcs.push({ssrcId:i.ssrcId+t,attributes:Uj(i.attributes)}),s.ssrcIds.push(i.ssrcId+t),o&&(e.attributes.ssrcs.push({ssrcId:o.ssrcIds[1]+t,attributes:Uj(i.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[i.ssrcId+t,o.ssrcIds[1]+t]}));e.attributes.ssrcGroups.unshift(s)}(o,e,this.store.codec))})),LX.exports.print(r)}mungReceiveAnswerSDP(e,t,n){const r=LX.exports.parse(e),i=r.mediaDescriptions.find((e=>e.attributes.mid===t));return i&&n===Ok.AUDIO&&"audio"===i.media.mediaType&&WX(i),LX.exports.print(r)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,n)=>{var r;null===(r=this.onFirstVideoDecoded)||void 0===r||r.call(this,e,t,n)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedLocalCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var n;null===(n=this.onSelectedRemoteCandidateChanged)||void 0===n||n.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let s=0;s<e.length;s++){var n,r,i,o;const a=e[s],c=t[s];if(c instanceof Zz&&!c._hints.includes(fk.LOW_STREAM)&&null!==(n=c._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=c._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(i=c._scalabiltyMode)&&void 0!==i&&i.numSpatialLayers&&(null===(o=c._scalabiltyMode)||void 0===o?void 0:o.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(c._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const n=a.sender.getParameters();await a.sender.setParameters(Object.assign(n,e))}}}async applySimulcastEncodings(e,t){if(!Ub()&&e.length===t.length)for(let n=0;n<e.length;n++){const r=t[n];if(r instanceof Zz&&this.isVP8Simulcast(r)){const t=e[n],i={},o={high:1e3*(r._encoderConfig.bitrateMax-50),medium:5e4};i.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:o.medium,scaleResolutionDownBy:4}];const s=t.sender.getParameters();await t.sender.setParameters(Object.assign(s,i))}}}isVP8Simulcast(e){var t,n,r,i;return!!(e instanceof Zz&&$D("SIMULCAST")&&"vp8"===this.store.codec&&!e._hints.includes(fk.LOW_STREAM)&&null!==(t=e._encoderConfig)&&void 0!==t&&t.bitrateMax&&(null===(n=e._encoderConfig)||void 0===n?void 0:n.bitrateMax)>200&&null!==(r=e._scalabiltyMode)&&void 0!==r&&r.numSpatialLayers&&(null===(i=e._scalabiltyMode)||void 0===i?void 0:i.numSpatialLayers)>1)}logSDPExchange(e,t,n,r){if($D("SDP_LOGGING"))return uD.upload("exchanging ".concat(n," ").concat(t," SDP during P2PConnection.").concat(r,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===n?"remote":"local",r)}:void 0}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return null==t?void 0:t[0].ssrcId}}).prototype,"connect",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"connect"),RZ.prototype),YV(RZ.prototype,"receive",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"receive"),RZ.prototype),YV(RZ.prototype,"batchReceive",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"batchReceive"),RZ.prototype),YV(RZ.prototype,"stopReceiving",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"stopReceiving"),RZ.prototype),YV(RZ.prototype,"muteRemote",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"muteRemote"),RZ.prototype),YV(RZ.prototype,"unmuteRemote",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"unmuteRemote"),RZ.prototype),YV(RZ.prototype,"muteLocal",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"muteLocal"),RZ.prototype),YV(RZ.prototype,"unmuteLocal",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"unmuteLocal"),RZ.prototype),YV(RZ.prototype,"reEstablish",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"reEstablish"),RZ.prototype),YV(RZ.prototype,"close",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"close"),RZ.prototype),YV(RZ.prototype,"updateEncoderConfig",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"updateEncoderConfig"),RZ.prototype),YV(RZ.prototype,"updateSendParameters",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"updateSendParameters"),RZ.prototype),YV(RZ.prototype,"replaceTrack",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"replaceTrack"),RZ.prototype),YV(RZ.prototype,"restartICE",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"restartICE"),RZ.prototype),YV(RZ.prototype,"getRemoteSSRC",[CZ],Object.getOwnPropertyDescriptor(RZ.prototype,"getRemoteSSRC"),RZ.prototype),TZ=RZ))||TZ;function CZ(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PConnection.".concat(t));try{for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return await r.apply(this,o)}finally{n()}},n}function OZ(e,t){let n=document.createElement("video"),r=document.createElement("canvas");n.setAttribute("style","display:none"),r.setAttribute("style","display:none"),n.setAttribute("muted",""),n.muted=!0,n.setAttribute("autoplay",""),n.autoplay=!0,n.setAttribute("playsinline",""),r.width=hj(t.width),r.height=hj(t.height);const i=hj(t.framerate||15);document.body.append(n),document.body.append(r);let o=e._mediaStreamTrack;n.srcObject=new MediaStream([o]),n.play();const s=r.getContext("2d");if(!s)throw new eD(ZN.UNEXPECTED_ERROR,"can not get canvas context");const a=Gk(),c=r.captureStream(a.supportRequestFrame?0:i).getVideoTracks()[0],u=BG((()=>(()=>{if(n.paused&&n.play(),n.videoHeight>2&&n.videoWidth>2){const e=n.videoWidth,t=n.videoHeight/e,i=r.width*t;Math.abs(i-r.height)>=2&&(uD.debug("adjust low stream resolution","".concat(r.width,"x").concat(r.height," -> ").concat(r.width,"x").concat(i)),r.height=i)}s.drawImage(n,0,0,r.width,r.height),c.requestFrame&&c.requestFrame(),o!==e._mediaStreamTrack&&(o=e._mediaStreamTrack,n.srcObject=new MediaStream([o]))})()),i),l=c.stop;return c.stop=()=>{l.call(c),u(),n&&(n.remove(),n=null),r&&(r.width=0,r.remove(),r=null),uD.debug("clean low stream renderer")},c}var bZ,wZ;function NZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function DZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?NZ(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NZ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class LZ extends IG{getUserId(){return this._userId}constructor(e,t,n,r){super(e,"track-".concat(e.kind,"-").concat(t,"-").concat(r.clientId,"_").concat(Sj(5,""))),iw(this,"_userId",void 0),iw(this,"_uintId",void 0),iw(this,"_isDestroyed",!1),iw(this,"store",void 0),iw(this,"processor",void 0),iw(this,"processorContext",void 0),this._userId=t,this._uintId=n,this.store=r}_updateOriginMediaStreamTrack(e){this._originMediaStreamTrack=e,this._mediaStreamTrack=e,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,uD.info("[".concat(this.getTrackId(),"] is destroyed")),ND("info",this,"_destroy"),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}}let PZ=PD("RemoteVideoTrack","getTrackId")(bZ=class extends LZ{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==lP.PLAYING)}constructor(e,t,n,r){super(e,t,n,r),iw(this,"_videoVisibleTimer",null),iw(this,"_previousVideoVisibleStatus",void 0),iw(this,"_clearPreviousVideoVisibleStatus",(()=>this._previousVideoVisibleStatus=void 0)),iw(this,"trackMediaType","video"),iw(this,"_videoWidth",void 0),iw(this,"_videoHeight",void 0),iw(this,"_player",void 0),iw(this,"processorDestination",void 0),iw(this,"processorContext",void 0),ND("info",this,"constructor",{userId:t}),this.updateMediaStreamTrackResolution(),this.processorContext=new YQ(this.getTrackId()),this.processorDestination=new WQ(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return Fj((()=>{uD.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead"),CD("warning",this,"[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")}),"remoteVideoTrackGetStatsWarning"),Lj(this,pk.GET_STATS)||DZ({},KP)}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.REMOTE_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof e?e:"HTMLElement",t]});if("string"==typeof e){const t=document.getElementById(e);t?e=t:(uD.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),CD("warning",this,'can not find "#'.concat(e,'" element, use document.body')),e=document.body)}uD.debug("[".concat(this.getTrackId(),"] start video playback"),JSON.stringify(t)),ND("debug",this,"play",t);const r=DZ(DZ({fit:"cover"},t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(r):(this._player=new z$(r),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.emit(_k.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval((()=>{try{const e=this.getVideoElementVisibleStatus();this.emit(_k.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}}),$D("CHECK_VIDEO_VISIBLE_INTERVAL")),n.onSuccess()}stop(){const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.REMOTE_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return e.onSuccess();this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,uD.debug("[".concat(this.getTrackId(),"] stop video playback")),ND("debug",this,"stop"),e.onSuccess()}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){bj(this._originMediaStreamTrack).then((e=>{let[t,n]=e;this._videoHeight=n,this._videoWidth=t})).catch(Oj)}_updatePlayerSource(){uD.debug("[".concat(this.getTrackId(),"] update player source track")),ND("debug",this,"_updatePlayerSource"),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;const n=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),r={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==n?void 0:n.parentElement},{element:i,slot:o}=r;if(this.isPlaying&&i instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=qz.checkOneElementVisible(i),t=Object.assign({},e);if(t.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=t.visible;const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});t.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(t.reason))}return t}return}catch(e){throw new eD(ZN.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new eD(ZN.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(xk.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(xk.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}})||bZ,kZ=PD("RemoteAudioTrack","getTrackId")(wZ=class extends LZ{get isPlaying(){return this._useAudioElement?oQ.isPlaying(this.getTrackId()):this._source.isPlayed}constructor(e,t,n,r){super(e,t,n,r),iw(this,"trackMediaType","audio"),iw(this,"_source",void 0),iw(this,"_useAudioElement",!0),iw(this,"_volume",100),iw(this,"processorContext",void 0),iw(this,"processorDestination",void 0),iw(this,"_played",!1),ND("info",this,"constructor",{userId:t}),$D("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1),this._source=new jG(e,!0),this._source.once(UP.RECEIVE_TRACK_BUFFER,(()=>{this.emit(_k.FIRST_FRAME_DECODED)})),this.processorContext=new $Q(this._source.context,this.getTrackId()),this.processorDestination=new KQ(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(UP.UPDATE_SOURCE,(()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})}))}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(UP.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(UP.ON_AUDIO_BUFFER),this._source.on(UP.ON_AUDIO_BUFFER,(t=>e(t)))}setVolume(e){const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.REMOTE_AUDIO_SET_VOLUME,options:[this.getTrackId(),e]},300);this._volume=e,this._useAudioElement?oQ.setVolume(this.getTrackId(),e):this._source.setVolume(e/100),t.onSuccess()}async setPlaybackDevice(e){const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),e]});if(!this._useAudioElement)throw new eD(ZN.NOT_SUPPORTED,"your browser does not support setting the audio output device");try{await oQ.setSinkID(this.getTrackId(),e)}catch(e){throw t.onError(e),e}t.onSuccess()}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return Fj((()=>{uD.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead"),CD("warning",this,"[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")}),"remoteAudioTrackGetStatsWarning"),Lj(this,pk.GET_STATS)||DZ({},WP)}play(){const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.REMOTE_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});uD.debug("[".concat(this.getTrackId(),"] start audio playback")),ND("debug",this,"play"),this._played=!0,this._useAudioElement?(uD.debug("[".concat(this.getTrackId(),"] use audio element to play")),CD("debug",this,"use audio element to play"),oQ.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play(),e.onSuccess()}stop(){const e=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.REMOTE_AUDIO_TRACK_STOP,options:[this.getTrackId()]});uD.debug("[".concat(this.getTrackId(),"] stop audio playback")),ND("debug",this,"stop"),this._played=!1,this._useAudioElement?oQ.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];uD.debug("[".concat(this.getTrackId(),"] update player source track")),ND("debug",this,"_updatePlayerSource"),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&oQ.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this.processor===e)return e;if(e._source)throw new eD(ZN.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(xk.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})),this.processorDestination.on(xk.ON_NODE,(e=>{this._source.processedNode=e;const t=!e;this._useAudioElement!==t&&(this._played?(this.stop(),this._useAudioElement=t,this.play()):this._useAudioElement=t)}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(xk.ON_TRACK),this.processorDestination.removeAllListeners(xk.ON_NODE)}})||wZ;function xZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function MZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xZ(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xZ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class UZ extends JN{constructor(){super(),iw(this,"uplinkStatsUploadInterval",void 0),iw(this,"uplinkStatsUploadSlowInterval",void 0),iw(this,"uplinkRelatedStatsUploadInterval",void 0),iw(this,"uplinkDenoiserStatsUploadInterval",void 0),iw(this,"transportStatsUploadInterval",void 0),iw(this,"uplinkExtensionStatsUploadInterval",void 0),iw(this,"downlinkExtensionStatsUploadInterval",void 0),iw(this,"downlinkStatsUploadInterval",void 0),iw(this,"downlinkStatsUploadSlowInterval",void 0),iw(this,"downlinkRelatedStatsUploadInterval",void 0),iw(this,"lastStats",void 0),iw(this,"uploadUnplinkStarted",!1),iw(this,"uploadDownlinkStarted",!1),iw(this,"uploadTransportStarted",!1),iw(this,"requestStats",void 0),iw(this,"requestLocalMedia",void 0),iw(this,"requestRemoteMedia",void 0),iw(this,"requestAllTracks",void 0),iw(this,"requestVideoIsReady",void 0),iw(this,"requestUpload",void 0)}startUploadTransportStats(){this.uploadTransportStarted||(this.uploadTransportStarted=!0,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=window.setInterval((()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&this.uploadTransportStats(t)}),6e3))}startUploadUplinkStats(){this.uploadUnplinkStarted||(this.uploadUnplinkStarted=!0,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkStatsUploadInterval=window.setInterval((()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&(this.uploadUplinkStats(t,this.lastStats),this.lastStats=t)}),3e3),this.uplinkStatsUploadSlowInterval&&window.clearInterval(this.uplinkStatsUploadSlowInterval),this.uplinkStatsUploadSlowInterval=window.setInterval((()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&this.uploadSlowUplinkStats(t)}),6e4),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkRelatedStatsUploadInterval=window.setInterval((()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&this.uploadRelatedUplinkStats(t,this.lastStats),this.lastStats=t}),1e3),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval=window.setInterval((()=>{var e;const t=null===(e=this.requestAllTracks)||void 0===e?void 0:e.call(this);t&&this.uploadDenoiserStats(t)}),2e3),this.uplinkExtensionStatsUploadInterval&&window.clearInterval(this.uplinkExtensionStatsUploadInterval),this.uplinkExtensionStatsUploadInterval=window.setInterval((()=>{var e;const t=null===(e=this.requestAllTracks)||void 0===e?void 0:e.call(this);t&&this.uploadExtensionStats(t)}),2e3))}uploadTransportStats(e){Mj((()=>{var t;null===(t=this.requestUpload)||void 0===t||t.call(this,kP.TRANSPORT_STATS,function(e){const t={connectionType:100};if("relay"===e.selectedCandidatePair.localCandidate.candidateType){const n=e.selectedCandidatePair.localCandidate.relayProtocol;"udp"===n&&(t.connectionType=101),"tcp"===n&&(t.connectionType=103),"tls"===n&&(t.connectionType=104)}return t}(e))}))}uploadUplinkStats(e,t){var n;((null===(n=this.requestLocalMedia)||void 0===n?void 0:n.call(this))||[]).forEach((n=>{let[r,{track:i,ssrcs:o}]=n;switch(r){case bk.LocalVideoLowTrack:case bk.LocalVideoTrack:{const n=function(e,t,n){var r;const i=t.videoSend.find((t=>t.ssrc===e));if(!i)return null;const o={id:Sj(10,""),timestamp:new Date(t.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:i.ssrc.toString()};switch(o.A_vstd=n._originMediaStreamTrack&&!n._originMediaStreamTrack.enabled||n._mediaStreamTrack&&!n._mediaStreamTrack.enabled?"1":"0",i.sentFrame&&(o.A_fhs=i.sentFrame.height.toString(),o.A_frs=i.sentFrame.frameRate.toString(),o.A_fws=i.sentFrame.width.toString()),i.adaptionChangeReason){case"none":o.A_ac="0";break;case"cpu":o.A_ac="1";break;case"bandwidth":o.A_ac="2";break;case"other":o.A_ac="3"}return o.A_lvps=dP[n._player?n._player.videoElementStatus:"uninit"].toString(),o.A_nr=null===(r=i.nacksCount)||void 0===r?void 0:r.toString(),i.avgEncodeMs&&(o.A_aem=i.avgEncodeMs.toFixed(0).toString()),o}(o[0].ssrcId,e,i),s=fj(o[0].ssrcId,e,t);n&&Mj((()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,kP.PUBLISH_STATS,{stream_type:r===bk.LocalVideoLowTrack?"low":"high",stats:MZ(MZ({},n),s)})}));break}case bk.LocalAudioTrack:{const t=function(e,t,n){const r=t.audioSend.find((t=>t.ssrc===e));if(!r)return null;const i={id:Sj(10,""),timestamp:new Date(t.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:r.ssrc.toString()};return i.A_astd=n._originMediaStreamTrack.enabled&&n._mediaStreamTrack.enabled?"0":"1",r.inputLevel?i.A_ail=Math.round(100*r.inputLevel).toString():i.A_ail=Math.round(100*n._source.getAccurateVolumeLevel()).toString(),i.A_apil=Math.round(100*n._source.getAccurateVolumeLevel()).toString(),r.aecReturnLoss&&(i.A_ecrl=Math.round(r.aecReturnLoss).toString()),r.aecReturnLossEnhancement&&(i.A_ecrle=Math.round(r.aecReturnLossEnhancement).toString()),i}(o[0].ssrcId,e,i);t&&Mj((()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,kP.PUBLISH_STATS,{stream_type:"high",stats:t})}));break}}const s=function(e){const t={id:"bweforvideo",timestamp:new Date(e.timestamp).toISOString(),type:"VideoBwe"};return e.bitrate.retransmit&&(t.A_rb=e.bitrate.retransmit.toString()),e.bitrate.targetEncoded&&(t.A_teb=e.bitrate.targetEncoded.toString()),t.A_aeb=e.bitrate.actualEncoded.toString(),t.A_tb=e.bitrate.transmit.toString(),void 0!==e.sendBandwidth&&(t.A_asb=e.sendBandwidth.toString()),t}(e);s&&Mj((()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,kP.PUBLISH_STATS,{stream_type:r===bk.LocalVideoLowTrack?"low":"high",stats:s})}))}))}uploadSlowUplinkStats(e){var t;((null===(t=this.requestLocalMedia)||void 0===t?void 0:t.call(this))||[]).filter((e=>{let[t]=e;return t===bk.LocalVideoLowTrack||t===bk.LocalVideoTrack})).forEach((t=>{let[n,{ssrcs:r}]=t;const i=fj(r[0].ssrcId,e);i&&Mj((()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,kP.PUBLISH_STATS,{stream_type:n===bk.LocalVideoLowTrack?"low":"high",stats:i})}))}))}uploadRelatedUplinkStats(e,t){var n;((null===(n=this.requestLocalMedia)||void 0===n?void 0:n.call(this))||[]).filter((e=>{let[t]=e;return t===bk.LocalVideoLowTrack||t===bk.LocalVideoTrack})).forEach((t=>{let[n,{ssrcs:r}]=t;const i=function(e,t){const n=t.videoSend.find((t=>t.ssrc===e));return n?{mediaType:"video",isVideoMute:!1,frameRateInput:n.inputFrame&&n.inputFrame.frameRate.toString(),frameRateSent:n.sentFrame&&n.sentFrame.frameRate.toString(),googRtt:n.rttMs.toString(),qpSumPerFrame:Math.floor(n.qpSumPerFrame).toString()}:null}(r[0].ssrcId,e);i&&Mj((()=>{var e;null===(e=this.requestUpload)||void 0===e||e.call(this,kP.PUBLISH_RELATED_STATS,{stream_type:n===bk.LocalVideoLowTrack?"low":"high",stats:i})}))}))}uploadDenoiserStats(e){for(let i=0;i<e.length;i++){const o=e[i];if(o instanceof XQ){var t,n,r;const e=null===(t=(n=o._external).getDenoiserStats)||void 0===t?void 0:t.call(n);return void(e&&(null===(r=this.requestUpload)||void 0===r||r.call(this,kP.DENOISER_STATS,e)))}}}uploadExtensionStats(e){for(let t=0;t<e.length;t++)e[t].getProcessorStats().forEach((e=>{var t;null===(t=this.requestUpload)||void 0===t||t.call(this,e.type,e.stats)}))}stopUploadUplinkStats(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStatsUploadInterval&&window.clearInterval(this.uplinkStatsUploadInterval),this.uplinkRelatedStatsUploadInterval&&window.clearInterval(this.uplinkRelatedStatsUploadInterval),this.uplinkDenoiserStatsUploadInterval&&window.clearInterval(this.uplinkDenoiserStatsUploadInterval),this.uplinkStatsUploadInterval=void 0,this.uplinkRelatedStatsUploadInterval=void 0,this.uplinkDenoiserStatsUploadInterval=void 0)}startUploadDownlinkStats(){this.uploadDownlinkStarted||(this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkStatsUploadInterval=window.setInterval((()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&(this.uploadDownlinkStats(t,this.lastStats),this.lastStats=t)}),3e3),this.downlinkStatsUploadSlowInterval&&window.clearInterval(this.downlinkStatsUploadSlowInterval),this.downlinkStatsUploadSlowInterval=window.setInterval((()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&this.uploadSlowDownlinkStats(t)}),6e4),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkRelatedStatsUploadInterval=window.setInterval((()=>{var e;const t=null===(e=this.requestStats)||void 0===e?void 0:e.call(this);t&&(this.uploadRelatedDownlinkStats(t,this.lastStats),this.lastStats=t)}),1e3),this.downlinkExtensionStatsUploadInterval&&window.clearInterval(this.downlinkExtensionStatsUploadInterval),this.downlinkExtensionStatsUploadInterval=window.setInterval((()=>{var e;const t=null===(e=this.requestRemoteMedia)||void 0===e?void 0:e.call(this);t&&this.uploadDownlinkExtensionStats(t)}),2e3))}uploadDownlinkStats(e,t){var n;((null===(n=this.requestRemoteMedia)||void 0===n?void 0:n.call(this))||[]).forEach((t=>{let[n,r]=t;if(r.has(Ok.VIDEO)&&n.videoTrack){const t=n.videoTrack?function(e,t,n){const r=t.videoRecv.find((t=>t.ssrc===e));if(!r)return null;const i={id:Sj(10,""),timestamp:new Date(t.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:r.ssrc.toString()};var o,s;return i.bytesReceived=r.bytes.toString(),i.packetsLost=r.packetsLost.toString(),i.packetsReceived=r.packets.toString(),r.framesRateFirefox&&(i.A_frr=r.framesRateFirefox.toString()),r.receivedFrame?(i.A_frr=r.receivedFrame.frameRate.toString(),i.A_fhr=r.receivedFrame.height.toString(),i.A_fwr=r.receivedFrame.width.toString()):(i.A_fhr=null===(o=n._videoHeight)||void 0===o?void 0:o.toString(),i.A_fwr=null===(s=n._videoWidth)||void 0===s?void 0:s.toString()),i.A_frd=r.decodeFrameRate.toString(),r.outputFrame&&(i.A_fro=r.outputFrame.frameRate.toString()),void 0!==r.jitterBufferMs&&(i.A_jbm=Math.floor(r.jitterBufferMs).toString()),void 0!==r.currentDelayMs&&(i.A_cdm=Math.floor(r.currentDelayMs).toString()),i.A_fs=r.firsCount.toString(),i.A_ns=r.nacksCount.toString(),i.A_ps=r.plisCount.toString(),n&&(i.A_vrtd=n._originMediaStreamTrack.enabled&&n._mediaStreamTrack.enabled?"0":"1"),n._player&&n._player.freezeTimeCounterList.length>0&&(i.A_vrft=n._player.freezeTimeCounterList.splice(0,1)[0].toString()),i.A_rvps=dP[n._player?n._player.videoElementStatus:"uninit"].toString(),i}(n._videoSSRC,e,n.videoTrack):void 0;t&&Mj((()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,kP.SUBSCRIBE_STATS,{stream_id:n.uid,stats:t})}))}if(r.has(Ok.AUDIO)&&n.audioTrack){const t=n.audioTrack?function(e,t,n){const r=t.audioRecv.find((t=>t.ssrc===e));if(!r)return null;const i={id:Sj(10,""),timestamp:new Date(t.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:r.ssrc.toString()};return i.bytesReceived=r.bytes.toString(),i.packetsLost=r.packetsLost.toString(),i.packetsReceived=r.packets.toString(),r.outputLevel?i.A_aol=Math.round(100*r.outputLevel).toString():i.A_aol=Math.round(100*n._source.getAccurateVolumeLevel()).toString(),i.A_apol=Math.round(100*n._source.getAccurateVolumeLevel()).toString(),n&&(i.A_artd=n._originMediaStreamTrack.enabled&&n._mediaStreamTrack.enabled?"0":"1"),i.A_jr=r.jitterMs.toString(),i.A_jbm=Math.floor(r.jitterBufferMs).toString(),i.A_cdm=Math.floor(r.jitterBufferMs).toString(),i.A_raps=dP[oQ.getPlayerState(n.getTrackId())].toString(),i}(n._audioSSRC,e,n.audioTrack):void 0;t&&Mj((()=>{var e;return null===(e=this.requestUpload)||void 0===e?void 0:e.call(this,kP.SUBSCRIBE_STATS,{stream_id:n.uid,stats:t})}))}}))}uploadSlowDownlinkStats(e){}uploadRelatedDownlinkStats(e,t){var n;((null===(n=this.requestRemoteMedia)||void 0===n?void 0:n.call(this))||[]).forEach((n=>{let[r,i]=n;if(i.has(Ok.VIDEO)&&r.videoTrack){var o;const n=!0===(r._videoSSRC&&(null===(o=this.requestVideoIsReady)||void 0===o?void 0:o.call(this,r._videoSSRC))||!1),i=function(e,t,n,r,i,o){const s=n.videoRecv.find((t=>t.ssrc===e)),a=i?i.videoRecv.find((t=>t.ssrc===e)):void 0;if(!s)return null;const c=sj.isRemoteVideoFreeze(o,s,a)&&t,u={mediaType:"video",isVideoMute:!1,peerId:r,frameRateReceived:s.receivedFrame&&s.receivedFrame.frameRate.toString(),frameRateDecoded:s.decodedFrame&&s.decodedFrame.frameRate.toString(),isFreeze:c,bytesReceived:s.bytes.toString(),packetsReceived:s.packets.toString(),packetsLost:s.packetsLost.toString(),qpSumPerFrame:Math.floor(s.qpSumPerFrame).toString()};return s.framesRateFirefox&&(u.frameRateDecoded=s.framesRateFirefox.toString(),u.frameRateReceived=s.framesRateFirefox.toString()),u}(r._videoSSRC,n,e,r.uid,t,r.videoTrack);i&&Mj((()=>{var e;null===(e=this.requestUpload)||void 0===e||e.call(this,kP.SUBSCRIBE_RELATED_STATS,{stream_id:r.uid,stats:i})}))}if(i.has(Ok.AUDIO)&&r.audioTrack){const t=function(e,t,n,r){const i=t.audioRecv.find((t=>t.ssrc===e));if(!i)return null;const o=sj.isRemoteAudioFreeze(r);return{mediaType:"audio",isAudioMute:!1,peerId:n,googJitterReceived:i.jitterMs.toString(),isFreeze:o,bytesReceived:i.bytes.toString(),packetsReceived:i.packets.toString(),packetsLost:i.packetsLost.toString(),frameReceived:i.receivedFrames.toString(),frameDropped:i.droppedFrames.toString()}}(r._audioSSRC,e,r.uid,r.audioTrack);t&&Mj((()=>{var e;null===(e=this.requestUpload)||void 0===e||e.call(this,kP.SUBSCRIBE_RELATED_STATS,{stream_id:r.uid,stats:t})}))}}))}stopUploadDownlinkStats(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval),this.downlinkRelatedStatsUploadInterval&&window.clearInterval(this.downlinkRelatedStatsUploadInterval),this.downlinkStatsUploadInterval=void 0,this.downlinkRelatedStatsUploadInterval=void 0)}stopUploadTransportStats(){this.uploadTransportStarted&&(this.uploadTransportStarted=!1,this.transportStatsUploadInterval&&window.clearInterval(this.transportStatsUploadInterval),this.transportStatsUploadInterval=void 0)}uploadDownlinkExtensionStats(e){e.forEach((e=>{let[t,n]=e;n.has(Ok.VIDEO)&&t.videoTrack&&t.videoTrack.getProcessorStats().forEach((e=>{var t;null===(t=this.requestUpload)||void 0===t||t.call(this,e.type,e.stats)})),n.has(Ok.AUDIO)&&t.audioTrack&&t.audioTrack.getProcessorStats().forEach((e=>{var t;null===(t=this.requestUpload)||void 0===t||t.call(this,e.type,e.stats)}))}))}}var BZ,FZ;function VZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function GZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?VZ(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VZ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function QZ(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=dX,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new jZ(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function jZ(e){function t(e){if(Object(e)!==e)return xv.reject(new TypeError(e+" is not an object."));var t=e.done;return xv.resolve(e.value).then((function(e){return{value:e,done:t}}))}return(jZ=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?xv.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?xv.reject(e):t(n.apply(this.s,arguments))}},new jZ(e)}let HZ=PD("P2PChannel","store.p2pId")((YV((FZ=class extends JN{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(Nk.StateChange,t,this._state)}constructor(e,t){super(),iw(this,"store",void 0),iw(this,"statsUploader",void 0),iw(this,"connection",void 0),iw(this,"localTrackMap",new Map),iw(this,"remoteUserMap",new Map),iw(this,"pendingLocalTracks",[]),iw(this,"pendingRemoteTracks",[]),iw(this,"statsCollector",void 0),iw(this,"isPlanB",!1),iw(this,"iceFailedCount",0),iw(this,"dtlsFailedCount",0),iw(this,"mutex",new SG("P2PChannel-mutex")),iw(this,"_state",wk.Disconnected),iw(this,"handleMuteLocalTrack",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection)return void n(new eD(ZN.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));ND("debug",this,"handleMuteLocalTrack",e.getTrackId()),await this.waitTillConnected();const i=this.filterTobeMutedTracks(e);if(0===i.length)return void t();const o=i.find((e=>"videoLowTrack"===e[0]));o&&o[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(i.map((e=>{let[,{id:t}]=e;return t})));const s=this.createMuteMessage(i);await Dj(this,Nk.RequestMuteLocal,s),t()}catch(e){n(e)}finally{r()}})),iw(this,"handleUnmuteLocalTrack",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection)return void n(new eD(ZN.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));ND("debug",this,"handleUnmuteLocalTrack",e.getTrackId()),await this.waitTillConnected();const i=this.filterTobeUnmutedTracks(e);if(0===i.length)return void t();const o=i.find((e=>"videoLowTrack"===e[0]));if(o){const t=o[1];if(t.track._originMediaStreamTrack.stop(),Gk().supportDualStreamEncoding){const n=e._mediaStreamTrack.clone();t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n}else{const n=OZ(e,Pj(this,Nk.RequestLowStreamParameter));t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n}await new xv(((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)}))}await this.connection.unmuteLocal(i.map((e=>{let[,{id:t}]=e;return t})));const s=this.createUnmuteMessage(i);await Dj(this,Nk.RequestUnmuteLocal,s),t()}catch(e){n(e)}finally{r()}})),iw(this,"handleUpdateVideoEncoder",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const n=this.localTrackMap.get(bk.LocalVideoTrack);if(!this.connection||!n||n.track!==e)return void t();await this.waitTillConnected();const{id:i,track:o}=n;await this.connection.updateSendParameters(i,o),await this.connection.updateEncoderConfig(i,o),this.emit(Nk.UpdateVideoEncoder,o),t()}catch(e){n(e)}finally{r()}})),iw(this,"handleSetOptimizationMode",(async(e,t,n)=>{const r=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const n=this.localTrackMap.get(bk.LocalVideoTrack);if(!this.connection||!n||n.track!==e)return;await this.waitTillConnected();const{id:i,track:o}=n;await this.connection.updateSendParameters(i,o),t()}catch(e){n(e)}finally{r()}})),iw(this,"handleReplaceTrack",(async(e,t,n,r)=>{let i;uD.debug("P2PChannel handleReplaceTrack for [track-id-".concat(e.getTrackId(),"]")),"boolean"==typeof r&&r||(i=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var o;const n=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(!this.connection||!n)return void t();if(await this.waitTillConnected(),await(null===(o=this.connection)||void 0===o?void 0:o.replaceTrack(e,n[1].id)),this.isPlanB){const t=n[1];t.id=e._mediaStreamTrack.id,this.localTrackMap.set(n[0],t)}if(n[0]===bk.LocalVideoTrack&&Gk().supportDualStreamEncoding){const t=this.localTrackMap.get(bk.LocalVideoLowTrack);if(t){const n=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=n,t.track._originMediaStreamTrack=n,await new xv(((e,n)=>{this.handleReplaceTrack(t.track,e,n,!0)}))}}t()}catch(e){n(e)}finally{var s;null===(s=i)||void 0===s||s()}})),iw(this,"handleGetLocalVideoStats",(e=>{e(this.statsCollector.getLocalVideoTrackStats())})),iw(this,"handleGetLocalAudioStats",(e=>{e(this.statsCollector.getLocalAudioTrackStats())})),iw(this,"handleGetRemoteVideoStats",(e=>this.statsCollector.getRemoteVideoTrackStats(e.uid)[e.uid])),iw(this,"handleGetRemoteAudioStats",(e=>this.statsCollector.getRemoteAudioTrackStats(e.uid)[e.uid])),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new UZ,this.bindStatsUploaderEvents(),this.isPlanB=!Gk().supportUnifiedPlan||$D("CHROME_FORCE_PLAN_B")&&$b()}async startP2PConnection(e){return this.state=wk.New,this.connection=this.isPlanB?new EZ(e,this.store):new SZ(e,this.store),this.bindConnectionEvents(this.connection),this.connection.establish()}async connect(e,t,n,r,i,o){if(!this.connection)throw new eD(ZN.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.store.peerConnectionStart(),await this.connection.connect(e,t,n,r,i,o),this.statsUploader.startUploadTransportStats(),this.state=wk.Connected}publish(e,t,n){var r=this;return aX((function*(){const i=yield cX(r.mutex.lock("From P2PChannel.publish"));try{if(!r.connection){if(r.state===wk.Disconnected)throw new eD(ZN.UNEXPECTED_ERROR,"PeerConnection already disconnected.");r.throwIfTrackTypeNotMatch(e);const t=e.filter((e=>-1===r.pendingLocalTracks.indexOf(e)));return void(r.pendingLocalTracks=r.pendingLocalTracks.concat(t))}r.store.pubId=r.store.pubId+1,rj.markPublishStart(r.store.clientId,r.store.pubId),yield cX(r.waitTillConnected());const o=r.filterTobePublishedTracks(e,t,n);if(0===o.length)return void(yield cX(r.tryToUnmuteAudio(e)));yield*lX(QZ(r.doPublish(r.connection,o)),cX)}finally{i()}}))()}doPublish(e,t){var n=this;return aX((function*(){t.forEach((e=>{let{track:t,type:r}=e;const i=Date.now();n.store.publish(t.getTrackId(),r===bk.LocalAudioTrack?"audio":"video",i)})),n.bindLocalTrackEvents(t);const r=yield cX(e.send(t.map((e=>{let{track:t}=e;return t})),n.store.codec,n.store.audioCodec)),i=(yield cX(r.next())).value,o=n.createGatewayPublishMessage(t,i);let s;try{s=yield o}catch(e){throw CD("error",n,"doPublish yield error: ".concat(e.toString())),r.throw(e),(null==e?void 0:e.code)===ZN.WS_ABORT&&t.forEach((e=>{let{track:t}=e;-1===n.pendingLocalTracks.indexOf(t)&&n.pendingLocalTracks.push(t)})),n.unbindLocalTrackEvents(t),e}const a=n.mapPubResToRemoteConfig(o,s);ND("debug",n,"doPublish",{remoteConfigs:a,tracks:t.map((e=>{let{track:t}=e;return t.getTrackId()})),pubMsg:o,pubAns:s});const c=(yield cX(r.next(a))).value;t.forEach((e=>{let{type:t}=e;n.statsCollector.addLocalStats(t)})),n.assignLocalTracks(t,c),n.statsUploader.startUploadUplinkStats(),t.forEach((e=>{let{track:t,type:r}=e;const i=Date.now();n.store.publish(t.getTrackId(),r===bk.LocalAudioTrack?"audio":"video",void 0,i)}))}))()}publishLowStream(e){var t=this;return aX((function*(){if(!t.connection)return;ND("debug",t,"publishLowStream",e);const n=yield cX(t.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const i=t.localTrackMap.get(bk.LocalVideoTrack);if(!i)throw new eD(ZN.UNEXPECTED_ERROR,"Could not find high stream");if(t.localTrackMap.has(bk.LocalVideoLowTrack))throw new eD(ZN.UNEXPECTED_ERROR,"[".concat(t.store.clientId,"] Can't publish low stream when stream already publish"));yield cX(t.waitTillConnected());const o=[{track:t.getLowVideoTrack(i.track,e),type:bk.LocalVideoLowTrack}];if(yield*lX(QZ(t.doPublish(t.connection,o)),cX),i.track.muted||!i.track.enabled){var r;const e=null===(r=t.localTrackMap.get(bk.LocalVideoLowTrack))||void 0===r?void 0:r.id;void 0!==e&&(yield cX(t.connection.muteLocal([e])))}}finally{n()}}))()}async republish(){this.pendingLocalTracks.length>0&&(uD.debug("Emit P2PChannelEvents.RequestRePublish to republish tracks."),ND("debug",this,"republish",this.pendingLocalTracks.map((e=>e.getTrackId()))),await Nj(this,Nk.RequestRePublish,this.pendingLocalTracks),this.emit(Nk.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async reSubscribe(e){ND("debug",this,"reSubscribe",this.pendingRemoteTracks.map((e=>{let{user:t}=e;return t.uid})));for(let e=this.pendingRemoteTracks.length-1;e>=0;e--){const{user:t,kind:n}=this.pendingRemoteTracks[e];(n!==Ok.AUDIO||t._audio_added_&&t._audioSSRC)&&(n!==Ok.VIDEO||t._video_added_&&t._videoSSRC)||this.pendingRemoteTracks.splice(e,1)}if(e)await Nj(this,Nk.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:e,kind:t}of this.pendingRemoteTracks)await this.subscribe(e,t,t===Ok.VIDEO?e._videoSSRC:e._audioSSRC);this.pendingRemoteTracks.forEach((e=>{let{user:t}=e;this.emit(Nk.MediaReconnectEnd,t.uid)})),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection)return void e.forEach((e=>{const t=this.pendingLocalTracks.indexOf(e);-1!==t&&this.pendingLocalTracks.splice(t,1)}));await this.waitTillConnected();const t=this.filterTobeUnpublishedTracks(e);if(0===t.length)return;const n=t.find((e=>"videoLowTrack"===e[0]));return n&&n[1].track.close(),ND("debug",this,"unpublish"),this.doUnpublish(this.connection,t)}async unpublishLowStream(){if(!this.connection)return;ND("debug",this,"unpublishLowStream");const e=this.localTrackMap.get(bk.LocalVideoLowTrack);if(!e)return;await this.waitTillConnected(),e.track.close();const t=[[bk.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,t)}async doUnpublish(e,t){const n=this.createGatewayUnpublishMessage(t);return await e.stopSending(t.map((e=>{let[,{id:t}]=e;return t}))),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map((e=>{let[t,{track:n}]=e;return{type:t,track:n}}))),t.forEach((e=>{let[t]=e;this.statsCollector.removeLocalStats(t)})),0===this.localTrackMap.size&&this.statsUploader.stopUploadUplinkStats(),n}async subscribe(e,t,n,r,i){var o;if(!this.connection)throw new eD(ZN.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(ND("debug",this,"subscribe",{uid:e.uid,mediaType:t,ssrcId:n}),null!==(o=this.remoteUserMap.get(e))&&void 0!==o&&o.has(t))return;let s,a;if(await this.waitTillConnected(),i){const n=i.find((e=>{let{stream_type:n}=e;return n===t}));if(!n)throw new eD(ZN.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(t," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(t,"."));const r=await this.connection.receive(t,n.ssrcs,String(e._uintid),n.attributes);s=r.track,a=r.id}else{const i=await this.connection.receive(t,[{ssrcId:n,rtx:r}],String(e._uintid),void 0);s=i.track,a=i.id}t===Ok.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(s):(e._audioTrack=new kZ(s,e.uid,e._uintid,this.store),uD.info("[".concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(s):(e._videoTrack=new PZ(s,e.uid,e._uintid,this.store),uD.info("[".concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),this.bindRemoteTrackEvents(e,e._videoTrack));const c=this.remoteUserMap.get(e);c?c.set(t,a):this.remoteUserMap.set(e,new Map([[t,a]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadDownlinkStats();const u=this.pendingRemoteTracks.findIndex((n=>{let{user:r,kind:i}=n;return r.uid===e.uid&&t===i}));-1!==u&&(this.pendingRemoteTracks.splice(u,1),this.emit(Nk.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection)throw new eD(ZN.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");ND("debug",this,"subscribeAll",e.map((e=>{let{user:t,mediaType:n,ssrcId:r}=e;return{uid:t.uid,mediaType:n,ssrcId:r}}))),e=e.filter((e=>{var t;let{user:n,mediaType:r}=e;return!(null!==(t=this.remoteUserMap.get(n))&&void 0!==t&&t.has(r))})),await this.waitTillConnected();const t=await this.connection.batchReceive(e.map((e=>{let{user:t,mediaType:n,ssrcId:r,rtxSsrcId:i}=e;return{kind:n,ssrcMsg:[{ssrcId:r,rtx:i}],mslabel:String(t._uintid)}})));e.forEach(((e,n)=>{let{user:r,mediaType:i}=e;const{track:o,id:s}=t[n];i===Ok.AUDIO?(r._audioTrack?r._audioTrack._updateOriginMediaStreamTrack(o):(r._audioTrack=new kZ(o,r.uid,r._uintid,this.store),uD.info("[".concat(this.store.p2pId,"] create remote audio track: ").concat(r._audioTrack.getTrackId()))),this.bindRemoteTrackEvents(r,r._audioTrack)):(r._videoTrack?r._videoTrack._updateOriginMediaStreamTrack(o):(r._videoTrack=new PZ(o,r.uid,r._uintid,this.store),uD.info("[".concat(this.store.p2pId,"] create remote video track: ").concat(r._videoTrack.getTrackId()))),this.bindRemoteTrackEvents(r,r._videoTrack));const a=this.remoteUserMap.get(r);a?a.set(i,s):this.remoteUserMap.set(r,new Map([[i,s]])),this.statsCollector.addRemoteStats(r.uid),this.statsUploader.startUploadDownlinkStats();const c=this.pendingRemoteTracks.findIndex((e=>{let{user:t,kind:n}=e;return t.uid===r.uid&&i===n}));-1!==c&&(this.pendingRemoteTracks.splice(c,1),this.emit(Nk.MediaReconnectEnd,r.uid))}))}async unsubscribe(e,t,n){const r=this.pendingRemoteTracks.filter((n=>{let{user:r,kind:i}=n;return void 0!==t?r.uid===e.uid&&t===i:r.uid===e.uid}));if(r.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),this.connection||n||r.forEach((t=>{let{kind:n}=t;var r;if(n===Ok.AUDIO)null===(r=e._audioTrack)||void 0===r||r._destroy(),e._audioTrack=void 0;else if(n===Ok.VIDEO){var i;null===(i=e._videoTrack)||void 0===i||i._destroy(),e._videoTrack=void 0}})),!this.connection)return;ND("debug",this,"unsubscribe",{uid:e.uid,mediaType:t});const i=this.filterTobeUnSubscribedTracks(e,t);if(0===i.length)return;await this.connection.stopReceiving(i.map((e=>{let[,{id:t}]=e;return t})));const o=this.createUnsubscribeMessage(i);return this.withdrawRemoteTracks(i),0===this.remoteUserMap.size&&this.statsUploader.stopUploadDownlinkStats(),i.forEach((e=>{let[t,{kind:r}]=e;var i,o;if(r===Ok.VIDEO&&t._videoSSRC&&(null===(i=this.connection)||void 0===i||i.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),r===Ok.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),n||(null===(o=t._videoTrack)||void 0===o||o._destroy(),t._videoTrack=void 0);else if(r===Ok.AUDIO){var s;this.unbindRemoteTrackEvents(t._audioTrack),n||(null===(s=t._audioTrack)||void 0===s||s._destroy(),t._audioTrack=void 0)}})),o}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let t=[];for(const{user:n,mediaType:r}of e){const e=this.pendingRemoteTracks.filter((e=>{let{user:t,kind:i}=e;return void 0!==r?t.uid===n.uid&&r===i:t.uid===n.uid}));e.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),t=t.concat(e)}if(!this.connection)return void t.forEach((e=>{let{user:t,kind:n}=e;var r;if(n===Ok.AUDIO)null===(r=t._audioTrack)||void 0===r||r._destroy(),t._audioTrack=void 0;else if(n===Ok.VIDEO){var i;null===(i=t._videoTrack)||void 0===i||i._destroy(),t._videoTrack=void 0}}));ND("debug",this,"batchUnsubscribe",e.map((e=>{let{user:t,mediaType:n}=e;return{uid:t.uid,mediaType:n}})));const n=lh(e).call(e,((e,t)=>{let{user:n,mediaType:r}=t;const i=this.filterTobeUnSubscribedTracks(n,r);return e.concat(i)}),[]);if(0===n.length)return;await this.connection.stopReceiving(n.map((e=>{let[,{id:t}]=e;return t})));const r=this.createUnsubscribeAllMessage(n);return this.withdrawRemoteTracks(n),0===this.remoteUserMap.size&&this.statsUploader.stopUploadDownlinkStats(),n.forEach((e=>{let[t,{kind:n}]=e;var r,i;if(n===Ok.VIDEO&&t._videoSSRC&&(null===(r=this.connection)||void 0===r||r.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),n===Ok.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),null===(i=t._videoTrack)||void 0===i||i._destroy(),t._videoTrack=void 0;else if(n===Ok.AUDIO){var o;this.unbindRemoteTrackEvents(t._audioTrack),null===(o=t._audioTrack)||void 0===o||o._destroy(),t._audioTrack=void 0}})),r}async muteRemote(e,t){if(!this.connection)return;ND("debug",this,"muteRemote",{uid:e.uid,kind:t});const n=this.remoteUserMap.get(e);if(!n)return uD.warning("P2PChannel.muteRemote has no remote user ".concat(e.uid,".")),void CD("warning",this,"P2PChannel.muteRemote has no remote user ".concat(e.uid,"."));if(!n.get(t))return uD.warning("P2PChannel.muteRemote has no remote user ".concat(e.uid," media type ").concat(t,".")),void CD("warning",this,"P2PChannel.muteRemote has no remote user ".concat(e.uid," media type ").concat(t,"."));const r=t===Ok.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==r&&this.connection.setStatsRemoteVideoIsReady(r,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.connection)return;ND("debug",this,"unmuteRemote",{uid:e.uid,kind:t});const n=this.remoteUserMap.get(e);return n?n.get(t)?void 0:(uD.warning("P2PChannel.unmuteRemote has no remote user ".concat(e.uid," media type ").concat(t,".")),void CD("warning",this,"unmuteRemote has no remote user ".concat(e.uid," media type ").concat(t))):(uD.warning("P2PChannel.unmuteRemote has no remote user ".concat(e.uid,".")),void CD("warning",this,"unmuteRemote has no remote user ".concat(e.uid)))}getAllTracks(e){const t=this.localTrackMap.get(bk.LocalAudioTrack);if((null==t?void 0:t.track)instanceof ej){const n=t.track;return Array.from(this.localTrackMap.entries()).filter((e=>{let[t]=e;return t!==bk.LocalAudioTrack})).filter((t=>{let[n]=t;return!(e&&n===bk.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t})).concat(n.trackList)}return Array.from(this.localTrackMap.entries()).filter((t=>{let[n]=t;return!(e&&n===bk.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t}))}reportPublishEvent(e,t,n,r,i){if(e){const n=this.localTrackMap.get(bk.LocalAudioTrack),o=r?this.localTrackMap.get(bk.LocalVideoLowTrack):this.localTrackMap.get(bk.LocalVideoTrack);mG.publish(this.store.sessionId,{eventElapse:rj.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==n?void 0:n.track.getTrackLabel(),videoName:null==o?void 0:o.track.getTrackLabel(),screenshare:-1!==(null==o?void 0:o.track._hints.indexOf(fk.SCREEN_TRACK)),audio:!!n,video:!!o,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}else{var o;n||(n=[]);const s=n.find((e=>e instanceof JQ)),a=r?null===(o=this.localTrackMap.get(bk.LocalVideoTrack))||void 0===o?void 0:o.track:n.find((e=>e instanceof Zz));mG.publish(this.store.sessionId,{eventElapse:rj.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==s?void 0:s.getTrackLabel(),videoName:null==a?void 0:a.getTrackLabel(),screenshare:-1!==(null==a?void 0:a._hints.indexOf(fk.SCREEN_TRACK)),audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:i})}}reportSubscribeEvent(e,t,n,r){const i=r===Ok.VIDEO?n._videoSSRC:n._audioSSRC;i&&mG.subscribe(this.store.sessionId,{succ:e,ec:t,video:r===Ok.VIDEO,audio:r===Ok.AUDIO,peerid:n.uid,subscribeRequestid:r===Ok.VIDEO?n._videoSSRC:n._audioSSRC,p2pid:this.store.p2pId,eventElapse:rj.measureFromSubscribeStart(this.store.clientId,i)})}reset(){uD.debug("P2PChannel.reset"),this.mutex=new SG("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.state=wk.Disconnected}getStats(){var e;return null===(e=this.connection)||void 0===e?void 0:e.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.connection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(bk.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(bk.LocalVideoTrack);if(e)return{width:e.track._videoWidth||0,height:e.track._videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof Zz||t&&t.track instanceof JQ?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const n=this.remoteUserMap.get(e);return!!n&&(!t||n.has(t))}getRemoteMedia(e){var t;const n=Array.from(eG(t=this.remoteUserMap).call(t)).find((t=>t.uid===e));return n?{audioTrack:n.audioTrack,audioSSRC:n._audioSSRC,videoTrack:n.videoTrack,videoSSRC:n._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map((e=>{let[t]=e;return{uid:t.uid,level:t.audioTrack?100*t.audioTrack._source.getAccurateVolumeLevel():0}}));const t=this.localTrackMap.get(bk.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=zL(e).call(e,((e,t)=>e.level-t.level)),e}async disconnectForReconnect(){this.connection&&(ND("debug",this,"disconnectForReconnect"),uD.debug("P2PChannel.disconnectForReconnect closing P2PConnection"),this.state=wk.Reconnecting,this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,0!==this.localTrackMap.size&&(Array.from(this.localTrackMap.entries()).forEach((e=>{let[t,{track:n}]=e;switch(t){case bk.LocalVideoTrack:n._hints.includes(fk.LOW_STREAM)?n.close():this.pendingLocalTracks.push(n);break;case bk.LocalAudioTrack:n instanceof ej?this.pendingLocalTracks=this.pendingLocalTracks.concat(n.trackList):this.pendingLocalTracks.push(n);case bk.LocalVideoLowTrack:}})),this.emit(Nk.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,n]=e;Array.from(eG(n).call(n)).forEach((e=>{this.setPendingRemoteMedia(t,e)})),this.emit(Nk.MediaReconnectStart,t.uid)})),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.statsUploader.stopUploadUplinkStats(),this.statsUploader.stopUploadDownlinkStats(),this.statsUploader.stopUploadTransportStats(),uD.debug("P2PChannel disconnected, waiting to reconnect."))}hasPendingRemoteMedia(e,t){for(const n of this.pendingRemoteTracks){const{user:r,kind:i}=n;if((e instanceof tq?e.uid:e)===r.uid&&t===i)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}async reEstablish(){if(this.connection)return this.connection.reEstablish()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),t=this.localTrackMap.get(bk.LocalVideoTrack),n=this.localTrackMap.get(bk.LocalAudioTrack),r=e.videoSend.find((e=>e.ssrc===(null==t?void 0:t.ssrcs[0].ssrcId))),i=e.audioSend.find((e=>e.ssrc===(null==n?void 0:n.ssrcs[0].ssrcId)));if(!r||!i)return 1;const o=Lj(this,Nk.NeedSignalRTT),s=r?r.rttMs:void 0,a=i?i.rttMs:void 0,c=s&&a?(s+a)/2:s||a,u=(c&&o?(c+o)/2:c||o)||0,l=100*e.sendPacketLossRate*.7/50+.3*u/1500,d=l<.17?1:l<.36?2:l<.59?3:l<.1?4:5,h=null==t?void 0:t.track;if(h&&h._encoderConfig&&-1===h._hints.indexOf(fk.SCREEN_TRACK)){const t=h._encoderConfig.bitrateMax,n=e.bitrate.actualEncoded;if(t&&n){const e=(1e3*t-n)/(1e3*t);return tL[e<.15?0:e<.3?1:e<.45?2:e<.6?3:4][d]}}return d}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach((n=>{let[r]=n;const i=r._audioSSRC,o=r._videoSSRC,s=e.audioRecv.find((e=>e.ssrc===i)),a=e.videoRecv.find((e=>e.ssrc===o));if(!s&&!a)return void(t+=1);const c=Lj(this,Nk.NeedSignalRTT),u=e.rtt,l=(u&&c?(u+c)/2:u||c)||0,d=s?s.jitterMs:void 0,h=e.recvPacketLossRate;let p=.7*h*100/50+.3*l/1500;d&&(p=.6*h*100/50+.2*l/1500+.2*d/400),t+=p<.1?1:p<.17?2:p<.36?3:p<.59?4:5})),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new xv(((t,n)=>{this.handleMuteLocalTrack(e,t,n)}))}filterTobePublishedTracks(e,t,n){const r=[],i=Gk(),o=this.getAllTracks();e=xj(e=e.filter((e=>-1===o.indexOf(e))));let s=!1,a=!1;for(const o of e){if(o instanceof Zz&&(this.localTrackMap.has(bk.LocalVideoTrack)||s?new eD(ZN.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(r.push({track:o,type:bk.LocalVideoTrack}),s=!0),t)){const e=this.getLowVideoTrack(o,n);r.push({track:e,type:bk.LocalVideoLowTrack})}if(o instanceof JQ){const e=this.localTrackMap.get(bk.LocalAudioTrack);if(e){if(!(e.track instanceof ej))throw new eD(ZN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(o._bypassWebAudio)throw new eD(ZN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(o),this.bindLocalAudioTrackEvents(o,!0)}else if(a){const e=r.find((e=>{let{type:t}=e;return t===bk.LocalAudioTrack}));if(!(e.track instanceof ej))throw new eD(ZN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(o._bypassWebAudio)throw new eD(ZN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(o)}else{if(!i.webAudioMediaStreamDest||o instanceof ej||o._bypassWebAudio)r.push({track:o,type:bk.LocalAudioTrack});else{const e=new ej;e.addAudioTrack(o),r.push({track:e,type:bk.LocalAudioTrack})}a=!0}}}return r}filterTobeUnpublishedTracks(e){const t=[],n=this.getAllTracks();e=xj(e=e.filter((e=>-1!==n.indexOf(e))));for(const n of e){if(n instanceof JQ){const e=this.localTrackMap.get(bk.LocalAudioTrack);if(!e)continue;e.track instanceof ej?(e.track.removeAudioTrack(n),this.unbindLocalAudioTrackEvents(n),0===e.track.trackList.length&&(t.push([bk.LocalAudioTrack,e]),e.track.close())):t.push([bk.LocalAudioTrack,e])}if(n instanceof Zz){const e=this.localTrackMap.get(bk.LocalVideoTrack);if(!e)continue;t.push([bk.LocalVideoTrack,e]);const n=this.localTrackMap.get(bk.LocalVideoLowTrack);n&&t.push([bk.LocalVideoLowTrack,n])}}return t}bindLocalTrackEvents(e){e.forEach((e=>{let{track:t,type:n}=e;switch(n){case bk.LocalVideoTrack:t.addListener(pk.GET_STATS,this.handleGetLocalVideoStats),t.addListener(pk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(pk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(pk.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.addListener(pk.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),t.addListener(pk.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.addListener(pk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(pk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case bk.LocalAudioTrack:this.bindLocalAudioTrackEvents(t);case bk.LocalVideoLowTrack:}}))}bindLocalAudioTrackEvents(e,t){e instanceof ej?e.trackList.forEach((e=>{e.addListener(pk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(pk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(pk.GET_STATS,this.handleGetLocalAudioStats),e.addListener(pk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(pk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.addListener(pk.GET_STATS,this.handleGetLocalAudioStats),e.addListener(pk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(pk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(pk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(pk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(pk.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map((e=>{let[t,{track:n}]=e;return{track:n,type:t}}))),e.forEach((e=>{let{track:t,type:n}=e;switch(n){case bk.LocalVideoTrack:t.off(pk.GET_STATS,this.handleGetLocalVideoStats),t.off(pk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(pk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(pk.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.off(pk.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),t.off(pk.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(pk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(pk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case bk.LocalAudioTrack:this.unbindLocalAudioTrackEvents(t);case bk.LocalVideoLowTrack:}}))}unbindLocalAudioTrackEvents(e){e instanceof ej?e.trackList.forEach((e=>{e.off(pk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(pk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(pk.GET_STATS,this.handleGetLocalAudioStats),e.off(pk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(pk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.off(pk.GET_STATS,this.handleGetLocalAudioStats),e.off(pk.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(pk.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(pk.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(pk.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(pk.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof PZ&&t.addListener(pk.GET_STATS,(t=>{t(this.handleGetRemoteVideoStats(e))})),t instanceof kZ&&t.addListener(pk.GET_STATS,(t=>{t(this.handleGetRemoteAudioStats(e))}))}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(pk.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,n]=e;n.has(Ok.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),n.has(Ok.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)}))}createGatewayPublishMessage(e,t){return e.map(((e,n)=>{let r,i,{track:o,type:s}=e;switch(s){case bk.LocalAudioTrack:r=lk.Audio,i={dtx:o instanceof XQ&&o._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case bk.LocalVideoTrack:r=o._hints.includes(fk.SCREEN_TRACK)?lk.Screen:lk.High,i=GZ(GZ({},pj(o)),{},{codec:this.store.codec});break;case bk.LocalVideoLowTrack:r=lk.Low,i=GZ(GZ({},pj(o)),{},{codec:this.store.codec})}return{stream_type:r,attributes:i,ssrcs:t[n]}}))}createGatewayUnpublishMessage(e){return e.map((e=>{let t,[n,{track:r,ssrcs:i,id:o}]=e;switch(n){case bk.LocalVideoTrack:t=r._hints.includes(fk.SCREEN_TRACK)?lk.Screen:lk.High;break;case bk.LocalAudioTrack:t=lk.Audio;break;case bk.LocalVideoLowTrack:t=lk.Low}return{stream_type:t,ssrcs:i,mid:o}}))}assignLocalTracks(e,t){e.forEach(((e,n)=>{let{track:r,type:i}=e;this.localTrackMap.set(i,{track:r,id:t[n].id,ssrcs:t[n].localSSRC})}))}withdrawLocalTracks(e){e.forEach((e=>{let[t]=e;this.localTrackMap.delete(t)}))}async waitTillConnected(){return new xv(((e,t)=>{switch(this.state){case wk.New:case wk.Reconnecting:{const n=(r,i)=>i===wk.Disconnected?(this.off(Nk.StateChange,n),void t(new eD(ZN.UNEXPECTED_ERROR,"PeerConnection already disconnected."))):i===wk.Connected?(this.off(Nk.StateChange,n),void e(void 0)):void 0;this.on(Nk.StateChange,n);break}case wk.Connected:e(void 0);break;case wk.Disconnected:t(new eD(ZN.UNEXPECTED_ERROR,"PeerConnection already disconnected."))}}))}bindConnectionEvents(e){e.onConnectionStateChange=async e=>{uD.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(e,")")),OD("info",this,"connectionStateChange",e),this.emit(Nk.PeerConnectionStateChange,e),"connected"!==e||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),"failed"===e&&await this.requestReconnect()},e.onICEConnectionStateChange=e=>{uD.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(e,")")),OD("info",this,"iceConnectionStateChange",e),mG.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:e,tag:mP.TRACER}).onSuccess(),this.emit(Nk.IceConnectionStateChange,e)},e.onICETransportStateChange=e=>{uD.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(e,")")),OD("info",this,"ICETransportStateChange",e)},e.onDTLSTransportStateChange=e=>{uD.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(e,")")),OD("info",this,"DTLSTransportStateChange",e)},e.onDTLSTransportError=e=>{uD.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(e,")")),OD("info",this,"DTLSTransportError",e)},e.onFirstAudioDecoded=e=>{var t;const n=Array.from(eG(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));var r;n&&(this.store.subscribe(n.uid,"audio",void 0,void 0,void 0,Date.now()),null===(r=n.audioTrack)||void 0===r||r.emit(_k.FIRST_FRAME_DECODED),mG.firstRemoteFrame(this.store.sessionId,fP.FIRST_AUDIO_DECODE,AP.FIRST_AUDIO_DECODE,{peer:n._uintid,subscribeElapse:rj.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=e=>{var t;const n=Array.from(eG(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));n&&mG.firstRemoteFrame(this.store.sessionId,fP.FIRST_AUDIO_RECEIVED,AP.FIRST_AUDIO_RECEIVED,{peer:n._uintid,subscribeElapse:rj.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(e,t,n)=>{this.reportVideoFirstFrameDecoded(e,t,n)},e.onFirstVideoReceived=e=>{var t;const n=Array.from(eG(t=this.remoteUserMap).call(t)).find((t=>t._videoSSRC===e));n&&mG.firstRemoteFrame(this.store.sessionId,fP.FIRST_VIDEO_RECEIVED,AP.FIRST_VIDEO_RECEIVED,{peer:n._uintid,subscribeElapse:rj.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(e,t)=>{const n="relay"===e.candidateType,r="relay"===t.candidateType;"unknown"!==t.candidateType&&n===r||this.emit(Nk.ConnectionTypeChange,n),uD.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(mj(t))," -> ").concat(JSON.stringify(mj(e)),")")),OD("info",this,"SelectedLocalCandidateChanged","".concat(JSON.stringify(mj(t))," -> ").concat(JSON.stringify(mj(e))))},e.onSelectedRemoteCandidateChanged=(e,t)=>{uD.info("[p2pId: ".concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(mj(t))," -> ").concat(JSON.stringify(mj(e)),")")),OD("info",this,"SelectedRemoteCandidateChanged","".concat(JSON.stringify(mj(t))," -> ").concat(JSON.stringify(mj(e))))},e.onFirstVideoDecodedTimeout=e=>{this.reportVideoFirstFrameDecoded(e,void 0,void 0,!0)}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const n=this.localTrackMap.get(bk.LocalAudioTrack);if(e instanceof JQ&&(null==n?void 0:n.track)instanceof ej)return n.track.isActive||t.push([bk.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(r&&(t.push(r),r[0]===bk.LocalVideoTrack)){const e=this.localTrackMap.get(bk.LocalVideoLowTrack);e&&t.push([bk.LocalVideoLowTrack,e])}return t}filterTobeUnmutedTracks(e){const t=[],n=this.localTrackMap.get(bk.LocalAudioTrack);if(e instanceof JQ&&(null==n?void 0:n.track)instanceof ej)return n.track.isActive&&t.push([bk.LocalAudioTrack,n]),t;const r=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:n}]=t;return e===n}));if(r)if(r[0]===bk.LocalVideoTrack){t.push(r);const e=this.localTrackMap.get(bk.LocalVideoLowTrack);e&&t.push([bk.LocalVideoLowTrack,e])}else t.push(r);return t}createMuteMessage(e){return e.map((e=>{let t,[n,{track:r,ssrcs:i,id:o}]=e;switch(n){case bk.LocalAudioTrack:t=lk.Audio;break;case bk.LocalVideoTrack:t=r._hints.includes(fk.SCREEN_TRACK)?lk.Screen:lk.High;break;case bk.LocalVideoLowTrack:t=lk.Low}return{stream_type:t,ssrcs:i,mid:o}}))}createUnmuteMessage(e){return e.map((e=>{let t,[n,{track:r,ssrcs:i,id:o}]=e;switch(n){case bk.LocalAudioTrack:t=lk.Audio;break;case bk.LocalVideoTrack:t=r._hints.includes(fk.SCREEN_TRACK)?lk.Screen:lk.High;break;case bk.LocalVideoLowTrack:t=lk.Low}return{stream_type:t,ssrcs:i,mid:o}}))}filterTobeUnSubscribedTracks(e,t){const n=[],r=this.remoteUserMap.get(e);if(!r)return n;if(t){const i=r.get(t);if(!i)return n;n.push([e,{kind:t,id:i}])}else Array.from(r.entries()).forEach((t=>{let[r,i]=t;n.push([e,{kind:r,id:i}])}));return n}createUnsubscribeMessage(e){const t=[];return e.forEach((e=>{let[n,{kind:r,id:i}]=e;switch(r){case Ok.VIDEO:return void(n._videoSSRC&&t.push({stream_type:Ok.VIDEO,ssrcId:n._videoSSRC}));case Ok.AUDIO:return void(n._audioSSRC&&t.push({stream_type:Ok.AUDIO,ssrcId:n._audioSSRC}))}})),t}createUnsubscribeAllMessage(e){const t=new Map;return e.forEach((e=>{let[n,{kind:r}]=e;if(t.has(n)){let e=t.get(n);r===Ok.VIDEO?e|=hk.Video:e|=hk.Audio,t.set(n,e)}else r===Ok.VIDEO?t.set(n,hk.Video):t.set(n,hk.Audio)})),{users:Array.from(t.entries()).map((e=>{let[t,n]=e;return{stream_id:t.uid,stream_type:n}}))}}withdrawRemoteTracks(e){e.forEach((e=>{let[t,{kind:n}]=e;const r=this.remoteUserMap.get(t);r&&(r.delete(n),0===Array.from(r.entries()).length&&this.remoteUserMap.delete(t))}))}async updateBitrateLimit(e){const t=this.localTrackMap.get(bk.LocalVideoTrack),n=this.localTrackMap.get(bk.LocalVideoLowTrack);t&&await t.track.setBitrateLimit(e.uplink),n&&e.low_stream_uplink&&await n.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return!this.connection||"connected"!==this.connection.peerConnectionState}mapPubResToRemoteConfig(e,t){return e.map(((e,n)=>{var r;let{stream_type:i}=e;return null===(r=t.find((e=>{let{stream_type:t}=e;return i===t})))||void 0===r?void 0:r.attributes}))}async tryToUnmuteAudio(e){for(let n=0;n<e.length;n++)if(e[n]instanceof JQ){var t;const r=this.filterTobeUnmutedTracks(e[n]);if(0===r.length)continue;await(null===(t=this.connection)||void 0===t?void 0:t.unmuteLocal(r.map((e=>{let[,{id:t}]=e;return t}))));const i=this.createUnmuteMessage(r);return void await Dj(this,Nk.RequestUnmuteLocal,i)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.connection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(Nk.RequestUploadStats,e,t),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await vj(nD(this.dtlsFailedCount,tD)),this.emit(Nk.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),t=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),t.length>0&&await Nj(this,Nk.RequestUnpublishForReconnectPC,t),this.disconnectForReconnect(),this.emit(Nk.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(bk.LocalVideoTrack)||this.pendingLocalTracks.some((e=>e instanceof Zz))}throwIfTrackTypeNotMatch(e){if(e.filter((e=>e instanceof Zz)).length>1)throw new eD(ZN.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter((e=>e instanceof JQ)).length>1&&(e.some((e=>e instanceof JQ&&e._bypassWebAudio))||!Gk().webAudioMediaStreamDest))throw new eD(ZN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof Zz&&this.pendingLocalTracks.some((e=>e instanceof Zz)))throw new eD(ZN.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof JQ&&this.pendingLocalTracks.some((e=>e instanceof JQ))&&(!Gk().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some((e=>e instanceof JQ&&e._bypassWebAudio))))throw new eD(ZN.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const n=Gk().supportDualStreamEncoding,r=GZ(GZ({},{width:160,height:120,framerate:15,bitrate:50}),t);let i;i=n?e._mediaStreamTrack.clone():OZ(e,r);const o=new Zz(i,GZ(GZ({},n&&{scaleResolutionDownBy:_j(r,e)}),{},{frameRate:r.framerate,bitrateMax:r.bitrate,bitrateMin:r.bitrate}));return o._hints.push(fk.LOW_STREAM),e.addListener(pk.NEED_CLOSE,(()=>{o.close()})),o}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}reportVideoFirstFrameDecoded(e,t,n,r){var i;const o=Array.from(eG(i=this.remoteUserMap).call(i)).find((t=>t._videoSSRC===e));if(o){r||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());const i=this.store.keyMetrics,s=i.subscribe.find((e=>e.userId===o.uid&&"video"===e.type));mG.firstRemoteVideoDecode(this.store.sessionId,fP.FIRST_VIDEO_DECODE,AP.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:n,subscribeElapse:rj.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:i.requestAPEnd||0,apStart:i.requestAPStart||0,joinGwEnd:i.joinGatewayEnd||0,joinGwStart:i.joinGatewayStart||0,pcEnd:i.peerConnectionEnd||0,pcStart:i.peerConnectionStart||0,subscriberEnd:(null==s?void 0:s.subscribeEnd)||0,subscriberStart:(null==s?void 0:s.subscribeStart)||0,videoAddNotify:(null==s?void 0:s.streamAdded)||0,state:r?1:0})}}async remoteMediaSsrcChanged(e,t,n){if(!this.connection)return!1;const r=this.remoteUserMap.get(e);if(!r)return!1;const i=r.get(t);if(!i)return!1;const o=await this.connection.getRemoteSSRC(i);return void 0!==o&&o!==n}}).prototype,"startP2PConnection",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"startP2PConnection"),FZ.prototype),YV(FZ.prototype,"connect",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"connect"),FZ.prototype),YV(FZ.prototype,"unpublish",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"unpublish"),FZ.prototype),YV(FZ.prototype,"unpublishLowStream",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"unpublishLowStream"),FZ.prototype),YV(FZ.prototype,"subscribe",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"subscribe"),FZ.prototype),YV(FZ.prototype,"massSubscribe",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"massSubscribe"),FZ.prototype),YV(FZ.prototype,"unsubscribe",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"unsubscribe"),FZ.prototype),YV(FZ.prototype,"massUnsubscribe",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"massUnsubscribe"),FZ.prototype),YV(FZ.prototype,"muteRemote",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"muteRemote"),FZ.prototype),YV(FZ.prototype,"unmuteRemote",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"unmuteRemote"),FZ.prototype),YV(FZ.prototype,"hasRemoteMediaWithLock",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"hasRemoteMediaWithLock"),FZ.prototype),YV(FZ.prototype,"disconnectForReconnect",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"disconnectForReconnect"),FZ.prototype),YV(FZ.prototype,"reEstablish",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"reEstablish"),FZ.prototype),YV(FZ.prototype,"updateBitrateLimit",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"updateBitrateLimit"),FZ.prototype),YV(FZ.prototype,"remoteMediaSsrcChanged",[WZ],Object.getOwnPropertyDescriptor(FZ.prototype,"remoteMediaSsrcChanged"),FZ.prototype),BZ=FZ))||BZ;function WZ(e,t,n){const r=e[t];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){const e=this.mutex,n=await e.lock("From P2PChannel.".concat(t));try{for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return await r.apply(this,o)}finally{n()}},n}function YZ(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var KZ,$Z="function"==typeof Symbol&&Symbol.observable||"@@observable",zZ=function(){return Math.random().toString(36).substring(7).split("").join(".")},qZ={INIT:"@@redux/INIT"+zZ(),REPLACE:"@@redux/REPLACE"+zZ(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+zZ()}};function JZ(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function XZ(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(YZ(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(YZ(1));return n(XZ)(e,t)}if("function"!=typeof e)throw new Error(YZ(2));var i=e,o=t,s=[],a=s,c=!1;function u(){a===s&&(a=s.slice())}function l(){if(c)throw new Error(YZ(3));return o}function d(e){if("function"!=typeof e)throw new Error(YZ(4));if(c)throw new Error(YZ(5));var t=!0;return u(),a.push(e),function(){if(t){if(c)throw new Error(YZ(6));t=!1,u();var n=a.indexOf(e);a.splice(n,1),s=null}}}function h(e){if(!JZ(e))throw new Error(YZ(7));if(void 0===e.type)throw new Error(YZ(8));if(c)throw new Error(YZ(9));try{c=!0,o=i(o,e)}finally{c=!1}for(var t=s=a,n=0;n<t.length;n++)(0,t[n])();return e}function p(e){if("function"!=typeof e)throw new Error(YZ(10));i=e,h({type:qZ.REPLACE})}function f(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(YZ(11));function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[$Z]=function(){return this},e}return h({type:qZ.INIT}),(r={dispatch:h,subscribe:d,getState:l,replaceReducer:p})[$Z]=f,r}function ZZ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function e0(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ZZ(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZZ(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_UID="SET_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.AVOID_JOIN_START="AVOID_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS"}(KZ||(KZ={}));class t0{constructor(e,t,n,r){iw(this,"store",void 0),iw(this,"reducer",void 0);const i={codec:e,audioCodec:t,mode:n,clientId:r,sessionId:null,p2pId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled"};this.reducer=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case KZ.SET_SESSION_ID:return e0(e0({},e),{},{sessionId:t.sessionId});case KZ.SET_P2P_ID:return e0(e0({},e),{},{p2pId:t.p2pId});case KZ.SET_UID:return e0(e0({},e),{},{uid:t.uid});case KZ.SET_PUB_ID:return e0(e0({},e),{},{pubId:t.pubId});case KZ.KEY_METRIC_CLIENT_CREATED:return e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{clientCreated:t.metric})});case KZ.KEY_METRIC_JOIN_START:return e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{joinStart:t.metric})});case KZ.AVOID_JOIN_START:return e0(e0({},e),{},{avoidJoinStart:t.avoidJoinStart});case KZ.KEY_METRIC_JOIN_END:return e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{joinEnd:t.metric})});case KZ.KEY_METRIC_REQUEST_AP_START:return e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{requestAPStart:t.metric})});case KZ.KEY_METRIC_REQUEST_AP_END:return e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{requestAPEnd:t.metric})});case KZ.KEY_METRIC_JOIN_GATEWAY_START:return e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{joinGatewayStart:t.metric})});case KZ.KEY_METRIC_JOIN_GATEWAY_END:return e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{joinGatewayEnd:t.metric})});case KZ.KEY_METRIC_PEER_CONNECTION_START:return e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{peerConnectionStart:t.metric})});case KZ.KEY_METRIC_PEER_CONNECTION_END:return e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{peerConnectionEnd:t.metric})});case KZ.KEY_METRIC_PUBLISH:{const n=e.keyMetrics.publish,r=n.findIndex((e=>e.trackId===t.metric.trackId));return-1!==r?(n[r]=e0(e0({},n[r]),t.metric),e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{publish:[...n]})})):e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{publish:[...e.keyMetrics.publish,t.metric]})})}case KZ.KEY_METRIC_SUBSCRIBE:{const n=e.keyMetrics.subscribe,r=n.findIndex((e=>e.userId===t.metric.userId&&e.type===t.metric.type));return-1!==r?(n[r]=e0(e0({},n[r]),t.metric),e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{subscribe:[...n]})})):e0(e0({},e),{},{keyMetrics:e0(e0({},e.keyMetrics),{},{subscribe:[...e.keyMetrics.subscribe,t.metric]})})}case KZ.SET_CLOUD_PROXY_SERVER_MODE:return e.cloudProxyServerMode=t.mode,e;case KZ.RECORD_JOIN_CHANNEL_SERVICE:return"number"!=typeof t.index?e.joinChannelServiceRecords=[...e.joinChannelServiceRecords,t.record]:(e.joinChannelServiceRecords[t.index]=e0(e0({},e.joinChannelServiceRecords[t.index]),t.record),e.joinChannelServiceRecords=[...e.joinChannelServiceRecords]),e;case KZ.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return e.joinChannelServiceRecords=[],e;case KZ.RESET_KEY_METRICS:return e.keyMetrics={publish:[],subscribe:[]},e;default:return e}},this.store=XZ(this.reducer)}set sessionId(e){this.store.dispatch({type:KZ.SET_SESSION_ID,sessionId:e})}get sessionId(){return this.store.getState().sessionId}get codec(){return this.store.getState().codec}get audioCodec(){return this.store.getState().audioCodec}get clientId(){return this.store.getState().clientId}set p2pId(e){this.store.dispatch({type:KZ.SET_P2P_ID,p2pId:e})}get p2pId(){return this.store.getState().p2pId}set uid(e){this.store.dispatch({type:KZ.SET_UID,uid:e})}get uid(){return this.store.getState().uid}set pubId(e){this.store.dispatch({type:KZ.SET_PUB_ID,pubId:e})}get pubId(){return this.store.getState().pubId}set cloudProxyServerMode(e){this.store.dispatch({type:KZ.SET_CLOUD_PROXY_SERVER_MODE,mode:e})}get cloudProxyServerMode(){return this.store.getState().cloudProxyServerMode}clientCreated(){this.store.dispatch({type:KZ.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.store.dispatch({type:KZ.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.store.dispatch({type:KZ.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.store.dispatch({type:KZ.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.store.dispatch({type:KZ.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.store.dispatch({type:KZ.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.store.dispatch({type:KZ.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.store.dispatch({type:KZ.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.store.dispatch({type:KZ.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}publish(e,t,n,r){this.store.dispatch({type:KZ.KEY_METRIC_PUBLISH,metric:e0(e0({trackId:e,type:t},n&&{publishStart:n}),r&&{publishEnd:r})})}subscribe(e,t,n,r,i,o,s){this.store.dispatch({type:KZ.KEY_METRIC_SUBSCRIBE,metric:e0(e0(e0(e0(e0({userId:e,type:t},n&&{subscribeStart:n}),r&&{subscribeEnd:r}),i&&{firstFrame:i}),o&&{streamAdded:o}),s&&{firstDecoded:s})})}massSubscribe(e,t,n,r){e.forEach((e=>{this.store.dispatch({type:KZ.KEY_METRIC_SUBSCRIBE,metric:e0(e0(e0({userId:e.userId,type:e.type},t&&{subscribeStart:t}),n&&{subscribeEnd:n}),r&&{firstFrame:r})})}))}get keyMetrics(){return this.store.getState().keyMetrics}recordJoinChannelService(e,t){"gateway"===e.service&&Array.isArray(e.urls)&&(e.urls=e.urls.map((e=>e.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2"))));try{return"number"!=typeof t?(this.store.dispatch({type:KZ.RECORD_JOIN_CHANNEL_SERVICE,record:e0(e0({},e),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.store.getState().joinChannelServiceRecords.length-1):(t<0||t>=this.store.getState().joinChannelServiceRecords.length||this.store.dispatch({type:KZ.RECORD_JOIN_CHANNEL_SERVICE,record:e,index:t}),t)}catch(e){return 0}}resetJoinChannelServiceRecords(){this.store.dispatch({type:KZ.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.store.dispatch({type:KZ.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.store.getState().joinChannelServiceRecords}catch(e){return[]}}get avoidJoinStart(){return this.store.getState().avoidJoinStart}set avoidJoinStart(e){this.store.dispatch({type:KZ.AVOID_JOIN_START,avoidJoinStart:e})}}let n0;const r0=()=>void 0!==window.isSecureContext;class i0{constructor(e,t){iw(this,"time",void 0),iw(this,"sequence",void 0),iw(this,"name",void 0),iw(this,"elapse",void 0),this.name=e,this.time=performance.now(),this.sequence=kk[t].indexOf(e)}setElapse(e){this.elapse=e}}const o0=new Map;class s0{constructor(e,t){iw(this,"records",[]),iw(this,"_id",void 0),iw(this,"_group",void 0),iw(this,"_localTimeStamp",void 0),iw(this,"_performanceTimeStamp",void 0),this._id=e,this._group=t,this._localTimeStamp=Date.now(),this._performanceTimeStamp=performance.now()}checkPoint(e){const t=new i0(e,this._group);-1===t.sequence&&uD.warning("[".concat(this._id,"] check point record failed, cannot get the sequence")),this.records.push(t);const n=this.records.find((e=>e.sequence===t.sequence-1));n&&t.setElapse(t.time-n.time)}getRecord(e){return this.records.find((t=>t&&t.name===e))}resetRecords(){this.records.length=0}}function a0(e){let t={};e:for(;!m0(e);){let n=w0(e);switch(n>>>3){case 0:break e;case 1:t.requestId=R0(e,w0(e));break;case 2:t.requestType=w0(e)>>>0;break;case 3:t.scorePorn=O0(e);break;case 4:t.scoreSexy=O0(e);break;case 5:t.scoreNeutral=O0(e);break;case 6:t.requestScene=w0(e)>>>0;break;case 7:t.scene=w0(e)>>>0;break;default:l0(e,7&n)}}return t}function c0(e,t){let n=e.service;void 0!==n&&(N0(t,8),N0(t,n));let r=e.vendor;void 0!==r&&(N0(t,16),N0(t,r));let i=e.token;void 0!==i&&(N0(t,26),v0(t,i));let o=e.callbackUrl;void 0!==o&&(N0(t,34),v0(t,o))}function u0(e){let t=w0(e),n=e.limit;return e.limit=e.offset+t,n}function l0(e,t){switch(t){case 0:for(;128&S0(e););break;case 2:_0(e,w0(e));break;case 5:_0(e,4);break;case 1:_0(e,8);break;default:throw new Error("Unimplemented type: "+t)}}let d0=new Float32Array(1);new Uint8Array(d0.buffer);let h0=new Float64Array(1),p0=new Uint8Array(h0.buffer);function f0(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let A0=[];function E0(){const e=A0.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function g0(e){A0.push(e)}function _0(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function m0(e){return e.offset>=e.limit}function I0(e,t){let n=e.bytes,r=e.offset,i=e.limit,o=r+t;if(o>n.length){let t=new Uint8Array(2*o);t.set(n),e.bytes=t}return e.offset=o,o>i&&(e.limit=o),r}function T0(e,t){let n=e.offset;if(n+t>e.limit)throw new Error("Read past limit");return e.offset+=t,n}function R0(e,t){let n=T0(e,t),r=String.fromCharCode,i=e.bytes,o="ï¿½",s="";for(let e=0;e<t;e++){let a,c,u,l,d=i[e+n];0==(128&d)?s+=r(d):192==(224&d)?e+1>=t?s+=o:(a=i[e+n+1],128!=(192&a)?s+=o:(l=(31&d)<<6|63&a,l<128?s+=o:(s+=r(l),e++))):224==(240&d)?e+2>=t?s+=o:(a=i[e+n+1],c=i[e+n+2],32896!=(49344&(a|c<<8))?s+=o:(l=(15&d)<<12|(63&a)<<6|63&c,l<2048||l>=55296&&l<=57343?s+=o:(s+=r(l),e+=2))):240==(248&d)?e+3>=t?s+=o:(a=i[e+n+1],c=i[e+n+2],u=i[e+n+3],8421504!=(12632256&(a|c<<8|u<<16))?s+=o:(l=(7&d)<<18|(63&a)<<12|(63&c)<<6|63&u,l<65536||l>1114111?s+=o:(l-=65536,s+=r(55296+(l>>10),56320+(1023&l)),e+=3))):s+=o}return s}function v0(e,t){let n=t.length,r=0;for(let e=0;e<n;e++){let i=t.charCodeAt(e);i>=55296&&i<=56319&&e+1<n&&(i=(i<<10)+t.charCodeAt(++e)-56613888),r+=i<128?1:i<2048?2:i<65536?3:4}N0(e,r);let i=I0(e,r),o=e.bytes;for(let e=0;e<n;e++){let r=t.charCodeAt(e);r>=55296&&r<=56319&&e+1<n&&(r=(r<<10)+t.charCodeAt(++e)-56613888),r<128?o[i++]=r:(r<2048?o[i++]=r>>6&31|192:(r<65536?o[i++]=r>>12&15|224:(o[i++]=r>>18&7|240,o[i++]=r>>12&63|128),o[i++]=r>>6&63|128),o[i++]=63&r|128)}}function y0(e,t){let n=I0(e,t.limit),r=e.bytes,i=t.bytes;for(let e=0,o=t.limit;e<o;e++)r[e+n]=i[e]}function S0(e){return e.bytes[T0(e,1)]}function C0(e,t){let n=I0(e,1);e.bytes[n]=t}function O0(e){let t=T0(e,8),n=e.bytes;return p0[0]=n[t++],p0[1]=n[t++],p0[2]=n[t++],p0[3]=n[t++],p0[4]=n[t++],p0[5]=n[t++],p0[6]=n[t++],p0[7]=n[t++],h0[0]}function b0(e,t){let n=I0(e,8),r=e.bytes;h0[0]=t,r[n++]=p0[0],r[n++]=p0[1],r[n++]=p0[2],r[n++]=p0[3],r[n++]=p0[4],r[n++]=p0[5],r[n++]=p0[6],r[n++]=p0[7]}function w0(e){let t,n=0,r=0;do{t=S0(e),n<32&&(r|=(127&t)<<n),n+=7}while(128&t);return r}function N0(e,t){for(t>>>=0;t>=128;)C0(e,127&t|128),t>>>=7;C0(e,t)}function D0(e,t){let n=t.low>>>0,r=(t.low>>>28|t.high<<4)>>>0,i=t.high>>>24,o=0===i?0===r?n<16384?n<128?1:2:n<1<<21?3:4:r<16384?r<128?5:6:r<1<<21?7:8:i<128?9:10,s=I0(e,o),a=e.bytes;switch(o){case 10:a[s+9]=i>>>7&1;case 9:a[s+8]=9!==o?128|i:127&i;case 8:a[s+7]=8!==o?r>>>21|128:r>>>21&127;case 7:a[s+6]=7!==o?r>>>14|128:r>>>14&127;case 6:a[s+5]=6!==o?r>>>7|128:r>>>7&127;case 5:a[s+4]=5!==o?128|r:127&r;case 4:a[s+3]=4!==o?n>>>21|128:n>>>21&127;case 3:a[s+2]=3!==o?n>>>14|128:n>>>14&127;case 2:a[s+1]=2!==o?n>>>7|128:n>>>7&127;case 1:a[s]=1!==o?128|n:127&n}}var L0={};Object.defineProperty(L0,"__esModule",{value:!0});var P0=function(){function e(){this._dataLength=0,this._bufferLength=0,this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}return e.hashStr=function(e,t){return void 0===t&&(t=!1),this.onePassHasher.start().appendStr(e).end(t)},e.hashAsciiStr=function(e,t){return void 0===t&&(t=!1),this.onePassHasher.start().appendAsciiStr(e).end(t)},e._hex=function(t){var n,r,i,o,s=e.hexChars,a=e.hexOut;for(o=0;o<4;o+=1)for(r=8*o,n=t[o],i=0;i<8;i+=2)a[r+1+i]=s.charAt(15&n),n>>>=4,a[r+0+i]=s.charAt(15&n),n>>>=4;return a.join("")},e._md5cycle=function(e,t){var n=e[0],r=e[1],i=e[2],o=e[3];r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&i)+t[1]-389564586|0)<<12|o>>>20)+n|0)&n|~o&r)+t[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&n)+t[3]-1044525330|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&i)+t[5]+1200080426|0)<<12|o>>>20)+n|0)&n|~o&r)+t[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&n)+t[7]-45705983|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&i)+t[9]-1958414417|0)<<12|o>>>20)+n|0)&n|~o&r)+t[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&n)+t[11]-1990404162|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&i|~r&o)+t[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&i)+t[13]-40341101|0)<<12|o>>>20)+n|0)&n|~o&r)+t[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&n)+t[15]+1236535329|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[1]-165796510|0)<<5|n>>>27)+r|0)&i|r&~i)+t[6]-1069501632|0)<<9|o>>>23)+n|0)&r|n&~r)+t[11]+643717713|0)<<14|i>>>18)+o|0)&n|o&~n)+t[0]-373897302|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[5]-701558691|0)<<5|n>>>27)+r|0)&i|r&~i)+t[10]+38016083|0)<<9|o>>>23)+n|0)&r|n&~r)+t[15]-660478335|0)<<14|i>>>18)+o|0)&n|o&~n)+t[4]-405537848|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[9]+568446438|0)<<5|n>>>27)+r|0)&i|r&~i)+t[14]-1019803690|0)<<9|o>>>23)+n|0)&r|n&~r)+t[3]-187363961|0)<<14|i>>>18)+o|0)&n|o&~n)+t[8]+1163531501|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r&o|i&~o)+t[13]-1444681467|0)<<5|n>>>27)+r|0)&i|r&~i)+t[2]-51403784|0)<<9|o>>>23)+n|0)&r|n&~r)+t[7]+1735328473|0)<<14|i>>>18)+o|0)&n|o&~n)+t[12]-1926607734|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[5]-378558|0)<<4|n>>>28)+r|0)^r^i)+t[8]-2022574463|0)<<11|o>>>21)+n|0)^n^r)+t[11]+1839030562|0)<<16|i>>>16)+o|0)^o^n)+t[14]-35309556|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[1]-1530992060|0)<<4|n>>>28)+r|0)^r^i)+t[4]+1272893353|0)<<11|o>>>21)+n|0)^n^r)+t[7]-155497632|0)<<16|i>>>16)+o|0)^o^n)+t[10]-1094730640|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[13]+681279174|0)<<4|n>>>28)+r|0)^r^i)+t[0]-358537222|0)<<11|o>>>21)+n|0)^n^r)+t[3]-722521979|0)<<16|i>>>16)+o|0)^o^n)+t[6]+76029189|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((o=((o+=((n=((n+=(r^i^o)+t[9]-640364487|0)<<4|n>>>28)+r|0)^r^i)+t[12]-421815835|0)<<11|o>>>21)+n|0)^n^r)+t[15]+530742520|0)<<16|i>>>16)+o|0)^o^n)+t[2]-995338651|0)<<23|r>>>9)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[0]-198630844|0)<<6|n>>>26)+r|0)|~i))+t[7]+1126891415|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[14]-1416354905|0)<<15|i>>>17)+o|0)|~n))+t[5]-57434055|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[12]+1700485571|0)<<6|n>>>26)+r|0)|~i))+t[3]-1894986606|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[10]-1051523|0)<<15|i>>>17)+o|0)|~n))+t[1]-2054922799|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[8]+1873313359|0)<<6|n>>>26)+r|0)|~i))+t[15]-30611744|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[6]-1560198380|0)<<15|i>>>17)+o|0)|~n))+t[13]+1309151649|0)<<21|r>>>11)+i|0,r=((r+=((o=((o+=(r^((n=((n+=(i^(r|~o))+t[4]-145523070|0)<<6|n>>>26)+r|0)|~i))+t[11]-1120210379|0)<<10|o>>>22)+n|0)^((i=((i+=(n^(o|~r))+t[2]+718787259|0)<<15|i>>>17)+o|0)|~n))+t[9]-343485551|0)<<21|r>>>11)+i|0,e[0]=n+e[0]|0,e[1]=r+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0},e.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(e.stateIdentity),this},e.prototype.appendStr=function(t){var n,r,i=this._buffer8,o=this._buffer32,s=this._bufferLength;for(r=0;r<t.length;r+=1){if((n=t.charCodeAt(r))<128)i[s++]=n;else if(n<2048)i[s++]=192+(n>>>6),i[s++]=63&n|128;else if(n<55296||n>56319)i[s++]=224+(n>>>12),i[s++]=n>>>6&63|128,i[s++]=63&n|128;else{if((n=1024*(n-55296)+(t.charCodeAt(++r)-56320)+65536)>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");i[s++]=240+(n>>>18),i[s++]=n>>>12&63|128,i[s++]=n>>>6&63|128,i[s++]=63&n|128}s>=64&&(this._dataLength+=64,e._md5cycle(this._state,o),s-=64,o[0]=o[16])}return this._bufferLength=s,this},e.prototype.appendAsciiStr=function(t){for(var n,r=this._buffer8,i=this._buffer32,o=this._bufferLength,s=0;;){for(n=Math.min(t.length-s,64-o);n--;)r[o++]=t.charCodeAt(s++);if(o<64)break;this._dataLength+=64,e._md5cycle(this._state,i),o=0}return this._bufferLength=o,this},e.prototype.appendByteArray=function(t){for(var n,r=this._buffer8,i=this._buffer32,o=this._bufferLength,s=0;;){for(n=Math.min(t.length-s,64-o);n--;)r[o++]=t[s++];if(o<64)break;this._dataLength+=64,e._md5cycle(this._state,i),o=0}return this._bufferLength=o,this},e.prototype.getState=function(){var e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}},e.prototype.setState=function(e){var t,n=e.buffer,r=e.state,i=this._state;for(this._dataLength=e.length,this._bufferLength=e.buflen,i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],t=0;t<n.length;t+=1)this._buffer8[t]=n.charCodeAt(t)},e.prototype.end=function(t){void 0===t&&(t=!1);var n=this._bufferLength,r=this._buffer8,i=this._buffer32,o=1+(n>>2);this._dataLength+=n;var s=8*this._dataLength;if(r[n]=128,r[n+1]=r[n+2]=r[n+3]=0,i.set(e.buffer32Identity.subarray(o),o),n>55&&(e._md5cycle(this._state,i),i.set(e.buffer32Identity)),s<=4294967295)i[14]=s;else{var a=s.toString(16).match(/(.*?)(.{0,8})$/);if(null===a)return;var c=parseInt(a[2],16),u=parseInt(a[1],16)||0;i[14]=c,i[15]=u}return e._md5cycle(this._state,i),t?this._state:e._hex(this._state)},e.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),e.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),e.hexChars="0123456789abcdef",e.hexOut=[],e.onePassHasher=new e,e}(),k0=L0.Md5=P0;if("5d41402abc4b2a76b9719d911017c592"!==P0.hashStr("hello"))throw new Error("Md5 self test failed.");function x0(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}const M0=new Map([["moderation",1],["supervise",2]]);class U0 extends JN{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const t=this._connectionState;this._connectionState=e,this.emit(Fk.CONNECTION_STATE_CHANGE,t,e)}get inspectType(){return this._inspectType}set inspectType(e){var t;this._inspectMode=lh(t=e.map((e=>M0.get(e)||0))).call(t,((e,t)=>e+t)),this._inspectType=e}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout((()=>{this.quality=this._quality/this.qualityRatio}),6e4))}constructor(e){super(),iw(this,"name","AgoraRTCVideoContentInspect"),iw(this,"_connectionState",Uk.CONNECTING),iw(this,"_innerConnectionState",void 0),iw(this,"sequence",0),iw(this,"inspectStartTime",void 0),iw(this,"workerManagerConnection",void 0),iw(this,"workerConnection",void 0),iw(this,"workerMessageLengthLimit",void 0),iw(this,"inspectIntervalMinimum",void 0),iw(this,"qualityRatio",void 0),iw(this,"_connectInfo",void 0),iw(this,"_cancelTokenSource",zN.CancelToken.source()),iw(this,"_retryConfig",void 0),iw(this,"wmSequence",0),iw(this,"inspectInterval",void 0),iw(this,"inspectTimer",null),iw(this,"ossFilePrefix",void 0),iw(this,"extraInfo",void 0),iw(this,"_inspectType",void 0),iw(this,"_inspectMode",void 0),iw(this,"_quality",1),iw(this,"qualityTimer",null),iw(this,"_inspectId",void 0),iw(this,"_needWorkUrlOnly",!1),iw(this,"inspectImage",(()=>{if(this.connectionState!==Uk.CONNECTED)throw new eD(ZN.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval((()=>{if(this.connectionState!==Uk.CONNECTED)return uD.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState),void CD("debug",this,"Inspect State is not connected , ".concat(this.connectionState));this.requestToInspectImage()}),this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()})),this._inspectId=Sj(5,"inspect-"),this.workerMessageLengthLimit=$D("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=$D("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=$D("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=e.interval,this.ossFilePrefix=e.ossFilePrefix,this.extraInfo=e.extraInfo,this.inspectType=e.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new e$("worker-manager-"+this._inspectId,tD),this.on(Fk.STATE_CHANGE,((e,t)=>{this._innerConnectionState=e,uD.debug("[".concat(this._inspectId,"] Inspect operation :").concat(Bk[e]," ").concat(t||"")),wD("debug",["Inspect",this._inspectId],Fk.STATE_CHANGE,"".concat(Bk[e]," ").concat(t||""))})),this.handleWorkerManagerEvents(),this.workerConnection=new e$("worker-"+this._inspectId,tD),this.handleWorkerEvents()}async init(e,t){this.emit(Fk.STATE_CHANGE,Bk.CONNECT_AP),this._connectInfo=e;const n=this._cancelTokenSource.token;return this._retryConfig=t,new xv(((r,i)=>{this.on(Fk.CONNECTION_STATE_CHANGE,((e,t)=>{t===Uk.CONNECTED&&r()})),this.requestAP(e,n,t).then((e=>{this.connectWorkerManager(e)})).catch((e=>{i(e)}))}))}async requestAP(e,t,n){const r=$D("WEBCS_DOMAIN").map((e=>"https://".concat(e,"/api/v1"))),i=await function(e,t,n,r){let{appId:i,areaCode:o,cname:s,sid:a,token:c,uid:u}=t;_$++;const l="image_moderation_api",d={service_name:l,json_body:JSON.stringify({appId:i,areaCode:o,cname:s,command:"allocateEdge",requestId:_$,seq:_$,sid:a,token:c,ts:Date.now(),uid:u+""})};let h,p,f=e[0];return rD((async()=>{h=Date.now();const e=await oG(f,{data:d,cancelToken:n,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(p=Date.now()-h,0!==e.code){const t=new eD(ZN.UNEXPECTED_RESPONSE,"image inspect ap error, code"+e.code,{retry:!0,responseTime:p});throw uD.error(t.toString()),ND("error",["AjaxAPI"],"requestImageInspectAP",void 0,t.toString()),t}const t=JSON.parse(e.json_body);if(200!==t.code){const e=new eD(ZN.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(t.code,", reason: ").concat(t.reason),{code:t.code,responseTime:p});throw uD.error(e.toString()),ND("error",["AjaxAPI"],"requestImageInspectAP",void 0,e.toString()),e}if(!t.servers||!Array.isArray(t.servers)||0===t.servers.length){const e=new eD(ZN.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:t.code,responseTime:p});throw uD.error(e.toString()),ND("error",["AjaxAPI"],"requestImageInspectAP",void 0,e.toString()),e}const r=$D("VIDEO_INSPECT_WORKER_MANAGER_HOST"),i=$D("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:t.servers.map((e=>{let{address:t,wss:n}=e;if(t&&n)return"wss://".concat(t.replace(/\./g,"-"),".").concat(r,":").concat(i||n)})).filter((e=>!!e)),workerToken:t.workerToken,vid:t.vid,responseTime:p}}),((t,n)=>(mG.apworkerEvent(a,{success:!0,sc:200,serviceName:l,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===n,responseTime:p,serverIp:e[n%e.length]}),!1)),((t,n)=>(mG.apworkerEvent(a,{success:!1,sc:t.data&&t.data.code||200,serviceName:l,responseTime:p,serverIp:e[n%e.length]}),!!(t.code!==ZN.OPERATION_ABORTED&&t.code!==ZN.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(f=e[(n+1)%e.length],!0))),r)}(r,e,t,n);this.emit(Fk.STATE_CHANGE,Bk.AP_CONNECTED);const{addressList:o}=i;return this.wmSequence++,o}async connectWorkerManager(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._needWorkUrlOnly=t,this.emit(Fk.STATE_CHANGE,Bk.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(e,1e4)}async connectWorker(e){await this.workerConnection.init([e])}handleWorkerManagerEvents(){this.workerManagerConnection.on($P.CONNECTED,(async()=>{this.emit(Fk.STATE_CHANGE,Bk.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.14.2",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)})),this.workerManagerConnection.on($P.CLOSED,(()=>{this._innerConnectionState<Bk.GET_WORKER_MANAGER_RESPONSE&&(uD.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker")),wD("debug",["Inspect",this._inspectId],"workerManagerConnectionClosed"))})),this.workerManagerConnection.on($P.FAILED,(()=>{this._innerConnectionState<Bk.GET_WORKER_MANAGER_RESPONSE&&(uD.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker")),wD("debug",["Inspect",this._inspectId],"workerManagerConnectionFailed"))})),this.workerManagerConnection.on($P.RECONNECTING,(()=>{this._innerConnectionState<Bk.GET_WORKER_MANAGER_RESPONSE&&(uD.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker")),wD("debug",["Inspect",this._inspectId],"workerManagerConnectionReconnecting"))})),this.workerManagerConnection.on($P.ON_MESSAGE,(async e=>{this.emit(Fk.STATE_CHANGE,Bk.GET_WORKER_MANAGER_RESPONSE);const t=this.workerManagerConnection.url;this.workerManagerConnection.close();const n=JSON.parse(e.data);if(200!==n.code)throw uD.error("[".concat(this._inspectId,"] Unexpected code ").concat(n.code," from worker manager")),CD("error",this,"Unexpected code ".concat(n.code," from worker manager")),new eD(ZN.UNEXPECTED_RESPONSE,"response code of worker is unexpected",n);if(!(n.serverResponse&&n.serverResponse.portWss&&t))throw uD.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(n))),CD("error",this,"Unexpected content from worker manager : "+JSON.stringify(n)),new eD(ZN.UNEXPECTED_RESPONSE,"response content of worker is unexpected",n);{const e=$D("VIDEO_INSPECT_WORKER_PORT")||n.serverResponse.portWss,r=t.replace(/:\d+\/?$/,":".concat(e));this.emit(Fk.STATE_CHANGE,Bk.CONNECT_WORKER,r),this._needWorkUrlOnly?this.emit(Fk.REQUEST_NEW_WORKER_URL,r):await this.connectWorker(r)}})),this.workerManagerConnection.on($P.WILL_RECONNECT,((e,t)=>{t(e)})),this.workerManagerConnection.on($P.REQUEST_NEW_URLS,((e,t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(t)}))}handleWorkerEvents(){this.workerConnection.on($P.CONNECTED,(async()=>{this.emit(Fk.STATE_CHANGE,Bk.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=Uk.CONNECTED})),this.workerConnection.on($P.ON_MESSAGE,(async e=>{if(e.data instanceof ArrayBuffer){const n=function(e){return function(e){let t={};e:for(;!m0(e);){let n=w0(e);switch(n>>>3){case 0:break e;case 1:t.code=w0(e);break;case 2:t.msg=R0(e,w0(e));break;case 3:{let n=u0(e);t.data=a0(e),e.limit=n;break}default:l0(e,7&n)}}return t}({bytes:t=e,offset:0,limit:t.length});var t}(new Uint8Array(e.data));if($D("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&uD.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(n)),200===n.code){if(Array.isArray(this.inspectType)&&1===this.inspectType.length&&"supervise"===this.inspectType[0])return void this.emit(Fk.INSPECT_RESULT,void 0,void 0);if(n.data&&n.data.scorePorn&&n.data.scoreSexy&&n.data.scoreNeutral){var t;const e={porn:n.data.scorePorn,sexy:n.data.scoreSexy,neutral:n.data.scoreNeutral},r=lh(t=Object.keys(e)).call(t,((t,n)=>e[t]>e[n]?t:n),"porn"),i=Object.keys(e).find((e=>e===r));this.emit(Fk.INSPECT_RESULT,i)}else this.emit(Fk.INSPECT_RESULT,void 0,new eD(ZN.UNEXPECTED_RESPONSE,n.code+"","There is an unexpected data on message"))}else this.emit(Fk.INSPECT_RESULT,void 0,new eD(ZN.UNEXPECTED_RESPONSE,n.code+"",n.msg))}else uD.error("[".concat(this._inspectId,"] Unexpected message type from worker")),CD("error",this,"Unexpected message type from worker"),this.emit(Fk.INSPECT_RESULT,void 0,new eD(ZN.UNEXPECTED_RESPONSE,"invalid worker message type"))})),this.workerConnection.on($P.CLOSED,(()=>{this.connectionState=Uk.CLOSED})),this.workerConnection.on($P.FAILED,(()=>{this.connectionState=Uk.CLOSED})),this.workerConnection.on($P.RECONNECTING,(()=>{this.connectionState=this.connectionState===Uk.CONNECTED?Uk.RECONNECTING:Uk.CONNECTING})),this.workerConnection.on($P.WILL_RECONNECT,((e,t)=>{"recover"===e&&t(e),t("tryNext")})),this.workerConnection.on($P.REQUEST_NEW_URLS,((e,t)=>{this.workerManagerConnection.close(),this.once(Fk.REQUEST_NEW_WORKER_URL,(t=>{e([t])})),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then((e=>{this.connectWorkerManager(e,!0)})).catch((e=>{t(e)}))}))}static intToLong(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}async requestToInspectImage(){this.sequence++;const e=Lj(this,Fk.CLIENT_LOCAL_VIDEO_TRACK),t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void this.emit(Fk.INSPECT_RESULT,void 0,new eD(ZN.INVALID_OPERATION,"Only the track being played can be inspected"));const n=await this.generateRequestData(e,t);this.workerConnection.sendMessage(n,!0,!0)}else this.emit(Fk.INSPECT_RESULT,void 0,new eD(ZN.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(e,t){let{appId:n,cname:r,cid:i,vid:o,sid:s,uid:a}=t;const c=Date.now(),u=await e.getCurrentFrameImage("image/jpeg",this.quality),l=await(async(e,t,n)=>await(async(e,t,n)=>{const r=""+t+n,i=new Uint8Array(k0.hashStr(r,!0).buffer).slice(0,16),o=i.slice(0,12),s=await window.crypto.subtle.importKey("raw",i,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},s,e))})(e.buffer,t,n))(u,n,r),d=this.sequence+"-"+i+"-"+a+"-"+c+"-"+Sj(12,""),h={appId:n,cid:i,cname:r,deviceId:"",elapse:U0.intToLong(Number(c-this.inspectStartTime)),fileSize:l.byteLength,jpgEncryption:2,height:u.height,width:u.width,jpg:l,networkType:6,osType:7,requestId:d,sdkVersion:"4.14.2",sequence:this.sequence,sid:s,timestamp:U0.intToLong(c),uid:a,vid:o,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};void 0===this.extraInfo&&delete h.callbackData,void 0===this.ossFilePrefix&&delete h.ossFilePrefix;const p=function(e){let t=E0();return function(e,t){let n=e.appId;void 0!==n&&(N0(t,10),v0(t,n));let r=e.cid;void 0!==r&&(N0(t,16),N0(t,r));let i=e.cname;void 0!==i&&(N0(t,26),v0(t,i));let o=e.deviceId;void 0!==o&&(N0(t,34),v0(t,o));let s=e.elapse;void 0!==s&&(N0(t,40),D0(t,s));let a=e.fileSize;void 0!==a&&(N0(t,48),D0(t,f0(a)));let c=e.height;void 0!==c&&(N0(t,56),D0(t,f0(c)));let u=e.jpg;void 0!==u&&(N0(t,66),N0(t,u.length),function(e,t){let n=I0(e,t.length);e.bytes.set(t,n)}(t,u));let l=e.networkType;void 0!==l&&(N0(t,72),D0(t,f0(l)));let d=e.osType;void 0!==d&&(N0(t,80),D0(t,f0(d)));let h=e.requestId;void 0!==h&&(N0(t,90),v0(t,h));let p=e.sdkVersion;void 0!==p&&(N0(t,98),v0(t,p));let f=e.sequence;void 0!==f&&(N0(t,104),D0(t,f0(f)));let A=e.sid;void 0!==A&&(N0(t,114),v0(t,A));let E=e.timestamp;void 0!==E&&(N0(t,120),D0(t,E));let g=e.uid;void 0!==g&&(N0(t,128),N0(t,g));let _=e.vid;void 0!==_&&(N0(t,136),N0(t,_));let m=e.width;void 0!==m&&(N0(t,144),D0(t,f0(m)));let I=e.service;void 0!==I&&(N0(t,152),N0(t,I));let T=e.callbackData;void 0!==T&&(N0(t,162),v0(t,T));let R=e.jpgEncryption;void 0!==R&&(N0(t,168),N0(t,R));let v=e.requestType;void 0!==v&&(N0(t,176),N0(t,v));let y=e.scorePorn;void 0!==y&&(N0(t,185),b0(t,y));let S=e.scoreSexy;void 0!==S&&(N0(t,193),b0(t,S));let C=e.scoreNeutral;void 0!==C&&(N0(t,201),b0(t,C));let O=e.scene;void 0!==O&&(N0(t,208),N0(t,O));let b=e.ossFilePrefix;void 0!==b&&(N0(t,218),v0(t,b));let w=e.serviceVendor;if(void 0!==w)for(let e of w){N0(t,226);let n=E0();c0(e,n),N0(t,n.limit),y0(t,n),g0(n)}}(e,t),function(e){let t=e.bytes,n=e.limit;return t.length===n?t:t.subarray(0,n)}(t)}(h);if(p.byteLength<this.workerMessageLengthLimit){if($D("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const e=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x0(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x0(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},h);delete e.jpg,uD.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(e)),CD("debug",this,"Request message for worker of inspect content ".concat(JSON.stringify(e)))}return p}{const t=this.quality*this.qualityRatio;return this.quality=t,await this.generateRequestData(e,{appId:n,cname:r,cid:i,vid:o,sid:s,uid:a})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=zN.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=Uk.CLOSED,this.emit(Fk.STATE_CHANGE,Bk.CLOSED)}}var B0,F0,V0,G0,Q0,j0,H0,W0,Y0,K0,$0,z0,q0;function J0(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function X0(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J0(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J0(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}let Z0=(B0=PD("AgoraRTCClient","store.clientId"),F0=gG({report:mG}),V0=gG(),G0=gG(),Q0=gG({report:mG}),j0=_G(),H0=_G({report:mG}),W0=_G({report:mG}),Y0=_G({report:mG}),K0=gG({reportResult:!0,report:mG}),$0=_G(),B0((YV((q0=class extends JN{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}constructor(e){let t;if(super(),iw(this,"store",void 0),iw(this,"_uid",void 0),iw(this,"_channelName",void 0),iw(this,"_uintUid",void 0),iw(this,"_users",[]),iw(this,"_codec",void 0),iw(this,"_mode",void 0),iw(this,"_config",void 0),iw(this,"_clientId",void 0),iw(this,"_appId",void 0),iw(this,"_sessionId",null),iw(this,"_key",void 0),iw(this,"_joinInfo",void 0),iw(this,"_gateway",void 0),iw(this,"_statsCollector",void 0),iw(this,"_configDistribute",void 0),iw(this,"_leaveMutex",new SG("client-leave")),iw(this,"_publishMutex",new SG("client-publish")),iw(this,"_renewTokenMutex",new SG("client-renewtoken")),iw(this,"_subscribeMutex",new SG("client-subscribe")),iw(this,"_encryptionMode","none"),iw(this,"_encryptionSecret",null),iw(this,"_encryptionSalt",null),iw(this,"_proxyServer",void 0),iw(this,"_performanceRecorder",void 0),iw(this,"_turnServer",{servers:[],mode:"auto"}),iw(this,"_cloudProxyServerMode","disabled"),iw(this,"_isDualStreamEnabled",!1),iw(this,"_defaultStreamFallbackType",void 0),iw(this,"_lowStreamParameter",void 0),iw(this,"_streamFallbackTypeCacheMap",new Map),iw(this,"_remoteStreamTypeCacheMap",new Map),iw(this,"_axiosCancelSource",zN.CancelToken.source()),iw(this,"_audioVolumeIndicationInterval",void 0),iw(this,"_networkQualityInterval",void 0),iw(this,"_userOfflineTimeout",void 0),iw(this,"_streamRemovedTimeout",void 0),iw(this,"_injectStreamingClient",void 0),iw(this,"_liveTranscodeStreamingClient",void 0),iw(this,"_liveRawStreamingClient",void 0),iw(this,"_channelMediaRelayClient",void 0),iw(this,"_networkQualitySensitivity","normal"),iw(this,"_p2pChannel",void 0),iw(this,"_useLocalAccessPoint",!1),iw(this,"_joinAndNotLeaveYet",!1),iw(this,"_numberOfJoinCount",0),iw(this,"_remoteDefaultVideoStreamType",void 0),iw(this,"_inspect",void 0),iw(this,"_license",void 0),iw(this,"_handleLocalTrackEnable",((e,t,n)=>{this.publish(e,!1).then(t).catch(n)})),iw(this,"_handleLocalTrackDisable",((e,t,n)=>{this.unpublish(e).then(t).catch(n)})),iw(this,"_handleUserOnline",(e=>{this.isStringUID&&"string"!=typeof e.uid&&(uD.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID")),CD("error",this,"StringUID is Mixed with UintUID"));const t=this._users.find((t=>t.uid===e.uid));if(t)t._trust_in_room_=!0;else{const t=new tq(e.uid,e.uint_id||e.uid);this._users.push(t),uD.debug("[".concat(this._clientId,"] user online"),e.uid),bD("info",this,"user-joined",{uid:e.uid}),this.emit(wP.USER_JOINED,t)}})),iw(this,"_handleUserOffline",(e=>{const t=this._users.find((t=>t.uid===e.uid));t&&(this._handleRemoveStream(e),kj(this._users,t),this._remoteStreamTypeCacheMap.delete(t.uid),this._streamFallbackTypeCacheMap.delete(t.uid),uD.debug("[".concat(this._clientId,"] user offline"),e.uid,"reason:",e.reason),bD("info",this,"user-left",{reason:e.reason,uid:e.uid}),this.emit(wP.USER_LEAVED,t,e.reason))})),iw(this,"_handleAddAudioOrVideoStream",((e,t,n,r,i,o,s)=>{const a=this._users.find((e=>e.uid===t));if(!a)return uD.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)")),void OD("error",["AgoraRTCGateway",this._clientId],"add_".concat(e,"_stream"),"can not find target user!");uD.debug("[".concat(this._clientId,"] stream added with uid ").concat(t,", type ").concat(e)),OD("debug",["AgoraRTCGateway",this._clientId],"add_".concat(e,"_stream"),{uid:t,mediaType:e}),this.store.subscribe(a.uid,e,void 0,void 0,void 0,Date.now());const c="audio"===e?a.hasAudio:a.hasVideo;a._uintid||(a._uintid=i||t),"audio"===e?a._trust_audio_stream_added_state_=!0:a._trust_video_stream_added_state_=!0,"audio"===e?(a._audio_added_=!0,void 0!==n&&(a._audioSSRC=n),void 0!==r&&(a._cname=r),o&&(a._audioOrtc=o)):(a._video_added_=!0,void 0!==n&&(a._videoSSRC=n),void 0!==r&&(a._cname=r),void 0!==s&&(a._rtxSsrcId=s),o&&(a._videoOrtc=o)),("audio"===e?a.hasAudio:a.hasVideo)&&!c&&(uD.info("[".concat(this._clientId,"] remote user ").concat(a.uid," published ").concat(e)),CD("info",this,"remote user ".concat(a.uid," published ").concat(e)),bD("info",this,"user-published",{uid:a.uid,mediaType:e}),this.emit(wP.USER_PUBLISHED,a,e)),"video"===e?mG.onGatewayStream(this._sessionId,fP.ON_ADD_VIDEO_STREAM,AP.ON_ADD_VIDEO_STREAM,{peer:i||t}):mG.onGatewayStream(this._sessionId,fP.ON_ADD_AUDIO_STREAM,AP.ON_ADD_AUDIO_STREAM,{peer:i||t}),this._p2pChannel.remoteMediaSsrcChanged(a,e,n).then((t=>{if(t)return uD.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(a.uid," after rejoin because SSRC id changed.")),this._p2pChannel.unsubscribe(a,e,!0).then((()=>this._subscribe(a,e,!0).catch((e=>{uD.error("[".concat(this._clientId,"] resubscribe error"),e.toString()),CD("error",this,"resubscribe error: ".concat(e.toString()))}))))})),this._p2pChannel.hasPendingRemoteMedia(a,e)&&(uD.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(a.uid," after reconnect.")),this._subscribe(a,e,!0).catch((e=>{uD.error("[".concat(this._clientId,"] resubscribe error"),e.toString()),CD("error",this,"resubscribe error: ".concat(e.toString()))})))})),iw(this,"_handleRemoveStream",(e=>{const t=this._users.find((t=>t.uid===e.uid));if(!t)return uD.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)")),void OD("warning",["AgoraRTCGateway",this._clientId],"remove_stream",{uid:e.uid,info:"can not find target user!"});uD.debug("[".concat(this._clientId,"] stream removed with uid ").concat(e.uid)),OD("debug",["AgoraRTCGateway",this._clientId],"remove_stream",{uid:e.uid});let n=()=>{};t.hasAudio&&t.hasVideo?n=()=>{uD.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished audio track")),bD("info",this,"user-unpublished",{uid:t.uid,mediaType:"audio"}),this.emit(wP.USER_UNPUBLISHED,t,"audio"),uD.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished video track")),bD("info",this,"user-unpublished",{uid:t.uid,mediaType:"video"}),this.emit(wP.USER_UNPUBLISHED,t,"video")}:t.hasVideo?n=()=>{uD.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished video track")),bD("info",this,"user-unpublished",{uid:t.uid,mediaType:"video"}),this.emit(wP.USER_UNPUBLISHED,t,"video")}:t.hasAudio&&(n=()=>{uD.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished audio track")),bD("info",this,"user-unpublished",{uid:t.uid,mediaType:"audio"}),this.emit(wP.USER_UNPUBLISHED,t,"audio")}),t._trust_audio_stream_added_state_=!0,t._trust_video_stream_added_state_=!0,t._audio_added_=!1,t._video_added_=!1,this._p2pChannel.unsubscribe(t).then((e=>{if(e)return this._gateway.unsubscribe(e,t.uid)})),t._audioSSRC=void 0,t._videoSSRC=void 0,t._audioOrtc=void 0,t._videoOrtc=void 0,t._rtxSsrcId=void 0,mG.onGatewayStream(this._sessionId,fP.ON_REMOVE_STREAM,AP.ON_REMOVE_STREAM,{peer:e.uint_id||e.uid}),n()})),iw(this,"_handleSetStreamLocalEnable",((e,t,n)=>{const r=this._users.find((e=>e.uid===t));if(!r)return uD.error("[".concat(this._clientId,"] can not find target user!(disable_local)")),void OD("error",this,"disable_local_video","can not find target user!(disable_local)");uD.debug("[".concat(this._clientId,"] local ").concat(e," ").concat(n?"enabled":"disabled"," with uid ").concat(t)),OD("debug",this,"disable_local_video","local ".concat(e," ").concat(n?"enabled":"disabled"," with uid ").concat(t));const i="audio"===e?r.hasAudio:r.hasVideo;if("audio"===e){r._trust_audio_enabled_state_=!0;const e=r._audio_enabled_;if(r._audio_enabled_=n,r._audio_enabled_===e)return;{const e=r._audio_enabled_?"enable-local-audio":"disable-local-audio";uD.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(t,", msg: ").concat(e)),LD("debug",this,"user-info-updated",{uid:t,msg:e}),this.emit(wP.USER_INFO_UPDATED,t,e)}}else{r._trust_video_enabled_state_=!0;const e=r._video_enabled_;if(r._video_enabled_=n,r._video_enabled_===e)return;{const e=r._video_enabled_?"enable-local-video":"disable-local-video";uD.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(t,", msg: ").concat(e)),LD("debug",this,"user-info-updated",{uid:t,msg:e}),this.emit(wP.USER_INFO_UPDATED,t,e)}}const o="audio"===e?r.hasAudio:r.hasVideo;return i!==o?!i&&o?(uD.info("[".concat(this._clientId,"] remote user ").concat(t," published ").concat(e)),bD("info",this,"user-published",{uid:t,mediaType:e}),void this.emit(wP.USER_PUBLISHED,r,e)):("video"===e&&r._videoTrack&&r._videoTrack._destroy(),"audio"===e&&r._audioTrack,this._p2pChannel.muteRemote(r,e),uD.info("[".concat(this._clientId,"] remote user ").concat(t," unpublished ").concat(e)),bD("info",this,"user-unpublished",{uid:t,mediaType:e}),void this.emit(wP.USER_UNPUBLISHED,r,e)):void 0})),iw(this,"_handleMuteStream",((e,t,n)=>{uD.debug("[".concat(this._clientId,"] receive mute message"),e,t,n),OD("debug",this,"mute_".concat(t),n);const r=this._users.find((t=>t.uid===e));if(!r)return uD.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(e)),void OD("warning",this,"mute_".concat(t),"can not find remote user, ignore mute event, uid: ".concat(e));const i="audio"===t?r.hasAudio:r.hasVideo;if("audio"===t){r._trust_audio_mute_state_=!0;const t=r._audio_muted_;if(r._audio_muted_=n,r._audio_muted_===t)return;{const t=r._audio_muted_?"mute-audio":"unmute-audio";uD.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(e,", msg: ").concat(t)),LD("debug",this,"user-info-updated",{uid:e,msg:t}),this.emit(wP.USER_INFO_UPDATED,e,t)}}else{r._trust_video_mute_state_=!0;const t=r._video_muted_;if(r._video_muted_=n,r._video_muted_===t)return;{const t=r._video_muted_?"mute-video":"unmute-video";uD.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(e,", msg: ").concat(t)),LD("debug",this,"user-info-updated",{uid:e,msg:t}),this.emit(wP.USER_INFO_UPDATED,e,t)}}const o="audio"===t?r.hasAudio:r.hasVideo;if(i!==o){if(!i&&o)return("audio"===t?r._audioSSRC:r._videoSSRC)?(uD.info("[".concat(this._clientId,"] remote user ").concat(e," published ").concat(t)),bD("info",this,"user-published",{uid:r.uid,mediaType:t}),void this.emit(wP.USER_PUBLISHED,r,t)):void uD.warning("[".concat(this._clientId,"] remote user ").concat(e," receive ").concat(t," unmute message  before add stream message, ").concat(t," SSRC doesn't exist yet."));"video"===t&&r._videoTrack&&r._videoTrack._destroy(),"audio"===t&&r._audioTrack,this._p2pChannel.muteRemote(r,t),uD.info("[".concat(this._clientId,"] remote user ").concat(e," unpublished ").concat(t)),bD("info",this,"user-unpublished",{uid:e,mediaType:t}),this.emit(wP.USER_UNPUBLISHED,r,t)}})),iw(this,"_handleP2PLost",(async e=>{if(uD.debug("[".concat(this._clientId,"] receive p2p lost"),e),OD("debug",this,"p2p_lost",e),parseInt(e.p2pid,10)!==this.store.p2pId)return uD.warning("P2PLost stream not found",e),void OD("warning",this,"p2p_lost","P2PLost stream not found, ".concat(e));await this._p2pChannel.requestReconnect()})),iw(this,"_handleTokenWillExpire",(()=>{uD.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),OD("debug",this,"token_privilege_will_expire"),this.emit(wP.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)})),iw(this,"_handleBeforeUnload",(e=>{"beforeunload"===e.type&&void 0!==e.returnValue&&""!==e.returnValue||(this.leave(),uD.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")),wD("info",["window",this.store.clientId],Mb()?"beforeunload":"pagehide"))})),iw(this,"_handleUpdateNetworkQuality",(()=>{if("normal"===this._networkQualitySensitivity)return;if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void this.emit(wP.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const e={downlinkNetworkQuality:0,uplinkNetworkQuality:0};e.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),e.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.emit(wP.NETWORK_QUALITY,e)})),this._codec=e.codec,this._mode=e.mode,this._clientId=Sj(5,"client-"),this.store=new t0(e.codec,e.audioCodec,e.mode,this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),uD.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(MD," build: ").concat(xD,", mode: ").concat(this._mode,", codec: ").concat(this._codec)),LD("info",this,"constructor",{version:MD,build:xD,mode:this._mode,codec:this._codec}),this._performanceRecorder=function(e,t){const n=new s0(e,"join");return o0.set(e,n),n}(this._clientId),e.clientRoleOptions)try{QP(e.clientRoleOptions),t=Object.assign({},e.clientRoleOptions)}catch(e){uD.warning("[".concat(this._clientId,"] ").concat(e.toString())),CD("warning",this,e.toString())}this._statsCollector=new sj(this.store),this._statsCollector.onStatsException=(e,t,n)=>{uD.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(e,", msg: ").concat(t,", uid: ").concat(n)),bD("debug",this,wP.EXCEPTION,{code:e,message:t,uid:n}),this.emit(wP.EXCEPTION,{code:e,msg:t,uid:n})},this._statsCollector.onUploadPublishDuration=(e,t,n,r)=>{const i=this._users.find((t=>t.uid===e));i&&mG.peerPublishStatus(this._sessionId,{subscribeElapse:r,audioPublishDuration:t,videoPublishDuration:n,peer:i._uintid})},this._gateway=new c$(this.store,{clientId:this._clientId,mode:this._mode,codec:this._codec,websocketRetryConfig:e.websocketRetryConfig||tD,httpRetryConfig:e.httpRetryConfig||tD,forceWaitGatewayResponse:void 0===e.forceWaitGatewayResponse||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:t}),this._config=e,this._configDistribute=new k$,this._p2pChannel=new HZ(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents()}async join(e,t,n,r,i){const o=++this._numberOfJoinCount;this._performanceRecorder.checkPoint("startJoin"),this.store.joinStart(),r&&(this.store.uid=r);const s="HTTPS"===(n0||n0||(n0=(window.location.protocol.split(":")[0]||"").toUpperCase(),n0)),a=r0()?window.isSecureContext:"Browser Not Support";if(!r0()&&!s||!window.isSecureContext){const e="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";uD.warning(e),ND("warning",this,e)}const c=Cj();"DISCONNECTED"===this.connectionState&&(this.store.avoidJoinStart=Math.round(Date.now()),uD.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)),ND("debug",this,"join",void 0,"[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const u=mG.reportApiInvoke(c,{name:_P.JOIN,options:[e,t,n,r],states:{isHttps:s,isSecureContext:a},tag:mP.TRACER});mG.setAppId(e);try{if(!n&&null!==n)throw new eD(ZN.INVALID_PARAMS,"Invalid token: ".concat(n,". If you don not use token, set it to null"));n&&eP(n,"token",1,2047),eP(e,"appid",1,2047),nP(t),r&&rP(r),i&&eP(i,"optionalInfo",1,2047)}catch(e){throw u.onError(e),e}if(uD.info("[".concat(this._clientId,"] start join channel ").concat(t,", join number: ").concat(o)),LD("info",this,"join",{channel:t}),this._leaveMutex.isLocked&&(uD.debug("[".concat(this._clientId,"] join: waiting leave operation")),CD("debug",this,"join: waiting leave operation"),(await this._leaveMutex.lock())(),uD.debug("[".concat(this._clientId,"] join: continue")),CD("debug",this,"join: continue")),this._joinAndNotLeaveYet=!0,"DISCONNECTED"!==this.connectionState){const e=new eD(ZN.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw u.onError(e),e}this._sessionId||(this._sessionId=c,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const l=X0({clientId:this._clientId,appId:e,sid:this._sessionId,cname:t,uid:"string"!=typeof r?r:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:n||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:i,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint},void 0!==this._remoteDefaultVideoStreamType&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if("string"==typeof r&&(l.stringUid=r,this._uintUid?(l.uid=this._uintUid,this._uintUid=void 0):l.uid=0),"none"!==this._encryptionMode&&this._encryptionSecret){if(l.aesmode=this._encryptionMode,l.aespassword=await(async e=>{const t=Vj("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),n=await window.crypto.subtle.importKey("spki",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),r=dG(e),i=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},n,r);return Gj(new Uint8Array(i))})(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new eD(ZN.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(l.aessalt=this._encryptionSalt)}this._startSession(this._sessionId,{channel:t,appId:e});const d=this._sessionId;setTimeout((()=>{"CONNECTING"===this.connectionState&&d===this._sessionId&&mG.joinChannelTimeout(this._sessionId,5)}),5e3);try{let r;const i=l.cloudProxyServer;if("443only"===i)l.proxyServer=$D("PROXY_SERVER_TYPE2");else if(["proxy3","proxy4","proxy5"].includes(i)){const e=$D("PROXY_SERVER_TYPE3");Array.isArray(e)?l.proxyServer=e[0]:l.proxyServer=e}if(mG.setProxyServer(l.proxyServer),uD.setProxyServer(l.proxyServer),SD(l.proxyServer),this._performanceRecorder.checkPoint("startRequestAp"),this.store.requestAPStart(),l.stringUid&&!l.uid&&"normal"===i){await S$(l,this._axiosCancelSource.token,this._config.httpRetryConfig||tD,!1,this.store);const e=await C$(l.stringUid,l,this._axiosCancelSource.token,this._config.httpRetryConfig||tD,this.store);uD.debug("getUserAccount Success ".concat(l.stringUid," => ").concat(e)),CD("debug",this,"getUserAccount Success ".concat(l.stringUid," => ").concat(e)),l.uid=e,r=await y$(l,this._axiosCancelSource.token,this._config.httpRetryConfig||tD,this.store)}else if(l.stringUid&&!l.uid){const e=await C$(l.stringUid,l,this._axiosCancelSource.token,this._config.httpRetryConfig||tD,this.store);uD.debug("getUserAccount Success ".concat(l.stringUid," => ").concat(e)),CD("debug",this,"getUserAccount Success ".concat(l.stringUid," => ").concat(e)),l.uid=e,r=await S$(l,this._axiosCancelSource.token,this._config.httpRetryConfig||tD,!0,this.store)}else r=await S$(l,this._axiosCancelSource.token,this._config.httpRetryConfig||tD,!0,this.store);if(!this._joinAndNotLeaveYet)throw new eD(ZN.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),this._performanceRecorder.checkPoint("startJoinGateway"),setTimeout((()=>{this._configDistribute.startGetConfigDistribute(l,this._axiosCancelSource.token),this._configDistribute.on(Sk.UPDATE_BITRATE_LIMIT,(e=>{this._p2pChannel.updateBitrateLimit(e)}))}),0),this._key=n||e;const o=r.gatewayInfo;this._joinInfo=X0(X0({},l),{},{cid:o.cid,uid:l.uid?l.uid:o.uid,vid:o.vid,apResponse:o.res,uni_lbs_ip:o.uni_lbs_ip,gatewayAddrs:o.gatewayAddrs});const s=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new eD(ZN.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));return u.onSuccess(s),this._appId=e,this._channelName=l.cname,this._uid=s,this.store.uid=s,setTimeout((()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(Mb()?"beforeunload":"pagehide",this._handleBeforeUnload)}),0),uD.info("[".concat(this._clientId,"] Joining channel success: ").concat(t)),LD("info",this,"join",t,"success"),setTimeout((()=>{$D("USE_NEW_LOG")?kD():uD.startUpload()}),5e3),this._performanceRecorder.checkPoint("finishJoin"),this.store.joinEnd(),this,nL.includes(this)||nL.push(this),s}catch(e){const n=Array.isArray(e)?e[0]:e;throw uD.error("[".concat(this._clientId,"] join number: ").concat(o,", Joining channel failed, rollback"),n),LD("error",this,"join",t,n.toString()),n.code!==ZN.OPERATION_ABORTED&&this._numberOfJoinCount===o&&(this._gateway.state="DISCONNECTED",this._reset()),u.onError(n),n}}_joinGateway(){if(!this._joinInfo||!this._key)throw new eD(ZN.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!("disabled"!==this._joinInfo.cloudProxyServer||this._joinInfo.proxyServer||!$D("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then((e=>e)).catch((e=>{if(e.code===ZN.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,bP.FALLBACK);throw e})).then((e=>{if(e)return e;if(uD.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new eD(ZN.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const t=$D("PROXY_SERVER_TYPE3");if(Array.isArray(t))if(this._joinInfo.apUrl){const e=new xK(this._joinInfo.apUrl).host.split("."),n=e.slice(e.length-2).join(".");t.forEach((e=>{this._joinInfo&&e.includes(n)&&(this._joinInfo.proxyServer=e)})),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=t[0])}else this._joinInfo.proxyServer=t[0];else this._joinInfo.proxyServer=t;return uD.setProxyServer(this._joinInfo.proxyServer),mG.setProxyServer(this._joinInfo.proxyServer),SD(this._joinInfo.proxyServer),mG.reportApiInvoke(this._sessionId,{name:_P.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:mP.TRACER}).onSuccess(),this.emit(wP.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),this._gateway.join(this._joinInfo,this._key)})).then((e=>e))}async leave(){const e=mG.reportApiInvoke(this._sessionId,{name:_P.LEAVE,options:[],tag:mP.TRACER});uD.info("[".concat(this._clientId,"] Leaving channel")),LD("info",this,"leave"),window.removeEventListener(Mb()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(e){const t=nL.indexOf(e);-1!==t&&nL.splice(t,1)}(this);const t=await this._leaveMutex.lock();if("DISCONNECTED"===this.connectionState)return uD.info("[".concat(this._clientId,"] Leaving channel repeated, success")),t(),e.onSuccess();await this._gateway.leave("CONNECTED"!==this.connectionState),uD.info("[".concat(this._clientId,"] Leaving channel success")),LD("info",this,"leave",void 0,"success"),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),t(),e.onSuccess()}async publish(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Array.isArray(e)||(e=[e]);const n=mG.reportApiInvoke(this._sessionId,{name:_P.PUBLISH,options:e.map((e=>e?Object(e).toString():"null")),tag:mP.TRACER});if(0===e.length){const e=new eD(ZN.INVALID_PARAMS,"track list is empty");return n.onError(e),e.throw()}if("audience"===this._gateway.role){const e=new eD(ZN.INVALID_OPERATION,"audience can not publish stream");return n.onError(e),e.throw()}for(const r of e){if(!(r instanceof OG)){const e=new eD(ZN.INVALID_PARAMS,"parameter is not local track");return n.onError(e),e.throw()}if(!r._enabled&&t){const e=new eD(ZN.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(r.getTrackId()));return n.onError(e),e.throw()}}uD.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(e.map((e=>"".concat(e.getTrackId()," "))))),LD("info",this,"publish",e.map((e=>"".concat(e.getTrackId())))),await this._configDistribute.awaitConfigDistributeComplete(),t&&e.forEach((e=>{const t=this._configDistribute.getBitrateLimit();e instanceof Zz&&t&&e.setBitrateLimit(t.uplink)}));const r=await this._publishMutex.lock();try{await this._publishHighStream(e),n.onSuccess(e.map((e=>e.trackMediaType+":"+e.getTrackLabel())).toString()),uD.info("[".concat(this._clientId,"] Publish success, id ").concat(e.map((e=>"".concat(e.getTrackId()," "))))),LD("info",this,"publish",e.map((e=>"".concat(e.getTrackId()))),"success")}catch(e){throw n.onError(e),uD.error("[".concat(this._clientId,"] publish error"),e.toString()),LD("error",this,"publish",void 0,e.toString()),e}finally{r()}}async unpublish(e){if(!this._joinInfo||void 0===this._uid)throw new eD(ZN.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");e?Array.isArray(e)||(e=[e]):e=this._p2pChannel.getAllTracks(!0);const t=mG.reportApiInvoke(this._sessionId,{name:_P.UNPUBLISH,options:e.map((e=>e.getTrackId())),tag:mP.TRACER});uD.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(e.map((e=>"".concat(e.getTrackId()," ")))," ")),LD("info",this,"unpublish",e.map((e=>"".concat(e.getTrackId()))));const n=await this._publishMutex.lock();try{const r=await this._p2pChannel.unpublish(e);r&&await this._gateway.unpublish(r,this._uid),uD.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(e.map((e=>"".concat(e.getTrackId()))))),LD("info",this,"unpublish",e.map((e=>"".concat(e.getTrackId()))),"success"),t.onSuccess()}catch(e){throw t.onError(e),uD.error("[".concat(this._clientId,"] unpublish error"),e.toString()),LD("error",this,"unpublish",void 0,e.toString()),e}finally{n&&n()}}async subscribe(e,t){return this._subscribe(e,t)}async _subscribe(e,t,n){JL(t,"mediaType",["audio","video"]);const r=mG.reportApiInvoke(this._sessionId,{name:_P.SUBSCRIBE,options:[e.uid,t],tag:mP.TRACER});if(!this._joinInfo){const e=new eD(ZN.INVALID_OPERATION,"Can't subscribe stream, not joined");throw r.onError(e),e}if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState){const e=new eD(ZN.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));throw r.onError(e),e}if(!this._users.find((t=>t===e))){const t=new eD(ZN.INVALID_REMOTE_USER,"user is not in the channel");throw uD.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),LD("error",this,"subscribe",e.uid,"this user is not in the channel"),r.onError(t),t}if(!e.hasAudio&&!e.hasVideo){const t=new eD(ZN.INVALID_REMOTE_USER,"user is not published");throw uD.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),LD("error",this,"subscribe",e.uid,"this user is not published"),r.onError(t),t}if(!(n||("audio"!==t||e.hasAudio&&void 0!==e._audioSSRC)&&("video"!==t||e.hasVideo&&void 0!==e._videoSSRC))){const n=new eD(ZN.REMOTE_USER_IS_NOT_PUBLISHED);throw uD.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),LD("error",this,"subscribe",e.uid,"mediaType ".concat(t,", remote track is not published")),r.onError(n),n}const i="audio"===t?e._audioSSRC:e._videoSSRC,o="audio"===t?e._audioOrtc:e._videoOrtc,s="video"===t?e._rtxSsrcId:void 0,a={stream_type:"audio"===t?Ok.AUDIO:Ok.VIDEO,ssrcId:i},c=await this._subscribeMutex.lock();uD.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t)),LD("info",this,"subscribe",{uid:e.uid,mediaType:t});try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{rj.markSubscribeStart(this.store.clientId,i),this.store.subscribe(e.uid,t,Date.now()),await this._p2pChannel.subscribe(e,t,i,s,o);try{await this._gateway.subscribe(e.uid,a,!0)}catch(n){if((null==n?void 0:n.code)!==ZN.WS_ABORT)throw await this._p2pChannel.unsubscribe(e,t),n;await this._p2pChannel.unsubscribe(e,t,!0),this._p2pChannel.setPendingRemoteMedia(e,t)}this.store.subscribe(e.uid,t,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,t)}catch(n){throw this._p2pChannel.reportSubscribeEvent(!1,null==n?void 0:n.code,e,t),n}uD.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),LD("info",this,"subscribe",{uid:e.uid,mediaType:t},"success"),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch((e=>{uD.warning("[".concat(this._clientId,"] auto set fallback failed"),e),CD("warning",this,"auto set fallback failed, ".concat(e.toString()))}));const u="audio"===t?e._audioTrack:e._videoTrack;if(!u){const e=new eD(ZN.UNEXPECTED_ERROR,"can not find remote track in user object");return r.onError(e),e.throw()}return r.onSuccess(u.getTrackId()),u}catch(n){throw r.onError(n),uD.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),n),LD("error",this,"subscribe",{uid:e.uid,mediaType:t},n.toString()),n}finally{c()}}async massSubscribe(e){tP(e,"subscribeList");const t=mG.reportApiInvoke(this._sessionId,{name:_P.MASS_SUBSCRIBE,options:e.map((e=>{let{user:t,mediaType:n}=e;return[null==t?void 0:t.uid,n]})),tag:mP.TRACER});if(!this._joinInfo){const e=new eD(ZN.INVALID_OPERATION,"Can't subscribe stream, not joined");throw t.onError(e),e}if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState){const e=new eD(ZN.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));throw t.onError(e),e}const n=Date.now(),r=new Map,i=await this._subscribeMutex.lock();uD.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n)})).join("; "))),LD("info",this,"massSubscribe",e);const o=(e=[...e]).map((e=>{let{user:t,mediaType:n}=e;return{user:t,mediaType:n}})),s=await this._p2pChannel.globalLock();try{var a;for(let n=e.length-1;n>=0;n--){const i=e[n],{user:s,mediaType:a}=i;if(JL(a,"mediaType",["audio","video"]),!s){const e=new eD(ZN.INVALID_PARAMS,"user property does not exist in subscribeList item");throw uD.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),t.onError(e),e}if(!this._users.find((e=>e===s))){const t=new eD(ZN.INVALID_REMOTE_USER,"user is not in the channel");uD.error("[".concat(this._clientId,"] can not massSubscribe ").concat(s.uid,", this user is not in the channel")),LD("error",this,"massSubscribe",s.uid,"this user is not in the channel"),o[n].error=t,e.splice(n,1);continue}if("audio"===a&&(!s.hasAudio||void 0===s._audioSSRC)||"video"===a&&(!s.hasVideo||void 0===s._videoSSRC)){const t=new eD(ZN.REMOTE_USER_IS_NOT_PUBLISHED);uD.error("[".concat(this._clientId,"] can not subscribe ").concat(s.uid," with mediaType ").concat(a,", remote user is not published")),LD("error",this,"subscribe",s.uid,"mediaType ".concat(a,", remote user is not published")),o[n].error=t,e.splice(n,1);continue}const c=hk.Video|hk.LwoVideo,u=r.get(s);if(u){if("video"===a?u&c:u&hk.Audio){e.splice(n,1),uD.warning("repeat massSubscribe user:".concat(s.uid,", mediaType:").concat(a," twice"));continue}r.set(s,u|("video"===a?c:hk.Audio))}else r.set(s,"video"===a?c:hk.Audio)}for(let t=e.length-1;t>=0;t--){const n=e[t],{user:i,mediaType:o}=n,s=hk.Video|hk.LwoVideo;if(this._p2pChannel.hasRemoteMedia(i,o)){await this._p2pChannel.unmuteRemoteNoLock(i,o);const n=r.get(i);r.set(i,"video"===o?n^s:n^hk.Audio),e.splice(t,1)}}this.store.massSubscribe(e.map((e=>({userId:e.user.uid,type:e.mediaType}))),n);const c=lh(a=Array.from(r.entries())).call(a,((e,t)=>{let[n,r]=t;if(0===r)return e;const i={stream_id:n.uid,stream_type:r};return r&hk.Audio&&(i.audio_ssrc=n._audioSSRC),r&hk.Video&&(i.video_ssrc=n._videoSSRC),e.push(i),e}),[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map((e=>{let{user:t,mediaType:n}=e;return{user:t,mediaType:n,ssrcId:n===Ok.VIDEO?t._videoSSRC:t._audioSSRC,rtxSsrcId:t._rtxSsrcId}})));const r=new Map;if(c.length>0){const e=await this._gateway.subscribeAll(c,!0);((null==e?void 0:e.users)||[]).forEach((e=>{let{stream_id:t,video_error_code:n,audio_error_code:i,error_code:o}=e;(n||i||o)&&r.set(t,{video_error_code:n,audio_error_code:i,error_code:o})}))}if(Array.from(r.entries()).length>0){const e=Array.from(r.entries()).map((e=>{let t,[n,r]=e;return r.error_code||r.video_error_code&&r.audio_error_code?t=void 0:r.video_error_code?t=Ok.VIDEO:r.audio_error_code&&(t=Ok.AUDIO),{user:this.remoteUsers.find((e=>e.uid===n)),mediaType:t}}));await this._p2pChannel.massUnsubscribeNoLock(e)}for(const e of o){const t=r.get(e.user.uid);if(t){const n=t.error_code||"audio"===e.mediaType&&t.audio_error_code||"video"===e.mediaType&&t.video_error_code;if(n){const t=FK(n);uD.error("user:".concat(e.user.uid," mediaType:").concat(e.mediaType," has massSubscribe error ").concat(t.desc)),e.error=new eD(ZN.SUBSCRIBE_FAILED,"code ".concat(n,": ").concat(t.desc))}}e.error||("video"===e.mediaType?e.track=e.user.videoTrack:e.track=e.user.audioTrack)}return this.store.massSubscribe(o.filter((e=>!e.error)).map((e=>({userId:e.user.uid,type:e.mediaType}))),void 0,Date.now()),o.forEach((e=>{var t;mG.subscribe(this.store.sessionId,{succ:!!e.error,ec:(null===(t=e.error)||void 0===t?void 0:t.code)||null,video:e.mediaType===Ok.VIDEO,audio:e.mediaType===Ok.AUDIO,peerid:e.user.uid,subscribeRequestid:e.mediaType===Ok.VIDEO?e.user._videoSSRC:e.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-n)},!0)})),t.onSuccess(),uD.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n)})).join("; "))),LD("info",this,"massSubscribe",e,"success"),o}catch(n){throw await this._p2pChannel.massUnsubscribeNoLock(e),t.onError(n),n}}finally{s(),i()}}async unsubscribe(e,t){if(t&&JL(t,"mediaType",["audio","video"]),!this._joinInfo)throw new eD(ZN.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");const n=mG.reportApiInvoke(this._sessionId,{name:_P.UNSUBSCRIBE,options:[e.uid,t],tag:mP.TRACER});if(!this._users.find((t=>t===e))){const r=new eD(ZN.INVALID_REMOTE_USER,"user is not in the channel");throw uD.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),LD("error",this,"unsubscribe",{uid:e.uid,mediaType:t},"user is not in the channel"),n.onError(r),r}uD.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(t)),LD("info",this,"unsubscribe",{uid:e.uid,mediaType:t});try{const r=await this._p2pChannel.unsubscribe(e,t);r&&await this._gateway.unsubscribe(r,e.uid),uD.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(t)),LD("info",this,"unsubscribe",{uid:e.uid,mediaType:t},"success"),n.onSuccess()}catch(r){if(r.code===ZN.DISCONNECT_P2P)return uD.warning("disconnecting p2p, abort unsubscribe request."),void n.onSuccess();throw uD.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),r.toString()),LD("error",this,"unsubscribe",{uid:e.uid,mediaType:t},r.toString()),n.onError(r),r}}async massUnsubscribe(e){tP(e,"unsubscribeList");const t=mG.reportApiInvoke(this._sessionId,{name:_P.UNSUBSCRIBE,options:e.map((e=>{let{user:t,mediaType:n}=e;return{uid:null==t?void 0:t.uid,mediaType:n}})),tag:mP.TRACER});if(!this._joinInfo){const e=new eD(ZN.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");throw t.onError(e),e}uD.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n,";")})).join())),LD("info",this,"massUnsubscribe",e),e=[...e];const n=new Map;for(let r=e.length-1;r>=0;r--){const{user:i,mediaType:o}=e[r];if(!i){const e=new eD(ZN.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw uD.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),t.onError(e),e}if(JL(o,"mediaType",["video","audio",void 0]),!this._users.find((e=>e===i))){uD.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(i.uid,", user is not in the channel")),LD("error",this,"unsubscribe",{uid:i.uid,mediaType:o},"user is not in the channel"),e.splice(r,1);continue}const s=hk.Video|hk.LwoVideo;if(n.has(i)){const t=n.get(i);let a;switch(o){case"video":a=t&s;break;case"audio":a=t&hk.Audio;break;default:a=t&(hk.Audio|s)}if(a){uD.warning("repeat massUnsubscribe user:".concat(i.uid,",mediaType:").concat(o," twice.")),e.splice(r,1);continue}o?"audio"===o?n.set(i,t|hk.Audio):"video"===o&&n.set(i,t|s):n.set(i,t|hk.Audio|s)}else o?"audio"===o?n.set(i,hk.Audio):"video"===o&&n.set(i,s):n.set(i,hk.Audio|s)}try{const n=await this._p2pChannel.massUnsubscribe(e);n&&await this._gateway.massUnsubscribe(n),uD.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map((e=>{let{user:t,mediaType:n}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(n,";")})).join())),LD("info",this,"massUnsubscribe",e,"success"),t.onSuccess()}catch(n){if(n.code===ZN.DISCONNECT_P2P)return uD.warning("disconnecting p2p, abort unsubscribe request."),void t.onSuccess();throw uD.error("[".concat(this._clientId,"] massUnsubscribe error"),n.toString()),LD("error",this,"massUnsubscribe",e,n.toString()),t.onError(n),n}}setLowStreamParameter(e){!function(e){if(!e)throw new eD(ZN.INVALID_PARAMS);iP(e.width)||ZL(e.width,"streamParameter.width"),iP(e.height)||ZL(e.height,"streamParameter.height"),iP(e.framerate)||ZL(e.framerate,"streamParameter.framerate"),iP(e.bitrate)||XL(e.bitrate,"streamParameter.bitrate")}(e);const t=mG.reportApiInvoke(this._sessionId,{name:_P.SET_LOW_STREAM_PARAMETER,options:[e],tag:mP.TRACER});(!e.width&&e.height||e.width&&!e.height)&&(uD.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),CD("warning",this,"The width and height parameters take effect only when both are set")),uD.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e)),LD("info",this,"setLowStreamParameter",e);const n=this._configDistribute.getLowStreamConfigDistribute();n&&n.bitrate&&e.bitrate&&n.bitrate<e.bitrate&&(e.bitrate=n.bitrate),this._lowStreamParameter=e,t.onSuccess()}async enableDualStream(){const e=mG.reportApiInvoke(this._sessionId,{name:_P.ENABLE_DUAL_STREAM,options:[],tag:mP.TRACER});if(!Gk().supportDualStream){mG.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1});const t=new eD(ZN.NOT_SUPPORTED,"Your browser is not support dual stream");throw e.onError(t),t}if(this._isDualStreamEnabled){const t=new eD(ZN.INVALID_OPERATION,"Dual stream is already enabled");throw e.onError(t),t}if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(t){throw mG.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e.onError(t),t}this._isDualStreamEnabled=!0,mG.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),uD.info("[".concat(this._clientId,"] enable dual stream")),LD("info",this,"enableDualStream"),e.onSuccess()}async disableDualStream(){if(!this._isDualStreamEnabled)return;if(!this._joinInfo)throw new eD(ZN.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");const e=mG.reportApiInvoke(this._sessionId,{name:_P.DISABLE_DUAL_STREAM,options:[],tag:mP.TRACER});if(this._p2pChannel.getLocalMedia(bk.LocalVideoLowTrack))try{const e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(t){throw mG.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e.onError(t),t}this._isDualStreamEnabled=!1,mG.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),uD.info("[".concat(this._clientId,"] disable dual stream")),LD("info",this,"disableDualStream"),e.onSuccess()}async setClientRole(e,t){!function(e){JL(e,"role",["audience","host"])}(e),t&&QP(t);const n=mG.reportApiInvoke(this._sessionId,{name:_P.SET_CLIENT_ROLE,options:[e,t],tag:mP.TRACER});if("rtc"===this._mode){uD.warning("[".concat(this._clientId,"]rtc mode can not use setClientRole")),LD("warning",this,"setClientRole",e,"rtc mode can not use setClientRole");const t=new eD(ZN.INVALID_OPERATION,"rtc mode can not use setClientRole");return n.onError(t),t.throw()}if(t&&t.level&&"host"===e){const e=new eD(ZN.INVALID_OPERATION,"host mode can not set audience latency level");return n.onError(e),e.throw()}try{if("audience"===e&&this._p2pChannel.hasLocalMedia()){const e=new eD(ZN.INVALID_OPERATION,"can not set client role to audience when publishing stream");return n.onError(e),e.throw()}await this._gateway.setClientRole(e,t),uD.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(t&&t.level)),LD("info",this,"setClientRole",{role:e,level:t&&t.level}),n.onSuccess()}catch(e){throw n.onError(e),e}}setProxyServer(e,t){if(eP(e,"proxyServer"),!t){if("DISCONNECTED"!==this.connectionState)throw new eD(ZN.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new eD(ZN.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,mG.setProxyServer(this._proxyServer),uD.setProxyServer(this._proxyServer),SD(this._proxyServer),uD.info("[".concat(this._clientId,"] Set proxy server ").concat(t?"by initialize call":""," success.")),LD("info",this,"setProxyServer",[...arguments],"success")}setTurnServer(e,t){if(Array.isArray(e)||(e=[e]),!t){if("DISCONNECTED"!==this.connectionState)throw new eD(ZN.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new eD(ZN.INVALID_OPERATION,"You have already set the proxy")}if(VP(e))return this._turnServer={servers:e,mode:"original-manual"},uD.info("[".concat(this._clientId,"] Set original turnserver ").concat(t?"by initialize call":""," success: ").concat(e.map((e=>e.urls)).join(","),".")),void LD("info",this,"setOriginalTurnServer",[...arguments],"success");e.forEach((e=>GP(e))),this._turnServer={servers:e,mode:"manual"},uD.info("[".concat(this._clientId,"] Set turnserver ").concat(t?"by initialize call":""," success.")),LD("info",this,"setTurnServer",[...arguments],"success")}setLicense(e){if("DISCONNECTED"!==this.connectionState)throw new eD(ZN.INVALID_OPERATION,"you should set license before join channel");if(eP(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new eD(ZN.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,uD.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){const t=mG.reportApiInvoke(this._sessionId,{name:_P.START_PROXY_SERVER,options:[],tag:mP.TRACER});if("DISCONNECTED"!==this.connectionState){const e=new eD(ZN.INVALID_OPERATION,"Start proxy server before join channel");throw t.onError(e),e}if(this._proxyServer||"manual"===this._turnServer.mode||this._useLocalAccessPoint){const e=new eD(ZN.INVALID_OPERATION,"You have already set the proxy");throw t.onError(e),e}const n=[1,2,3,4,5];let r;switch(void 0===e&&(e=1),e){case 1:r="normal";break;case 2:r="443only";break;case 3:r="proxy3";break;case 4:r="proxy4";break;case 5:r="proxy5";break;default:{const e=new eD(ZN.INVALID_PARAMS,"proxy server mode must be ".concat(n.join("|")));throw t.onError(e),e}}this._cloudProxyServerMode=r,this.store.cloudProxyServerMode=r,uD.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),LD("info",this,"startProxyServer",this._cloudProxyServerMode),t.onSuccess()}stopProxyServer(){const e=mG.reportApiInvoke(this._sessionId,{name:_P.STOP_PROXY_SERVER,options:[],tag:mP.TRACER});if("DISCONNECTED"!==this.connectionState)throw new eD(ZN.INVALID_OPERATION,"Stop proxy server after leave channel");mG.setProxyServer(),uD.setProxyServer(),SD(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",uD.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),LD("info",this,"stopProxyServer",this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]},e.onSuccess()}setLocalAccessPoints(e,t){if(tP(e,"serverList"),eP(t,"domain"),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new eD(ZN.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const n=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map((e=>n.test(e)?"".concat(e.replace(/\./g,"-"),".").concat(t):e)),this._useLocalAccessPoint=!0,KD("WEBCS_DOMAIN",e),KD("WEBCS_DOMAIN_BACKUP_LIST",e),KD("GATEWAY_DOMAINS",[t]),KD("EVENT_REPORT_DOMAIN",e[0]),KD("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),KD("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),uD.info("set local access point success"),LD("info",this,"setLocalAccessPoints")}async setRemoteDefaultVideoStreamType(e){if(JL(e,"streamType",[0,1]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(e){throw uD.error("[".concat(this._clientId,"] set default remote video stream type error"),e.toString()),e}else uD.debug("haven't joined yet, cache remoteDefaultVideoStreamType ".concat(e))}async setRemoteVideoStreamType(e,t){JL(t,"streamType",[0,1]);const n=mG.reportApiInvoke(this._sessionId,{name:_P.SET_REMOTE_VIDEO_STREAM_TYPE,options:[e,t],tag:mP.TRACER});try{await this._gateway.setRemoteVideoStreamType(e,t),setTimeout((()=>{const t=this._users.find((t=>t.uid===e));t&&t.videoTrack&&t.videoTrack.updateMediaStreamTrackResolution()}),2e3)}catch(e){throw n.onError(e),uD.error("[".concat(this._clientId,"] set remote video stream type error"),e.toString()),LD("error",this,"setRemoteVideoStreamType",void 0,e.toString()),e}uD.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(t)),LD("info",this,"setRemoteVideoStreamType",{uid:e,streamType:t}),this._remoteStreamTypeCacheMap.set(e,t),n.onSuccess()}async setStreamFallbackOption(e,t){JL(t,"fallbackType",[0,1,2]);const n=mG.reportApiInvoke(this._sessionId,{name:_P.SET_STREAM_FALLBACK_OPTION,options:["too long to show",t],tag:mP.TRACER});try{await this._gateway.setStreamFallbackOption(e,t)}catch(e){throw n.onError(e),uD.error("[".concat(this._clientId,"] set stream fallback option"),e.toString()),LD("error",this,"setStreamFallbackOption",void 0,e.toString()),e}uD.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(t)),LD("info",this,"setStreamFallbackOption",{uid:e,fallbackType:t}),this._streamFallbackTypeCacheMap.set(e,t),n.onSuccess()}setEncryptionConfig(e,t,n){const r=mG.reportApiInvoke(this._sessionId,{name:_P.SET_ENCRYPTION_CONFIG,options:[e],tag:mP.TRACER});try{if(function(e){JL(e,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(e),eP(t,"secret"),["aes-128-gcm2","aes-256-gcm2"].includes(e)){if(!n||!(n instanceof Uint8Array&&32===n.length))throw new eD(ZN.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(n)throw new eD(ZN.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'\"|{}\\[\\]])(?=.{8,})").test(t)||(uD.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      "),CD("warning",this,"The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      ")),this._encryptionMode=e,this._encryptionSecret=t,n&&(this._encryptionSalt=Gj(n)),r.onSuccess()}catch(e){throw r.onError(e),e}}async renewToken(e){eP(e,"token",1,2047);const t=mG.reportApiInvoke(this._sessionId,{name:_P.RENEW_TOKEN,options:[e],tag:mP.TRACER});if(!this._key||!this._joinInfo){const e=new eD(ZN.INVALID_OPERATION,"renewToken should not be called before user join");return t.onError(e),e.throw()}const n=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const r=await this._renewTokenMutex.lock();try{if($D("USE_NEW_TOKEN")){uD.debug("start renew token with ticket from unilbs"),LD("debug",this,"renewToken","unilbs");const t=await N$(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||tD);uD.debug("[".concat(this._clientId,"] get ticket from unilbs success")),LD("debug",this,"renewToken","unilbs","success"),await this._gateway.renewToken({token:e,ticket:t})}else uD.debug("start renew token without ticket"),LD("debug",this,"renewToken"),await this._gateway.renewToken({token:e});uD.debug("[".concat(this._clientId,"] renewToken success")),LD("debug",this,"renewToken",void 0,"success"),t.onSuccess()}catch(e){throw this._key=n,this._joinInfo.token=n,t.onError(e),uD.error("[".concat(this._clientId,"] renewToken failed"),e.toString()),LD("error",this,"renewToken",void 0,e.toString()),e}finally{r()}}enableAudioVolumeIndicator(){const e=mG.reportApiInvoke(this._sessionId,{name:_P.ENABLE_AUDIO_VOLUME_INDICATOR,options:[],tag:mP.TRACER});if(this._audioVolumeIndicationInterval)return uD.warning("you have already enabled audio volume indicator!"),LD("warning",this,"enableAudioVolumeIndicator","you have already enabled audio volume indicator!"),e.onSuccess();this._audioVolumeIndicationInterval=window.setInterval((()=>{const e=this._p2pChannel.getAudioLevels();this.emit(wP.VOLUME_INDICATOR,e)}),$D("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3),e.onSuccess()}getRTCStats(){const e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}startLiveStreaming(e,t){const n=mG.reportApiInvoke(this._sessionId,{name:_P.START_LIVE_STREAMING,options:[e,t],tag:mP.TRACER});if(!t){if("h264"!==this._codec){const e=new eD(ZN.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");return n.onError(e),xv.reject(e)}if(!this._p2pChannel.hasLocalMedia()){const e=new eD(ZN.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming");return n.onError(e),xv.reject(e)}}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e)){const e=new eD(ZN.LIVE_STREAMING_TASK_CONFLICT);return n.onError(e),xv.reject(e)}const r=t?zP.TRANSCODE:zP.RAW;return this._createLiveStreamingClient(r).startLiveStreamingTask(e,r).then((()=>n.onSuccess())).catch((e=>{throw n.onError(e),e}))}setLiveTranscoding(e){const t=mG.reportApiInvoke(this._sessionId,{name:_P.SET_LIVE_TRANSCODING,options:[e],tag:mP.TRACER});return this._createLiveStreamingClient(zP.TRANSCODE).setTranscodingConfig(e).then((()=>t.onSuccess())).catch((e=>{throw t.onError(e),e}))}stopLiveStreaming(e){const t=mG.reportApiInvoke(this._sessionId,{name:_P.STOP_LIVE_STREAMING,options:[e],tag:mP.TRACER}),n=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter((t=>t&&t.hasUrl(e)));if(!n.length){const e=new eD(ZN.INVALID_PARAMS,"can not find live streaming url to stop");return t.onError(e),xv.reject(e)}return xv.all(n.map((t=>t&&t.stopLiveStreamingTask(e)))).then((()=>t.onSuccess())).catch((e=>{throw t.onError(e),e}))}async addInjectStreamUrl(e,t){const n=mG.reportApiInvoke(this._sessionId,{name:_P.ADD_INJECT_STREAM_URL,options:[e,t],tag:mP.TRACER});try{if(!this._joinInfo)throw new eD(ZN.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const n=this._createLiveStreamingClient(zP.INJECT);n.setInjectStreamConfig(t,0),await n.startLiveStreamingTask(e,zP.INJECT)}catch(e){throw n.onError(e),e}n.onSuccess()}async removeInjectStreamUrl(){const e=mG.reportApiInvoke(this._sessionId,{name:_P.REMOVE_INJECT_STREAM_URL,options:[],tag:mP.TRACER});try{var t;const e=this._createLiveStreamingClient(zP.INJECT),n=Array.from(HQ(t=e.streamingTasks).call(t)).find((e=>e.mode===zP.INJECT));if(!this._joinInfo||!n)throw new eD(ZN.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await e.stopLiveStreamingTask(n.url)}catch(t){throw e.onError(t),t}e.onSuccess()}async startChannelMediaRelay(e){const t=mG.reportApiInvoke(this._sessionId,{name:_P.START_CHANNEL_MEDIA_RELAY,options:[e],tag:mP.TRACER});try{Q$(e);const t=this._createChannelMediaRelayClient();await t.startChannelMediaRelay(e)}catch(e){return t.onError(e),e.throw()}t.onSuccess()}async updateChannelMediaRelay(e){const t=mG.reportApiInvoke(this._sessionId,{name:_P.UPDATE_CHANNEL_MEDIA_RELAY,options:[e],tag:mP.TRACER});try{Q$(e);const t=this._createChannelMediaRelayClient();await t.updateChannelMediaRelay(e)}catch(e){return t.onError(e),e.throw()}t.onSuccess()}async stopChannelMediaRelay(){const e=mG.reportApiInvoke(this._sessionId,{name:_P.STOP_CHANNEL_MEDIA_RELAY,options:[],tag:mP.TRACER});try{const e=this._createChannelMediaRelayClient();await e.stopChannelMediaRelay()}catch(t){return e.onError(t),t.throw()}e.onSuccess()}sendStreamMessage(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this._joinInfo)throw new eD(ZN.INVALID_OPERATION,"can not send data stream, not joined");if("string"==typeof e&&(e=(new TextEncoder).encode(e)),new Blob([e]).size>1024)throw new eD(ZN.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(PP.DATA_STREAM,{payload:Gj(e)},!t)}sendMetadata(e){if(!this._joinInfo)throw new eD(ZN.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new eD(ZN.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(PP.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:Gj(e)})}async sendCustomReportMessage(e){Array.isArray(e)||(e=[e]),e.forEach(hP);const t=mG.reportApiInvoke(this._sessionId,{name:_P.SEND_CUSTOM_REPORT_MESSAGE,options:[JSON.stringify(e)],tag:mP.TRACER});if(!this._joinInfo){const e=new eD(ZN.INVALID_OPERATION,"can not send custom report, not joined");return t.onError(e),e.throw()}await mG.sendCustomReportMessage(this._joinInfo.sid,e),t.onSuccess()}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,t){JL(t.spatialLayer,"spatialLayer",[0,1,2,3]),JL(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,t)}catch(e){throw uD.error("[".concat(this._clientId,"] pick SVC layer failed"),e.toString()),ND("error",this,"pickSVCLayer",t,e.toString()),e}}_reset(){if(uD.debug("[".concat(this._clientId,"] reset client")),ND("debug",this,"_reset"),this._axiosCancelSource.cancel(),this._axiosCancelSource=zN.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._users.forEach((e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy()})),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),"fallback"===this._cloudProxyServerMode&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new SG("client-publish"),this._subscribeMutex=new SG("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch(e){}}_startSession(e,t){const n=e||Cj();e?uD.debug("[".concat(this._clientId,"] new Session ").concat(n)):uD.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(n)),ND("debug",this,"_startSession",{newSid:n,sid:this._sessionId}),this._sessionId=n,this.store.sessionId=n,t?mG.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:t.channel,appid:t.appId,mode:this._mode}):this._joinInfo?mG.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this._mode}):this._gateway.joinInfo&&mG.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this._mode}),this._joinInfo&&(this._joinInfo.sid=n),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=n)}async _publishHighStream(e){if(!this._joinInfo||void 0===this._uid)throw new eD(ZN.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new eD(ZN.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&$D("FORCE_TURN")&&!$D("TURN_ENABLE_TCP")&&!$D("TURN_ENABLE_UDP"))throw new eD(ZN.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");uD.debug("[".concat(this._clientId,"] publish high stream")),ND("debug",this,"_publishHighStream");try{const n=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter),r=(await n.next()).value;if(r){var t;let i;try{i=await this._gateway.publish(this._uid,r,!0)}catch(e){if(e.code!==ZN.DISCONNECT_P2P)throw n.throw(e),e}await n.next((null===(t=i)||void 0===t?void 0:t.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const t of e)t instanceof Zz&&t._encoderConfig&&this._gateway.setVideoProfile(t._encoderConfig),!t.muted&&t.enabled||await this._p2pChannel.muteLocalTrack(t)}catch(t){if(this._p2pChannel.reportPublishEvent(!1,null==t?void 0:t.code,e),(null==t?void 0:t.code)===ZN.WS_ABORT)return;throw t}}async _publishLowStream(){if(!this._joinInfo||void 0===this._uid)throw new eD(ZN.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new eD(ZN.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));uD.debug("[".concat(this._clientId,"] publish low stream")),ND("debug",this,"_publishLowStream");const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const e=await this._p2pChannel.publishLowStream(this._lowStreamParameter),n=(await e.next()).value;if(n){var t;let r;try{r=await this._gateway.publish(this._uid,n,!0)}catch(t){if(t.code!==ZN.DISCONNECT_P2P)throw e.throw(t),t}e.next((null===(t=r)||void 0===t?void 0:t.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(e){if(this._p2pChannel.reportPublishEvent(!1,null==e?void 0:e.code,void 0,!0),(null==e?void 0:e.code)===ZN.WS_ABORT)return;throw e}}_createLiveStreamingClient(e){if(!this._joinInfo||!this._appId)return new eD(ZN.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const t=()=>new V$(this._joinInfo,this._config.websocketRetryConfig||tD,this._config.httpRetryConfig||tD),n=e=>{e.onLiveStreamError=(e,t)=>{mG.reportApiInvoke(this._sessionId,{name:_P.ON_LIVE_STREAM_ERROR,options:[e,t],tag:mP.TRACER}).onSuccess(),this.emit(wP.LIVE_STREAMING_ERROR,e,t)},e.onLiveStreamWarning=(e,t)=>{mG.reportApiInvoke(this._sessionId,{name:_P.ON_LIVE_STREAM_WARNING,options:[e,t],tag:mP.TRACER}).onSuccess(),this.emit(wP.LIVE_STREAMING_WARNING,e,t)},e.on(rk.REQUEST_WORKER_MANAGER_LIST,((e,t,n)=>{if(!this._joinInfo)return n(new eD(ZN.INVALID_OPERATION,"can not find join info to get worker manager"));w$(e,this._joinInfo,this._axiosCancelSource.token,tD).then(t).catch(n)}))};switch(e){case zP.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=t(),n(this._liveRawStreamingClient)),this._liveRawStreamingClient;case zP.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=t(),n(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case zP.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=t(),this._injectStreamingClient.on(rk.REQUEST_WORKER_MANAGER_LIST,((e,t,n)=>{if(!this._joinInfo)return n(new eD(ZN.INVALID_OPERATION,"can not find join info to get worker manager"));w$(e,this._joinInfo,this._axiosCancelSource.token,tD).then(t).catch(n)})),this._injectStreamingClient.onInjectStatusChange=(e,t,n)=>{this.emit(wP.INJECT_STREAM_STATUS,e,t,n)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){return this._joinInfo?(this._channelMediaRelayClient||(this._channelMediaRelayClient=new H$(this._joinInfo,this._clientId,this._config.websocketRetryConfig||tD,this._config.httpRetryConfig||tD),this._channelMediaRelayClient.on("state",(e=>{e===ck.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.emit(wP.CHANNEL_MEDIA_RELAY_STATE,e)})),this._channelMediaRelayClient.on("event",(e=>{this.emit(wP.CHANNEL_MEDIA_RELAY_EVENT,e)}))),this._channelMediaRelayClient):new eD(ZN.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw()}_handleGatewayEvents(){this._gateway.on(dk.DISCONNECT_P2P,(async()=>{await this._p2pChannel.disconnectForReconnect()})),this._gateway.on(dk.CONNECTION_STATE_CHANGE,((e,t,n)=>{var r;if(n===bP.FALLBACK)return;const i=()=>{this.emit(wP.CONNECTION_STATE_CHANGE,e,t,n)};if(mG.reportApiInvoke(this._sessionId||(null===(r=this._gateway.joinInfo)||void 0===r?void 0:r.sid)||null,{name:_P.CONNECTION_STATE_CHANGE,options:[e,t,n],tag:mP.TRACER}).onSuccess(JSON.stringify({cur:e,prev:t,reason:n})),uD.info("[".concat(this._clientId,"] connection state change: ").concat(t," -> ").concat(e)),OD("info",this,"connection-state-change","".concat(t," -> ").concat(e)),"DISCONNECTED"===e)return this._reset(),void i();if("RECONNECTING"===e)this._users.forEach((e=>{e._trust_in_room_=!1,e._trust_audio_enabled_state_=!1,e._trust_video_enabled_state_=!1,e._trust_audio_mute_state_=!1,e._trust_video_mute_state_=!1,e._trust_audio_stream_added_state_=!1,e._trust_video_stream_added_state_=!1,e._audioSSRC=void 0,e._videoSSRC=void 0,e._videoOrtc=void 0,e._audioOrtc=void 0,e._cname=void 0,e._rtxSsrcId=void 0})),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if("CONNECTED"===e){var o;this._streamFallbackTypeCacheMap.forEach(((e,t)=>{this._gateway.setStreamFallbackOption(t,e).catch((e=>{uD.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),e),CD("warning",this,"auto set stream fallback option failed, ".concat(e.toString()))}))})),this._remoteStreamTypeCacheMap.forEach(((e,t)=>{this._gateway.setRemoteVideoStreamType(t,e).catch((e=>{uD.warning("[".concat(this._clientId,"] auto set remote stream type failed"),e),CD("warning",this,"auto set remote stream type failed, ".concat(e.toString()))}))})),void 0!==this._remoteDefaultVideoStreamType&&void 0===(null===(o=this._joinInfo)||void 0===o?void 0:o.defaultVideoStream)&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then((()=>{uD.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))})).catch((e=>{uD.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(e))})),this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout((()=>{"CONNECTED"===this.connectionState&&(this._userOfflineTimeout=void 0,this._users.filter((e=>!e._trust_in_room_)).forEach((e=>{uD.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(e.uid)),CD("debug",this,"user offline timeout, emit user offline ".concat(e.uid)),this._handleUserOffline({uid:e.uid})})))}),3e3),this._streamRemovedTimeout=window.setTimeout((()=>{"CONNECTED"===this.connectionState&&(this._streamRemovedTimeout=void 0,this._users.forEach((e=>{e._trust_audio_mute_state_||(uD.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(e.uid)),CD("debug",this,"auto dispatch audio unmute event ".concat(e.uid)),this._handleMuteStream(e.uid,"audio",!1)),e._trust_video_mute_state_||(uD.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(e.uid)),CD("debug",this,"auto dispatch video unmute event ".concat(e.uid)),this._handleMuteStream(e.uid,"video",!1)),e._trust_audio_enabled_state_||(uD.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(e.uid)),CD("debug",this,"auto dispatch enable local audio ".concat(e.uid)),this._handleSetStreamLocalEnable("audio",e.uid,!0)),e._trust_video_enabled_state_||(uD.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(e.uid)),CD("debug",this,"auto dispatch enable local video ".concat(e.uid)),this._handleSetStreamLocalEnable("video",e.uid,!0)),e._trust_video_stream_added_state_||(uD.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(e.uid)),this._handleResetAddStream(e,"video")),e._trust_audio_stream_added_state_||(uD.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(e.uid)),this._handleResetAddStream(e,"audio")),e._video_added_||e._audio_added_||(uD.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(e.uid)),CD("debug",this,"auto dispatch stream remove ".concat(e.uid)),this._handleRemoveStream({uid:e.uid,uint_id:e._uintid}))})))}),1e3)}i()})),this._gateway.on(dk.REQUEST_NEW_GATEWAY_LIST,((e,t)=>{if(!this._joinInfo)return t(new eD(ZN.UNEXPECTED_ERROR,"can not recover, no join info"));y$(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||tD,this.store).then((t=>{this._joinInfo&&(this._joinInfo.apResponse=t.gatewayInfo.res,this._joinInfo.gatewayAddrs=t.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=t.gatewayInfo.uni_lbs_ip),e(t.gatewayInfo.gatewayAddrs.map((e=>{if(this._joinInfo&&this._joinInfo.proxyServer){const t=e.address.split(":");return"wss://".concat(this._joinInfo.proxyServer,"/ws/?h=").concat(t[0],"&p=").concat(t[1])}return"wss://".concat(e.address)})))})).catch(t)})),this._gateway.on(dk.NETWORK_QUALITY,(e=>{"normal"===this._networkQualitySensitivity&&this.emit(wP.NETWORK_QUALITY,e)})),this._gateway.on(dk.STREAM_TYPE_CHANGE,((e,t)=>{this.emit(wP.STREAM_TYPE_CHANGED,e,t),mG.reportApiInvoke(this._sessionId,{name:_P.STREAM_TYPE_CHANGE,options:[e,t],tag:mP.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:t}))})),this._gateway.on(dk.IS_P2P_DISCONNECTED,(e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)})),this._gateway.on(dk.NEED_RENEW_SESSION,(()=>{this._startSession()})),this._gateway.on(dk.REQUEST_P2P_CONNECTION_PARAMS,(async(e,t,n)=>{try{t(await this._p2pChannel.startP2PConnection(e))}catch(e){n(e)}})),this._gateway.on(dk.JOIN_RESPONSE,((e,t)=>{const{dtlsParameters:n,iceParameters:r,candidates:i,rtpCapabilities:o,setup:s,cname:a}=UX(e.ortc,t);this._p2pChannel.connect(r,n,i,o,s,a)})),this._gateway.signal.on(xP.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(xP.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(xP.ON_ADD_AUDIO_STREAM,(e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc))),this._gateway.signal.on(xP.ON_ADD_VIDEO_STREAM,(e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId))),this._gateway.signal.on(xP.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(xP.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(xP.MUTE_AUDIO,(e=>(OD("debug",["AgoraRTCGateway",this._clientId],"mute_audio",{uid:e.uid}),this._handleMuteStream(e.uid,"audio",!0)))),this._gateway.signal.on(xP.UNMUTE_AUDIO,(e=>(OD("debug",["AgoraRTCGateway",this._clientId],"unmute_audio",{uid:e.uid}),this._handleMuteStream(e.uid,"audio",!1)))),this._gateway.signal.on(xP.MUTE_VIDEO,(e=>(OD("debug",["AgoraRTCGateway",this._clientId],"mute_video",{uid:e.uid}),this._handleMuteStream(e.uid,"video",!0)))),this._gateway.signal.on(xP.UNMUTE_VIDEO,(e=>(OD("debug",["AgoraRTCGateway",this._clientId],"unmute_video",{uid:e.uid}),this._handleMuteStream(e.uid,"video",!1)))),this._gateway.signal.on(xP.RECEIVE_METADATA,(e=>{const t=Vj(e.metadata);this.emit(wP.RECEIVE_METADATA,e.uid,t)})),this._gateway.signal.on(xP.ON_DATA_STREAM,(e=>{e.seq&&delete e.seq,e.payload=Vj(e.payload),this.emit(wP.STREAM_MESSAGE,e.uid,e.payload),this.onStreamMessage&&this.onStreamMessage(e)})),this._gateway.signal.on(xP.ON_CRYPT_ERROR,(()=>{Fj((()=>{uD.warning("[".concat(this._clientId,"] on crypt error")),OD("warning",this,"crypt_error"),this.emit(wP.CRYPT_ERROR)}),this._sessionId)})),this._gateway.signal.on(xP.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(xP.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{uD.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),OD("warning",this,"token_privilege_did_expire"),this._gateway.leave(!0),this.emit(wP.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()})),this._gateway.signal.on(xP.ON_STREAM_FALLBACK_UPDATE,(e=>{uD.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),OD("debug",this,"stream_fallback_update",{peerId:e.stream_id,attr:e.stream_type}),this.emit(wP.STREAM_FALLBACK,e.stream_id,1===e.stream_type?"fallback":"recover")})),this._gateway.signal.on(xP.ON_PUBLISH_STREAM,(e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),uD.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))),OD("info",this,"publish_stream",e))})),this._gateway.signal.on(xP.ENABLE_LOCAL_VIDEO,(e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)})),this._gateway.signal.on(xP.DISABLE_LOCAL_VIDEO,(e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)})),this._gateway.signal.on(LP.REQUEST_TIMEOUT,((e,t)=>{if(this._joinInfo)switch(e){case PP.PUBLISH:{if(!t)return;const e=t.ortc;if(e){var n,r,i,o;const s=e.some((e=>{let{stream_type:t}=e;return t===lk.Audio})),a=e.some((e=>{let{stream_type:t}=e;return t!==lk.Audio})),c=e.some((e=>{let{stream_type:t}=e;return t===lk.Screen||t===lk.ScreenLow}));"offer"===t.state&&mG.publish(this._joinInfo.sid,{eventElapse:rj.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:ZN.TIMEOUT,audio:s,video:a,p2pid:t.p2p_id,publishRequestid:this.store.pubId,screenshare:c,audioName:s?null===(n=e.find((e=>{let{stream_type:t}=e;return t===lk.Audio})))||void 0===n||null===(r=n.ssrcs[0])||void 0===r?void 0:r.ssrcId.toString():void 0,videoName:a?null===(i=e.find((e=>{let{stream_type:t}=e;return t!==lk.Audio})))||void 0===i||null===(o=i.ssrcs[0])||void 0===o?void 0:o.ssrcId.toString():void 0})}break}case PP.SUBSCRIBE:t&&mG.subscribe(this._joinInfo.sid,{succ:!1,ec:ZN.TIMEOUT,audio:t.stream_type===Ok.AUDIO,video:t.stream_type===Ok.VIDEO,peerid:t.stream_id,subscribeRequestid:t.ssrcId,p2pid:this.store.p2pId,eventElapse:rj.measureFromSubscribeStart(this.store.clientId,t.ssrcId)})}})),this._gateway.signal.on(xP.ON_P2P_OK,(e=>{this.uid,this._uid})),this._gateway.signal.on(xP.ON_PUBLISHED_USER_LIST,(e=>{if(null==e||!e.users)return;const t=[],n=[];for(const r of e.users){let e=this._users.find((e=>e.uid===r.stream_id));e?e._trust_in_room_=!0:(e=new tq(r.stream_id,r.stream_id),this._users.push(e),0===this.getListeners(wP.PUBLISHED_USER_LIST).length&&(uD.debug("[".concat(this._clientId,"] user online"),r.stream_id),bD("info",this,"user-joined",{uid:r.stream_id}),this.emit(wP.USER_JOINED,e)));const i=hk.Audio&r.stream_type,o=(hk.Video|hk.LwoVideo)&r.stream_type,s=i&&e.hasAudio,a=o&&e.hasVideo;o&&(e._trust_video_stream_added_state_=!0,e._video_added_=!0,e._videoSSRC=r.video_ssrc),i&&(e._trust_audio_stream_added_state_=!0,e._audio_added_=!0,e._audioSSRC=r.audio_ssrc),i&&!s&&0===this.getListeners(wP.PUBLISHED_USER_LIST).length&&(uD.info("[".concat(this._clientId,"] remote user ").concat(e.uid," published audio")),CD("info",this,"remote user ".concat(e.uid," published audio")),this.emit(wP.USER_PUBLISHED,e,"audio")),o&&!a&&0===this.getListeners(wP.PUBLISHED_USER_LIST).length&&(uD.info("[".concat(this._clientId,"] remote user ").concat(e.uid," published video")),CD("info",this,"remote user ".concat(e.uid," published video")),this.emit(wP.USER_PUBLISHED,e,"video")),(i&&!s||o&&!a)&&t.push(e),o&&this._p2pChannel.hasPendingRemoteMedia(e,"video")&&n.push({user:e,mediaType:"video"}),i&&this._p2pChannel.hasPendingRemoteMedia(e,"audio")&&n.push({user:e,mediaType:"audio"})}n.length>0&&(uD.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(n.map((e=>"user: ".concat(e.user.uid,", mediaType: ").concat(e.mediaType))).join("; ")," ")),this.massSubscribe(n).catch((e=>{uD.error("[".concat(this._clientId,"] mass resubscribe error"),e.toString())}))),this.getListeners(wP.PUBLISHED_USER_LIST).length>0?(uD.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(t.map((e=>e.uid)).join(", "))),this.emit(wP.PUBLISHED_USER_LIST,t)):uD.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(t.map((e=>e.uid)).join(", ")))}))}_handleP2PChannelEvents(){this._p2pChannel.on(Nk.RequestMuteLocal,(async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===ZN.DISCONNECT_P2P?t():n(e)}else t()})),this._p2pChannel.on(Nk.RequestUnmuteLocal,(async(e,t,n)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===ZN.DISCONNECT_P2P?t():n(e)}else t()})),this._p2pChannel.on(Nk.RequestRePublish,((e,t,n)=>{this.publish(e,!1).then(t).catch(n)})),this._p2pChannel.on(Nk.RequestReSubscribe,(async(e,t,n)=>{try{for(const{user:t,kind:n}of e)n===Ok.VIDEO?await this.subscribe(t,"video"):await this.subscribe(t,"audio");t()}catch(e){n(e)}})),this._p2pChannel.on(Nk.RequestUploadStats,((e,t)=>{this._gateway.uploadStats(e,t)})),this._p2pChannel.on(Nk.MediaReconnectStart,(e=>{this.emit(wP.MEDIA_RECONNECT_START,e)})),this._p2pChannel.on(Nk.MediaReconnectEnd,(e=>{this.emit(wP.MEDIA_RECONNECT_END,e)})),this._p2pChannel.on(Nk.NeedSignalRTT,(e=>{e(this._gateway.getSignalRTT())})),this._p2pChannel.on(Nk.RequestRestartICE,(async()=>{const e=await this._p2pChannel.reEstablish();if(e){const{restartICEResponse:t,gatewayAddress:n}=await this._gateway.restartICE({iceParameters:e.iceParameters}),{candidates:r,iceParameters:i}=function(e,t){const n=e.iceParameters;let r;return t&&t.ip&&"number"==typeof t.port?(r=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip,port:t.port.toString(),type:"host",extension:{}}],uD.debug("Using remote candidate from AP ".concat(t.ip,":").concat(t.port)),CD("debug",[],"Using remote candidate from AP ".concat(t.ip,":").concat(t.port)),t.ip6&&(r=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip6,port:t.port.toString(),type:"host",extension:{}}],uD.debug("Using remote candidate from AP ".concat(t.ip6,":").concat(t.port)),CD("debug",[],"Using remote candidate from AP ".concat(t.ip6,":").concat(t.port)))):r=n.candidates.map((e=>({foundation:e.foundation,componentId:"1",transport:e.protocol,priority:e.priority.toString(),connectionAddress:e.ip,port:e.port.toString(),type:e.type,extension:{}}))),{candidates:r,iceParameters:{iceUfrag:n.iceUfrag,icePwd:n.icePwd}}}(t,n);await e.restartICE(i,r)}})),this._p2pChannel.on(Nk.RequestReconnect,(async()=>{this._gateway.reconnect()})),this._p2pChannel.on(Nk.RequestReconnectPC,(async()=>{var e;const{iceParameters:t,dtlsParameters:n,rtpCapabilities:r}=await this._p2pChannel.startP2PConnection({turnServer:null===(e=this._joinInfo)||void 0===e?void 0:e.turnServer}),{gatewayEstablishParams:i,gatewayAddress:o}=await this._gateway.reconnectPC({iceParameters:t,dtlsParameters:n,rtpCapabilities:r}),{dtlsParameters:s,iceParameters:a,candidates:c,rtpCapabilities:u,setup:l,cname:d}=UX(i,o);await this._p2pChannel.connect(a,s,c,u,l,d),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()})),this._p2pChannel.on(Nk.RequestUnpublishForReconnectPC,(async(e,t,n)=>{this._joinInfo&&void 0!==this._uid?(await this._gateway.unpublish(e,this._uid),t()):n()})),this._p2pChannel.on(Nk.P2PLost,(()=>{this.emit(wP.P2P_LOST,this.store.uid)})),this._p2pChannel.on(Nk.UpdateVideoEncoder,(e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)})),this._p2pChannel.on(Nk.ConnectionTypeChange,(e=>{this.emit(wP.IS_USING_CLOUD_PROXY,e)})),this._p2pChannel.on(Nk.RequestLowStreamParameter,(e=>{e(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})}))}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(e){if("CONNECTED"!==this.connectionState||!this._joinInfo)throw new eD(ZN.INVALID_OPERATION,"[".concat(this._clientId,"] Client did not join channel"));if(this._inspect)throw new eD(ZN.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));if(!e)throw new eD(ZN.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig is necessary"));if(!e.inspectType||!Array.isArray(e.inspectType))throw new eD(ZN.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const t=[...new Set(e.inspectType)];t.forEach((e=>{if(!["supervise","moderation"].includes(e))throw new eD(ZN.INVALID_PARAMS,"[".concat(this._clientId,"] ").concat(e," is not a valid inspect type."))})),e.inspectType=t}if(e&&e.extraInfo&&e.extraInfo.length>1024)throw new eD(ZN.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const t=new U0(e);this._inspect=t,this.handleVideoInspectEvents(this._inspect),await t.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},tD)}catch(e){throw Array.isArray(e)?e[0]:e}}async disableContentInspect(){if(!this._inspect)throw new eD(ZN.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}handleVideoInspectEvents(e){e.on(Fk.CONNECTION_STATE_CHANGE,((t,n)=>{if(this.emit(wP.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,t,n),n===Uk.CONNECTED){if("CONNECTED"!==this.connectionState)return void this.emit(wP.CONTENT_INSPECT_ERROR,new eD(ZN.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}})),e.on(Fk.INSPECT_RESULT,((e,t)=>{var n;if((null==t?void 0:t.code)===ZN.INVALID_OPERATION&&"DISCONNECTED"===this.connectionState)return uD.debug("Stop inspect content because that has left channel"),null==this||null===(n=this._inspect)||void 0===n||n.close(),void(this._inspect=void 0);this.emit(wP.CONTENT_INSPECT_RESULT,e,t)})),e.on(Fk.CLIENT_LOCAL_VIDEO_TRACK,(e=>{e(this.localTracks.filter((e=>"video"===e.trackMediaType))[0])}))}getJoinChannelServiceRecords(){return uD.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(e){qL(e,"enabled"),KD("ENABLE_PUBLISH_AUDIO_FILTER",e),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(e)}_handleResetAddStream(e,t){switch(t){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}}).prototype,"setProxyServer",[F0],Object.getOwnPropertyDescriptor(q0.prototype,"setProxyServer"),q0.prototype),YV(q0.prototype,"setTurnServer",[V0],Object.getOwnPropertyDescriptor(q0.prototype,"setTurnServer"),q0.prototype),YV(q0.prototype,"setLicense",[G0],Object.getOwnPropertyDescriptor(q0.prototype,"setLicense"),q0.prototype),YV(q0.prototype,"setLocalAccessPoints",[Q0],Object.getOwnPropertyDescriptor(q0.prototype,"setLocalAccessPoints"),q0.prototype),YV(q0.prototype,"setRemoteDefaultVideoStreamType",[j0],Object.getOwnPropertyDescriptor(q0.prototype,"setRemoteDefaultVideoStreamType"),q0.prototype),YV(q0.prototype,"pickSVCLayer",[H0],Object.getOwnPropertyDescriptor(q0.prototype,"pickSVCLayer"),q0.prototype),YV(q0.prototype,"enableContentInspect",[W0],Object.getOwnPropertyDescriptor(q0.prototype,"enableContentInspect"),q0.prototype),YV(q0.prototype,"disableContentInspect",[Y0],Object.getOwnPropertyDescriptor(q0.prototype,"disableContentInspect"),q0.prototype),YV(q0.prototype,"getJoinChannelServiceRecords",[K0],Object.getOwnPropertyDescriptor(q0.prototype,"getJoinChannelServiceRecords"),q0.prototype),YV(q0.prototype,"setPublishAudioFilterEnabled",[$0],Object.getOwnPropertyDescriptor(q0.prototype,"setPublishAudioFilterEnabled"),q0.prototype),z0=q0))||z0);class e1 extends QG{set currentState(e){e!==this._currentState&&(this._currentState=e,this.emit(UP.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),iw(this,"audioBuffer",void 0),iw(this,"sourceNode",void 0),iw(this,"startPlayTime",0),iw(this,"startPlayOffset",0),iw(this,"pausePlayTime",0),iw(this,"options",void 0),iw(this,"currentLoopCount",0),iw(this,"_currentState","stopped"),this.audioBuffer=e,this.options=t,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer.duration}get currentTime(){return"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:(this.context.currentTime-this.startPlayTime+this.startPlayOffset)%this.audioBuffer.duration}updateOptions(e){"stopped"===this.currentState?(this.options=e,this.startPlayOffset=this.options.startPlayTime||0):uD.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(e){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=e,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=e))}resumeProcessAudioBuffer(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch(e){}this.reset()}}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const e=this.context.createBufferSource();return e.buffer=this.audioBuffer,e.loop=!!this.options.loop,e.connect(this.outputNode),e}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const t1=new Map;function n1(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r1(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?n1(Object(n),!0).forEach((function(t){iw(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):n1(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i1(e,t,n,r){n.optimizationMode&&(r&&r.width&&r.height?(n.encoderConfig=r1(r1({},r),{},{bitrateMin:r.bitrateMin,bitrateMax:r.bitrateMax}),"motion"!==n.optimizationMode&&"detail"!==n.optimizationMode||(t.contentHint=n.optimizationMode,t.contentHint===n.optimizationMode?(uD.debug("[".concat(e,"] set content hint to"),n.optimizationMode),LD("debug",["AgoraRTC"],"videoTrackOptimizationModeProcess",[e,n,r])):(uD.debug("[".concat(e,"] set content hint failed")),LD("warning",["AgoraRTC"],"videoTrackOptimizationModeProcess",[e,n,r],"failed")))):(uD.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")),CD("warning",["AgoraRTC"],"[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig"))))}const o1=wb().name;function s1(e,t,n,r){let i,o=0,s=null;return new xv(((a,c)=>{setTimeout((()=>{i&&(i(),a(o))}),t),i=BG((()=>{!function(){o>r&&i&&(i(),a(o));const t=n.getContext("2d");if(!t){const e=new eD(ZN.UNEXPECTED_ERROR,"can not get canvas 2d context.");return uD.error(e.toString()),void c(e)}t.drawImage(e,0,0,160,120);const u=t.getImageData(0,0,n.width,n.height),l=Math.floor(u.data.length/3);if(s){for(let e=0;e<l;e+=3)if(u.data[e]!==s[e])return o+=1,void(s=u.data);s=u.data}else s=u.data}()}),30)}))}class a1{constructor(e,t){iw(this,"id",0),iw(this,"element",void 0),iw(this,"peerPair",void 0),iw(this,"context",void 0),iw(this,"audioPlayerElement",void 0),iw(this,"audioTrack",void 0),a1.count+=1,this.id=a1.count,this.element=e,this.context=t}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=e=>{const t=document.createElement("audio");t.srcObject=new MediaStream([e.track]),t.play(),this.audioPlayerElement=t}}async switchSdp(){if(!this.peerPair)return;const e=async(e,t)=>{const n="offer"===t?await e.createOffer():await e.createAnswer();return await e.setLocalDescription(n),"complete"===e.iceGatheringState?e.localDescription:new xv((t=>{e.onicegatheringstatechange=()=>{"complete"===e.iceGatheringState&&t(e.localDescription)}}))},t=async(e,t)=>await e.setRemoteDescription(t);try{const n=await e(this.peerPair[0],"offer");await t(this.peerPair[1],n);const r=await e(this.peerPair[1],"answer");await t(this.peerPair[0],r)}catch(e){throw new eD(ZN.LOCAL_AEC_ERROR,e.toString()).print()}}async getTracksFromMediaElement(e){if(this.audioTrack)return this.audioTrack;let t;try{e instanceof HTMLVideoElement&&(e.captureStream?e.captureStream():e.mozCaptureStream()),t=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(e).connect(t)}catch(e){throw new eD(ZN.LOCAL_AEC_ERROR,e.toString()).print()}if(!t)throw new eD(ZN.LOCAL_AEC_ERROR,"no dest node when local aec").print();const n=t.stream.getAudioTracks()[0];return this.audioTrack=n,n}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const e=this.element,t=await this.getTracksFromMediaElement(e);this.peerPair&&this.peerPair[0].addTrack(t),await this.switchSdp()}close(){uD.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach((e=>{e.close()})),this.peerPair=void 0,this.audioPlayerElement=void 0}}var c1,u1;iw(a1,"count",0);const l1=window.AudioContext||window.webkitAudioContext,d1=new(c1=gG({report:mG}),YV((u1=class{constructor(){iw(this,"units",[]),iw(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return uD.debug("the system does not need to process local aec"),-1;this.context||(this.context=new l1);let t=this.units.find((t=>t&&t.getElement()===e));return t||(t=new a1(e,this.context),this.units.push(t)),t.startEchoCancellation(),uD.debug("start processing local audio echo cancellation, id is",t.id),t.id}_doesEnvironmentNeedAEC(){return wb().name!==Sb.SAFARI}}).prototype,"processExternalMediaAEC",[c1],Object.getOwnPropertyDescriptor(u1.prototype,"processExternalMediaAEC"),u1.prototype),u1);KD("PROCESS_ID","process-".concat(Sj(8,""),"-").concat(Sj(4,""),"-").concat(Sj(4,""),"-").concat(Sj(4,""),"-").concat(Sj(12,""))),function(){const e=wb();Vk.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),Vk.getStreamFromExtension=e.name===Sb.CHROME&&Number(e.version)>34,Vk.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver)return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const e=new RTCPeerConnection;let t=!1;try{e.addTransceiver("audio"),t=!0}catch(e){}return e.close(),t}(),Vk.supportMinBitrate=e.name===Sb.CHROME||e.name===Sb.EDGE,Vk.supportSetRtpSenderParameters=function(){const e=wb();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!$b()||!(!Mb()&&!kb())||e.name===Sb.FIREFOX&&Number(e.version)>=64)}(),e.name===Sb.SAFARI&&(Number(e.version)>=14?Vk.supportDualStream=!0:Vk.supportDualStream=!1),Vk.webAudioMediaStreamDest=function(){const e=wb();return!(e.name===Sb.SAFARI&&Number(e.version)<12)}(),Vk.supportReplaceTrack=!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack,Vk.supportWebGL="undefined"!=typeof WebGLRenderingContext,Vk.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,$b()||(Vk.webAudioWithAEC=!0),Vk.supportShareAudio=function(){const e=wb();return(e.os===yb.WIN_10||e.os===yb.WIN_81||e.os===yb.WIN_7||e.os===yb.LINUX||e.os===yb.MAC_OS)&&e.name===Sb.CHROME&&Number(e.version)>=74}(),Vk.supportDualStreamEncoding=function(){const e=wb();return"Safari"===e.name&&Number(e.version)>=14||!!("Chrome"===e.name&&/Windows/i.test(e.os||"")&&Number(e.version)>=100&&$D("CHROME_DUAL_STREAM_USE_ENCODING"))}(),uD.info("browser compatibility",JSON.stringify(Vk),JSON.stringify(e)),ND("info",[],"updateAgoraRTCCompatibility",{browserCompatibility:Vk,browserInfo:e})}(),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(e){return void uD.error("Error loading sdk config",e.message)}if(e)try{const t=JSON.parse(window.atob(e)),n=Date.now();uD.debug("Loading global parameters from cache",t),ND("debug",[],"loadConfigFromLocalStorage",t),Object.keys(t).forEach((e=>{if(Object.prototype.hasOwnProperty.call(zD,e)){const{value:r,expires:i}=t[e];if(i&&i<=n)return;qD[e]=r,zD[e]=r}}))}catch(t){uD.error("Error loading mutableParamsCache: ".concat(e),t.message)}}();const h1={__CLIENT_LIST__:nL,__TRACK_LIST__:rL,VERSION:MD,BUILD:xD,setParameter:KD,getParameter:$D,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let t=new RTCPeerConnection;t.addTransceiver("video",{direction:"recvonly"}),t.addTransceiver("audio",{direction:"recvonly"});const n=(await t.createOffer()).sdp;if(!n)return e;t.close(),t=null,e=function(e){const t={video:[],audio:[]};return e.match(/ VP8/i)&&t.video.push("VP8"),e.match(/ VP9/i)&&t.video.push("VP9"),e.match(/ AV1/i)&&t.video.push("AV1"),e.match(/ H264/i)&&t.video.push("H264"),e.match(/ opus/i)&&t.audio.push("OPUS"),e.match(/ PCMU/i)&&t.audio.push("PCMU"),e.match(/ PCMA/i)&&t.audio.push("PCMA"),e.match(/ G722/i)&&t.audio.push("G722"),t}(n)}catch(e){throw new eD(ZN.CREATE_OFFER_FAILED,e.toString&&e.toString()).print()}return e},checkSystemRequirements:function(){const e=mG.reportApiInvoke(null,{name:_P.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:mP.TRACER});let t=!1;try{const e=window.RTCPeerConnection,n=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,r=window.WebSocket;t=!!(e&&n&&r)}catch(e){return uD.error("check system requirement failed: ",e),!1}let n=!1;const r=wb();r.name===Sb.CHROME&&Number(r.version)>=58&&(!("WebKit"===bb.engine.name)||function(){const e=wb();if(kb()){if(e.os===yb.MAC_OS)return!0;if(e.os===yb.IOS){const e=bb.os.version&&bb.os.version.split(".");if(e&&14===Number(e[0])&&e[1]&&Number(e[1])>=3)return!0;if(e&&Number(e[0])>14)return!0}}return!1}())&&(n=!0),r.name===Sb.FIREFOX&&Number(r.version)>=56&&(n=!0),r.name===Sb.OPERA&&Number(r.version)>=45&&(n=!0),r.name===Sb.SAFARI&&Number(r.version)>=11&&(n=!0),(Yb()||wb().name===Sb.QQ)&&(n=!0),uD.debug("checkSystemRequirements, api:",t,"browser",n);const i=t&&n;return e.onSuccess(i),i},getDevices:function(e){return tQ.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return tQ.getRecordingDevices(e)},getCameras:function(e){return tQ.getCamerasDevices(e)},getElectronScreenSources:WG,getPlaybackDevices:function(e){return tQ.getSpeakers(e)},createClient:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const t=mG.reportApiInvoke(null,{name:_P.CREATE_CLIENT,options:[e],tag:mP.TRACER});try{FP(e)}catch(e){throw t.onError(e),e}return void 0===e.audioCodec&&(e.audioCodec="opus"),t.onSuccess(),new Z0(X0(X0({forceWaitGatewayResponse:!0},e),{},{role:"rtc"===e.mode?"host":e.role}))},createCameraVideoTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{encoderConfig:"480p_1"};const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CREATE_CAM_VIDEO_TRACK,options:[r1({},e)]}),n=mz(e),r=Sj(8,"track-cam-");let i=null;uD.info("start create camera video track with config",JSON.stringify(e),"trackId",r),LD("info",["AgoraRTC"],"createCameraVideoTrack",e);try{i=(await JG({video:n},r)).getVideoTracks()[0]||null}catch(e){throw t.onError(e),e}if(!i){const e=new eD(ZN.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(e),e.throw()}e.optimizationMode&&i1(r,i,e,e.encoderConfig&&QD(e.encoderConfig));const o=new eq(i,e,n,e.scalabiltyMode?HD(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,r);return t.onSuccess(o.getTrackId()),uD.info("create camera video success, trackId:",r),LD("info",["AgoraRTC"],"createCameraVideoTrack",void 0,r),o},createCustomVideoTrack:function(e){const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),n=new Zz(e.mediaStreamTrack,{bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?HD(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode);return t.onSuccess(n.getTrackId()),uD.info("create custom video track success with config",e,"trackId",n.getTrackId()),LD("info",["AgoraRTC"],"createCustomVideoTrack",e,n.getTrackId()),n},createScreenVideoTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"disable";const n=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CREATE_SCREEN_VIDEO_TRACK,options:[r1({},e),t]});e.encoderConfig?"string"==typeof e.encoderConfig||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const r=Iz(e),i=Sj(8,"track-scr");let o=null,s=null;const a=Gk();if(!a.supportShareAudio&&"enable"===t){const e=new eD(ZN.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return n.onError(e),e.throw()}uD.info("start create screen video track with config",e,"withAudio",t,"trackId",i),LD("info",["AgoraRTC"],"createScreenVideoTrack",[e,t]);try{const e=await JG({screen:r,screenAudio:"auto"===t?a.supportShareAudio:"enable"===t},i);o=e.getVideoTracks()[0]||null,s=e.getAudioTracks()[0]||null}catch(e){throw n.onError(e),e}if(!o){const e=new eD(ZN.UNEXPECTED_ERROR,"can not find track in media stream");return n.onError(e),e.throw()}if(!s&&"enable"===t){o&&o.stop();const e=new eD(ZN.SHARE_AUDIO_NOT_ALLOWED);return n.onError(e),e.throw()}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(i1(i,o,e,e.encoderConfig&&jD(e.encoderConfig)),e.encoderConfig&&"string"!=typeof e.encoderConfig&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const c=new Zz(o,e.encoderConfig?jD(e.encoderConfig):{},e.scalabiltyMode?HD(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,i,[fk.SCREEN_TRACK]);if(!s)return n.onSuccess(c.getTrackId()),uD.info("create screen video track success","video:",c.getTrackId()),LD("info",["AgoraRTC"],"createScreenVideoTrack",void 0,{videoTrack:c.getTrackId()}),c;const u=new JQ(s);return n.onSuccess([c.getTrackId(),u.getTrackId()]),uD.info("create screen video track success","video:",c.getTrackId(),"audio:",u.getTrackId()),LD("info",["AgoraRTC"],"createScreenVideoTrack",void 0,{videoTrack:c.getTrackId(),audioTrack:u.getTrackId()}),[c,u]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{encoderConfig:"480p_1"};const n=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CREATE_MIC_AND_CAM_TRACKS,options:[e,t]}),r=mz(t),i=Tz(e),o=Sj(8,"track-mic-"),s=Sj(8,"track-cam-");let a=null,c=null;uD.info("start create camera video track(".concat(s,") and microphone audio track(").concat(o,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(t))),LD("info",["AgoraRTC"],"createMicrophoneAndCameraTracks",{videoConfig:t,audioConfig:e});try{const e=await JG({audio:i,video:r},"".concat(o,"-").concat(s));a=e.getAudioTracks()[0],c=e.getVideoTracks()[0]}catch(e){throw n.onError(e),e}if(!a||!c){const e=new eD(ZN.UNEXPECTED_ERROR,"can not find tracks in media stream");return n.onError(e),e.throw()}t.optimizationMode&&i1(s,c,t,t.encoderConfig&&QD(t.encoderConfig));const u=new XQ(a,e,i,o),l=new eq(c,t,r,t.scalabiltyMode?HD(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,s);return n.onSuccess([u.getTrackId(),l.getTrackId()]),uD.info("create camera video track(".concat(s,") and microphone audio track(").concat(o,") success")),LD("info",["AgoraRTC"],"createMicrophoneAndCameraTracks",void 0,{videoTrackId:s,audioTrackId:o}),[u,l]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CREATE_MIC_AUDIO_TRACK,options:[e]}),n=Tz(e),r=Sj(8,"track-mic-");let i=null;uD.info("start create microphone audio track with config",JSON.stringify(e),"trackId",r),LD("info",["AgoraRTC"],"createMicrophoneAudioTrack",e);try{i=(await JG({audio:n},r)).getAudioTracks()[0]||null}catch(e){throw t.onError(e),e}if(!i){const e=new eD(ZN.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(e),e.throw()}const o=new XQ(i,e,n,r);return t.onSuccess(o.getTrackId()),uD.info("create microphone audio track success, trackId:",r),LD("info",["AgoraRTC"],"createMicrophoneAudioTrack",e,r),o},createCustomAudioTrack:function(e){const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),n=new JQ(e.mediaStreamTrack,e.encoderConfig?YD(e.encoderConfig):{});return uD.info("create custom audio track success with config",e,"trackId",n.getTrackId()),LD("info",["AgoraRTC"],"createCustomAudioTrack",e,n.getTrackId()),t.onSuccess(n.getTrackId()),n},createBufferSourceAudioTrack:async function(e){const t=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CREATE_BUFFER_AUDIO_TRACK,options:[e]}),n=Sj(8,"track-buf-");uD.info("start create buffer source audio track with config",JSON.stringify(e),"trackId",n),LD("info",[],"createBufferSourceAudioTrack",e);const r=e.source;if(!(e.source instanceof AudioBuffer))try{e.source=await async function(e,t){let n=null;if("string"==typeof e){const t=t1.get(e);if(t)return uD.debug("use cached audio resource: ",e),t;try{n=(await rD((()=>zN.get(e,{responseType:"arraybuffer"})),void 0,void 0,{maxRetryCount:3})).data}catch(e){throw new eD(ZN.FETCH_AUDIO_FILE_FAILED,e.toString())}}else{const t=new xv(((t,n)=>{const r=new FileReader;r.onload=e=>{e.target?t(e.target.result):n(new eD(ZN.READ_LOCAL_AUDIO_FILE_ERROR))},r.onerror=()=>{n(new eD(ZN.READ_LOCAL_AUDIO_FILE_ERROR))},r.readAsArrayBuffer(e)}));n=await t}const r=await function(e){const t=xG();return new xv(((n,r)=>{t.decodeAudioData(e,(e=>{n(e)}),(e=>{r(new eD(ZN.DECODE_AUDIO_FILE_FAILED,e.toString()))}))}))}(n);return"string"==typeof e&&t&&t1.set(e,r),r}(e.source,e.cacheOnlineFile)}catch(e){return t.onError(e),e.throw()}const i=new e1(e.source),o=new ZQ(r,i,e.encoderConfig?YD(e.encoderConfig):{},n);return uD.info("create buffer source audio track success, trackId:",n),LD("info",["AgoraRTC"],"createBufferSourceAudioTrack",void 0,n),t.onSuccess(o.getTrackId()),o},setAppType:function(e){if(uD.debug("setAppType: ".concat(e)),!(Number.isInteger(e)&&e>=0))throw uD.debug("Invalid appType"),new eD(ZN.INVALID_PARAMS,"invalid app type",e);KD("APP_TYPE",Math.floor(e))},setLogLevel:function(e){$D("USE_NEW_LOG")?function(e){e=Math.min(Math.max(0,e),4),ED=e}(e):uD.setLogLevel(e)},enableLogUpload:function(){$D("USE_NEW_LOG")?KD("UPLOAD_LOG",!0):uD.enableLogUpload()},disableLogUpload:function(){$D("USE_NEW_LOG")?KD("UPLOAD_LOG",!1):uD.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new G$},checkAudioTrackIsActive:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof JQ||e instanceof kZ)){const e=new eD(ZN.INVALID_TRACK,"the parameter is not a audio track");return n.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const r=e instanceof JQ?e.getTrackLabel():"remote_track",i=e.getVolumeLevel();let o=i,s=i;const a=Date.now();return new xv((i=>{const c=setInterval((()=>{const u=e.getVolumeLevel();o=u>o?u:o,s=u<s?u:s;const l=o-s>1e-4,d=Date.now()-a;if(l||d>t){clearInterval(c);const t=l,s={duration:d,deviceLabel:r,maxVolumeLevel:o,result:t};uD.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(s))),n.onSuccess(s),i(t)}}),200)}))},checkVideoTrackIsActive:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const n=mG.reportApiInvoke(null,{tag:mP.TRACER,name:_P.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof Zz||e instanceof PZ)){const e=new eD(ZN.INVALID_TRACK,"the parameter is not a video track");return n.onError(e),e.throw()}const r=4;t&&t<1e3&&(t=1e3);const i=e instanceof Zz?e.getTrackLabel():"remote_track",o=e.getMediaStreamTrack(!0),s=document.createElement("video");s.style.width="1px",s.style.height="1px",s.setAttribute("muted",""),s.muted=!0,s.setAttribute("playsinline",""),s.controls=!1,(Mb()||kb())&&(s.style.opacity="0.01",s.style.position="fixed",s.style.left="0",s.style.top="0",document.body.appendChild(s)),s.srcObject=new MediaStream([o]),s.play();const a=document.createElement("canvas");a.width=160,a.height=120;let c=0,u=0;try{const e=Date.now();c=await s1(s,t,a,r),u=Date.now()-e}catch(e){throw n.onError(e),e}o1===Sb.SAFARI&&(s.pause(),s.remove()),s.srcObject=null;const l=c>r,d={duration:u,changedPicNum:c,deviceLabel:i,result:l};return uD.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(d))),n.onSuccess(d),l},setArea:function(e){const t=mG.reportApiInvoke(null,{name:_P.SET_AREA,options:e,tag:mP.TRACER});try{let t=[];if("string"==typeof e&&(t=[e]),Array.isArray(e)&&(e.forEach((e=>{if(!Rk.includes(e))throw new eD(ZN.INVALID_PARAMS,"invalid area code")})),t=e),"[object Object]"===Object.prototype.toString.call(e)){const{areaCode:n,excludedArea:r}=e;if(!n)throw new eD(ZN.INVALID_PARAMS,"area code is needed");let i=n;"string"==typeof n&&(i=[n]),t=r?function(e,t){let n=[];if(e.includes(mk.GLOBAL)){const o=[mk.GLOBAL,mk.OVERSEA],s=Object.keys(yk);if(t===mk.GLOBAL)throw new eD(ZN.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===mk.CHINA)n=[mk.OVERSEA];else if(i=t,R$.includes(i)){const e=(r=t,T$[mk.GLOBAL][r]||[]),i=[...o,t,...e];n=s.filter((e=>!i.includes(e)))}else if(function(e){let t=!1;return R$.forEach((n=>{T$[mk.GLOBAL][n].includes(e)&&(t=!0)})),t}(t)){const e=function(e){let t;return R$.forEach((n=>{T$[mk.GLOBAL][n].includes(e)&&(t=n)})),t}(t),r=[...o,e,t];n=s.filter((e=>!r.includes(e)))}else n=e;n=function(e){const t=[];return v$.forEach((n=>{e.includes(n)&&t.push(n)})),t.concat(e.filter((e=>!v$.includes(e))))}(n)}else n=e;var r,i;return n}(i,r):i}KD("AREAS",t);const n=(e=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return e.map((e=>{const n=yk[e],r=Object.keys(n);r&&r.map((e=>{"CODE"!==e&&(t[e]=t[e].concat(n[e]))}))})),t})(t);Object.keys(n).map((e=>{KD(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?n[e][0]:n[e])})),uD.debug("set area success:",t.join(","))}catch(e){throw t.onError(e),e}t.onSuccess()},loadModule:async function(e,t){if(uD.debug("loadModule: ".concat(e.name,", loadOption: ").concat(JSON.stringify(t))),!e.moduleInit)throw uD.debug("Invalid Plugin"),new eD(ZN.INVALID_PLUGIN,"invalid plugin");try{wG.installPlugin(e),await e.moduleInit({logger:uD,report:mG,pluginCenter:wG,getParameter:$D},t)}catch(e){throw new eD(ZN.UNEXPECTED_ERROR,"unexpected error in loadModule",e)}},audioElementPlayCenter:oQ,processExternalMediaAEC:function(e){d1.processExternalMediaAEC(e)},registerExtensions:function(e){e.forEach((e=>{const t=e;t.__registered__=!0,t.logger.hookLog=uD.extLog,t.reporter.hookApiInvoke=mG.extApiInvoke,t.parameters&&Object.keys(t.parameters).forEach((e=>{t.parameters[e]=$D(e)}))}))},ChannelMediaRelayError:uk,ChannelMediaRelayEvent:ak,ChannelMediaRelayState:ck,RemoteStreamFallbackType:Ek,RemoteStreamType:Ak,ConnectionDisconnectedReason:bP,AudienceLatencyLevelType:OP,AREAS:mk};return Object.defineProperties(h1,{onAudioAutoplayFailed:{get:()=>uG.onAudioAutoplayFailed,set:e=>{uG.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>uG.onAutoplayFailed,set:e=>{uG.onAutoplayFailed=e}}}),tQ.on(TP.CAMERA_DEVICE_CHANGED,(e=>{uD.info("camera device changed",JSON.stringify(e)),h1.onCameraChanged&&h1.onCameraChanged(e)})),tQ.on(TP.RECORDING_DEVICE_CHANGED,(e=>{uD.info("microphone device changed",JSON.stringify(e)),h1.onMicrophoneChanged&&h1.onMicrophoneChanged(e)})),tQ.on(TP.PLAYOUT_DEVICE_CHANGED,(e=>{uD.debug("playout device changed",JSON.stringify(e)),h1.onPlaybackDeviceChanged&&h1.onPlaybackDeviceChanged(e)})),oQ.onAutoplayFailed=()=>{uD.info("detect audio element autoplay failed"),uG.onAudioAutoplayFailed&&uG.onAudioAutoplayFailed()},kG.on("autoplay-failed",(()=>{uD.info("detect webaudio autoplay failed"),uG.onAudioAutoplayFailed&&uG.onAudioAutoplayFailed()})),window&&(window.__ARTC__=h1),h1}()},674:e=>{var t;self,t=()=>(()=>{var e={991:e=>{self,e.exports=(()=>{var e={3476:(e,t,n)=>{e.exports=n(7460)},4341:(e,t,n)=>{e.exports=n(3685)},3536:(e,t,n)=>{var r=n(1910);e.exports=r},8171:(e,t,n)=>{n(6450);var r=n(4058).Object,i=e.exports=function(e,t,n){return r.defineProperty(e,t,n)};r.defineProperty.sham&&(i.sham=!0)},2956:(e,t,n)=>{n(7627),n(6274),n(5967),n(8881),n(4560),n(7206),n(4349),n(7971);var r=n(4058);e.exports=r.Promise},3685:(e,t,n)=>{var r=n(3536);e.exports=r},4883:(e,t,n)=>{var r=n(1899),i=n(7475),o=n(9826),s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not a function")}},174:(e,t,n)=>{var r=n(1899),i=n(4284),o=n(9826),s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not a constructor")}},1851:(e,t,n)=>{var r=n(1899),i=n(7475),o=r.String,s=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw s("Can't set "+o(e)+" as a prototype")}},8479:e=>{e.exports=function(){}},5743:(e,t,n)=>{var r=n(1899),i=n(7046),o=r.TypeError;e.exports=function(e,t){if(i(t,e))return e;throw o("Incorrect invocation")}},6059:(e,t,n)=>{var r=n(1899),i=n(941),o=r.String,s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not an object")}},1692:(e,t,n)=>{var r=n(4529),i=n(9413),o=n(623),s=function(e){return function(t,n,s){var a,c=r(t),u=o(c),l=i(s,u);if(e&&n!=n){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},3765:(e,t,n)=>{var r=n(5329);e.exports=r([].slice)},1385:(e,t,n)=>{var r=n(9813)("iterator"),i=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){i=!0}};s[r]=function(){return this},Array.from(s,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},2532:(e,t,n)=>{var r=n(5329),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},9697:(e,t,n)=>{var r=n(1899),i=n(2885),o=n(7475),s=n(2532),a=n(9813)("toStringTag"),c=r.Object,u="Arguments"==s(function(){return arguments}());e.exports=i?s:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=c(e),a))?n:u?s(t):"Object"==(r=s(t))&&o(t.callee)?"Arguments":r}},8694:(e,t,n)=>{var r=n(5329)("".replace),i=String(Error("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,s=o.test(i);e.exports=function(e,t){if(s&&"string"==typeof e)for(;t--;)e=r(e,o,"");return e}},3489:(e,t,n)=>{var r=n(953),i=n(1136),o=n(9677),s=n(5988);e.exports=function(e,t,n){for(var a=i(t),c=s.f,u=o.f,l=0;l<a.length;l++){var d=a[l];r(e,d)||n&&r(n,d)||c(e,d,u(t,d))}}},4160:(e,t,n)=>{var r=n(5981);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},1046:(e,t,n)=>{"use strict";var r=n(5143).IteratorPrototype,i=n(9290),o=n(1887),s=n(904),a=n(2077),c=function(){return this};e.exports=function(e,t,n,u){var l=t+" Iterator";return e.prototype=i(r,{next:o(+!u,n)}),s(e,l,!1,!0),a[l]=c,e}},2029:(e,t,n)=>{var r=n(5746),i=n(5988),o=n(1887);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},1887:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},7771:(e,t,n)=>{"use strict";var r=n(6887),i=n(8834),o=n(2529),s=n(9417),a=n(7475),c=n(1046),u=n(249),l=n(8929),d=n(904),h=n(2029),p=n(9754),f=n(9813),A=n(2077),E=n(5143),g=s.PROPER,_=s.CONFIGURABLE,m=E.IteratorPrototype,I=E.BUGGY_SAFARI_ITERATORS,T=f("iterator"),R="keys",v="values",y="entries",S=function(){return this};e.exports=function(e,t,n,s,f,E,C){c(n,t,s);var O,b,w,N=function(e){if(e===f&&x)return x;if(!I&&e in P)return P[e];switch(e){case R:case v:case y:return function(){return new n(this,e)}}return function(){return new n(this)}},D=t+" Iterator",L=!1,P=e.prototype,k=P[T]||P["@@iterator"]||f&&P[f],x=!I&&k||N(f),M="Array"==t&&P.entries||k;if(M&&(O=u(M.call(new e)))!==Object.prototype&&O.next&&(o||u(O)===m||(l?l(O,m):a(O[T])||p(O,T,S)),d(O,D,!0,!0),o&&(A[D]=S)),g&&f==v&&k&&k.name!==v&&(!o&&_?h(P,"name",v):(L=!0,x=function(){return i(k,this)})),f)if(b={values:N(v),keys:E?x:N(R),entries:N(y)},C)for(w in b)(I||L||!(w in P))&&p(P,w,b[w]);else r({target:t,proto:!0,forced:I||L},b);return o&&!C||P[T]===x||p(P,T,x,{name:f}),A[t]=x,b}},5746:(e,t,n)=>{var r=n(5981);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},1333:(e,t,n)=>{var r=n(1899),i=n(941),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},3281:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3321:e=>{e.exports="object"==typeof window},4470:(e,t,n)=>{var r=n(2861),i=n(1899);e.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==i.Pebble},2749:(e,t,n)=>{var r=n(2861);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},6049:(e,t,n)=>{var r=n(2532),i=n(1899);e.exports="process"==r(i.process)},8045:(e,t,n)=>{var r=n(2861);e.exports=/web0s(?!.*chrome)/i.test(r)},2861:(e,t,n)=>{var r=n(626);e.exports=r("navigator","userAgent")||""},3385:(e,t,n)=>{var r,i,o=n(1899),s=n(2861),a=o.process,c=o.Deno,u=a&&a.versions||c&&c.version,l=u&&u.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},6759:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8780:(e,t,n)=>{var r=n(5981),i=n(1887);e.exports=!r((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))},6887:(e,t,n)=>{"use strict";var r=n(1899),i=n(9730),o=n(5329),s=n(7475),a=n(9677).f,c=n(7252),u=n(4058),l=n(6843),d=n(2029),h=n(953),p=function(e){var t=function(n,r,o){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(n);case 2:return new e(n,r)}return new e(n,r,o)}return i(e,this,arguments)};return t.prototype=e.prototype,t};e.exports=function(e,t){var n,i,f,A,E,g,_,m,I=e.target,T=e.global,R=e.stat,v=e.proto,y=T?r:R?r[I]:(r[I]||{}).prototype,S=T?u:u[I]||d(u,I,{})[I],C=S.prototype;for(f in t)n=!c(T?f:I+(R?".":"#")+f,e.forced)&&y&&h(y,f),E=S[f],n&&(g=e.noTargetGet?(m=a(y,f))&&m.value:y[f]),A=n&&g?g:t[f],n&&typeof E==typeof A||(_=e.bind&&n?l(A,r):e.wrap&&n?p(A):v&&s(A)?o(A):A,(e.sham||A&&A.sham||E&&E.sham)&&d(_,"sham",!0),d(S,f,_),v&&(h(u,i=I+"Prototype")||d(u,i,{}),d(u[i],f,A),e.real&&C&&!C[f]&&d(C,f,A)))}},5981:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},9730:(e,t,n)=>{var r=n(8285),i=Function.prototype,o=i.apply,s=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},6843:(e,t,n)=>{var r=n(5329),i=n(4883),o=n(8285),s=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?s(e,t):function(){return e.apply(t,arguments)}}},8285:(e,t,n)=>{var r=n(5981);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},8834:(e,t,n)=>{var r=n(8285),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},9417:(e,t,n)=>{var r=n(5746),i=n(953),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),c=a&&"something"===function(){}.name,u=a&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:u}},5329:(e,t,n)=>{var r=n(8285),i=Function.prototype,o=i.bind,s=i.call,a=r&&o.bind(s,s);e.exports=r?function(e){return e&&a(e)}:function(e){return e&&function(){return s.apply(e,arguments)}}},626:(e,t,n)=>{var r=n(4058),i=n(1899),o=n(7475),s=function(e){return o(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?s(r[e])||s(i[e]):r[e]&&r[e][t]||i[e]&&i[e][t]}},2902:(e,t,n)=>{var r=n(9697),i=n(4229),o=n(2077),s=n(9813)("iterator");e.exports=function(e){if(null!=e)return i(e,s)||i(e,"@@iterator")||o[r(e)]}},429:(e,t,n)=>{var r=n(1899),i=n(8834),o=n(4883),s=n(6059),a=n(9826),c=n(2902),u=r.TypeError;e.exports=function(e,t){var n=arguments.length<2?c(e):t;if(o(n))return s(i(n,e));throw u(a(e)+" is not iterable")}},4229:(e,t,n)=>{var r=n(4883);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},1899:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},953:(e,t,n)=>{var r=n(5329),i=n(9678),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},7748:e=>{e.exports={}},4845:(e,t,n)=>{var r=n(1899);e.exports=function(e,t){var n=r.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},5463:(e,t,n)=>{var r=n(626);e.exports=r("document","documentElement")},2840:(e,t,n)=>{var r=n(5746),i=n(5981),o=n(1333);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},7026:(e,t,n)=>{var r=n(1899),i=n(5329),o=n(5981),s=n(2532),a=r.Object,c=i("".split);e.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?c(e,""):a(e)}:a},1302:(e,t,n)=>{var r=n(5329),i=n(7475),o=n(3030),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},3794:(e,t,n)=>{var r=n(941),i=n(2029);e.exports=function(e,t){r(t)&&"cause"in t&&i(e,"cause",t.cause)}},5402:(e,t,n)=>{var r,i,o,s=n(8019),a=n(1899),c=n(5329),u=n(941),l=n(2029),d=n(953),h=n(3030),p=n(4262),f=n(7748),A="Object already initialized",E=a.TypeError,g=a.WeakMap;if(s||h.state){var _=h.state||(h.state=new g),m=c(_.get),I=c(_.has),T=c(_.set);r=function(e,t){if(I(_,e))throw new E(A);return t.facade=e,T(_,e,t),t},i=function(e){return m(_,e)||{}},o=function(e){return I(_,e)}}else{var R=p("state");f[R]=!0,r=function(e,t){if(d(e,R))throw new E(A);return t.facade=e,l(e,R,t),t},i=function(e){return d(e,R)?e[R]:{}},o=function(e){return d(e,R)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!u(t)||(n=i(t)).type!==e)throw E("Incompatible receiver, "+e+" required");return n}}}},6782:(e,t,n)=>{var r=n(9813),i=n(2077),o=r("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||s[o]===e)}},7475:e=>{e.exports=function(e){return"function"==typeof e}},4284:(e,t,n)=>{var r=n(5329),i=n(5981),o=n(7475),s=n(9697),a=n(626),c=n(1302),u=function(){},l=[],d=a("Reflect","construct"),h=/^\s*(?:class|function)\b/,p=r(h.exec),f=!h.exec(u),A=function(e){if(!o(e))return!1;try{return d(u,l,e),!0}catch(e){return!1}},E=function(e){if(!o(e))return!1;switch(s(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return f||!!p(h,c(e))}catch(e){return!0}};E.sham=!0,e.exports=!d||i((function(){var e;return A(A.call)||!A(Object)||!A((function(){e=!0}))||e}))?E:A},7252:(e,t,n)=>{var r=n(5981),i=n(7475),o=/#|\.prototype\./,s=function(e,t){var n=c[a(e)];return n==l||n!=u&&(i(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},c=s.data={},u=s.NATIVE="N",l=s.POLYFILL="P";e.exports=s},941:(e,t,n)=>{var r=n(7475);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},2529:e=>{e.exports=!0},6664:(e,t,n)=>{var r=n(1899),i=n(626),o=n(7475),s=n(7046),a=n(2302),c=r.Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&s(t.prototype,c(e))}},3091:(e,t,n)=>{var r=n(1899),i=n(6843),o=n(8834),s=n(6059),a=n(9826),c=n(6782),u=n(623),l=n(7046),d=n(429),h=n(2902),p=n(7609),f=r.TypeError,A=function(e,t){this.stopped=e,this.result=t},E=A.prototype;e.exports=function(e,t,n){var r,g,_,m,I,T,R,v=n&&n.that,y=!(!n||!n.AS_ENTRIES),S=!(!n||!n.IS_ITERATOR),C=!(!n||!n.INTERRUPTED),O=i(t,v),b=function(e){return r&&p(r,"normal",e),new A(!0,e)},w=function(e){return y?(s(e),C?O(e[0],e[1],b):O(e[0],e[1])):C?O(e,b):O(e)};if(S)r=e;else{if(!(g=h(e)))throw f(a(e)+" is not iterable");if(c(g)){for(_=0,m=u(e);m>_;_++)if((I=w(e[_]))&&l(E,I))return I;return new A(!1)}r=d(e,g)}for(T=r.next;!(R=o(T,r)).done;){try{I=w(R.value)}catch(e){p(r,"throw",e)}if("object"==typeof I&&I&&l(E,I))return I}return new A(!1)}},7609:(e,t,n)=>{var r=n(8834),i=n(6059),o=n(4229);e.exports=function(e,t,n){var s,a;i(e);try{if(!(s=o(e,"return"))){if("throw"===t)throw n;return n}s=r(s,e)}catch(e){a=!0,s=e}if("throw"===t)throw n;if(a)throw s;return i(s),n}},5143:(e,t,n)=>{"use strict";var r,i,o,s=n(5981),a=n(7475),c=n(9290),u=n(249),l=n(9754),d=n(9813),h=n(2529),p=d("iterator"),f=!1;[].keys&&("next"in(o=[].keys())?(i=u(u(o)))!==Object.prototype&&(r=i):f=!0),null==r||s((function(){var e={};return r[p].call(e)!==e}))?r={}:h&&(r=c(r)),a(r[p])||l(r,p,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},2077:e=>{e.exports={}},623:(e,t,n)=>{var r=n(3057);e.exports=function(e){return r(e.length)}},6132:(e,t,n)=>{var r,i,o,s,a,c,u,l,d=n(1899),h=n(6843),p=n(9677).f,f=n(2941).set,A=n(2749),E=n(4470),g=n(8045),_=n(6049),m=d.MutationObserver||d.WebKitMutationObserver,I=d.document,T=d.process,R=d.Promise,v=p(d,"queueMicrotask"),y=v&&v.value;y||(r=function(){var e,t;for(_&&(e=T.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?s():o=void 0,e}}o=void 0,e&&e.enter()},A||_||g||!m||!I?!E&&R&&R.resolve?((u=R.resolve(void 0)).constructor=R,l=h(u.then,u),s=function(){l(r)}):_?s=function(){T.nextTick(r)}:(f=h(f,d),s=function(){f(r)}):(a=!0,c=I.createTextNode(""),new m(r).observe(c,{characterData:!0}),s=function(){c.data=a=!a})),e.exports=y||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,s()),o=t}},9297:(e,t,n)=>{var r=n(1899);e.exports=r.Promise},2497:(e,t,n)=>{var r=n(3385),i=n(5981);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},8019:(e,t,n)=>{var r=n(1899),i=n(7475),o=n(1302),s=r.WeakMap;e.exports=i(s)&&/native code/.test(o(s))},9520:(e,t,n)=>{"use strict";var r=n(4883),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},4649:(e,t,n)=>{var r=n(5803);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},9290:(e,t,n)=>{var r,i=n(6059),o=n(9938),s=n(6759),a=n(7748),c=n(5463),u=n(1333),l=n(4262)("IE_PROTO"),d=function(){},h=function(e){return"<script>"+e+"<\/script>"},p=function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t},f=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;f="undefined"!=typeof document?document.domain&&r?p(r):((t=u("iframe")).style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F):p(r);for(var n=s.length;n--;)delete f.prototype[s[n]];return f()};a[l]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(d.prototype=i(e),n=new d,d.prototype=null,n[l]=e):n=f(),void 0===t?n:o.f(n,t)}},9938:(e,t,n)=>{var r=n(5746),i=n(3937),o=n(5988),s=n(6059),a=n(4529),c=n(4771);t.f=r&&!i?Object.defineProperties:function(e,t){s(e);for(var n,r=a(t),i=c(t),u=i.length,l=0;u>l;)o.f(e,n=i[l++],r[n]);return e}},5988:(e,t,n)=>{var r=n(1899),i=n(5746),o=n(2840),s=n(3937),a=n(6059),c=n(3894),u=r.TypeError,l=Object.defineProperty,d=Object.getOwnPropertyDescriptor;t.f=i?s?function(e,t,n){if(a(e),t=c(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=d(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=c(t),a(n),o)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},9677:(e,t,n)=>{var r=n(5746),i=n(8834),o=n(6760),s=n(1887),a=n(4529),c=n(3894),u=n(953),l=n(2840),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=c(t),l)try{return d(e,t)}catch(e){}if(u(e,t))return s(!i(o.f,e,t),e[t])}},946:(e,t,n)=>{var r=n(5629),i=n(6759).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},7857:(e,t)=>{t.f=Object.getOwnPropertySymbols},249:(e,t,n)=>{var r=n(1899),i=n(953),o=n(7475),s=n(9678),a=n(4262),c=n(4160),u=a("IE_PROTO"),l=r.Object,d=l.prototype;e.exports=c?l.getPrototypeOf:function(e){var t=s(e);if(i(t,u))return t[u];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof l?d:null}},7046:(e,t,n)=>{var r=n(5329);e.exports=r({}.isPrototypeOf)},5629:(e,t,n)=>{var r=n(5329),i=n(953),o=n(4529),s=n(1692).indexOf,a=n(7748),c=r([].push);e.exports=function(e,t){var n,r=o(e),u=0,l=[];for(n in r)!i(a,n)&&i(r,n)&&c(l,n);for(;t.length>u;)i(r,n=t[u++])&&(~s(l,n)||c(l,n));return l}},4771:(e,t,n)=>{var r=n(5629),i=n(6759);e.exports=Object.keys||function(e){return r(e,i)}},6760:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},8929:(e,t,n)=>{var r=n(5329),i=n(6059),o=n(1851);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},5623:(e,t,n)=>{"use strict";var r=n(2885),i=n(9697);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},9811:(e,t,n)=>{var r=n(1899),i=n(8834),o=n(7475),s=n(941),a=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!s(r=i(n,e)))return r;if(o(n=e.valueOf)&&!s(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!s(r=i(n,e)))return r;throw a("Can't convert object to primitive value")}},1136:(e,t,n)=>{var r=n(626),i=n(5329),o=n(946),s=n(7857),a=n(6059),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?c(t,n(e)):t}},4058:e=>{e.exports={}},2:e=>{e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},6584:(e,t,n)=>{var r=n(6059),i=n(941),o=n(9520);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},8397:e=>{var t=function(){this.head=null,this.tail=null};t.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},e.exports=t},7524:(e,t,n)=>{var r=n(9754);e.exports=function(e,t,n){for(var i in t)n&&n.unsafe&&e[i]?e[i]=t[i]:r(e,i,t[i],n);return e}},9754:(e,t,n)=>{var r=n(2029);e.exports=function(e,t,n,i){i&&i.enumerable?e[t]=n:r(e,t,n)}},8219:(e,t,n)=>{var r=n(1899).TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},4911:(e,t,n)=>{var r=n(1899),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},4431:(e,t,n)=>{"use strict";var r=n(626),i=n(5988),o=n(9813),s=n(5746),a=o("species");e.exports=function(e){var t=r(e),n=i.f;s&&t&&!t[a]&&n(t,a,{configurable:!0,get:function(){return this}})}},904:(e,t,n)=>{var r=n(2885),i=n(5988).f,o=n(2029),s=n(953),a=n(5623),c=n(9813)("toStringTag");e.exports=function(e,t,n,u){if(e){var l=n?e:e.prototype;s(l,c)||i(l,c,{configurable:!0,value:t}),u&&!r&&o(l,"toString",a)}}},4262:(e,t,n)=>{var r=n(8726),i=n(9418),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},3030:(e,t,n)=>{var r=n(1899),i=n(4911),o="__core-js_shared__",s=r[o]||i(o,{});e.exports=s},8726:(e,t,n)=>{var r=n(2529),i=n(3030);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.3",mode:r?"pure":"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},487:(e,t,n)=>{var r=n(6059),i=n(174),o=n(9813)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||null==(n=r(s)[o])?t:i(n)}},4620:(e,t,n)=>{var r=n(5329),i=n(2435),o=n(5803),s=n(8219),a=r("".charAt),c=r("".charCodeAt),u=r("".slice),l=function(e){return function(t,n){var r,l,d=o(s(t)),h=i(n),p=d.length;return h<0||h>=p?e?"":void 0:(r=c(d,h))<55296||r>56319||h+1===p||(l=c(d,h+1))<56320||l>57343?e?a(d,h):r:e?u(d,h,h+2):l-56320+(r-55296<<10)+65536}};e.exports={codeAt:l(!1),charAt:l(!0)}},2941:(e,t,n)=>{var r,i,o,s,a=n(1899),c=n(9730),u=n(6843),l=n(7475),d=n(953),h=n(5981),p=n(5463),f=n(3765),A=n(1333),E=n(2749),g=n(6049),_=a.setImmediate,m=a.clearImmediate,I=a.process,T=a.Dispatch,R=a.Function,v=a.MessageChannel,y=a.String,S=0,C={};try{r=a.location}catch(e){}var O=function(e){if(d(C,e)){var t=C[e];delete C[e],t()}},b=function(e){return function(){O(e)}},w=function(e){O(e.data)},N=function(e){a.postMessage(y(e),r.protocol+"//"+r.host)};_&&m||(_=function(e){var t=f(arguments,1);return C[++S]=function(){c(l(e)?e:R(e),void 0,t)},i(S),S},m=function(e){delete C[e]},g?i=function(e){I.nextTick(b(e))}:T&&T.now?i=function(e){T.now(b(e))}:v&&!E?(s=(o=new v).port2,o.port1.onmessage=w,i=u(s.postMessage,s)):a.addEventListener&&l(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!h(N)?(i=N,a.addEventListener("message",w,!1)):i="onreadystatechange"in A("script")?function(e){p.appendChild(A("script")).onreadystatechange=function(){p.removeChild(this),O(e)}}:function(e){setTimeout(b(e),0)}),e.exports={set:_,clear:m}},9413:(e,t,n)=>{var r=n(2435),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},4529:(e,t,n)=>{var r=n(7026),i=n(8219);e.exports=function(e){return r(i(e))}},2435:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){var r=+e;return r!=r||0===r?0:(r>0?n:t)(r)}},3057:(e,t,n)=>{var r=n(2435),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},9678:(e,t,n)=>{var r=n(1899),i=n(8219),o=r.Object;e.exports=function(e){return o(i(e))}},6935:(e,t,n)=>{var r=n(1899),i=n(8834),o=n(941),s=n(6664),a=n(4229),c=n(9811),u=n(9813),l=r.TypeError,d=u("toPrimitive");e.exports=function(e,t){if(!o(e)||s(e))return e;var n,r=a(e,d);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!o(n)||s(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),c(e,t)}},3894:(e,t,n)=>{var r=n(6935),i=n(6664);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},2885:(e,t,n)=>{var r={};r[n(9813)("toStringTag")]="z",e.exports="[object z]"===String(r)},5803:(e,t,n)=>{var r=n(1899),i=n(9697),o=r.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},9826:(e,t,n)=>{var r=n(1899).String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},9418:(e,t,n)=>{var r=n(5329),i=0,o=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+o,36)}},2302:(e,t,n)=>{var r=n(2497);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3937:(e,t,n)=>{var r=n(5746),i=n(5981);e.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},9813:(e,t,n)=>{var r=n(1899),i=n(8726),o=n(953),s=n(9418),a=n(2497),c=n(2302),u=i("wks"),l=r.Symbol,d=l&&l.for,h=c?l:l&&l.withoutSetter||s;e.exports=function(e){if(!o(u,e)||!a&&"string"!=typeof u[e]){var t="Symbol."+e;a&&o(l,e)?u[e]=l[e]:u[e]=c&&d?d(t):h(t)}return u[e]}},7627:(e,t,n)=>{"use strict";var r=n(6887),i=n(1899),o=n(7046),s=n(249),a=n(8929),c=n(3489),u=n(9290),l=n(2029),d=n(1887),h=n(8694),p=n(3794),f=n(3091),A=n(4649),E=n(9813),g=n(8780),_=E("toStringTag"),m=i.Error,I=[].push,T=function(e,t){var n,r=arguments.length>2?arguments[2]:void 0,i=o(R,this);a?n=a(new m,i?s(this):R):(n=i?this:u(R),l(n,_,"Error")),void 0!==t&&l(n,"message",A(t)),g&&l(n,"stack",h(n.stack,1)),p(n,r);var c=[];return f(e,I,{that:c}),l(n,"errors",c),n};a?a(T,m):c(T,m,{name:!0});var R=T.prototype=u(m.prototype,{constructor:d(1,T),message:d(1,""),name:d(1,"AggregateError")});r({global:!0},{AggregateError:T})},6274:(e,t,n)=>{"use strict";var r=n(4529),i=n(8479),o=n(2077),s=n(5402),a=n(5988).f,c=n(7771),u=n(2529),l=n(5746),d="Array Iterator",h=s.set,p=s.getterFor(d);e.exports=c(Array,"Array",(function(e,t){h(this,{type:d,target:r(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var f=o.Arguments=o.Array;if(i("keys"),i("values"),i("entries"),!u&&l&&"values"!==f.name)try{a(f,"name",{value:"values"})}catch(e){}},6450:(e,t,n)=>{var r=n(6887),i=n(5746),o=n(5988).f;r({target:"Object",stat:!0,forced:Object.defineProperty!==o,sham:!i},{defineProperty:o})},5967:()=>{},4560:(e,t,n)=>{"use strict";var r=n(6887),i=n(8834),o=n(4883),s=n(9520),a=n(2),c=n(3091);r({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=s.f(t),r=n.resolve,u=n.reject,l=a((function(){var n=o(t.resolve),s=[],a=0,u=1;c(e,(function(e){var o=a++,c=!1;u++,i(n,t,e).then((function(e){c||(c=!0,s[o]={status:"fulfilled",value:e},--u||r(s))}),(function(e){c||(c=!0,s[o]={status:"rejected",reason:e},--u||r(s))}))})),--u||r(s)}));return l.error&&u(l.value),n.promise}})},7206:(e,t,n)=>{"use strict";var r=n(6887),i=n(4883),o=n(626),s=n(8834),a=n(9520),c=n(2),u=n(3091),l="No one promise resolved";r({target:"Promise",stat:!0},{any:function(e){var t=this,n=o("AggregateError"),r=a.f(t),d=r.resolve,h=r.reject,p=c((function(){var r=i(t.resolve),o=[],a=0,c=1,p=!1;u(e,(function(e){var i=a++,u=!1;c++,s(r,t,e).then((function(e){u||p||(p=!0,d(e))}),(function(e){u||p||(u=!0,o[i]=e,--c||h(new n(o,l)))}))})),--c||h(new n(o,l))}));return p.error&&h(p.value),r.promise}})},4349:(e,t,n)=>{"use strict";var r=n(6887),i=n(2529),o=n(9297),s=n(5981),a=n(626),c=n(7475),u=n(487),l=n(6584),d=n(9754);if(r({target:"Promise",proto:!0,real:!0,forced:!!o&&s((function(){o.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=u(this,a("Promise")),n=c(e);return this.then(n?function(n){return l(t,e()).then((function(){return n}))}:e,n?function(n){return l(t,e()).then((function(){throw n}))}:e)}}),!i&&c(o)){var h=a("Promise").prototype.finally;o.prototype.finally!==h&&d(o.prototype,"finally",h,{unsafe:!0})}},8881:(e,t,n)=>{"use strict";var r,i,o,s,a=n(6887),c=n(2529),u=n(1899),l=n(626),d=n(8834),h=n(9297),p=n(9754),f=n(7524),A=n(8929),E=n(904),g=n(4431),_=n(4883),m=n(7475),I=n(941),T=n(5743),R=n(1302),v=n(3091),y=n(1385),S=n(487),C=n(2941).set,O=n(6132),b=n(6584),w=n(4845),N=n(9520),D=n(2),L=n(8397),P=n(5402),k=n(7252),x=n(9813),M=n(3321),U=n(6049),B=n(3385),F=x("species"),V="Promise",G=P.getterFor(V),Q=P.set,j=P.getterFor(V),H=h&&h.prototype,W=h,Y=H,K=u.TypeError,$=u.document,z=u.process,q=N.f,J=q,X=!!($&&$.createEvent&&u.dispatchEvent),Z=m(u.PromiseRejectionEvent),ee="unhandledrejection",te=!1,ne=k(V,(function(){var e=R(W),t=e!==String(W);if(!t&&66===B)return!0;if(c&&!Y.finally)return!0;if(B>=51&&/native code/.test(e))return!1;var n=new W((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[F]=r,!(te=n.then((function(){}))instanceof r)||!t&&M&&!Z})),re=ne||!y((function(e){W.all(e).catch((function(){}))})),ie=function(e){var t;return!(!I(e)||!m(t=e.then))&&t},oe=function(e,t){var n,r,i,o=t.value,s=1==t.state,a=s?e.ok:e.fail,c=e.resolve,u=e.reject,l=e.domain;try{a?(s||(2===t.rejection&&le(t),t.rejection=1),!0===a?n=o:(l&&l.enter(),n=a(o),l&&(l.exit(),i=!0)),n===e.promise?u(K("Promise-chain cycle")):(r=ie(n))?d(r,n,c,u):c(n)):u(o)}catch(e){l&&!i&&l.exit(),u(e)}},se=function(e,t){e.notified||(e.notified=!0,O((function(){for(var n,r=e.reactions;n=r.get();)oe(n,e);e.notified=!1,t&&!e.rejection&&ce(e)})))},ae=function(e,t,n){var r,i;X?((r=$.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),u.dispatchEvent(r)):r={promise:t,reason:n},!Z&&(i=u["on"+e])?i(r):e===ee&&w("Unhandled promise rejection",n)},ce=function(e){d(C,u,(function(){var t,n=e.facade,r=e.value;if(ue(e)&&(t=D((function(){U?z.emit("unhandledRejection",r,n):ae(ee,n,r)})),e.rejection=U||ue(e)?2:1,t.error))throw t.value}))},ue=function(e){return 1!==e.rejection&&!e.parent},le=function(e){d(C,u,(function(){var t=e.facade;U?z.emit("rejectionHandled",t):ae("rejectionhandled",t,e.value)}))},de=function(e,t,n){return function(r){e(t,r,n)}},he=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,se(e,!0))},pe=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw K("Promise can't be resolved itself");var r=ie(t);r?O((function(){var n={done:!1};try{d(r,t,de(pe,n,e),de(he,n,e))}catch(t){he(n,t,e)}})):(e.value=t,e.state=1,se(e,!1))}catch(t){he({done:!1},t,e)}}};if(ne&&(Y=(W=function(e){T(this,Y),_(e),d(r,this);var t=G(this);try{e(de(pe,t),de(he,t))}catch(e){he(t,e)}}).prototype,(r=function(e){Q(this,{type:V,done:!1,notified:!1,parent:!1,reactions:new L,rejection:!1,state:0,value:void 0})}).prototype=f(Y,{then:function(e,t){var n=j(this),r=q(S(this,W));return n.parent=!0,r.ok=!m(e)||e,r.fail=m(t)&&t,r.domain=U?z.domain:void 0,0==n.state?n.reactions.add(r):O((function(){oe(r,n)})),r.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r,t=G(e);this.promise=e,this.resolve=de(pe,t),this.reject=de(he,t)},N.f=q=function(e){return e===W||e===o?new i(e):J(e)},!c&&m(h)&&H!==Object.prototype)){s=H.then,te||(p(H,"then",(function(e,t){var n=this;return new W((function(e,t){d(s,n,e,t)})).then(e,t)}),{unsafe:!0}),p(H,"catch",Y.catch,{unsafe:!0}));try{delete H.constructor}catch(e){}A&&A(H,Y)}a({global:!0,wrap:!0,forced:ne},{Promise:W}),E(W,V,!1,!0),g(V),o=l(V),a({target:V,stat:!0,forced:ne},{reject:function(e){var t=q(this);return d(t.reject,void 0,e),t.promise}}),a({target:V,stat:!0,forced:c||ne},{resolve:function(e){return b(c&&this===o?W:this,e)}}),a({target:V,stat:!0,forced:re},{all:function(e){var t=this,n=q(t),r=n.resolve,i=n.reject,o=D((function(){var n=_(t.resolve),o=[],s=0,a=1;v(e,(function(e){var c=s++,u=!1;a++,d(n,t,e).then((function(e){u||(u=!0,o[c]=e,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=q(t),r=n.reject,i=D((function(){var i=_(t.resolve);v(e,(function(e){d(i,t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},7971:(e,t,n)=>{"use strict";var r=n(4620).charAt,i=n(5803),o=n(5402),s=n(7771),a="String Iterator",c=o.set,u=o.getterFor(a);s(String,"String",(function(e){c(this,{type:a,string:i(e),index:0})}),(function(){var e,t=u(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},7634:(e,t,n)=>{n(6274);var r=n(3281),i=n(1899),o=n(9697),s=n(2029),a=n(2077),c=n(9813)("toStringTag");for(var u in r){var l=i[u],d=l&&l.prototype;d&&o(d)!==c&&s(d,c,u),a[u]=a.Array}},1910:(e,t,n)=>{var r=n(8171);e.exports=r},7460:(e,t,n)=>{var r=n(2956);n(7634),e.exports=r},9662:(e,t,n)=>{var r=n(7854),i=n(614),o=n(6330),s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not a function")}},6077:(e,t,n)=>{var r=n(7854),i=n(614),o=r.String,s=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw s("Can't set "+o(e)+" as a prototype")}},1223:(e,t,n)=>{var r=n(5112),i=n(30),o=n(3070),s=r("unscopables"),a=Array.prototype;null==a[s]&&o.f(a,s,{configurable:!0,value:i(null)}),e.exports=function(e){a[s][e]=!0}},9670:(e,t,n)=>{var r=n(7854),i=n(111),o=r.String,s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not an object")}},1318:(e,t,n)=>{var r=n(5656),i=n(1400),o=n(6244),s=function(e){return function(t,n,s){var a,c=r(t),u=o(c),l=i(s,u);if(e&&n!=n){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},4326:(e,t,n)=>{var r=n(1702),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},648:(e,t,n)=>{var r=n(7854),i=n(1694),o=n(614),s=n(4326),a=n(5112)("toStringTag"),c=r.Object,u="Arguments"==s(function(){return arguments}());e.exports=i?s:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=c(e),a))?n:u?s(t):"Object"==(r=s(t))&&o(t.callee)?"Arguments":r}},7741:(e,t,n)=>{var r=n(1702)("".replace),i=String(Error("zxcasd").stack),o=/\n\s*at [^:]*:[^\n]*/,s=o.test(i);e.exports=function(e,t){if(s&&"string"==typeof e)for(;t--;)e=r(e,o,"");return e}},9920:(e,t,n)=>{var r=n(2597),i=n(3887),o=n(1236),s=n(3070);e.exports=function(e,t,n){for(var a=i(t),c=s.f,u=o.f,l=0;l<a.length;l++){var d=a[l];r(e,d)||n&&r(n,d)||c(e,d,u(t,d))}}},8544:(e,t,n)=>{var r=n(7293);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},4994:(e,t,n)=>{"use strict";var r=n(3383).IteratorPrototype,i=n(30),o=n(9114),s=n(8003),a=n(7497),c=function(){return this};e.exports=function(e,t,n,u){var l=t+" Iterator";return e.prototype=i(r,{next:o(+!u,n)}),s(e,l,!1,!0),a[l]=c,e}},8880:(e,t,n)=>{var r=n(9781),i=n(3070),o=n(9114);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},9114:e=>{e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},654:(e,t,n)=>{"use strict";var r=n(2109),i=n(6916),o=n(1913),s=n(6530),a=n(614),c=n(4994),u=n(9518),l=n(7674),d=n(8003),h=n(8880),p=n(1320),f=n(5112),A=n(7497),E=n(3383),g=s.PROPER,_=s.CONFIGURABLE,m=E.IteratorPrototype,I=E.BUGGY_SAFARI_ITERATORS,T=f("iterator"),R="keys",v="values",y="entries",S=function(){return this};e.exports=function(e,t,n,s,f,E,C){c(n,t,s);var O,b,w,N=function(e){if(e===f&&x)return x;if(!I&&e in P)return P[e];switch(e){case R:case v:case y:return function(){return new n(this,e)}}return function(){return new n(this)}},D=t+" Iterator",L=!1,P=e.prototype,k=P[T]||P["@@iterator"]||f&&P[f],x=!I&&k||N(f),M="Array"==t&&P.entries||k;if(M&&(O=u(M.call(new e)))!==Object.prototype&&O.next&&(o||u(O)===m||(l?l(O,m):a(O[T])||p(O,T,S)),d(O,D,!0,!0),o&&(A[D]=S)),g&&f==v&&k&&k.name!==v&&(!o&&_?h(P,"name",v):(L=!0,x=function(){return i(k,this)})),f)if(b={values:N(v),keys:E?x:N(R),entries:N(y)},C)for(w in b)(I||L||!(w in P))&&p(P,w,b[w]);else r({target:t,proto:!0,forced:I||L},b);return o&&!C||P[T]===x||p(P,T,x,{name:f}),A[t]=x,b}},9781:(e,t,n)=>{var r=n(7293);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:(e,t,n)=>{var r=n(7854),i=n(111),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},8324:e=>{e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},8509:(e,t,n)=>{var r=n(317)("span").classList,i=r&&r.constructor&&r.constructor.prototype;e.exports=i===Object.prototype?void 0:i},8113:(e,t,n)=>{var r=n(5005);e.exports=r("navigator","userAgent")||""},7392:(e,t,n)=>{var r,i,o=n(7854),s=n(8113),a=o.process,c=o.Deno,u=a&&a.versions||c&&c.version,l=u&&u.v8;l&&(i=(r=l.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},748:e=>{e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2914:(e,t,n)=>{var r=n(7293),i=n(9114);e.exports=!r((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))},2109:(e,t,n)=>{var r=n(7854),i=n(1236).f,o=n(8880),s=n(1320),a=n(3505),c=n(9920),u=n(4705);e.exports=function(e,t){var n,l,d,h,p,f=e.target,A=e.global,E=e.stat;if(n=A?r:E?r[f]||a(f,{}):(r[f]||{}).prototype)for(l in t){if(h=t[l],d=e.noTargetGet?(p=i(n,l))&&p.value:n[l],!u(A?l:f+(E?".":"#")+l,e.forced)&&void 0!==d){if(typeof h==typeof d)continue;c(h,d)}(e.sham||d&&d.sham)&&o(h,"sham",!0),s(n,l,h,e)}}},7293:e=>{e.exports=function(e){try{return!!e()}catch(e){return!0}}},2104:(e,t,n)=>{var r=n(4374),i=Function.prototype,o=i.apply,s=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},4374:(e,t,n)=>{var r=n(7293);e.exports=!r((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},6916:(e,t,n)=>{var r=n(4374),i=Function.prototype.call;e.exports=r?i.bind(i):function(){return i.apply(i,arguments)}},6530:(e,t,n)=>{var r=n(9781),i=n(2597),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),c=a&&"something"===function(){}.name,u=a&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:u}},1702:(e,t,n)=>{var r=n(4374),i=Function.prototype,o=i.bind,s=i.call,a=r&&o.bind(s,s);e.exports=r?function(e){return e&&a(e)}:function(e){return e&&function(){return s.apply(e,arguments)}}},5005:(e,t,n)=>{var r=n(7854),i=n(614),o=function(e){return i(e)?e:void 0};e.exports=function(e,t){return arguments.length<2?o(r[e]):r[e]&&r[e][t]}},8173:(e,t,n)=>{var r=n(9662);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},7854:(e,t,n)=>{var r=function(e){return e&&e.Math==Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof n.g&&n.g)||function(){return this}()||Function("return this")()},2597:(e,t,n)=>{var r=n(1702),i=n(7908),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},3501:e=>{e.exports={}},490:(e,t,n)=>{var r=n(5005);e.exports=r("document","documentElement")},4664:(e,t,n)=>{var r=n(9781),i=n(7293),o=n(317);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},8361:(e,t,n)=>{var r=n(7854),i=n(1702),o=n(7293),s=n(4326),a=r.Object,c=i("".split);e.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?c(e,""):a(e)}:a},9587:(e,t,n)=>{var r=n(614),i=n(111),o=n(7674);e.exports=function(e,t,n){var s,a;return o&&r(s=t.constructor)&&s!==n&&i(a=s.prototype)&&a!==n.prototype&&o(e,a),e}},2788:(e,t,n)=>{var r=n(1702),i=n(614),o=n(5465),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},8340:(e,t,n)=>{var r=n(111),i=n(8880);e.exports=function(e,t){r(t)&&"cause"in t&&i(e,"cause",t.cause)}},9909:(e,t,n)=>{var r,i,o,s=n(8536),a=n(7854),c=n(1702),u=n(111),l=n(8880),d=n(2597),h=n(5465),p=n(6200),f=n(3501),A="Object already initialized",E=a.TypeError,g=a.WeakMap;if(s||h.state){var _=h.state||(h.state=new g),m=c(_.get),I=c(_.has),T=c(_.set);r=function(e,t){if(I(_,e))throw new E(A);return t.facade=e,T(_,e,t),t},i=function(e){return m(_,e)||{}},o=function(e){return I(_,e)}}else{var R=p("state");f[R]=!0,r=function(e,t){if(d(e,R))throw new E(A);return t.facade=e,l(e,R,t),t},i=function(e){return d(e,R)?e[R]:{}},o=function(e){return d(e,R)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!u(t)||(n=i(t)).type!==e)throw E("Incompatible receiver, "+e+" required");return n}}}},614:e=>{e.exports=function(e){return"function"==typeof e}},4705:(e,t,n)=>{var r=n(7293),i=n(614),o=/#|\.prototype\./,s=function(e,t){var n=c[a(e)];return n==l||n!=u&&(i(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},c=s.data={},u=s.NATIVE="N",l=s.POLYFILL="P";e.exports=s},111:(e,t,n)=>{var r=n(614);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},1913:e=>{e.exports=!1},2190:(e,t,n)=>{var r=n(7854),i=n(5005),o=n(614),s=n(7976),a=n(3307),c=r.Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&s(t.prototype,c(e))}},3383:(e,t,n)=>{"use strict";var r,i,o,s=n(7293),a=n(614),c=n(30),u=n(9518),l=n(1320),d=n(5112),h=n(1913),p=d("iterator"),f=!1;[].keys&&("next"in(o=[].keys())?(i=u(u(o)))!==Object.prototype&&(r=i):f=!0),null==r||s((function(){var e={};return r[p].call(e)!==e}))?r={}:h&&(r=c(r)),a(r[p])||l(r,p,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},7497:e=>{e.exports={}},6244:(e,t,n)=>{var r=n(7466);e.exports=function(e){return r(e.length)}},133:(e,t,n)=>{var r=n(7392),i=n(7293);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},8536:(e,t,n)=>{var r=n(7854),i=n(614),o=n(2788),s=r.WeakMap;e.exports=i(s)&&/native code/.test(o(s))},6277:(e,t,n)=>{var r=n(1340);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},30:(e,t,n)=>{var r,i=n(9670),o=n(6048),s=n(748),a=n(3501),c=n(490),u=n(317),l=n(6200)("IE_PROTO"),d=function(){},h=function(e){return"<script>"+e+"<\/script>"},p=function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t},f=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t;f="undefined"!=typeof document?document.domain&&r?p(r):((t=u("iframe")).style.display="none",c.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F):p(r);for(var n=s.length;n--;)delete f.prototype[s[n]];return f()};a[l]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(d.prototype=i(e),n=new d,d.prototype=null,n[l]=e):n=f(),void 0===t?n:o.f(n,t)}},6048:(e,t,n)=>{var r=n(9781),i=n(3353),o=n(3070),s=n(9670),a=n(5656),c=n(1956);t.f=r&&!i?Object.defineProperties:function(e,t){s(e);for(var n,r=a(t),i=c(t),u=i.length,l=0;u>l;)o.f(e,n=i[l++],r[n]);return e}},3070:(e,t,n)=>{var r=n(7854),i=n(9781),o=n(4664),s=n(3353),a=n(9670),c=n(4948),u=r.TypeError,l=Object.defineProperty,d=Object.getOwnPropertyDescriptor;t.f=i?s?function(e,t,n){if(a(e),t=c(t),a(n),"function"==typeof e&&"prototype"===t&&"value"in n&&"writable"in n&&!n.writable){var r=d(e,t);r&&r.writable&&(e[t]=n.value,n={configurable:"configurable"in n?n.configurable:r.configurable,enumerable:"enumerable"in n?n.enumerable:r.enumerable,writable:!1})}return l(e,t,n)}:l:function(e,t,n){if(a(e),t=c(t),a(n),o)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw u("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},1236:(e,t,n)=>{var r=n(9781),i=n(6916),o=n(5296),s=n(9114),a=n(5656),c=n(4948),u=n(2597),l=n(4664),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=c(t),l)try{return d(e,t)}catch(e){}if(u(e,t))return s(!i(o.f,e,t),e[t])}},8006:(e,t,n)=>{var r=n(6324),i=n(748).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},5181:(e,t)=>{t.f=Object.getOwnPropertySymbols},9518:(e,t,n)=>{var r=n(7854),i=n(2597),o=n(614),s=n(7908),a=n(6200),c=n(8544),u=a("IE_PROTO"),l=r.Object,d=l.prototype;e.exports=c?l.getPrototypeOf:function(e){var t=s(e);if(i(t,u))return t[u];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof l?d:null}},7976:(e,t,n)=>{var r=n(1702);e.exports=r({}.isPrototypeOf)},6324:(e,t,n)=>{var r=n(1702),i=n(2597),o=n(5656),s=n(1318).indexOf,a=n(3501),c=r([].push);e.exports=function(e,t){var n,r=o(e),u=0,l=[];for(n in r)!i(a,n)&&i(r,n)&&c(l,n);for(;t.length>u;)i(r,n=t[u++])&&(~s(l,n)||c(l,n));return l}},1956:(e,t,n)=>{var r=n(6324),i=n(748);e.exports=Object.keys||function(e){return r(e,i)}},5296:(e,t)=>{"use strict";var n={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,i=r&&!n.call({1:2},1);t.f=i?function(e){var t=r(this,e);return!!t&&t.enumerable}:n},7674:(e,t,n)=>{var r=n(1702),i=n(9670),o=n(6077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},2140:(e,t,n)=>{var r=n(7854),i=n(6916),o=n(614),s=n(111),a=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!s(r=i(n,e)))return r;if(o(n=e.valueOf)&&!s(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!s(r=i(n,e)))return r;throw a("Can't convert object to primitive value")}},3887:(e,t,n)=>{var r=n(5005),i=n(1702),o=n(8006),s=n(5181),a=n(9670),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?c(t,n(e)):t}},1320:(e,t,n)=>{var r=n(7854),i=n(614),o=n(2597),s=n(8880),a=n(3505),c=n(2788),u=n(9909),l=n(6530).CONFIGURABLE,d=u.get,h=u.enforce,p=String(String).split("String");(e.exports=function(e,t,n,c){var u,d=!!c&&!!c.unsafe,f=!!c&&!!c.enumerable,A=!!c&&!!c.noTargetGet,E=c&&void 0!==c.name?c.name:t;i(n)&&("Symbol("===String(E).slice(0,7)&&(E="["+String(E).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!o(n,"name")||l&&n.name!==E)&&s(n,"name",E),(u=h(n)).source||(u.source=p.join("string"==typeof E?E:""))),e!==r?(d?!A&&e[t]&&(f=!0):delete e[t],f?e[t]=n:s(e,t,n)):f?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return i(this)&&d(this).source||c(this)}))},2261:(e,t,n)=>{"use strict";var r,i,o=n(6916),s=n(1702),a=n(1340),c=n(7066),u=n(2999),l=n(2309),d=n(30),h=n(9909).get,p=n(9441),f=n(7168),A=l("native-string-replace",String.prototype.replace),E=RegExp.prototype.exec,g=E,_=s("".charAt),m=s("".indexOf),I=s("".replace),T=s("".slice),R=(i=/b*/g,o(E,r=/a/,"a"),o(E,i,"a"),0!==r.lastIndex||0!==i.lastIndex),v=u.BROKEN_CARET,y=void 0!==/()??/.exec("")[1];(R||y||v||p||f)&&(g=function(e){var t,n,r,i,s,u,l,p=this,f=h(p),S=a(e),C=f.raw;if(C)return C.lastIndex=p.lastIndex,t=o(g,C,S),p.lastIndex=C.lastIndex,t;var O=f.groups,b=v&&p.sticky,w=o(c,p),N=p.source,D=0,L=S;if(b&&(w=I(w,"y",""),-1===m(w,"g")&&(w+="g"),L=T(S,p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==_(S,p.lastIndex-1))&&(N="(?: "+N+")",L=" "+L,D++),n=new RegExp("^(?:"+N+")",w)),y&&(n=new RegExp("^"+N+"$(?!\\s)",w)),R&&(r=p.lastIndex),i=o(E,b?n:p,L),b?i?(i.input=T(i.input,D),i[0]=T(i[0],D),i.index=p.lastIndex,p.lastIndex+=i[0].length):p.lastIndex=0:R&&i&&(p.lastIndex=p.global?i.index+i[0].length:r),y&&i&&i.length>1&&o(A,i[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(i[s]=void 0)})),i&&O)for(i.groups=u=d(null),s=0;s<O.length;s++)u[(l=O[s])[0]]=i[l[1]];return i}),e.exports=g},7066:(e,t,n)=>{"use strict";var r=n(9670);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},2999:(e,t,n)=>{var r=n(7293),i=n(7854).RegExp,o=r((function(){var e=i("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),s=o||r((function(){return!i("a","y").sticky})),a=o||r((function(){var e=i("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:a,MISSED_STICKY:s,UNSUPPORTED_Y:o}},9441:(e,t,n)=>{var r=n(7293),i=n(7854).RegExp;e.exports=r((function(){var e=i(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},7168:(e,t,n)=>{var r=n(7293),i=n(7854).RegExp;e.exports=r((function(){var e=i("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},4488:(e,t,n)=>{var r=n(7854).TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},3505:(e,t,n)=>{var r=n(7854),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},8003:(e,t,n)=>{var r=n(3070).f,i=n(2597),o=n(5112)("toStringTag");e.exports=function(e,t,n){e&&!n&&(e=e.prototype),e&&!i(e,o)&&r(e,o,{configurable:!0,value:t})}},6200:(e,t,n)=>{var r=n(2309),i=n(9711),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},5465:(e,t,n)=>{var r=n(7854),i=n(3505),o="__core-js_shared__",s=r[o]||i(o,{});e.exports=s},2309:(e,t,n)=>{var r=n(1913),i=n(5465);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.20.3",mode:r?"pure":"global",copyright:"Â© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.20.3/LICENSE",source:"https://github.com/zloirock/core-js"})},1400:(e,t,n)=>{var r=n(9303),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},5656:(e,t,n)=>{var r=n(8361),i=n(4488);e.exports=function(e){return r(i(e))}},9303:e=>{var t=Math.ceil,n=Math.floor;e.exports=function(e){var r=+e;return r!=r||0===r?0:(r>0?n:t)(r)}},7466:(e,t,n)=>{var r=n(9303),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},7908:(e,t,n)=>{var r=n(7854),i=n(4488),o=r.Object;e.exports=function(e){return o(i(e))}},7593:(e,t,n)=>{var r=n(7854),i=n(6916),o=n(111),s=n(2190),a=n(8173),c=n(2140),u=n(5112),l=r.TypeError,d=u("toPrimitive");e.exports=function(e,t){if(!o(e)||s(e))return e;var n,r=a(e,d);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!o(n)||s(n))return n;throw l("Can't convert object to primitive value")}return void 0===t&&(t="number"),c(e,t)}},4948:(e,t,n)=>{var r=n(7593),i=n(2190);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},1694:(e,t,n)=>{var r={};r[n(5112)("toStringTag")]="z",e.exports="[object z]"===String(r)},1340:(e,t,n)=>{var r=n(7854),i=n(648),o=r.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},6330:(e,t,n)=>{var r=n(7854).String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},9711:(e,t,n)=>{var r=n(1702),i=0,o=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+o,36)}},3307:(e,t,n)=>{var r=n(133);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},3353:(e,t,n)=>{var r=n(9781),i=n(7293);e.exports=r&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},5112:(e,t,n)=>{var r=n(7854),i=n(2309),o=n(2597),s=n(9711),a=n(133),c=n(3307),u=i("wks"),l=r.Symbol,d=l&&l.for,h=c?l:l&&l.withoutSetter||s;e.exports=function(e){if(!o(u,e)||!a&&"string"!=typeof u[e]){var t="Symbol."+e;a&&o(l,e)?u[e]=l[e]:u[e]=c&&d?d(t):h(t)}return u[e]}},9191:(e,t,n)=>{"use strict";var r=n(5005),i=n(2597),o=n(8880),s=n(7976),a=n(7674),c=n(9920),u=n(9587),l=n(6277),d=n(8340),h=n(7741),p=n(2914),f=n(1913);e.exports=function(e,t,n,A){var E=A?2:1,g=e.split("."),_=g[g.length-1],m=r.apply(null,g);if(m){var I=m.prototype;if(!f&&i(I,"cause")&&delete I.cause,!n)return m;var T=r("Error"),R=t((function(e,t){var n=l(A?t:e,void 0),r=A?new m(e):new m;return void 0!==n&&o(r,"message",n),p&&o(r,"stack",h(r.stack,2)),this&&s(I,this)&&u(r,this,R),arguments.length>E&&d(r,arguments[E]),r}));if(R.prototype=I,"Error"!==_&&(a?a(R,T):c(R,T,{name:!0})),c(R,m),!f)try{I.name!==_&&o(I,"name",_),I.constructor=R}catch(e){}return R}}},6992:(e,t,n)=>{"use strict";var r=n(5656),i=n(1223),o=n(7497),s=n(9909),a=n(3070).f,c=n(654),u=n(1913),l=n(9781),d="Array Iterator",h=s.set,p=s.getterFor(d);e.exports=c(Array,"Array",(function(e,t){h(this,{type:d,target:r(e),index:0,kind:t})}),(function(){var e=p(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values");var f=o.Arguments=o.Array;if(i("keys"),i("values"),i("entries"),!u&&l&&"values"!==f.name)try{a(f,"name",{value:"values"})}catch(e){}},1703:(e,t,n)=>{var r=n(2109),i=n(7854),o=n(2104),s=n(9191),a=i.WebAssembly,c=7!==Error("e",{cause:7}).cause,u=function(e,t){var n={};n[e]=s(e,t,c),r({global:!0,forced:c},n)},l=function(e,t){if(a&&a[e]){var n={};n[e]=s("WebAssembly."+e,t,c),r({target:"WebAssembly",stat:!0,forced:c},n)}};u("Error",(function(e){return function(t){return o(e,this,arguments)}})),u("EvalError",(function(e){return function(t){return o(e,this,arguments)}})),u("RangeError",(function(e){return function(t){return o(e,this,arguments)}})),u("ReferenceError",(function(e){return function(t){return o(e,this,arguments)}})),u("SyntaxError",(function(e){return function(t){return o(e,this,arguments)}})),u("TypeError",(function(e){return function(t){return o(e,this,arguments)}})),u("URIError",(function(e){return function(t){return o(e,this,arguments)}})),l("CompileError",(function(e){return function(t){return o(e,this,arguments)}})),l("LinkError",(function(e){return function(t){return o(e,this,arguments)}})),l("RuntimeError",(function(e){return function(t){return o(e,this,arguments)}}))},4916:(e,t,n)=>{"use strict";var r=n(2109),i=n(2261);r({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},3948:(e,t,n)=>{var r=n(7854),i=n(8324),o=n(8509),s=n(6992),a=n(8880),c=n(5112),u=c("iterator"),l=c("toStringTag"),d=s.values,h=function(e,t){if(e){if(e[u]!==d)try{a(e,u,d)}catch(t){e[u]=d}if(e[l]||a(e,l,t),i[t])for(var n in s)if(e[n]!==s[n])try{a(e,n,s[n])}catch(t){e[n]=s[n]}}};for(var p in i)h(r[p]&&r[p].prototype,p);h(o,"DOMTokenList")}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r),n.d(r,{AudioExtension:()=>T,AudioProcessor:()=>m,Extension:()=>I,Ticker:()=>v,VideoProcessor:()=>_,logger:()=>d,reporter:()=>f});var e=n(4341);function t(t,n,r){return n in t?e(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}n(1703),n(6992),n(3948);var i=n(3476),o=n.n(i);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const n=Math.random().toString(16).substr(2,e).toLowerCase();return n.length===e?"".concat(t).concat(n):"".concat(t).concat(n)+s(e-n.length,"")}n(4916);const a=Date.now(),c={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4};function u(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const l=e=>{for(const t in c)if(Object.prototype.hasOwnProperty.call(c,t)&&c[t]===e)return t;return"DEFAULT"},d=new class{constructor(){t(this,"logLevel",c.DEBUG),t(this,"hookLog",void 0)}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[c.DEBUG].concat(t);this.log.apply(this,r)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[c.INFO].concat(t);this.log.apply(this,r)}warning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[c.WARNING].concat(t);this.log.apply(this,r)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=[c.ERROR].concat(t);this.log.apply(this,r)}log(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(Date.now()-a<100)return void setTimeout((()=>{this.log(...n)}),Date.now()-a);const i=Math.max(0,Math.min(4,n[0]));if(n[0]=u()+" Agora-Extension [".concat(l(i),"]:"),i<this.logLevel)return;const o=u()+" %cAgora-Extension [".concat(l(i),"]:");let s=[];switch(i){case c.DEBUG:s=[o,"color: #64B5F6;"].concat(n.slice(1)),console.log.apply(console,s);break;case c.INFO:s=[o,"color: #1E88E5; font-weight: bold;"].concat(n.slice(1)),console.log.apply(console,s);break;case c.WARNING:s=[o,"color: #FB8C00; font-weight: bold;"].concat(n.slice(1)),console.warn.apply(console,s);break;case c.ERROR:s=[o,"color: #B00020; font-weight: bold;"].concat(n.slice(1)),console.error.apply(console,s)}null===(e=this.hookLog)||void 0===e||e.call(this,i,s)}};function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?h(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const f=new class{constructor(){t(this,"apiInvokeMsgQueue",[]),t(this,"hookApiInvoke",void 0)}reportApiInvoke(e){e.timeout=e.timeout||6e4,e.reportResult=void 0===e.reportResult||e.reportResult;const t=Date.now(),n=()=>({name:e.name,apiInvokeTime:t,options:e.options});let r=!1;var i;(i=e.timeout,new(o())((e=>{window.setTimeout(e,i)}))).then((()=>{r||(this.sendApiInvoke(p(p({},n()),{},{error:"API_INVOKE_TIMEOUT",success:!1})),d.debug("".concat(e.name," timeout")))}));const s=new Error("".concat(e.name,": this api invoke is end"));return{onSuccess:t=>{if(r)throw s;r=!0,this.sendApiInvoke(p(p({},n()),{},{success:!0},e.reportResult&&{result:t}))},onError:e=>{if(r)throw e;r=!0,this.sendApiInvoke(p(p({},n()),{},{success:!1,error:e.toString()}))}}}sendApiInvoke(e){this.hookApiInvoke?(this.hookApiInvoke([...this.apiInvokeMsgQueue,e]),this.apiInvokeMsgQueue=[]):this.apiInvokeMsgQueue.push(e)}};function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?A(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class g extends class{constructor(){t(this,"_events",{}),t(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map((e=>e.listener)):[]}on(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);const n=this._events[e];-1===this._indexOfListener(n,t)&&n.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;const n=this._events[e],r=this._indexOfListener(n,t);-1!==r&&n.splice(r,1),0===this._events[e].length&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const t=this._events[e].map((e=>e));for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(let n=0;n<t.length;n+=1){const i=t[n];i.once&&this.off(e,i.listener),i.listener.apply(this,r||[])}}_indexOfListener(e,t){let n=e.length;for(;n--;)if(e[n].listener===t)return n;return-1}emitAsPromise(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return 0===this.getListeners(e).length?o().reject(new Error("No promise event handler.")):new(o())(((t,r)=>{this.emit(e,...n,t,r)}))}emitAsPromiseNoResponse(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return 0===this.getListeners(e).length?o().resolve():new(o())(((t,r)=>{this.emit(e,...n,t,r)}))}}{get enabled(){return this._enabled}output(e,t){if(this.outputTrack===e)return;const n=f.reportApiInvoke({name:"".concat(this.name,".output"),options:{track:null==e?void 0:e.toString()}});this.outputTrack=e,this.destination&&this.destination.updateInput({track:e,context:t}),n.onSuccess()}constructor(){super(),t(this,"inputTrack",void 0),t(this,"outputTrack",void 0),t(this,"_enabled",!0),t(this,"_source",void 0),t(this,"ID",s(6,"")),t(this,"destination",void 0),t(this,"context",void 0),t(this,"name",void 0)}enable(){if(this._enabled)return;const e=f.reportApiInvoke({name:"".concat(this.name,".setEnabled"),options:!0});d.info("".concat(this.name,"-").concat(this.ID," enabled")),this._enabled=!0;try{var t;const n=null===(t=this.onEnableChange)||void 0===t?void 0:t.call(this,this._enabled);if(n instanceof o())return n.then((()=>{e.onSuccess()})).catch((t=>{throw e.onError(t),t}));e.onSuccess()}catch(t){throw e.onError(t),t}}disable(){if(!this._enabled)return;const e=f.reportApiInvoke({name:"".concat(this.name,".setEnabled"),options:!1});d.info("".concat(this.name,"-").concat(this.ID," disabled")),this._enabled=!1;try{var t;const n=null===(t=this.onEnableChange)||void 0===t?void 0:t.call(this,this._enabled);if(n instanceof o())return n.then((()=>{e.onSuccess()})).catch((t=>{throw e.onError(t),t}));e.onSuccess()}catch(t){throw e.onError(t),t}}}class _ extends g{get kind(){return"video"}pipe(e){const t=f.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:e.name}});if(this.destination===e)return t.onSuccess(),e;if(e._source){const n=new Error("Processor ".concat(e.name," already piped, please call unpipe beforehand."));throw t.onError(n),n}return this.destination&&this.unpipe(),this.destination=e,e._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,context:this.context}),t.onSuccess(),e}unpipe(){if(!this.destination)return;const e=f.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});d.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));try{const t=this.destination;this.destination._source=void 0,this.destination=void 0,t.reset()}finally{e.onSuccess()}}updateInput(e){var t,n;e.context!==this.context&&(this.context=e.context,null===(t=this.onPiped)||void 0===t||t.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,context:e.context})),e.track&&this.inputTrack!==e.track&&(this.inputTrack=e.track,null===(n=this.onTrack)||void 0===n||n.call(this,e.track,this.context))}reset(){var e;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.context=void 0,null===(e=this.onUnpiped)||void 0===e||e.call(this),this.destination&&this.destination.reset()}}class m extends g{constructor(){super(...arguments),t(this,"inputNode",void 0),t(this,"outputNode",void 0),t(this,"destination",void 0),t(this,"context",void 0)}get kind(){return"audio"}pipe(e){const t=f.reportApiInvoke({name:"".concat(this.name,".pipe"),options:{processor:e.name}});if(this.destination===e)return t.onSuccess(),e;if(e._source){const n=new Error("Processor ".concat(e.name," already piped, please call unpipe beforehand."));throw t.onError(n),n}return this.destination&&this.unpipe(),this.destination=e,e._source=this,this.context&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:this.context}),t.onSuccess(),e}unpipe(){if(!this.destination)return;d.info("unpiping processor ".concat(this.destination.name,"-").concat(this.destination.ID));const e=f.reportApiInvoke({name:"".concat(this.name,".unpipe"),options:{processor:this.destination.name}});try{var t;let n=this.destination;null===(t=this.outputNode)||void 0===t||t.disconnect(),this.destination._source=void 0,this.destination=void 0,n.reset()}finally{e.onSuccess()}}output(e,t){if(e instanceof MediaStreamTrack)super.output(e,t);else if(e instanceof AudioNode){if(this.outputNode===e)return;const n=f.reportApiInvoke({name:"".concat(this.name,".output"),options:E(E({},e instanceof MediaStreamTrack&&{track:e.toString()}),e instanceof AudioNode&&{audioNode:e.toString()})});this.outputNode=e,this.destination&&this.destination.updateInput({node:e,context:t}),n.onSuccess()}}updateInput(e){var t,n,r;e.context!==this.context&&(this.context=e.context,null===(t=this.onPiped)||void 0===t||t.call(this,this.context),this.destination&&this.destination.updateInput({track:this.outputTrack,node:this.outputNode,context:e.context})),e.track&&this.inputTrack!==e.track&&(this.inputTrack=e.track,null===(n=this.onTrack)||void 0===n||n.call(this,e.track,this.context)),e.node&&this.inputNode!==e.node&&(this.inputNode=e.node,null===(r=this.onNode)||void 0===r||r.call(this,e.node,this.context))}reset(){var e;this.context&&this.context.requestRevertConstraints(this),this.inputTrack=void 0,this.inputNode=void 0,this.context=void 0,null===(e=this.onUnpiped)||void 0===e||e.call(this),this.destination&&this.destination.reset()}}class I{constructor(){t(this,"__registered__",!1),t(this,"logger",d),t(this,"reporter",f),t(this,"parameters",{})}createProcessor(){if(!this.__registered__)throw new Error("Extension not registered yet!");return this._createProcessor()}}class T extends I{}let R;class v{get running(){return this._running}constructor(e,n){if(t(this,"type",void 0),t(this,"interval",void 0),t(this,"fn",void 0),t(this,"_running",!1),t(this,"_osc",void 0),!e)throw new Error;if(n<=0)throw new Error;this.type=e,this.interval=n}add(e){this.fn=e}remove(){this.fn=void 0}start(){if(!this._running)switch(this._running=!0,this.type){case"Timer":{const e=()=>{setTimeout((()=>{this.fn&&this.fn(),this._running&&e()}),this.interval)};e();break}case"RAF":{const e=t=>{requestAnimationFrame((n=>{n-t<this.interval?this._running&&e(t):(this.fn&&this.fn(),this._running&&e(n))}))};e(performance.now());break}case"Oscillator":{R||(R=new AudioContext);const e=R.createGain();let t;e.gain.value=0,e.connect(R.destination);const n=()=>{this.fn&&this.fn(),t&&t.disconnect(),t=R.createOscillator(),this._osc=t,t.connect(e),this._running&&(t.onended=n,t.start(0),t.stop(R.currentTime+this.interval/1e3))};n();break}}}stop(){this._running=!1,this._osc&&(this._osc.onended=null,this._osc=void 0)}}})(),r})()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{"use strict";n.r(r),n.d(r,{VideoExtension:()=>R});var e=n(991),t={683:()=>{},345:()=>{}},i={};function o(e){var n=i[e];if(void 0!==n)return n.exports;var r=i[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s={};(()=>{o.d(s,{A:()=>$_,G:()=>J_});var e=function(){return e=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},e.apply(this,arguments)};function t(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}function n(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function r(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var i=function(){function e(e,t,n){this.NB_BUFFERS=5,this._videoFrames=[],this._nbFramesDelay=0,this._videoElement=e,this._videoCanvas=document.createElement("canvas"),this._videoCanvas.style.display="none",this._videoCanvasContext=this._videoCanvas.getContext("2d"),null!=t&&(this._videoCanvas.width=t),null!=n&&(this._videoCanvas.height=n)}return e.prototype.getNbFramesDelay=function(){return this._nbFramesDelay},e.prototype.setNbFramesDelay=function(e){e>=0&&e<this.NB_BUFFERS?this._nbFramesDelay=e:console.error("Invalid frames delay, delay must be less than ",this.NB_BUFFERS)},e.prototype.getVideoCanvas=function(){return this._videoCanvas},e.prototype.compare=function(e,t,n,r){var i=!0;return[1,50,100,1e3,2e3,3e3,5e3,9e3].forEach((function(o){o<n*r*3&&e.data[o]!=t.data[o]&&(i=!1)})),i},e.prototype.preProcessWithBuffer=function(e){for(var t=0;t<this._videoFrames.length;t++)if(this.compare(this._videoFrames[t],e,this._videoCanvas.width,this._videoCanvas.height))return!1;return this._videoFrames.length===this.NB_BUFFERS&&(this._videoFrames=this._videoFrames.slice(0,-1)),this._videoFrames=r([e],this._videoFrames,!0),!0},e.prototype.preProcess=function(){if(null==this._videoElement||0===this._videoElement.videoWidth||0===this._videoElement.videoHeight)return!1;this._videoCanvas.width===this._videoElement.videoWidth&&this._videoCanvas.height===this._videoElement.videoHeight||(this._videoFrames=[],this._videoCanvas.width=this._videoElement.videoWidth,this._videoCanvas.height=this._videoElement.videoHeight),this._videoCanvasContext.drawImage(this._videoElement,0,0,this._videoCanvas.width,this._videoCanvas.height);for(var e=this._videoCanvasContext.getImageData(0,0,this._videoCanvas.width,this._videoCanvas.height),t=0;t<this._videoFrames.length;t++)if(this.compare(this._videoFrames[t],e,this._videoCanvas.width,this._videoCanvas.height))return!1;return this._videoFrames.length===this.NB_BUFFERS&&(this._videoFrames=this._videoFrames.slice(0,-1)),this._videoFrames=r([e],this._videoFrames,!0),!0},e.prototype.postProcess=function(){if(this._nbFramesDelay>0&&this._videoFrames.length>0){var e=this._nbFramesDelay<this._videoFrames.length?this._videoFrames[this._nbFramesDelay]:this._videoFrames[this._videoFrames.length-1];this._videoCanvasContext.putImageData(e,0,0)}},e.prototype.getCameraFrame=function(){if(this._nbFramesDelay>0&&this._videoFrames.length>0)return this._nbFramesDelay<this._videoFrames.length?this._videoFrames[this._nbFramesDelay]:this._videoFrames[this._videoFrames.length-1]},e.prototype.updateDelay=function(e){e>=0&&e<this.NB_BUFFERS?this._nbFramesDelay=e:console.error("Invalid frames delay, delay must be less than ",this.NB_BUFFERS)},e.prototype.getLastBuffer=function(){return this._videoFrames.length>0?this._videoFrames[0]:null},e.prototype.setOverlapingImage=function(e){this._videoCanvasContext.putImageData(e,10,10)},e}(),a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)};function c(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function u(e){return"function"==typeof e}var l=!1,d={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){e&&(new Error).stack,l=e},get useDeprecatedSynchronousErrorHandling(){return l}};function h(e){setTimeout((function(){throw e}),0)}var p={closed:!0,next:function(e){},error:function(e){if(d.useDeprecatedSynchronousErrorHandling)throw e;h(e)},complete:function(){}},f=Array.isArray||function(e){return e&&"number"==typeof e.length};function A(e){return null!==e&&"object"==typeof e}var E=function(){function e(e){return Error.call(this),this.message=e?e.length+" errors occurred during unsubscription:\n"+e.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),g=E,_=function(){function e(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}return e.prototype.unsubscribe=function(){var t;if(!this.closed){var n=this,r=n._parentOrParents,i=n._ctorUnsubscribe,o=n._unsubscribe,s=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof e)r.remove(this);else if(null!==r)for(var a=0;a<r.length;++a)r[a].remove(this);if(u(o)){i&&(this._unsubscribe=void 0);try{o.call(this)}catch(e){t=e instanceof g?m(e.errors):[e]}}if(f(s)){a=-1;for(var c=s.length;++a<c;){var l=s[a];if(A(l))try{l.unsubscribe()}catch(e){t=t||[],e instanceof g?t=t.concat(m(e.errors)):t.push(e)}}}if(t)throw new g(t)}},e.prototype.add=function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},e.prototype.remove=function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}},e.EMPTY=function(e){return e.closed=!0,e}(new e),e}();function m(e){return e.reduce((function(e,t){return e.concat(t instanceof g?t.errors:t)}),[])}var I="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),T=function(e){function t(n,r,i){var o=e.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=p;break;case 1:if(!n){o.destination=p;break}if("object"==typeof n){n instanceof t?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new R(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new R(o,n,r,i)}return o}return c(t,e),t.prototype[I]=function(){return this},t.create=function(e,n,r){var i=new t(e,n,r);return i.syncErrorThrowable=!1,i},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this))},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){this.destination.error(e),this.unsubscribe()},t.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},t.prototype._unsubscribeAndRecycle=function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this},t}(_),R=function(e){function t(t,n,r,i){var o,s=e.call(this)||this;s._parentSubscriber=t;var a=s;return u(n)?o=n:n&&(o=n.next,r=n.error,i=n.complete,n!==p&&(u((a=Object.create(n)).unsubscribe)&&s.add(a.unsubscribe.bind(a)),a.unsubscribe=s.unsubscribe.bind(s))),s._context=a,s._next=o,s._error=r,s._complete=i,s}return c(t,e),t.prototype.next=function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;d.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}},t.prototype.error=function(e){if(!this.isStopped){var t=this._parentSubscriber,n=d.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):h(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;h(e)}}},t.prototype.complete=function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};d.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},t.prototype.__tryOrUnsub=function(e,t){try{e.call(this._context,t)}catch(e){if(this.unsubscribe(),d.useDeprecatedSynchronousErrorHandling)throw e;h(e)}},t.prototype.__tryOrSetError=function(e,t,n){if(!d.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(t){return d.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=t,e.syncErrorThrown=!0,!0):(h(t),!0)}return!1},t.prototype._unsubscribe=function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()},t}(T),v="function"==typeof Symbol&&Symbol.observable||"@@observable";function y(e){return e}function S(e){return 0===e.length?y:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var C=function(){function e(e){this._isScalar=!1,e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r=this.operator,i=function(e,t,n){if(e){if(e instanceof T)return e;if(e[I])return e[I]()}return e||t||n?new T(e,t,n):new T(p)}(e,t,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||d.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),d.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){d.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,r=t.destination,i=t.isStopped;if(n||i)return!1;e=r&&r instanceof T?r:null}return!0}(e)?e.error(t):console.warn(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=O(t))((function(t,r){var i;i=n.subscribe((function(t){try{e(t)}catch(e){r(e),i&&i.unsubscribe()}}),r,t)}))},e.prototype._subscribe=function(e){var t=this.source;return t&&t.subscribe(e)},e.prototype[v]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?this:S(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=O(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))},e.create=function(t){return new e(t)},e}();function O(e){if(e||(e=d.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var b=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}},w="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",N=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function D(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var L=function(e){if(e&&"function"==typeof e[v])return r=e,function(e){var t=r[v]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(N(e))return b(e);if(D(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,h),e};if(e&&"function"==typeof e[w])return t=e,function(e){for(var n=t[w]();;){var r=void 0;try{r=n.next()}catch(t){return e.error(t),e}if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,r,i=A(e)?"an invalid object":"'"+e+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")},P=function(e){function t(t){var n=e.call(this)||this;return n.parent=t,n}return c(t,e),t.prototype._next=function(e){this.parent.notifyNext(e)},t.prototype._error=function(e){this.parent.notifyError(e),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},t}(T),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.notifyNext=function(e){this.destination.next(e)},t.prototype.notifyError=function(e){this.destination.error(e)},t.prototype.notifyComplete=function(){this.destination.complete()},t}(T);function x(e){return e&&"function"==typeof e.schedule}var M=function(e){function t(t,n,r){var i=e.call(this)||this;return i.parent=t,i.outerValue=n,i.outerIndex=r,i.index=0,i}return c(t,e),t.prototype._next=function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)},t.prototype._error=function(e){this.parent.notifyError(e,this),this.unsubscribe()},t.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},t}(T);function U(e,t,n,r,i){if(void 0===i&&(i=new M(e,n,r)),!i.closed)return t instanceof C?t.subscribe(i):L(t)(i)}var B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return c(t,e),t.prototype.notifyNext=function(e,t,n,r,i){this.destination.next(t)},t.prototype.notifyError=function(e,t){this.destination.error(e)},t.prototype.notifyComplete=function(e){this.destination.complete()},t}(T);function F(e,t){return new C((function(n){var r=new _,i=0;return r.add(t.schedule((function(){i!==e.length?(n.next(e[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function V(e,t){return t?F(e,t):new C(b(e))}var G={};function Q(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=void 0,r=void 0;return x(e[e.length-1])&&(r=e.pop()),"function"==typeof e[e.length-1]&&(n=e.pop()),1===e.length&&f(e[0])&&(e=e[0]),V(e,r).lift(new j(n))}var j=function(){function e(e){this.resultSelector=e}return e.prototype.call=function(e,t){return t.subscribe(new H(e,this.resultSelector))},e}(),H=function(e){function t(t,n){var r=e.call(this,t)||this;return r.resultSelector=n,r.active=0,r.values=[],r.observables=[],r}return c(t,e),t.prototype._next=function(e){this.values.push(G),this.observables.push(e)},t.prototype._complete=function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(U(this,r,void 0,n))}}},t.prototype.notifyComplete=function(e){0==(this.active-=1)&&this.destination.complete()},t.prototype.notifyNext=function(e,t,n){var r=this.values,i=r[n],o=this.toRespond?i===G?--this.toRespond:this.toRespond:0;r[n]=t,0===o&&(this.resultSelector?this._tryResultSelector(r):this.destination.next(r.slice()))},t.prototype._tryResultSelector=function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(B);function W(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[v]}(e))return function(e,t){return new C((function(n){var r=new _;return r.add(t.schedule((function(){var i=e[v]();r.add(i.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}(e,t);if(D(e))return function(e,t){return new C((function(n){var r=new _;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}(e,t);if(N(e))return F(e,t);if(function(e){return e&&"function"==typeof e[w]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new C((function(n){var r,i=new _;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(t.schedule((function(){r=e[w](),i.add(t.schedule((function(){if(!n.closed){var e,t;try{var i=r.next();e=i.value,t=i.done}catch(e){return void n.error(e)}t?n.complete():(n.next(e),this.schedule())}})))}))),i}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof C?e:new C(L(e))}function Y(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[e.length-1];return x(n)?(e.pop(),F(e,n)):V(e)}function K(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new $(e,t))}}var $=function(){function e(e,t){this.project=e,this.thisArg=t}return e.prototype.call=function(e,t){return t.subscribe(new z(e,this.project,this.thisArg))},e}(),z=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return c(t,e),t.prototype._next=function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(e){return void this.destination.error(e)}this.destination.next(t)},t}(T),q=new C((function(e){return e.complete()}));function J(e,t){return new C(t?function(n){return t.schedule(X,0,{error:e,subscriber:n})}:function(t){return t.error(e)})}function X(e){var t=e.error;e.subscriber.error(t)}function Z(e){return function(t){return t.lift(new ee(e))}}var ee=function(){function e(e){this.callback=e}return e.prototype.call=function(e,t){return t.subscribe(new te(e,this.callback))},e}(),te=function(e){function t(t,n){var r=e.call(this,t)||this;return r.add(new _(n)),r}return c(t,e),t}(T),ne=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),re=function(e){function t(t,n){var r=e.call(this)||this;return r.subject=t,r.subscriber=n,r.closed=!1,r}return c(t,e),t.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}},t}(_),ie=function(e){function t(t){var n=e.call(this,t)||this;return n.destination=t,n}return c(t,e),t}(T),oe=function(e){function t(){var t=e.call(this)||this;return t.observers=[],t.closed=!1,t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return c(t,e),t.prototype[I]=function(){return new ie(this)},t.prototype.lift=function(e){var t=new se(this,this);return t.operator=e,t},t.prototype.next=function(e){if(this.closed)throw new ne;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].next(e)},t.prototype.error=function(e){if(this.closed)throw new ne;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),i=0;i<n;i++)r[i].error(e);this.observers.length=0},t.prototype.complete=function(){if(this.closed)throw new ne;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0},t.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},t.prototype._trySubscribe=function(t){if(this.closed)throw new ne;return e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){if(this.closed)throw new ne;return this.hasError?(e.error(this.thrownError),_.EMPTY):this.isStopped?(e.complete(),_.EMPTY):(this.observers.push(e),new re(this,e))},t.prototype.asObservable=function(){var e=new C;return e.source=this,e},t.create=function(e,t){return new se(e,t)},t}(C),se=function(e){function t(t,n){var r=e.call(this)||this;return r.destination=t,r.source=n,r}return c(t,e),t.prototype.next=function(e){var t=this.destination;t&&t.next&&t.next(e)},t.prototype.error=function(e){var t=this.destination;t&&t.error&&this.destination.error(e)},t.prototype.complete=function(){var e=this.destination;e&&e.complete&&this.destination.complete()},t.prototype._subscribe=function(e){return this.source?this.source.subscribe(e):_.EMPTY},t}(oe),ae=function(e){function t(t){var n=e.call(this)||this;return n._value=t,n}return c(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),t.prototype._subscribe=function(t){var n=e.prototype._subscribe.call(this,t);return n&&!n.closed&&t.next(this._value),n},t.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new ne;return this._value},t.prototype.next=function(t){e.prototype.next.call(this,this._value=t)},t}(oe);function ce(e){return void 0===e&&(e=-1),function(t){return t.lift(new ue(e,t))}}var ue=function(){function e(e,t){this.count=e,this.source=t}return e.prototype.call=function(e,t){return t.subscribe(new le(e,this.count,this.source))},e}(),le=function(e){function t(t,n,r){var i=e.call(this,t)||this;return i.count=n,i.source=r,i}return c(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=this.source,r=this.count;if(0===r)return e.prototype.error.call(this,t);r>-1&&(this.count=r-1),n.subscribe(this._unsubscribeAndRecycle())}},t}(T);function de(e,t){return"function"==typeof t?function(n){return n.pipe(de((function(n,r){return W(e(n,r)).pipe(K((function(e,i){return t(n,e,r,i)})))})))}:function(t){return t.lift(new he(e))}}var he=function(){function e(e){this.project=e}return e.prototype.call=function(e,t){return t.subscribe(new pe(e,this.project))},e}(),pe=function(e){function t(t,n){var r=e.call(this,t)||this;return r.project=n,r.index=0,r}return c(t,e),t.prototype._next=function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(e){return void this.destination.error(e)}this._innerSub(t)},t.prototype._innerSub=function(e){var t=this.innerSubscription;t&&t.unsubscribe();var n=new P(this),r=this.destination;r.add(n),this.innerSubscription=function(e,t){if(!t.closed){if(e instanceof C)return e.subscribe(t);var n;try{n=L(e)(t)}catch(e){t.error(e)}return n}}(e,n),this.innerSubscription!==n&&r.add(this.innerSubscription)},t.prototype._complete=function(){var t=this.innerSubscription;t&&!t.closed||e.prototype._complete.call(this),this.unsubscribe()},t.prototype._unsubscribe=function(){this.innerSubscription=void 0},t.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&e.prototype._complete.call(this)},t.prototype.notifyNext=function(e){this.destination.next(e)},t}(k);function fe(){}var Ae=function(){function e(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}return e.prototype.call=function(e,t){return t.subscribe(new Ee(e,this.nextOrObserver,this.error,this.complete))},e}(),Ee=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o._tapNext=fe,o._tapError=fe,o._tapComplete=fe,o._tapError=r||fe,o._tapComplete=i||fe,u(n)?(o._context=o,o._tapNext=n):n&&(o._context=n,o._tapNext=n.next||fe,o._tapError=n.error||fe,o._tapComplete=n.complete||fe),o}return c(t,e),t.prototype._next=function(e){try{this._tapNext.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.next(e)},t.prototype._error=function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)},t.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()},t}(T);function ge(e){return new C((function(t){var n;try{n=e()}catch(e){return void t.error(e)}return(n?W(n):q).subscribe(t)}))}var _e=void 0!==o.g?o.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function me(){throw new Error("setTimeout has not been defined")}function Ie(){throw new Error("clearTimeout has not been defined")}var Te=me,Re=Ie;function ve(e){if(Te===setTimeout)return setTimeout(e,0);if((Te===me||!Te)&&setTimeout)return Te=setTimeout,setTimeout(e,0);try{return Te(e,0)}catch(t){try{return Te.call(null,e,0)}catch(t){return Te.call(this,e,0)}}}"function"==typeof _e.setTimeout&&(Te=setTimeout),"function"==typeof _e.clearTimeout&&(Re=clearTimeout);var ye,Se=[],Ce=!1,Oe=-1;function be(){Ce&&ye&&(Ce=!1,ye.length?Se=ye.concat(Se):Oe=-1,Se.length&&we())}function we(){if(!Ce){var e=ve(be);Ce=!0;for(var t=Se.length;t;){for(ye=Se,Se=[];++Oe<t;)ye&&ye[Oe].run();Oe=-1,t=Se.length}ye=null,Ce=!1,function(e){if(Re===clearTimeout)return clearTimeout(e);if((Re===Ie||!Re)&&clearTimeout)return Re=clearTimeout,clearTimeout(e);try{Re(e)}catch(t){try{return Re.call(null,e)}catch(t){return Re.call(this,e)}}}(e)}}function Ne(e,t){this.fun=e,this.array=t}function De(){}Ne.prototype.run=function(){this.fun.apply(null,this.array)};var Le=De,Pe=De,ke=De,xe=De,Me=De,Ue=De,Be=De,Fe=_e.performance||{},Ve=Fe.now||Fe.mozNow||Fe.msNow||Fe.oNow||Fe.webkitNow||function(){return(new Date).getTime()},Ge=new Date,Qe={nextTick:function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Se.push(new Ne(e,t)),1!==Se.length||Ce||ve(we)},title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:Le,addListener:Pe,once:ke,off:xe,removeListener:Me,removeAllListeners:Ue,emit:Be,binding:function(e){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(e){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(e){var t=.001*Ve.call(Fe),n=Math.floor(t),r=Math.floor(t%1*1e9);return e&&(n-=e[0],(r-=e[1])<0&&(n--,r+=1e9)),[n,r]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Ge)/1e3}},je=Qe;class He{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class We{refCount(e){return Ye("refCount")}incRef(e){return Ye("incRef")}timerAvailable(){return!0}time(e){return Ye("time")}read(e){return Ye("read")}readSync(e){return Ye("readSync")}readToGPU(e,t){return Ye("readToGPU")}numDataIds(){return Ye("numDataIds")}disposeData(e,t){return Ye("disposeData")}write(e,t,n){return Ye("write")}move(e,t,n,r,i){return Ye("move")}memory(){return Ye("memory")}floatPrecision(){return Ye("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return Ye("dispose")}}function Ye(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function Ke(e,t,n){return Math.max(e,Math.min(t,n))}function $e(e){return e%2==0?e:e+1}function ze(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function qe(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function Je(e,t,n=""){qe(tt(e,t),(()=>n+` Shapes ${e} and ${t} must match`))}function Xe(e){qe(null!=e,(()=>"The input to the tensor constructor must be a non-null value."))}function Ze(e,t=[],n=!1){if(null==t&&(t=[]),Array.isArray(e)||ht(e)&&!n)for(let r=0;r<e.length;++r)Ze(e[r],t,n);else t.push(e);return t}function et(e){if(0===e.length)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function tt(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function nt(e){return e%1==0}function rt(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function it(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function ot(e,t=(e=>0),n){return new Promise(((r,i)=>{let o=0;const s=()=>{if(e())return void r();o++;const a=t(o);null!=n&&o>=n?i():setTimeout(s,a)};s()}))}function st(e,t){let n=1,r=-1;for(let t=0;t<e.length;++t)if(e[t]>=0)n*=e[t];else if(-1===e[t]){if(-1!==r)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${t}`);r=t}else if(e[t]<0)throw Error(`Shapes can not be < 0. Found ${e[t]} at dim ${t}`);if(-1===r){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(0===n)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);const i=e.slice();return i[r]=t/n,i}function at(e,t){const n=t.length;return qe((e=null==e?t.map(((e,t)=>t)):[].concat(e)).every((e=>e>=-n&&e<n)),(()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`)),qe(e.every((e=>nt(e))),(()=>`All values in axis param must be integers but got axis ${e}`)),e.map((e=>e<0?n+e:e))}function ct(e,t){const n=[],r=[],i=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||i?null:at(t,e).sort();let s=0;for(let t=0;t<e.length;++t){if(null!=o){if(o[s]===t&&1!==e[t])throw new Error(`Can't squeeze axis ${t} since its dim '${e[t]}' is not 1`);(null==o[s]||o[s]>t)&&1===e[t]&&(n.push(e[t]),r.push(t)),o[s]<=t&&s++}1!==e[t]&&(n.push(e[t]),r.push(t))}return{newShape:n,keptDims:r}}function ut(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error(`Unknown data type ${e}`);n=new Uint8Array(t)}return n}function lt(e,t){let n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error(`Unknown data type ${e}`);n=new Array(t)}return n}function dt(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)}function ht(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}function pt(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error(`Unknown dtype ${e}`)}function ft(e){return"string"==typeof e||e instanceof String}function At(e){return Array.isArray(e)?At(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":"number"==typeof e?"float32":ft(e)?"string":function(e){return"boolean"==typeof e}(e)?"bool":"float32"}function Et(e){return!!(e&&e.constructor&&e.call&&e.apply)}function gt(e,t){for(let n=t;n<e;++n)if(e%n==0)return n;return e}function _t(e){const t=e.length;if(t<2)return[];const n=new Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function mt(e,t,n,r=!1){const i=new Array;if(1===t.length){const o=t[0]*(r?2:1);for(let t=0;t<o;t++)i[t]=n[e+t]}else{const o=t[0],s=t.slice(1),a=s.reduce(((e,t)=>e*t))*(r?2:1);for(let t=0;t<o;t++)i[t]=mt(e+t*a,s,n,r)}return i}function It(e,t,n=!1){if(0===e.length)return t[0];const r=e.reduce(((e,t)=>e*t))*(n?2:1);if(0===r)return[];if(r!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${n?" for a complex tensor":""}.`);return mt(0,e,t,n)}function Tt(e,t){const n=Rt(e,t);for(let e=0;e<n.length;e++)n[e]=1;return n}function Rt(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function vt(e){e.forEach((t=>{qe(Number.isInteger(t)&&t>=0,(()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`))}))}function yt(e,t,n){if(0===t)return 0;if(1===t)return e[0];let r=e[e.length-1];for(let t=0;t<e.length-1;++t)r+=n[t]*e[t];return r}function St(e,t,n){if(0===t)return[];if(1===t)return[e];const r=new Array(t);for(let t=0;t<r.length-1;++t)r[t]=Math.floor(e/n[t]),e-=r[t]*n[t];return r[r.length-1]=e,r}function Ct(e){return e&&e.then&&"function"==typeof e.then}class Ot{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=bt,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(wt().getBool("IS_TEST")||wt().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){const t=this.urlFlags[e];wt().getBool("IS_TEST")||wt().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${t}.`),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(Ct(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);"tfjsflags"in e&&e.tfjsflags.split(",").forEach((e=>{const[t,n]=e.split(":");this.urlFlags[t]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error(`Could not parse value flag value ${t} for flag ${e}.`)}(t,n)}))}}function bt(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,((e,...n)=>(function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(t,n[0],n[1]),n.join("=")))),t}function wt(){return Dt}let Nt,Dt=null;function Lt(){if(null==Nt){let e;if("undefined"!=typeof window)e=window;else if(void 0!==_e)e=_e;else if(void 0!==je)e=je;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}Nt=e}return Nt}function Pt(e,t){const n=function(){const e=Lt();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);{const r=t();return n.set(e,r),n.get(e)}}function kt(...e){wt().getBool("IS_TEST")||wt().getBool("PROD")||console.warn(...e)}const xt=Pt("kernelRegistry",(()=>new Map)),Mt=Pt("gradRegistry",(()=>new Map));function Ut(e,t){const n=Gt(e,t);return xt.get(n)}function Bt(e){return Mt.get(e)}function Ft(e){const t=xt.entries(),n=[];for(;;){const{done:r,value:i}=t.next();if(r)break;const[o,s]=i,[a]=o.split("_");a===e&&n.push(s)}return n}function Vt(e){const{kernelName:t,backendName:n}=e,r=Gt(t,n);xt.has(r)&&kt(`The kernel '${t}' for backend '${n}' is already registered`),xt.set(r,e)}function Gt(e,t){return`${t}_${e}`}var Qt=Ht,jt=null;try{jt=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(qn){}function Ht(e,t,n){this.low=0|e,this.high=0|t,this.unsigned=!!n}function Wt(e){return!0===(e&&e.__isLong__)}Ht.prototype.__isLong__,Object.defineProperty(Ht.prototype,"__isLong__",{value:!0}),Ht.isLong=Wt;var Yt={},Kt={};function $t(e,t){var n,r,i;return t?(i=0<=(e>>>=0)&&e<256)&&(r=Kt[e])?r:(n=qt(e,(0|e)<0?-1:0,!0),i&&(Kt[e]=n),n):(i=-128<=(e|=0)&&e<128)&&(r=Yt[e])?r:(n=qt(e,e<0?-1:0,!1),i&&(Yt[e]=n),n)}function zt(e,t){if(isNaN(e))return t?sn:on;if(t){if(e<0)return sn;if(e>=tn)return dn}else{if(e<=-nn)return hn;if(e+1>=nn)return ln}return e<0?zt(-e,t).neg():qt(e%en|0,e/en|0,t)}function qt(e,t,n){return new Ht(e,t,n)}Ht.fromInt=$t,Ht.fromNumber=zt,Ht.fromBits=qt;var Jt=Math.pow;function Xt(e,t,n){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return on;if("number"==typeof t?(n=t,t=!1):t=!!t,(n=n||10)<2||36<n)throw RangeError("radix");var r;if((r=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===r)return Xt(e.substring(1),t,n).neg();for(var i=zt(Jt(n,8)),o=on,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),c=parseInt(e.substring(s,s+a),n);if(a<8){var u=zt(Jt(n,a));o=o.mul(u).add(zt(c))}else o=(o=o.mul(i)).add(zt(c))}return o.unsigned=t,o}function Zt(e,t){return"number"==typeof e?zt(e,t):"string"==typeof e?Xt(e,t):qt(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Ht.fromString=Xt,Ht.fromValue=Zt;var en=4294967296,tn=en*en,nn=tn/2,rn=$t(1<<24),on=$t(0);Ht.ZERO=on;var sn=$t(0,!0);Ht.UZERO=sn;var an=$t(1);Ht.ONE=an;var cn=$t(1,!0);Ht.UONE=cn;var un=$t(-1);Ht.NEG_ONE=un;var ln=qt(-1,2147483647,!1);Ht.MAX_VALUE=ln;var dn=qt(-1,-1,!0);Ht.MAX_UNSIGNED_VALUE=dn;var hn=qt(0,-2147483648,!1);Ht.MIN_VALUE=hn;var pn=Ht.prototype;pn.toInt=function(){return this.unsigned?this.low>>>0:this.low},pn.toNumber=function(){return this.unsigned?(this.high>>>0)*en+(this.low>>>0):this.high*en+(this.low>>>0)},pn.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(hn)){var t=zt(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=zt(Jt(e,6),this.unsigned),o=this,s="";;){var a=o.div(i),c=(o.sub(a.mul(i)).toInt()>>>0).toString(e);if((o=a).isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},pn.getHighBits=function(){return this.high},pn.getHighBitsUnsigned=function(){return this.high>>>0},pn.getLowBits=function(){return this.low},pn.getLowBitsUnsigned=function(){return this.low>>>0},pn.getNumBitsAbs=function(){if(this.isNegative())return this.eq(hn)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},pn.isZero=function(){return 0===this.high&&0===this.low},pn.eqz=pn.isZero,pn.isNegative=function(){return!this.unsigned&&this.high<0},pn.isPositive=function(){return this.unsigned||this.high>=0},pn.isOdd=function(){return 1==(1&this.low)},pn.isEven=function(){return 0==(1&this.low)},pn.equals=function(e){return Wt(e)||(e=Zt(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},pn.eq=pn.equals,pn.notEquals=function(e){return!this.eq(e)},pn.neq=pn.notEquals,pn.ne=pn.notEquals,pn.lessThan=function(e){return this.comp(e)<0},pn.lt=pn.lessThan,pn.lessThanOrEqual=function(e){return this.comp(e)<=0},pn.lte=pn.lessThanOrEqual,pn.le=pn.lessThanOrEqual,pn.greaterThan=function(e){return this.comp(e)>0},pn.gt=pn.greaterThan,pn.greaterThanOrEqual=function(e){return this.comp(e)>=0},pn.gte=pn.greaterThanOrEqual,pn.ge=pn.greaterThanOrEqual,pn.compare=function(e){if(Wt(e)||(e=Zt(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},pn.comp=pn.compare,pn.negate=function(){return!this.unsigned&&this.eq(hn)?hn:this.not().add(an)},pn.neg=pn.negate,pn.add=function(e){Wt(e)||(e=Zt(e));var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,a=e.low>>>16,c=0,u=0,l=0,d=0;return l+=(d+=i+(65535&e.low))>>>16,u+=(l+=r+a)>>>16,c+=(u+=n+s)>>>16,c+=t+o,qt((l&=65535)<<16|(d&=65535),(c&=65535)<<16|(u&=65535),this.unsigned)},pn.subtract=function(e){return Wt(e)||(e=Zt(e)),this.add(e.neg())},pn.sub=pn.subtract,pn.multiply=function(e){if(this.isZero())return on;if(Wt(e)||(e=Zt(e)),jt)return qt(jt.mul(this.low,this.high,e.low,e.high),jt.get_high(),this.unsigned);if(e.isZero())return on;if(this.eq(hn))return e.isOdd()?hn:on;if(e.eq(hn))return this.isOdd()?hn:on;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(rn)&&e.lt(rn))return zt(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,n=65535&this.high,r=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,a=e.low>>>16,c=65535&e.low,u=0,l=0,d=0,h=0;return d+=(h+=i*c)>>>16,l+=(d+=r*c)>>>16,d&=65535,l+=(d+=i*a)>>>16,u+=(l+=n*c)>>>16,l&=65535,u+=(l+=r*a)>>>16,l&=65535,u+=(l+=i*s)>>>16,u+=t*c+n*a+r*s+i*o,qt((d&=65535)<<16|(h&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},pn.mul=pn.multiply,pn.divide=function(e){if(Wt(e)||(e=Zt(e)),e.isZero())throw Error("division by zero");var t,n,r;if(jt)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?qt((this.unsigned?jt.div_u:jt.div_s)(this.low,this.high,e.low,e.high),jt.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?sn:on;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return sn;if(e.gt(this.shru(1)))return cn;r=sn}else{if(this.eq(hn))return e.eq(an)||e.eq(un)?hn:e.eq(hn)?an:(t=this.shr(1).div(e).shl(1)).eq(on)?e.isNegative()?an:un:(n=this.sub(e.mul(t)),r=t.add(n.div(e)));if(e.eq(hn))return this.unsigned?sn:on;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();r=on}for(n=this;n.gte(e);){t=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:Jt(2,i-48),s=zt(t),a=s.mul(e);a.isNegative()||a.gt(n);)a=(s=zt(t-=o,this.unsigned)).mul(e);s.isZero()&&(s=an),r=r.add(s),n=n.sub(a)}return r},pn.div=pn.divide,pn.modulo=function(e){return Wt(e)||(e=Zt(e)),jt?qt((this.unsigned?jt.rem_u:jt.rem_s)(this.low,this.high,e.low,e.high),jt.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},pn.mod=pn.modulo,pn.rem=pn.modulo,pn.not=function(){return qt(~this.low,~this.high,this.unsigned)},pn.and=function(e){return Wt(e)||(e=Zt(e)),qt(this.low&e.low,this.high&e.high,this.unsigned)},pn.or=function(e){return Wt(e)||(e=Zt(e)),qt(this.low|e.low,this.high|e.high,this.unsigned)},pn.xor=function(e){return Wt(e)||(e=Zt(e)),qt(this.low^e.low,this.high^e.high,this.unsigned)},pn.shiftLeft=function(e){return Wt(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?qt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):qt(0,this.low<<e-32,this.unsigned)},pn.shl=pn.shiftLeft,pn.shiftRight=function(e){return Wt(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?qt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):qt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},pn.shr=pn.shiftRight,pn.shiftRightUnsigned=function(e){if(Wt(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?qt(this.low>>>e|t<<32-e,t>>>e,this.unsigned):qt(32===e?t:t>>>e-32,0,this.unsigned)},pn.shru=pn.shiftRightUnsigned,pn.shr_u=pn.shiftRightUnsigned,pn.toSigned=function(){return this.unsigned?qt(this.low,this.high,!1):this},pn.toUnsigned=function(){return this.unsigned?this:qt(this.low,this.high,!0)},pn.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},pn.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},pn.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Ht.fromBytes=function(e,t,n){return n?Ht.fromBytesLE(e,t):Ht.fromBytesBE(e,t)},Ht.fromBytesLE=function(e,t){return new Ht(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Ht.fromBytesBE=function(e,t){return new Ht(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const fn=Qt||function(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){if("default"!==n&&!(n in e)){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}}))})),Object.freeze(e)}({__proto__:null,default:Qt},[Qt]);function An(e){return fn.fromString(e,!0,16)}const En=An("c3a5c85c97cb3127"),gn=An("b492b66fbe98f273"),_n=An("9ae16a3b2f90404f");function mn(e){return e.xor(e.shru(47))}function In(e,t,n){const r=e.slice(t,t+n);return fn.fromBytes(Array.from(r),!0,!0)}function Tn(e,t){return In(e,t,8)}function Rn(e,t){return In(e,t,4)}function vn(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function yn(e,t,n=An("9ddfea08eb382d69")){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function Sn(e,t,n,r){return function(e,t,n,r,i,o){i=i.add(e),o=vn(o.add(i).add(r),21);const s=i;return i=(i=i.add(t)).add(n),o=o.add(vn(i,44)),[i.add(r),o.add(s)]}(Tn(e,t),Tn(e,t+8),Tn(e,t+16),Tn(e,t+24),n,r)}function Cn(e,t=e.length){const n=fn.fromNumber(81,!0);if(t<=32)return t<=16?function(e,t=e.length){if(t>=8){const n=_n.add(2*t),r=Tn(e,0).add(_n),i=Tn(e,t-8);return yn(vn(i,37).mul(n).add(r),vn(r,25).add(i).mul(n),n)}if(t>=4){const n=_n.add(2*t);return yn(Rn(e,0).shl(3).add(t),Rn(e,t-4),n)}if(t>0){const n=e[0]+(e[t>>1]<<8),r=t+(e[t-1]<<2);return mn(_n.mul(n).xor(En.mul(r))).mul(_n)}return _n}(e,t):function(e,t=e.length){const n=_n.add(2*t),r=Tn(e,0).mul(gn),i=Tn(e,8),o=Tn(e,t-8).mul(n),s=Tn(e,t-16).mul(_n);return yn(vn(r.add(i),43).add(vn(o,30)).add(s),r.add(vn(i.add(_n),18)).add(o),n)}(e,t);if(t<=64)return function(e,t=e.length){const n=_n.add(2*t),r=Tn(e,0).mul(_n),i=Tn(e,8),o=Tn(e,t-8).mul(n),s=Tn(e,t-16).mul(_n),a=vn(r.add(i),43).add(vn(o,30)).add(s),c=yn(a,r.add(vn(i.add(_n),18)).add(o),n),u=Tn(e,16).mul(n),l=Tn(e,24),d=a.add(Tn(e,t-32)).mul(n),h=c.add(Tn(e,t-24)).mul(n);return yn(vn(u.add(l),43).add(vn(d,30)).add(h),u.add(vn(l.add(r),18)).add(d),n)}(e,t);let r=n,i=n.mul(gn).add(113),o=mn(i.mul(_n).add(113)).mul(_n),s=[fn.UZERO,fn.UZERO],a=[fn.UZERO,fn.UZERO];r=r.mul(_n).add(Tn(e,0));let c=0;const u=64*(t-1>>6),l=u+(t-1&63)-63;do{r=vn(r.add(i).add(s[0]).add(Tn(e,c+8)),37).mul(gn),i=vn(i.add(s[1]).add(Tn(e,c+48)),42).mul(gn),r=r.xor(a[1]),i=i.add(s[0]).add(Tn(e,c+40)),o=vn(o.add(a[0]),33).mul(gn),s=Sn(e,c,s[1].mul(gn),r.add(a[0])),a=Sn(e,c+32,o.add(a[1]),i.add(Tn(e,c+16))),[o,r]=[r,o],c+=64}while(c!==u);const d=gn.add(o.and(255).shl(1));return c=l,a[0]=a[0].add(t-1&63),s[0]=s[0].add(a[0]),a[0]=a[0].add(s[0]),r=vn(r.add(i).add(s[0]).add(Tn(e,c+8)),37).mul(d),i=vn(i.add(s[1]).add(Tn(e,c+48)),42).mul(d),r=r.xor(a[1].mul(9)),i=i.add(s[0].mul(9).add(Tn(e,c+40))),o=vn(o.add(a[0]),33).mul(d),s=Sn(e,c,s[1].mul(d),r.add(a[0])),a=Sn(e,c+32,o.add(a[1]),i.add(Tn(e,c+16))),[o,r]=[r,o],yn(yn(s[0],a[0],d).add(mn(i).mul(En)).add(o),yn(s[1],a[1],d).add(r),d)}function On(e,t){return"string"===t?Nn(e):bn([e],t)}function bn(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Ze(e)),wt().getBool("DEBUG")&&function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)0!==Math.round(e[n])&&(t[n]=1);return t}throw new Error(`Unknown data type ${t}`)}function wn(){return wt().platform.now()}function Nn(e,t="utf-8"){return t=t||"utf-8",wt().platform.encode(e,t)}function Dn(e,t="utf-8"){return t=t||"utf-8",wt().platform.decode(e,t)}class Ln{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new kn)}profileKernel(e,t,n){let r;const i=()=>{r=n()};let o;const s=wn();if(this.backendTimer.timerAvailable())o=this.backendTimer.time(i);else{i();for(const e of r)e.dataSync();o=Promise.resolve({kernelMs:wn()-s})}if(wt().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let t=0;t<r.length;t++){const n=r[t];n.data().then((t=>{Pn(t,n.dtype,e)}))}return{kernelName:e,outputs:r,inputs:t,timeMs:o.then((e=>e.kernelMs)),extraInfo:o.then((e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""))}}logKernelProfile(e){const{kernelName:t,outputs:n,timeMs:r,inputs:i,extraInfo:o}=e;n.forEach((e=>{Promise.all([e.data(),r,o]).then((n=>{this.logger.logKernelProfile(t,e,n[0],n[1],i,n[2])}))}))}}function Pn(e,t,n){if("float32"!==t)return!1;for(let t=0;t<e.length;t++){const r=e[t];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class kn{logKernelProfile(e,t,n,r,i,o){const s="number"==typeof r?it(`${r}ms`,9):r.error,a=it(e,25),c=t.rank,u=t.size,l=it(t.shape.toString(),14);let d="";for(const e in i){const n=i[e];if(null!=n){const r=n.shape||t.shape,i=r.length;d+=`${e}: ${i}D ${i>0?r:""} `}}console.log(`%c${a}\t%c${s}\t%c${c}D ${l}\t%c${u}\t%c${d}\t%c${o}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}function xn(e,t,n,r){const i=_t(t),o=function(e,t,n,r){const i=et(t),o=r[r.length-1],s=new Array(o).fill(0),a=t.length,c="complex64"===n?Fn(e):e;if(a>1)for(let e=0;e<i/o;e++){const t=e*o;for(let e=0;e<o;e++)s[e]=Math.max(s[e],Mn(c[t+e],0,n).length)}return s}(e,t,n,i),s=t.length,a=Bn(e,t,n,i,o),c=["Tensor"];return r&&(c.push(`  dtype: ${n}`),c.push(`  rank: ${s}`),c.push(`  shape: [${t}]`),c.push("  values:")),c.push(a.map((e=>"    "+e)).join("\n")),c.join("\n")}function Mn(e,t,n){let r;return r=Array.isArray(e)?`${parseFloat(e[0].toFixed(7))} + ${parseFloat(e[1].toFixed(7))}j`:ft(e)?`'${e}'`:"bool"===n?Un(e):parseFloat(e.toFixed(7)).toString(),it(r,t)}function Un(e){return 0===e?"false":"true"}function Bn(e,t,n,r,i,o=!0){const s="complex64"===n?2:1,a=t[0],c=t.length;if(0===c)return"complex64"===n?[Mn(Fn(e)[0],0,n)]:"bool"===n?[Un(e[0])]:[e[0].toString()];if(1===c){if(a>20){const t=3*s;let r=Array.from(e.slice(0,t)),o=Array.from(e.slice((a-3)*s,a*s));return"complex64"===n&&(r=Fn(r),o=Fn(o)),["["+r.map(((e,t)=>Mn(e,i[t],n))).join(", ")+", ..., "+o.map(((e,t)=>Mn(e,i[a-3+t],n))).join(", ")+"]"]}return["["+("complex64"===n?Fn(e):Array.from(e)).map(((e,t)=>Mn(e,i[t],n))).join(", ")+"]"]}const u=t.slice(1),l=r.slice(1),d=r[0]*s,h=[];if(a>20){for(let t=0;t<3;t++){const r=t*d,o=r+d;h.push(...Bn(e.slice(r,o),u,n,l,i,!1))}h.push("...");for(let t=a-3;t<a;t++){const r=t*d,o=r+d;h.push(...Bn(e.slice(r,o),u,n,l,i,t===a-1))}}else for(let t=0;t<a;t++){const r=t*d,o=r+d;h.push(...Bn(e.slice(r,o),u,n,l,i,t===a-1))}const p=2===c?",":"";h[0]="["+h[0]+p;for(let e=1;e<h.length-1;e++)h[e]=" "+h[e]+p;let f=",\n";for(let e=2;e<c;e++)f+="\n";return h[h.length-1]=" "+h[h.length-1]+"]"+(o?"":f),h}function Fn(e){const t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}class Vn{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=et(e),null!=n){const e=n.length;qe(e===this.size,(()=>`Length of values '${e}' does not match the size inferred by the shape '${this.size}'.`))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||lt(t,this.size),this.strides=_t(e)}set(e,...t){0===t.length&&(t=[0]),qe(t.length===this.rank,(()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`));const n=this.locToIndex(t);this.values[n]=e}get(...e){0===e.length&&(e=[0]);let t=0;for(const n of e){if(n<0||n>=this.shape[t]){const t=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(t)}t++}let n=e[e.length-1];for(let t=0;t<e.length-1;++t)n+=this.strides[t]*e[t];return this.values[n]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Gn().makeTensor(this.values,this.shape,this.dtype)}}let Gn=null,Qn=null;class jn{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=et(e),this.strides=_t(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Qn.buffer(this.shape,this.dtype,e)}bufferSync(){return Qn.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return It(this.shape,e,"complex64"===this.dtype)}arraySync(){return It(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=Gn().read(this.dataId);if("string"===this.dtype){const t=await e;try{return t.map((e=>Dn(e)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Gn().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Gn().readSync(this.dataId);if("string"===this.dtype)try{return e.map((e=>Dn(e)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Gn().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(Gn().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Qn.print(this,e)}clone(){return this.throwIfDisposed(),Qn.clone(this)}toString(e=!1){return xn(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Qn.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),Gn().makeVariable(this,e,t,n)}}Object.defineProperty(jn,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),Pt("Tensor",(()=>jn));class Hn extends jn{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!tt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Gn().disposeTensor(this),this.dataId=e.dataId,Gn().incRef(this,null)}dispose(){Gn().disposeVariable(this),this.isDisposedInternal=!0}}var Wn,Yn,Kn,$n,zn,qn;Object.defineProperty(Hn,Symbol.hasInstance,{value:e=>e instanceof jn&&null!=e.assign&&e.assign instanceof Function}),(qn=Wn||(Wn={})).R0="R0",qn.R1="R1",qn.R2="R2",qn.R3="R3",qn.R4="R4",qn.R5="R5",qn.R6="R6",function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Yn||(Yn={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Kn||(Kn={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}($n||($n={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(zn||(zn={}));const Jn={float32:$n,int32:Yn,bool:Kn,complex64:zn};function Xn(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return Jn[e][t]}function Zn(e,t){if(e.dtype===t.dtype)return[e,t];const n=Xn(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function er(e){const t=[];return tr(e,t,new Set),t}function tr(e,t,n){if(null==e)return;if(e instanceof jn)return void t.push(e);if(r=e,!Array.isArray(r)&&"object"!=typeof r)return;var r;const i=e;for(const e in i){const r=i[e];n.has(r)||(n.add(r),tr(r,t,n))}}function nr(e){return null!=e.kernelName}class rr{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((e=>e.name))))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class ir{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new rr}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t];if(await this.initializeBackend(n).success)return void await this.setBackend(n)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(kt(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Ln(this.backendInstance),!0}setupRegisteredKernels(){Ft(this.backendName).forEach((e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(e){Ft(e).forEach((t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])}))}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const n=t.factory();if(!n||n instanceof We||"function"!=typeof n.then)return this.registry[e]=n,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,r=n.then((n=>!(t<this.pendingBackendInitId||(this.registry[e]=n,this.pendingBackendInit=null,0)))).catch((n=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,kt(`Initialization of backend ${e} failed`),kt(n.stack||n.message)),!1)));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}}catch(t){return kt(`Initialization of backend ${e} failed`),kt(t.stack||t.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority))}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const n=e[t],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const n=this.state.tensorInfo.get(t),r=n.backend,i=this.readSync(t),o=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,i,n.shape,n.dtype,o),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n,r=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}return this.scopedRun((()=>this.startScope(r)),(()=>this.endScope(n)),(()=>(n=t(),n instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n)))}scopedRun(e,t,n){e();try{const e=n();return t(),e}catch(e){throw t(),e}}nextTensorId(){return ir.nextTensorId++}nextVariableId(){return ir.nextVariableId++}clone(e){const t=sr.runKernel("Identity",{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(e=>({x:()=>{const t={x:e};return sr.runKernel("Cast",t,{dtype:"float32"})}})),[],{}),t}runKernel(e,t,n){if(null==this.backendName&&this.backend,null==Ut(e,this.backendName))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,n){const r=this.backend.numDataIds();let i=0;n.forEach((e=>{i+="complex64"===e.dtype?3:1}));const o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=r-t-i-o;if(s>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${s} data ids) after running '${e}'`)}runKernelFunc(e){let t,n=[];const r=this.isTapeOn(),i=this.state.numBytes,o=this.state.numTensors;let s,a;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const c=nr(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(nr(e)){const{kernelName:t,inputs:i,attrs:o}=e;null==this.backendName&&this.backend;const c=Ut(t,this.backendName);qe(null!=c,(()=>`Cannot find registered kernel '${t}' for backend '${this.backendName}'`)),s=()=>{const e=this.backend.numDataIds();a=c.kernelFunc({inputs:i,attrs:o,backend:this.backend});const s=Array.isArray(a)?a:[a];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,s);const u=s.map((e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e)));if(r){const e=this.getTensorsForGradient(t,i,u);n=this.saveTensorsForBackwardMode(e)}return u}}else{const{forwardFunc:t}=e,i=e=>{r&&(n=e.map((e=>this.keep(this.clone(e)))))};s=()=>{const e=this.backend.numDataIds();a=this.tidy((()=>t(this.backend,i)));const n=Array.isArray(a)?a:[a];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,e,n),n}}const{inputs:u,attrs:l}=e,d=nr(e)?null:e.backwardsFunc;let h;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(h=this.profiler.profileKernel(c,u,(()=>s())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),t=h.outputs):t=s()})),r&&this.addTapeNode(c,u,t,d,n,l),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-o,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map((e=>null!=u[e]?u[e].shape:null)),outputShapes:t.map((e=>e.shape)),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(a)?t:t[0]}saveTensorsForBackwardMode(e){return e.map((e=>this.keep(this.clone(e))))}getTensorsForGradient(e,t,n){const r=Bt(e);if(null!=r){const e=r.inputsToSave||[],i=r.outputsToSave||[];let o;r.saveAllInputs?(qe(Array.isArray(t),(()=>"saveAllInputs is true, expected inputs to be an array.")),o=Object.keys(t).map((e=>t[e]))):o=e.map((e=>t[e]));const s=n.filter(((e,t)=>i[t]));return o.concat(s)}return[]}makeTensor(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;let i=e;"string"===n&&ft(e[0])&&(i=e.map((e=>Nn(e))));const o=r.write(i,t,n),s=new jn(t,n,o,this.nextTensorId());if(this.trackTensor(s,r),"string"===n){const e=this.state.tensorInfo.get(o),t=function(e){if(null==e)return 0;let t=0;return e.forEach((e=>t+=e.length)),t}(i);this.state.numBytes+=t-e.bytes,e.bytes=t}return s}makeTensorFromDataId(e,t,n,r){const i={dataId:e,shape:t,dtype:n=n||"float32"};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,t){const{dataId:n,shape:r,dtype:i}=e,o=new jn(r,i,n,this.nextTensorId());return this.trackTensor(o,t),o}makeVariable(e,t=!0,n,r){n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));const i=new Hn(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[i.name])throw new Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*pt(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof Hn||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*pt(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((e=>e.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(const e of this.state.activeProfile.kernels)e.kernelTimeMs=await e.kernelTimeMs,e.extraInfo=await e.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,n,r,i,o){const s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:i},a=Bt(e);null!=a&&(r=a.gradFunc),null!=r&&(s.gradient=e=>(e=e.map(((e,t)=>{if(null==e){const e=n[t],r=Rt(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e})),r(e.length>1?e:e[0],i,o))),this.state.activeTape.push(s)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=er(e),n=new Set(t.map((e=>e.id)));for(let e=0;e<this.state.activeScope.track.length;e++){const t=this.state.activeScope.track[e];t.kept||n.has(t.id)||t.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach((e=>{e.kept||e.scopeId!==r.id||this.track(e)}))}gradients(e,t,n,r=!1){if(qe(t.length>0,(()=>"gradients() received an empty list of xs.")),null!=n&&"float32"!==n.dtype)throw new Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);const i=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",e)));qe(i instanceof jn,(()=>"The result y returned by f() must be a tensor."));const o=function(e,t,n){const r={},i={};for(let e=0;e<t.length;e++)r[t[e].id]=!0;for(let n=0;n<e.length;n++){const o=e[n],s=o.inputs;for(const e in s){const n=s[e];let a=!1;for(let e=0;e<t.length;e++)if(r[n.id]){o.outputs.forEach((e=>r[e.id]=!0)),a=!0,i[o.id]=!0;break}if(a)break}}const o={};o[n.id]=!0;const s={};for(let t=e.length-1;t>=0;t--){const n=e[t],r=n.inputs;for(let e=0;e<n.outputs.length;e++)if(o[n.outputs[e].id]){for(const e in r)o[r[e].id]=!0,s[n.id]=!0;break}}const a=[];for(let t=0;t<e.length;t++){const n=e[t];if(i[n.id]&&s[n.id]){const e={};for(const t in n.inputs){const i=n.inputs[t];r[i.id]&&(e[t]=i)}const t=Object.assign({},n);t.inputs=e,t.outputs=n.outputs,a.push(t)}}return a}(this.state.activeTape,t,i);if(!r&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const e={};e[i.id]=null==n?function(e){const t=Tt(et(e),"float32");return sr.makeTensor(t,e,"float32")}(i.shape):n,function(e,t,n,r){for(let i=t.length-1;i>=0;i--){const o=t[i],s=[];if(o.outputs.forEach((t=>{const n=e[t.id];null!=n?s.push(n):s.push(null)})),null==o.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(s);for(const t in o.inputs){if(!(t in a))throw new Error(`Cannot backprop through input ${t}. Available gradients found: ${Object.keys(a)}.`);const i=n((()=>a[t]()));if("float32"!==i.dtype)throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${t} must have 'float32' dtype, but has '${i.dtype}'`);const s=o.inputs[t];if(!tt(i.shape,s.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${t}' has shape '${i.shape}', which does not match the shape of the input '${s.shape}'`);if(null==e[s.id])e[s.id]=i;else{const t=e[s.id];e[s.id]=r(t,i),t.dispose()}}}}(e,o,(e=>this.tidy(e)),ar);const r=t.map((t=>e[t.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((e=>{for(const t of e.saved)t.dispose()})),this.state.activeTape=null),{value:i,grads:r}}))}customGrad(e){return qe(Et(e),(()=>"The f passed in customGrad(f) must be a function.")),(...t)=>{let n;qe(t.every((e=>e instanceof jn)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const r={};return t.forEach(((e,t)=>{r[t]=e})),this.runKernelFunc({forwardFunc:(r,i)=>(n=e(...t,i),qe(n.value instanceof jn,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),qe(Et(n.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),n.value),backwardsFunc:(e,r)=>{const i=n.gradFunc(e,r),o=Array.isArray(i)?i:[i];qe(o.length===t.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),qe(o.every((e=>e instanceof jn)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const s={};return o.forEach(((e,t)=>{s[t]=()=>e})),s},inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=wn(),n=await this.backend.time(e);return n.wallMs=wn()-t,n}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new rr;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function or(){const e=Lt();if(null==e._tfengine){const t=new Ot(e);e._tfengine=new ir(t)}var t;return t=e._tfengine.ENV,Dt=t,Gn=()=>e._tfengine,e._tfengine}ir.nextTensorId=0,ir.nextVariableId=0;const sr=or();function ar(e,t){const n={a:e,b:t};return sr.runKernel("Add",n)}function cr(e){if(e||"undefined"!=typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;const t=e.userAgent||e.vendor||("undefined"!=typeof window?window.opera:"");if(!t){const t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function ur(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}const lr=wt();lr.registerFlag("DEBUG",(()=>!1),(e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),lr.registerFlag("IS_BROWSER",(()=>ur())),lr.registerFlag("IS_NODE",(()=>void 0!==je&&void 0!==je.versions&&void 0!==je.versions.node)),lr.registerFlag("IS_CHROME",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),lr.registerFlag("PROD",(()=>!1)),lr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>lr.getBool("DEBUG"))),lr.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),lr.registerFlag("IS_TEST",(()=>!1)),lr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>!0)),lr.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),lr.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1));var dr=[],hr=[],pr="undefined"!=typeof Uint8Array?Uint8Array:Array,fr=!1;function Ar(){fr=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0,n=e.length;t<n;++t)dr[t]=e[t],hr[e.charCodeAt(t)]=t;hr["-".charCodeAt(0)]=62,hr["_".charCodeAt(0)]=63}function Er(e,t,n){for(var r,i,o=[],s=t;s<n;s+=3)r=(e[s]<<16)+(e[s+1]<<8)+e[s+2],o.push(dr[(i=r)>>18&63]+dr[i>>12&63]+dr[i>>6&63]+dr[63&i]);return o.join("")}function gr(e){var t;fr||Ar();for(var n=e.length,r=n%3,i="",o=[],s=16383,a=0,c=n-r;a<c;a+=s)o.push(Er(e,a,a+s>c?c:a+s));return 1===r?(t=e[n-1],i+=dr[t>>2],i+=dr[t<<4&63],i+="=="):2===r&&(t=(e[n-2]<<8)+e[n-1],i+=dr[t>>10],i+=dr[t>>4&63],i+=dr[t<<2&63],i+="="),o.push(i),o.join("")}function _r(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,d=n?i-1:0,h=n?-1:1,p=e[t+d];for(d+=h,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+e[t+d],d+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+e[t+d],d+=h,l-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),o-=u}return(p?-1:1)*s*Math.pow(2,o-r)}function mr(e,t,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,d=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,f=r?1:-1,A=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=l?(a=0,s=l):s+d>=1?(a=(t*c-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[n+p]=255&a,p+=f,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[n+p]=255&s,p+=f,s/=256,u-=8);e[n+p-f]|=128*A}var Ir={}.toString,Tr=Array.isArray||function(e){return"[object Array]"==Ir.call(e)};function Rr(){return yr.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function vr(e,t){if(Rr()<t)throw new RangeError("Invalid typed array length");return yr.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=yr.prototype:(null===e&&(e=new yr(t)),e.length=t),e}function yr(e,t,n){if(!(yr.TYPED_ARRAY_SUPPORT||this instanceof yr))return new yr(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return Or(this,e)}return Sr(this,e,t,n)}function Sr(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),yr.TYPED_ARRAY_SUPPORT?(e=t).__proto__=yr.prototype:e=br(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!yr.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|Dr(t,n),i=(e=vr(e,r)).write(t,n);return i!==r&&(e=e.slice(0,i)),e}(e,t,n):function(e,t){if(Nr(t)){var n=0|wr(t.length);return 0===(e=vr(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?vr(e,0):br(e,t);if("Buffer"===t.type&&Tr(t.data))return br(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function Cr(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function Or(e,t){if(Cr(t),e=vr(e,t<0?0:0|wr(t)),!yr.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function br(e,t){var n=t.length<0?0:0|wr(t.length);e=vr(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function wr(e){if(e>=Rr())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Rr().toString(16)+" bytes");return 0|e}function Nr(e){return!(null==e||!e._isBuffer)}function Dr(e,t){if(Nr(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return ri(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ii(e).length;default:if(r)return ri(e).length;t=(""+t).toLowerCase(),r=!0}}function Lr(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Yr(this,t,n);case"utf8":case"utf-8":return jr(this,t,n);case"ascii":return Hr(this,t,n);case"latin1":case"binary":return Wr(this,t,n);case"base64":return Qr(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Kr(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function Pr(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function kr(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=yr.from(t,r)),Nr(t))return 0===t.length?-1:xr(e,t,n,r,i);if("number"==typeof t)return t&=255,yr.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):xr(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function xr(e,t,n,r,i){var o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var l=-1;for(o=n;o<a;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*s}else-1!==l&&(o-=o-l),l=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){for(var d=!0,h=0;h<c;h++)if(u(e,o+h)!==u(t,h)){d=!1;break}if(d)return o}return-1}function Mr(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function Ur(e,t,n,r){return oi(ri(t,e.length-n),e,n,r)}function Br(e,t,n,r){return oi(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function Fr(e,t,n,r){return Br(e,t,n,r)}function Vr(e,t,n,r){return oi(ii(t),e,n,r)}function Gr(e,t,n,r){return oi(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(n=e.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function Qr(e,t,n){return 0===t&&n===e.length?gr(e):gr(e.slice(t,n))}function jr(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,c,u=e[i],l=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=n)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}function Hr(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function Wr(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function Yr(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=ni(e[o]);return i}function Kr(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function $r(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function zr(e,t,n,r,i,o){if(!Nr(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function qr(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function Jr(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function Xr(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Zr(e,t,n,r,i){return i||Xr(e,0,n,4),mr(e,t,n,r,23,4),n+4}function ei(e,t,n,r,i){return i||Xr(e,0,n,8),mr(e,t,n,r,52,8),n+8}yr.TYPED_ARRAY_SUPPORT=void 0===_e.TYPED_ARRAY_SUPPORT||_e.TYPED_ARRAY_SUPPORT,Rr(),yr.poolSize=8192,yr._augment=function(e){return e.__proto__=yr.prototype,e},yr.from=function(e,t,n){return Sr(null,e,t,n)},yr.TYPED_ARRAY_SUPPORT&&(yr.prototype.__proto__=Uint8Array.prototype,yr.__proto__=Uint8Array),yr.alloc=function(e,t,n){return function(e,t,n,r){return Cr(t),t<=0?vr(e,t):void 0!==n?"string"==typeof r?vr(e,t).fill(n,r):vr(e,t).fill(n):vr(e,t)}(null,e,t,n)},yr.allocUnsafe=function(e){return Or(null,e)},yr.allocUnsafeSlow=function(e){return Or(null,e)},yr.isBuffer=function(e){return null!=e&&(!!e._isBuffer||si(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&si(e.slice(0,0))}(e))},yr.compare=function(e,t){if(!Nr(e)||!Nr(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},yr.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},yr.concat=function(e,t){if(!Tr(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return yr.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=yr.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!Nr(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},yr.byteLength=Dr,yr.prototype._isBuffer=!0,yr.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Pr(this,t,t+1);return this},yr.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Pr(this,t,t+3),Pr(this,t+1,t+2);return this},yr.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Pr(this,t,t+7),Pr(this,t+1,t+6),Pr(this,t+2,t+5),Pr(this,t+3,t+4);return this},yr.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?jr(this,0,e):Lr.apply(this,arguments)},yr.prototype.equals=function(e){if(!Nr(e))throw new TypeError("Argument must be a Buffer");return this===e||0===yr.compare(this,e)},yr.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},yr.prototype.compare=function(e,t,n,r,i){if(!Nr(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),c=this.slice(r,i),u=e.slice(t,n),l=0;l<a;++l)if(c[l]!==u[l]){o=c[l],s=u[l];break}return o<s?-1:s<o?1:0},yr.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},yr.prototype.indexOf=function(e,t,n){return kr(this,e,t,n,!0)},yr.prototype.lastIndexOf=function(e,t,n){return kr(this,e,t,n,!1)},yr.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return Mr(this,e,t,n);case"utf8":case"utf-8":return Ur(this,e,t,n);case"ascii":return Br(this,e,t,n);case"latin1":case"binary":return Fr(this,e,t,n);case"base64":return Vr(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Gr(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},yr.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},yr.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),yr.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=yr.prototype;else{var i=t-e;n=new yr(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},yr.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||$r(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},yr.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||$r(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},yr.prototype.readUInt8=function(e,t){return t||$r(e,1,this.length),this[e]},yr.prototype.readUInt16LE=function(e,t){return t||$r(e,2,this.length),this[e]|this[e+1]<<8},yr.prototype.readUInt16BE=function(e,t){return t||$r(e,2,this.length),this[e]<<8|this[e+1]},yr.prototype.readUInt32LE=function(e,t){return t||$r(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},yr.prototype.readUInt32BE=function(e,t){return t||$r(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},yr.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||$r(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},yr.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||$r(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},yr.prototype.readInt8=function(e,t){return t||$r(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},yr.prototype.readInt16LE=function(e,t){t||$r(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},yr.prototype.readInt16BE=function(e,t){t||$r(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},yr.prototype.readInt32LE=function(e,t){return t||$r(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},yr.prototype.readInt32BE=function(e,t){return t||$r(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},yr.prototype.readFloatLE=function(e,t){return t||$r(e,4,this.length),_r(this,e,!0,23,4)},yr.prototype.readFloatBE=function(e,t){return t||$r(e,4,this.length),_r(this,e,!1,23,4)},yr.prototype.readDoubleLE=function(e,t){return t||$r(e,8,this.length),_r(this,e,!0,52,8)},yr.prototype.readDoubleBE=function(e,t){return t||$r(e,8,this.length),_r(this,e,!1,52,8)},yr.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||zr(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},yr.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||zr(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},yr.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||zr(this,e,t,1,255,0),yr.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},yr.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||zr(this,e,t,2,65535,0),yr.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):qr(this,e,t,!0),t+2},yr.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||zr(this,e,t,2,65535,0),yr.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):qr(this,e,t,!1),t+2},yr.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||zr(this,e,t,4,4294967295,0),yr.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):Jr(this,e,t,!0),t+4},yr.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||zr(this,e,t,4,4294967295,0),yr.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Jr(this,e,t,!1),t+4},yr.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);zr(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},yr.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);zr(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},yr.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||zr(this,e,t,1,127,-128),yr.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},yr.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||zr(this,e,t,2,32767,-32768),yr.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):qr(this,e,t,!0),t+2},yr.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||zr(this,e,t,2,32767,-32768),yr.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):qr(this,e,t,!1),t+2},yr.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||zr(this,e,t,4,2147483647,-2147483648),yr.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):Jr(this,e,t,!0),t+4},yr.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||zr(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),yr.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):Jr(this,e,t,!1),t+4},yr.prototype.writeFloatLE=function(e,t,n){return Zr(this,e,t,!0,n)},yr.prototype.writeFloatBE=function(e,t,n){return Zr(this,e,t,!1,n)},yr.prototype.writeDoubleLE=function(e,t,n){return ei(this,e,t,!0,n)},yr.prototype.writeDoubleBE=function(e,t,n){return ei(this,e,t,!1,n)},yr.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!yr.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},yr.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!yr.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=Nr(e)?e:ri(new yr(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var ti=/[^+\/0-9A-Za-z-_]/g;function ni(e){return e<16?"0"+e.toString(16):e.toString(16)}function ri(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function ii(e){return function(e){var t,n,r,i,o,s;fr||Ar();var a=e.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");o="="===e[a-2]?2:"="===e[a-1]?1:0,s=new pr(3*a/4-o),r=o>0?a-4:a;var c=0;for(t=0,n=0;t<r;t+=4,n+=3)i=hr[e.charCodeAt(t)]<<18|hr[e.charCodeAt(t+1)]<<12|hr[e.charCodeAt(t+2)]<<6|hr[e.charCodeAt(t+3)],s[c++]=i>>16&255,s[c++]=i>>8&255,s[c++]=255&i;return 2===o?(i=hr[e.charCodeAt(t)]<<2|hr[e.charCodeAt(t+1)]>>4,s[c++]=255&i):1===o&&(i=hr[e.charCodeAt(t)]<<10|hr[e.charCodeAt(t+1)]<<4|hr[e.charCodeAt(t+2)]>>2,s[c++]=i>>8&255,s[c++]=255&i),s}(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(ti,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function oi(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function si(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function ai(e,t){let n=e;if(ht(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];const r=[];for(;Array.isArray(n)||ht(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&wt().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&ci(e,r,[]),r}function ci(e,t,n){if(n=n||[],!Array.isArray(e)&&!ht(e))return void qe(0===t.length,(()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`));qe(t.length>0,(()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${e.length} elements`)),qe(e.length===t[0],(()=>`Element arr[${n.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`));const r=t.slice(1);for(let t=0;t<e.length;++t)ci(e[t],r,n.concat(t))}function ui(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function li(e,t,n,r="numeric"){if(e instanceof jn)return ui(r,e.dtype,t,n),e;let i=At(e);if("string"!==i&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),ui(r,i,t,n),null==e||!ht(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){const r=null==e?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}const o=ai(e,i);ht(e)||Array.isArray(e)||(e=[e]);const s="string"!==i?bn(e,i):Ze(e,[],!0);return sr.makeTensor(s,o,i)}function di(e,t,n,r="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map(((e,i)=>li(e,`${t}[${i}]`,n,r)))}function hi(e){const t=Object.keys(e);if(1!==t.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0];const r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";const i=(...e)=>{sr.startScope(n);try{const t=r(...e);return Ct(t)&&console.error("Cannot return a Promise inside of tidy."),sr.endScope(t),t}catch(e){throw sr.endScope(null),e}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}const pi=hi({complex_:function(e,t){const n=li(e,"real","complex"),r=li(t,"imag","complex");Je(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:n,imag:r};return sr.runKernel("Complex",i)}});function fi(e,t,n,r){if(null==r&&(r=At(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!ht(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){vt(t);const e=et(t),r=et(n);qe(e===r,(()=>`Based on the provided shape, [${t}], the tensor should have ${e} values but has ${r}`));for(let e=0;e<n.length;++e){const r=n[e],i=e!==n.length-1||r!==et(t.slice(e));qe(n[e]===t[e]||!i,(()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `))}}return ht(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?bn(e,r):Ze(e,[],!0),sr.makeTensor(e,t,r)}function Ai(e,t,n){return fi(e,t,ai(e,n),n)}const Ei={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},gi="undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa;function _i(e){return gi?yr.byteLength(e):new Blob([e]).size}function mi(e){if(1===e.length)return e[0];let t=0;e.forEach((e=>{t+=e.byteLength}));const n=new Uint8Array(t);let r=0;return e.forEach((e=>{n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Ii(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:_i(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:_i(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function Ti(){const e=function(){const e=e=>{let t=e<<13,n=0;for(;0==(8388608&t);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}(),t=function(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),n=function(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return r=>{const i=new ArrayBuffer(4*r.length),o=new Uint32Array(i);for(let i=0;i<r.length;i++){const s=r[i],a=e[n[s>>10]+(1023&s)]+t[s>>10];o[i]=a}return new Float32Array(i)}}class Ri{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Ri.instance&&(Ri.instance=new Ri),Ri.instance}static registerSaveRouter(e){Ri.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Ri.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Ri.getHandlers(e,"save")}static getLoadHandlers(e,t){return Ri.getHandlers(e,"load",t)}static getHandlers(e,t,n){const r=[];return("load"===t?Ri.getInstance().loadRouters:Ri.getInstance().saveRouters).forEach((t=>{const i=t(e,n);null!==i&&r.push(i)})),r}}function vi(){if(!wt().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function yi(e){const t=e.result;t.createObjectStore("models_store",{keyPath:"modelPath"}),t.createObjectStore("model_info_store",{keyPath:"modelPath"})}class Si{constructor(e){if(this.indexedDB=vi(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise(((e,n)=>{const r=this.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=()=>yi(r),r.onsuccess=()=>{const i=r.result;if(null==t){const t=i.transaction("models_store","readonly"),r=t.objectStore("models_store").get(this.modelPath);r.onsuccess=()=>{if(null==r.result)return i.close(),n(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));e(r.result.modelArtifacts)},r.onerror=e=>(i.close(),n(r.error)),t.oncomplete=()=>i.close()}else{const r=Ii(t),o=i.transaction("model_info_store","readwrite");let s=o.objectStore("model_info_store");const a=s.put({modelPath:this.modelPath,modelArtifactsInfo:r});let c;a.onsuccess=()=>{c=i.transaction("models_store","readwrite");const a=c.objectStore("models_store").put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:r});a.onsuccess=()=>e({modelArtifactsInfo:r}),a.onerror=e=>{s=o.objectStore("model_info_store");const t=s.delete(this.modelPath);t.onsuccess=()=>(i.close(),n(a.error)),t.onerror=e=>(i.close(),n(a.error))}},a.onerror=e=>(i.close(),n(a.error)),o.oncomplete=()=>{null==c?i.close():c.oncomplete=()=>i.close()}}},r.onerror=e=>n(r.error)}))}}Si.URL_SCHEME="indexeddb://";const Ci=e=>{return wt().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Si.URL_SCHEME)?(t=e.slice(Si.URL_SCHEME.length),new Si(t)):null;var t};Ri.registerSaveRouter(Ci),Ri.registerLoadRouter(Ci);class Oi{constructor(){this.indexedDB=vi()}async listModels(){return new Promise(((e,t)=>{const n=this.indexedDB.open("tensorflowjs",1);n.onupgradeneeded=()=>yi(n),n.onsuccess=()=>{const r=n.result,i=r.transaction("model_info_store","readonly"),o=i.objectStore("model_info_store").getAll();o.onsuccess=()=>{const t={};for(const e of o.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},o.onerror=e=>(r.close(),t(o.error)),i.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)}))}async removeModel(e){var t;return e=(t=e).startsWith(Si.URL_SCHEME)?t.slice(Si.URL_SCHEME.length):t,new Promise(((t,n)=>{const r=this.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=()=>yi(r),r.onsuccess=()=>{const i=r.result,o=i.transaction("model_info_store","readwrite"),s=o.objectStore("model_info_store"),a=s.get(e);let c;a.onsuccess=()=>{if(null==a.result)return i.close(),n(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const r=s.delete(e),o=()=>{c=i.transaction("models_store","readwrite");const r=c.objectStore("models_store").delete(e);r.onsuccess=()=>t(a.result.modelArtifactsInfo),r.onerror=e=>n(a.error)};r.onsuccess=o,r.onerror=e=>(o(),i.close(),n(a.error))}},a.onerror=e=>(i.close(),n(a.error)),o.oncomplete=()=>{null==c?i.close():c.oncomplete=()=>i.close()}},r.onerror=e=>n(r.error)}))}}const bi="tensorflowjs_models",wi="info",Ni="model_topology",Di="weight_specs",Li="weight_data",Pi="model_metadata";function ki(e){return{info:[bi,e,wi].join("/"),topology:[bi,e,Ni].join("/"),weightSpecs:[bi,e,Di].join("/"),weightData:[bi,e,Li].join("/"),modelMetadata:[bi,e,Pi].join("/")}}function xi(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function Mi(e){const t=e.split("/");if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join("/")}class Ui{constructor(e){if(!wt().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=ki(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=Ii(e);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(gi)return yr.from(e).toString("base64");const t=new Uint8Array(e);let n="";for(let e=0,r=t.length;e<r;e++)n+=String.fromCharCode(t[e]);return btoa(n)}(e.weightData));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch(e){throw xi(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(null==n)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==r)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const i=this.LS.getItem(this.keys.modelMetadata);if(null!=i){const e=JSON.parse(i);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const o=this.LS.getItem(this.keys.weightData);if(null==o)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=function(e){if(gi){const t=yr.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n.set([t.charCodeAt(e)],e);return n.buffer}(o),t}}Ui.URL_SCHEME="localstorage://";const Bi=e=>{return wt().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ui.URL_SCHEME)?(t=e.slice(Ui.URL_SCHEME.length),new Ui(t)):null;var t};Ri.registerSaveRouter(Bi),Ri.registerLoadRouter(Bi);class Fi{constructor(){qe(wt().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),qe("undefined"==typeof window||void 0!==window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const e={},t=bi+"/",n="/"+wi;for(let r=0;r<this.LS.length;++r){const i=this.LS.key(r);i.startsWith(t)&&i.endsWith(n)&&(e[Mi(i)]=JSON.parse(this.LS.getItem(i)))}return e}async removeModel(e){var t;const n=ki(e=(t=e).startsWith(Ui.URL_SCHEME)?t.slice(Ui.URL_SCHEME.length):t);if(null==this.LS.getItem(n.info))throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return xi(n),r}}function Vi(e,t,n,r){!function(e){qe(null!=e&&Array.isArray(e)&&e.length>0,(()=>"promises must be a none empty array"))}(e),function(e,t){qe(e>=0&&e<=1,(()=>`Progress fraction must be in range [0, 1], but got startFraction ${e}`)),qe(t>=0&&t<=1,(()=>`Progress fraction must be in range [0, 1], but got endFraction ${t}`)),qe(t>=e,(()=>`startFraction must be no more than endFraction, but got startFraction ${e} and endFraction ${t}`))}(n=null==n?0:n,r=null==r?1:r);let i=0;return Promise.all(e.map((o=>(o.then((o=>{const s=n+ ++i/e.length*(r-n);return t(s),o})),o))))}class Gi{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(qe("function"==typeof t.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=t.fetchFunc):this.fetch=wt().platform.fetch,qe(null!=e&&e.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(e)&&qe(2===e.length,(()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`)),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const n=function(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),n}(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);t.body.append("model.json",new Blob([JSON.stringify(n)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin");const r=await this.fetch(this.path,t);if(r.ok)return{modelArtifactsInfo:Ii(e),responses:[r]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${r.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch(e){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const n=t.modelTopology,r=t.weightsManifest;if(null==n&&null==r)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return async function(e,t){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),null!=e.weightsManifest){const[r,i]=await t(e.weightsManifest);n.weightSpecs=r,n.weightData=i}return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),n}(t,(e=>this.loadWeights(e)))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=function(e){const t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),i=this.weightPathPrefix||n,o=[];for(const t of e)o.push(...t.weights);const s=[],a=[];for(const t of e)for(const e of t.paths)null!=this.weightUrlConverter?a.push(this.weightUrlConverter(e)):s.push(i+e+r);this.weightUrlConverter&&s.push(...await Promise.all(a));const c=await async function(e,t){null==t&&(t={});const n=null==t.fetchFunc?wt().platform.fetch:t.fetchFunc,r=e.map((e=>n(e,t.requestInit,{isBinary:!0}))),i=(null==t.onProgress?await Promise.all(r):await Vi(r,t.onProgress,0,.5)).map((e=>e.arrayBuffer()));return null==t.onProgress?await Promise.all(i):await Vi(i,t.onProgress,.5,1)}(s,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[o,mi(c)]}}function Qi(e){return null!=e.match(Gi.URL_SCHEME_REGEX)}Gi.URL_SCHEME_REGEX=/^https?:\/\//;const ji=(e,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;{let n=!0;if(n=Array.isArray(e)?e.every((e=>Qi(e))):Qi(e),n)return Hi(e,t)}return null};function Hi(e,t){return new Gi(e,t)}function Wi(e,t){return Hi(e,t)}Ri.registerSaveRouter(ji),Ri.registerLoadRouter(ji);class Yi{constructor(){this.managers={}}static getInstance(){return null==Yi.instance&&(Yi.instance=new Yi),Yi.instance}static registerManager(e,t){qe(null!=e,(()=>"scheme must not be undefined or null.")),e.endsWith("://")&&(e=e.slice(0,e.indexOf("://"))),qe(e.length>0,(()=>"scheme must not be an empty string."));const n=Yi.getInstance();qe(null==n.managers[e],(()=>`A model store manager is already registered for scheme '${e}'.`)),n.managers[e]=t}static getManager(e){const t=this.getInstance().managers[e];if(null==t)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(this.getInstance().managers)}}const Ki=hi({cast_:function(e,t){const n=li(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:t};return sr.runKernel("Cast",r,i)}}),$i=hi({matMul_:function(e,t,n=!1,r=!1){let i=li(e,"a","matMul"),o=li(t,"b","matMul");[i,o]=Zn(i,o);const s={a:i,b:o},a={transposeA:n,transposeB:r};return sr.runKernel("BatchMatMul",s,a)}}),zi=hi({oneHot_:function(e,t,n=1,r=0){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const i={indices:li(e,"indices","oneHot","int32")},o={depth:t,onValue:n,offValue:r};return sr.runKernel("OneHot",i,o)}});function qi(){return sr}function Ji(e,t){return sr.tidy(e,t)}function Xi(e){return sr.keep(e)}function Zi(e,t,n=1){return sr.registerBackend(e,t,n)}const eo=hi({imag_:function(e){const t={input:li(e,"input","imag")};return sr.runKernel("Imag",t)}}),to=hi({neg_:function(e){const t={x:li(e,"x","neg")};return sr.runKernel("Neg",t)}}),no=hi({real_:function(e){const t={input:li(e,"input","real")};return sr.runKernel("Real",t)}}),ro=hi({transpose_:function(e,t,n){const r=li(e,"x","transpose");if(null==t&&(t=r.shape.map(((e,t)=>t)).reverse()),qe(r.rank===t.length,(()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`)),t.forEach((e=>{qe(e>=0&&e<r.rank,(()=>"All entries in 'perm' must be between 0 and "+(r.rank-1)+` but got ${t}`))})),r.rank<=1)return r.clone();const i={x:r},o={perm:t};return"complex64"===r.dtype?Ji((()=>{let e=no(r),t=eo(r);return e=sr.runKernel("Transpose",{x:e},o),t=sr.runKernel("Transpose",{x:t},o),n&&(t=to(t)),pi(e,t)})):sr.runKernel("Transpose",i,o)}});function io(e,t){const n=e.length,r=[];for(let i=0;i<n;i++){const o=n-1-i,s=e[o]||1;(t[t.length-1-i]||1)>1&&1===s&&r.unshift(o)}return r}function oo(e,t){const n=[];for(let r=0;r<t.length;r++){const i=e[e.length-r-1],o=t.length-r-1,s=t[o];(null==i||1===i&&s>1)&&n.unshift(o)}return n}function so(e,t){const n=[],r=Math.max(e.length,t.length);for(let i=0;i<r;i++){let r=e[e.length-i-1];null==r&&(r=1);let o=t[t.length-i-1];if(null==o&&(o=1),1===r)n.unshift(o);else if(1===o)n.unshift(r);else{if(r!==o)throw Error(`Operands could not be broadcast together with shapes ${e} and ${t}.`);n.unshift(r)}}return n}let ao;const co=hi({fromPixels_:function(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,o=!1,s=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)i=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)o=!0;else if(null!=e.getContext)s=!0;else{if(!("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);a=!0}if(i){const t=2;if(i&&e.readyState<t)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=Ut("FromPixels",sr.backendName)){const n={pixels:e},r={numChannels:t};return sr.runKernel("FromPixels",n,r)}const[c,u]=i?[e.videoWidth,e.videoHeight]:[e.width,e.height];let l,d;if(s)l=e.getContext("2d").getImageData(0,0,c,u).data;else if(r||n)l=e.data;else if(o||i||a){if(null==ao)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");ao=new OffscreenCanvas(1,1).getContext("2d")}else ao=document.createElement("canvas").getContext("2d");ao.canvas.width=c,ao.canvas.height=u,ao.drawImage(e,0,0,c,u),l=ao.getImageData(0,0,c,u).data}if(4===t)d=new Int32Array(l);else{const e=c*u;d=new Int32Array(e*t);for(let n=0;n<e;n++)for(let e=0;e<t;++e)d[n*t+e]=l[4*n+e]}return function(e,t,n){if(Xe(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const r=ai(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return fi(e,t,r,n)}(d,[u,c,t],"int32")}});function uo(e,t,n){const r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(o+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw new Error(o+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw new Error(o+" update.rank != "+(i+e.length-r));for(let e=0;e<i;++e)if(n.shape[e]!==t.shape[e])throw new Error(o+` updates.shape[${e}] (${n.shape[e]}) != indices.shape[${e}] (${t.shape[e]}).`);for(let t=0;t<n.rank-i;++t)if(n.shape[t+i]!==e[t+r])throw new Error(o+` updates.shape[${t+i}] (${n.shape[t+i]}) != shape[${t+i}] (${e[t+i]})`)}function lo(e,t,n){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if("int32"!==t.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(0===n.length){if(0===t.size)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===e.size)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}uo(n,t,e)}function ho(e,t,n){const r=e.shape.length;qe(r===t.length,(()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`)),qe(r===n.length,(()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`));for(let i=0;i<r;++i)qe(t[i]+n[i]<=e.shape[i],(()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`))}function po(e,t,n){const r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function fo(e,t,n,r){const i=[...e];for(let e=i.length;e<r.length;e++)i.push(1);for(let e=0;e<n;e++)0===e?i[t]=1:(i.splice(t,0,1),i.pop());return i}function Ao(e,t,n){return n<=e?n:n-(t-1)}function Eo(e,t){const n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function go(e,t,n,r,i){const o=[...i],s=Eo(n,t);for(let i=0;i<o.length;i++)if(s.indexOf(i)>-1)o[i]=0;else{const s=Ao(t,n,i);let a=r[s];e&1<<s&&(a=0),o[i]=a}return o}function _o(e,t,n,r,i){const o=[...i],s=Eo(n,t);for(let i=0;i<o.length;i++)if(s.indexOf(i)>-1)o[i]=Number.MAX_SAFE_INTEGER;else{const s=Ao(t,n,i);let a=r[s];e&1<<s&&(a=Number.MAX_SAFE_INTEGER),o[i]=a}for(let e=0;e<o.length;e++){const t=i[e];o[e]<0&&(o[e]+=t),o[e]=Ke(0,o[e],i[e])}return o}function mo(e,t,n){let r=e[t];return(n&1<<t||null==r)&&(r=1),r}function Io(e,t,n,r,i,o){let s=t[i];const a=n[i]||1;(e&1<<i||o&1<<i||null==s)&&(s=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const c=r[i];return s<0&&(s+=c),s=Ke(0,s,c-1),s}function To(e,t,n,r,i,o){let s=t[i];const a=n[i]||1;(e&1<<i||o&1<<i||null==s)&&(s=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const c=r[i];return s<0&&(s+=c),s=a>0?Ke(0,s,c):Ke(-1,s,c-1),s}function Ro(e,t,n){let r=n.length;for(let e=0;e<n.length;e++)if(n[e]>1){r=e;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function vo(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function yo(e,t,n){let r;const i=e.shape.length;let o;return r="number"==typeof t?[t,...new Array(i-1).fill(0)]:t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice(),r.forEach((e=>{qe(-1!==e,(()=>"slice() does not support negative begin indexing."))})),o=null==n?new Array(i).fill(-1):"number"==typeof n?[n,...new Array(i-1).fill(-1)]:n.length<i?n.concat(new Array(i-n.length).fill(-1)):n,o=o.map(((t,n)=>t>=0?t:(qe(-1===t,(()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${n}.`)),e.shape[n]-r[n]))),[r,o]}function So(e,t,n,r,i,o,s,a,c){let u;if(null==r?(u=new Array(t.length),u.fill(1)):u=r,null!=s&&0!=(s&s-1))throw new Error("Multiple ellipses in slice is not allowed.");let l=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:u.slice(),beginMask:i,endMask:o,ellipsisMask:s,newAxisMask:a,shrinkAxisMask:c};for(let e=0;e<d.dims;e++)l&&0!=(1<<e&a)&&d.numAddAxisAfterEllipsis++,1<<e&s&&(l=!0);l||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){const i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(-2),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=e.begin&&(t.begin[n]=e.begin[r]),null!=e.end&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(-1),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}(d,h);let p=!0,f=!0,A=!0;const E=[],g=[];for(let t=0;t<e.length;++t){if(0===h.strides[t])throw Error(`strides[${t}] must be non-zero`);const n=!!(h.shrinkAxisMask&1<<t),r=e[t];if(-1===r){E.push(n?1:-1);continue}const i=[h.beginMask&1<<t,h.endMask&1<<t],o=[h.strides[t]>0?0:-1,h.strides[t]>0?r:r-1];if(n&&h.strides[t]<=0)throw Error("only stride 1 allowed on non-range indexing.");A=A&&1===h.strides[t];const s=!!(h.beginMask&1<<t&&h.endMask&1<<t);if(h.beginValid&&h.endValid){if(n){const e=h.begin[t]<0?r+h.begin[t]:h.begin[t];if(h.begin[t]=e,h.end[t]=h.begin[t]+1,e<0||e>=r)throw Error(`slice index ${h.begin[t]} of dimension ${t} out of bounds.`)}else h.begin[t]=Co(h.begin[t],0,h.strides[t],r,i,o),h.end[t]=Co(h.end[t],1,h.strides[t],r,i,o);const e=1===h.strides[t]&&0===h.begin[t]&&h.end[t]===r;p=p&&e,f=f&&(0===t&&1===h.strides[t]||e)}else p=p&&1===h.strides[t]&&s,f=f&&(0===t&&1===h.strides[t]||s);let a,c=!1;if(h.beginValid&&h.endValid?(a=h.end[t]-h.begin[t],c=!0):n?(a=1,c=!0):s&&r>=0&&(a=h.strides[t]<0?-r:r,c=!0),c){let e;e=0===a||a<0!=h.strides[t]<0?0:Math.trunc(a/h.strides[t])+(a%h.strides[t]!=0?1:0),E.push(e)}else E.push(-1)}for(let e=0;e<h.finalShapeGatherIndices.length;++e){const t=h.finalShapeGatherIndices[e];t>=0?g.push(E[t]):-2===t&&g.push(1)}const _=g.filter(((e,t)=>-2!==h.finalShapeGatherIndices[t]));return{finalShapeSparse:_,finalShape:g,isIdentity:p,sliceDim0:f,isSimpleSlice:A,begin:h.begin,end:h.end,strides:h.strides}}function Co(e,t,n,r,i,o){if(i[t])return n>0?o[t]:o[t+1&1];{const t=e<0?r+e:e;return t<o[0]?o[0]:t>o[1]?o[1]:t}}var Oo=Object.freeze({__proto__:null,assertParamsValid:ho,maskToAxes:function(e){const t=[];let n=0;for(;e>0;)1&e&&t.push(n),e/=2,n++;return t},computeOutShape:po,stridesWithElidedDims:fo,getNormalizedAxes:function(e,t,n,r,i,o,s,a,c){const u=e.length;let l=new Array(u),d=new Array(u),h=new Array(u);if(t.length&&n>0){const c=t[0],u=n+1;l=go(s,c,u,r,e),d=_o(a,c,u,i,e),h=fo(o,c,u,e)}else for(let t=0;t<u;t++)l[t]=Io(s,r,o,e,t,c),d[t]=To(a,i,o,e,t,c),h[t]=mo(o,t,c);return{begin:l,end:d,strides:h}},startIndicesWithElidedDims:go,stopIndicesWithElidedDims:_o,stridesForAxis:mo,startForAxis:Io,stopForAxis:To,isSliceContinous:Ro,computeFlatOffset:vo,parseSliceParams:yo,sliceInfo:So});const bo=hi({add_:function(e,t){let n=li(e,"a","add"),r=li(t,"b","add");[n,r]=Zn(n,r);const i={a:n,b:r};return sr.runKernel("Add",i)}}),wo=hi({floorDiv_:function(e,t){let n=li(e,"a","floorDiv"),r=li(t,"b","floorDiv");[n,r]=Zn(n,r);const i={a:n,b:r};return sr.runKernel("FloorDiv",i)}}),No=hi({div_:function(e,t){let n=li(e,"a","div"),r=li(t,"b","div");if([n,r]=Zn(n,r),"int32"===n.dtype&&"int32"===r.dtype)return wo(n,r);const i={a:n,b:r};return sr.runKernel("RealDiv",i,{})}}),Do=hi({mul_:function(e,t){let n=li(e,"a","mul"),r=li(t,"b","mul");[n,r]=Zn(n,r);const i={a:n,b:r};return sr.runKernel("Multiply",i)}}),Lo=hi({abs_:function(e){const t=li(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return sr.runKernel("ComplexAbs",e)}{const e={x:t};return sr.runKernel("Abs",e)}}}),Po=hi({acos_:function(e){const t={x:li(e,"x","acos")};return sr.runKernel("Acos",t)}}),ko=hi({acosh_:function(e){const t={x:li(e,"x","acosh")};return sr.runKernel("Acosh",t)}}),xo=hi({addN_:function(e){qe(Array.isArray(e),(()=>"The argument passed to tf.addN() must be a list of tensors")),qe(e.length>=1,(()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`));const t=e.map(((e,t)=>li(e,`tensors${t}`,"addN"))),n=t[0];t.forEach((e=>{if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((e=>{if(!tt(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const r=t;return sr.runKernel("AddN",r)}}),Mo=hi({all_:function(e,t=null,n=!1){const r={x:li(e,"x","all","bool")},i={axis:t,keepDims:n};return sr.runKernel("All",r,i)}}),Uo=hi({any_:function(e,t=null,n=!1){const r={x:li(e,"x","any","bool")},i={axis:t,keepDims:n};return sr.runKernel("Any",r,i)}}),Bo=hi({argMax_:function(e,t=0){const n={x:li(e,"x","argMax")},r={axis:t};return sr.runKernel("ArgMax",n,r)}}),Fo=hi({argMin_:function(e,t=0){const n={x:li(e,"x","argMin")},r={axis:t};return sr.runKernel("ArgMin",n,r)}}),Vo=hi({asin_:function(e){const t={x:li(e,"x","asin")};return sr.runKernel("Asin",t)}}),Go=hi({asinh_:function(e){const t={x:li(e,"x","asinh")};return sr.runKernel("Asinh",t)}}),Qo=hi({atan_:function(e){const t={x:li(e,"x","atan")};return sr.runKernel("Atan",t)}}),jo=hi({atan2_:function(e,t){let n=li(e,"a","atan2"),r=li(t,"b","atan2");[n,r]=Zn(n,r);const i={a:n,b:r};return sr.runKernel("Atan2",i)}}),Ho=hi({atanh_:function(e){const t={x:li(e,"x","atanh")};return sr.runKernel("Atanh",t)}});function Wo(e,t,n,r,i,o,s="channelsLast"){const[a,c]=zo(t);let u;if("channelsLast"===s)u=[a,c,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);u=[a,c,e[1],e[1]]}return Yo(e,u,n,r,i,o,!1,s)}function Yo(e,t,n,r,i,o,s=!1,a="channelsLast"){let[c,u,l,d]=[-1,-1,-1,-1];if("channelsLast"===a)[c,u,l,d]=e;else{if("channelsFirst"!==a)throw new Error(`Unknown dataFormat ${a}`);[c,d,u,l]=e}const[h,p,,f]=t,[A,E]=zo(n),[g,_]=zo(r),m=Jo(h,g),I=Jo(p,_),{padInfo:T,outHeight:R,outWidth:v}=function(e,t,n,r,i,o,s,a,c){let u,l,d;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const i=function(e,t,n,r,i){null==r&&(r=$o(e,t,n));const o=e[1];return[Xo((e[0]-t+2*r)/n+1,i),Xo((o-t+2*r)/n+1,i)]}([t,n],o,r,e,a);l=i[0],d=i[1]}else if("same"===e){l=Math.ceil(t/r),d=Math.ceil(n/i);const e=Math.max(0,(l-1)*r+o-t),a=Math.max(0,(d-1)*i+s-n),c=Math.floor(e/2),h=e-c,p=Math.floor(a/2);u={top:c,bottom:h,left:p,right:a-p,type:"SAME"}}else if("valid"===e)u={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-o+1)/r),d=Math.ceil((n-s+1)/i);else{if("object"!=typeof e)throw Error(`Unknown padding parameter: ${e}`);{const h="channelsLast"===c?e[1][0]:e[2][0],p="channelsLast"===c?e[1][1]:e[2][1],f="channelsLast"===c?e[2][0]:e[3][0],A="channelsLast"===c?e[2][1]:e[3][1];u={top:h,bottom:p,left:f,right:A,type:0===h&&0===p&&0===f&&0===A?"VALID":"EXPLICIT"},l=Xo((t-o+h+p)/r+1,a),d=Xo((n-s+f+A)/i+1,a)}}return{padInfo:u,outHeight:l,outWidth:d}}(i,u,l,A,E,m,I,o,a),y=s?f*d:f;let S;return"channelsFirst"===a?S=[c,y,R,v]:"channelsLast"===a&&(S=[c,R,v,y]),{batchSize:c,dataFormat:a,inHeight:u,inWidth:l,inChannels:d,outHeight:R,outWidth:v,outChannels:y,padInfo:T,strideHeight:A,strideWidth:E,filterHeight:h,filterWidth:p,effectiveFilterHeight:m,effectiveFilterWidth:I,dilationHeight:g,dilationWidth:_,inShape:e,outShape:S,filterShape:t}}function Ko(e,t,n,r,i,o=!1,s="channelsLast",a){let[c,u,l,d,h]=[-1,-1,-1,-1,-1];if("channelsLast"===s)[c,u,l,d,h]=e;else{if("channelsFirst"!==s)throw new Error(`Unknown dataFormat ${s}`);[c,h,u,l,d]=e}const[p,f,A,,E]=t,[g,_,m]=qo(n),[I,T,R]=qo(r),v=Jo(p,I),y=Jo(f,T),S=Jo(A,R),{padInfo:C,outDepth:O,outHeight:b,outWidth:w}=function(e,t,n,r,i,o,s,a,c,u,l){let d,h,p,f;if("number"==typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};const o=function(e,t,n,r,i,o){null==i&&(i=$o(e,t,r));const s=e[1],a=e[2];return[Xo((e[0]-t+2*i)/r+1,o),Xo((s-t+2*i)/r+1,o),Xo((a-t+2*i)/r+1,o),1]}([t,n,r,1],a,0,i,e,l);h=o[0],p=o[1],f=o[2]}else if("same"===e){h=Math.ceil(t/i),p=Math.ceil(n/o),f=Math.ceil(r/s);const e=(h-1)*i+a-t,l=(p-1)*o+c-n,A=(f-1)*s+u-r,E=Math.floor(e/2),g=e-E,_=Math.floor(l/2),m=l-_,I=Math.floor(A/2);d={top:_,bottom:m,left:I,right:A-I,front:E,back:g,type:"SAME"}}else{if("valid"!==e)throw Error(`Unknown padding parameter: ${e}`);d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((t-a+1)/i),p=Math.ceil((n-c+1)/o),f=Math.ceil((r-u+1)/s)}return{padInfo:d,outDepth:h,outHeight:p,outWidth:f}}(i,u,l,d,g,_,m,v,y,S,a),N=o?E*h:E;let D;return"channelsFirst"===s?D=[c,N,O,b,w]:"channelsLast"===s&&(D=[c,O,b,w,N]),{batchSize:c,dataFormat:s,inDepth:u,inHeight:l,inWidth:d,inChannels:h,outDepth:O,outHeight:b,outWidth:w,outChannels:N,padInfo:C,strideDepth:g,strideHeight:_,strideWidth:m,filterDepth:p,filterHeight:f,filterWidth:A,effectiveFilterDepth:v,effectiveFilterHeight:y,effectiveFilterWidth:S,dilationDepth:I,dilationHeight:T,dilationWidth:R,inShape:e,outShape:D,filterShape:t}}function $o(e,t,n,r=1){const i=Jo(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function zo(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function qo(e){return"number"==typeof e?[e,e,e]:e}function Jo(e,t){return t<=1?e:e+(e-1)*(t-1)}function Xo(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function Zo(e){const[t,n,r]=zo(e);return 1===t&&1===n&&1===r}function es(e,t){return Zo(e)||Zo(t)}function ts(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function ns(e,t,n){if(null!=n){if("string"==typeof t)throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if("number"==typeof t)qe(nt(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`));else{if("object"!=typeof t)throw Error(`Error in ${e}: Unknown padding parameter: ${t}`);t.forEach((t=>{t.forEach((t=>{qe(nt(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`))}))}))}}}const rs=hi({reshape_:function(e,t){const n={x:li(e,"x","reshape","string_or_numeric")},r={shape:t};return sr.runKernel("Reshape",n,r)}}),is=hi({avgPool_:function(e,t,n,r,i){const o=li(e,"x","avgPool","float32");qe(es(n,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`));let s=o,a=!1;3===o.rank&&(a=!0,s=rs(o,[1,o.shape[0],o.shape[1],o.shape[2]])),qe(4===s.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${s.rank}.`)),ns("avgPool",r,i);const c={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:i};let l=sr.runKernel("AvgPool",c,u);return l=Ki(l,o.dtype),a?rs(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),os=hi({avgPool3d_:function(e,t,n,r,i,o="NDHWC"){const s=li(e,"x","avgPool3d","float32");let a=s,c=!1;4===s.rank&&(c=!0,a=rs(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),qe(5===a.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`)),qe("NDHWC"===o,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`)),ns("avgPool3d",r,i);const u={x:a},l={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:o};let d=sr.runKernel("AvgPool3D",u,l);return d=Ki(d,a.dtype),c?rs(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),ss=hi({clone_:function(e){const t={x:li(e,"x","clone","string_or_numeric")};return sr.runKernel("Identity",t)}}),as=hi({concat_:function(e,t=0){qe(e.length>=1,(()=>"Pass at least one tensor to concat"));const n=di(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((e=>{if("complex64"!==e.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${e.dtype}. `)})),1===n.length)return ss(n[0]);const r=n,i={axis:t};return sr.runKernel("Concat",r,i)}}),cs=hi({sigmoid_:function(e){const t={x:li(e,"x","sigmoid","float32")};return sr.runKernel("Sigmoid",t)}}),us=hi({slice_:function(e,t,n){const r=li(e,"x","slice","string_or_numeric");if(0===r.rank)throw new Error("Slicing scalar is not possible");const i={x:r},o={begin:t,size:n};return sr.runKernel("Slice",i,o)}}),ls=hi({tanh_:function(e){const t={x:li(e,"x","tanh","float32")};return sr.runKernel("Tanh",t)}}),ds=hi({batchToSpaceND_:function(e,t,n){const r=li(e,"x","batchToSpaceND"),i=t.reduce(((e,t)=>e*t));qe(r.rank>=1+t.length,(()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`)),qe(n.length===t.length,(()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`)),qe(r.shape[0]%i==0,(()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${i}`));const o={x:r},s={blockShape:t,crops:n};return sr.runKernel("BatchToSpaceND",o,s)}}),hs=hi({batchNorm_:function(e,t,n,r,i,o){null==o&&(o=.001);const s=li(e,"x","batchNorm"),a=li(t,"mean","batchNorm"),c=li(n,"variance","batchNorm");let u,l;null!=i&&(u=li(i,"scale","batchNorm")),null!=r&&(l=li(r,"offset","batchNorm")),qe(a.rank===c.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),qe(null==l||a.rank===l.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),qe(null==u||a.rank===u.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const d=function(e){let t;return t=0===e.rank||1===e.rank?rs(e,[1,1,1,e.size]):2===e.rank?rs(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?rs(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(s),h={x:d,scale:u,offset:l,mean:a,variance:c},p={varianceEpsilon:o},f=sr.runKernel("FusedBatchNorm",h,p);return rs(f,s.shape)}}),ps=hi({bincount_:function(e,t,n){const r=li(e,"x","bincount"),i=li(t,"weights","bincount");qe("int32"===r.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`)),qe(n>=0,(()=>`size must be non-negative, but got ${n}.`)),qe(i.size===r.size||0===i.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`));const o={x:r,weights:i},s={size:n};return sr.runKernel("Bincount",o,s)}}),fs=hi({broadcastArgs_:function(e,t){const n=li(e,"s0","broadcastArgs","int32"),r=li(t,"s1","broadcastArgs","int32");if(1!==n.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(1!==r.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const i={s0:n,s1:r};return sr.runKernel("BroadcastArgs",i)}}),As=hi({broadcastTo_:function(e,t){let n=li(e,"broadcastTo","x");const r=n.shape;if(t.some((e=>!(e>0)||e%1!=0)))throw new Error(`broadcastTo(): Invalid broadcast shape [${t}].`);if(t.length<n.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){const e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=rs(n,e)}const i=n.shape,o=Array.from(t);for(let e=t.length-1;e>=0;e--)if(i[e]===t[e])o[e]=1;else if(1!==n.shape[e])throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);const s=o.map(((e,t)=>e>1?t:-1)).filter((e=>e>=0));if(0===s.length)return ss(n);const a={x:n},c={reps:o};return sr.runKernel("Tile",a,c)}});function Es(e,t="float32",n){return t=t||"float32",vt(e),new Vn(e,t,n)}const gs=hi({ceil_:function(e){const t={x:li(e,"x","ceil","float32")};return sr.runKernel("Ceil",t)}}),_s=hi({clipByValue_:function(e,t,n){const r=li(e,"x","clipByValue");qe(t<=n,(()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`));const i={x:r},o={clipValueMin:t,clipValueMax:n};return sr.runKernel("ClipByValue",i,o)}}),ms=hi({conv2d_:function(e,t,n,r,i="NHWC",o=[1,1],s){const a=li(e,"x","conv2d","float32"),c=li(t,"filter","conv2d","float32");let u=a,l=!1;3===a.rank&&(l=!0,u=rs(a,[1,a.shape[0],a.shape[1],a.shape[2]])),qe(4===u.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`)),qe(4===c.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${c.rank}.`)),ns("conv2d",r,s);const d="NHWC"===i?u.shape[3]:u.shape[1];qe(d===c.shape[2],(()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${c.shape[2]}.`)),qe(es(n,o),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`));const h={x:u,filter:c},p={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s},f=sr.runKernel("Conv2D",h,p);return l?rs(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),Is=hi({conv1d_:function(e,t,n,r,i="NWC",o=1,s){const a=li(e,"x","conv1d"),c=li(t,"filter","conv1d");let u=a,l=!1;2===a.rank&&(l=!0,u=rs(a,[1,a.shape[0],a.shape[1]])),qe(3===u.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`)),qe(3===c.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${c.rank}.`)),ns("conv1d",r,s),qe(u.shape[2]===c.shape[1],(()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${c.shape[1]}.`)),qe(es(n,o),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`)),qe("NWC"===i,(()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`));const d=rs(c,[1,c.shape[0],c.shape[1],c.shape[2]]),h=rs(u,[u.shape[0],1,u.shape[1],u.shape[2]]),p=ms(h,d,[1,n],r,"NHWC",[1,o],s);return rs(p,l?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}}),Ts=hi({conv2DBackpropInput_:function(e,t,n,r,i,o="NHWC",s){qe(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let a=e,c=t,u=!1;3===t.rank&&(u=!0,c=rs(t,[1,t.shape[0],t.shape[1],t.shape[2]]),a=[1,e[0],e[1],e[2]]),qe(4===a.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`)),qe(4===c.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${c.rank}`)),qe(4===n.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`));const l="NHWC"===o?a[3]:a[1],d="NHWC"===o?c.shape[3]:c.shape[1];qe(l===n.shape[2],(()=>`Error in conv2dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[2]}.`)),qe(d===n.shape[3],(()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`)),ns("conv2dDerInput",i,s);const h={dy:c,filter:n},p={strides:r,pad:i,dataFormat:o,dimRoundingMode:s,inputShape:a},f=sr.runKernel("Conv2DBackpropInput",h,p);return u?rs(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),Rs=hi({conv2dTranspose_:function(e,t,n,r,i,o){const s=li(e,"x","conv2dTranspose"),a=li(t,"filter","conv2dTranspose");return Ts(n,s,a,r,i,"NHWC",o)}}),vs=hi({conv3d_:function(e,t,n,r,i="NDHWC",o=[1,1,1]){const s=li(e,"x","conv3d"),a=li(t,"filter","conv3d");let c=s,u=!1;4===s.rank&&(u=!0,c=rs(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),qe(5===c.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${c.rank}.`)),qe(5===a.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`)),qe(c.shape[4]===a.shape[3],(()=>`Error in conv3d: depth of input (${c.shape[4]}) must match input depth for filter ${a.shape[3]}.`)),qe(es(n,o),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`)),qe("NDHWC"===i,(()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`));const l={x:c,filter:a},d={strides:n,pad:r,dataFormat:i,dilations:o},h=sr.runKernel("Conv3D",l,d);return u?rs(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),ys=hi({cos_:function(e){const t={x:li(e,"x","cos","float32")};return sr.runKernel("Cos",t)}}),Ss=hi({cosh_:function(e){const t={x:li(e,"x","cosh","float32")};return sr.runKernel("Cosh",t)}}),Cs=hi({cumprod_:function(e,t=0,n=!1,r=!1){const i={x:li(e,"x","cumprod")},o={axis:t,exclusive:n,reverse:r};return sr.runKernel("Cumprod",i,o)}}),Os=hi({cumsum_:function(e,t=0,n=!1,r=!1){const i={x:li(e,"x","cumsum")},o={axis:t,exclusive:n,reverse:r};return sr.runKernel("Cumsum",i,o)}}),bs=hi({denseBincount_:function(e,t,n,r=!1){const i=li(e,"x","denseBincount"),o=li(t,"weights","denseBincount");qe("int32"===i.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`)),qe(i.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`)),qe(n>=0,(()=>`size must be non-negative, but got ${n}.`)),qe(o.size===i.size||0===o.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${o.shape}.`));const s={x:i,weights:o},a={size:n,binaryOutput:r};return sr.runKernel("DenseBincount",s,a)}}),ws=hi({depthToSpace_:function(e,t,n="NHWC"){const r=li(e,"x","depthToSpace","float32"),i="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],s="NHWC"===n?r.shape[3]:r.shape[1];qe(t>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`)),qe(i*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${i} and ${t}  for depthToSpace with input shape\n    ${r.shape}`)),qe(o*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${o} and ${t} for depthToSpace with input shape\n        ${r.shape}`)),qe(s%(t*t)==0,(()=>`Dimension size must be evenly divisible by ${t*t} but is ${s} for depthToSpace with input shape ${r.shape}`));const a={x:r},c={blockSize:t,dataFormat:n};return sr.runKernel("DepthToSpace",a,c)}}),Ns=hi({depthwiseConv2d_:function(e,t,n,r,i="NHWC",o=[1,1],s){const a=li(e,"x","depthwiseConv2d","float32"),c=li(t,"filter","depthwiseConv2d","float32");let u=a,l=!1;3===a.rank&&(l=!0,u=rs(a,[1,a.shape[0],a.shape[1],a.shape[2]])),qe(4===u.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`)),qe(4===c.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`)),qe(u.shape[3]===c.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${u.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`)),ns("depthwiseConv2d",r,s);const d={x:u,filter:c},h={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s},p=sr.runKernel("DepthwiseConv2dNative",d,h);return l?rs(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),Ds=hi({dilation2d_:function(e,t,n,r,i=[1,1],o="NHWC"){const s=li(e,"x","dilation2d"),a=li(t,"filter","dilation2d");qe(3===s.rank||4===s.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${s.rank}.`)),qe(3===a.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`)),qe("NHWC"===o,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`));let c=s,u=!1;3===s.rank&&(c=rs(s,[1,s.shape[0],s.shape[1],s.shape[2]]),u=!0);const l={x:c,filter:a},d={strides:n,pad:r,dilations:i},h=sr.runKernel("Dilation2D",l,d);return u?rs(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),Ls=hi({equal_:function(e,t){let n=li(e,"a","equal","string_or_numeric"),r=li(t,"b","equal","string_or_numeric");[n,r]=Zn(n,r),so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("Equal",i)}}),Ps=hi({where_:function(e,t,n){const r=li(t,"a","where"),i=li(n,"b","where"),o=li(e,"condition","where","bool"),s=so(so(o.shape,r.shape),i.shape),a={condition:As(o,s),t:As(r,s),e:As(i,s)};return sr.runKernel("Select",a)}}),ks=hi({zerosLike_:function(e){const t={x:li(e,"x","zerosLike")};return sr.runKernel("ZerosLike",t)}}),xs=hi({divNoNan_:function(e,t){let n=li(e,"a","div"),r=li(t,"b","div");[n,r]=Zn(n,r);const i=No(n,r),o=ks(i),s=Ls(r,o);return Ps(s,o,i)}}),Ms=hi({einsum_:function(e,...t){const n=t.map(((e,t)=>li(e,`tensors${t}`,"einsum"))),r={equation:e};return sr.runKernel("Einsum",n,r)}}),Us=hi({elu_:function(e){const t={x:li(e,"x","elu","float32")};return sr.runKernel("Elu",t)}}),Bs=hi({erf_:function(e){let t=li(e,"x","erf");qe("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=Ki(t,"float32"));const n={x:t};return sr.runKernel("Erf",n)}});function Fs(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Vs(e,t,n){const r=e.length+t.length,i=[];let o=0,s=0;for(let a=0;a<r;a++)-1===n.indexOf(a)?i.push(e[o++]):i.push(t[s++]);return i}function Gs(e,t){const n=[],r=e.length;for(let i=0;i<r;i++)-1===t.indexOf(i)&&n.push(e[i]);return[n,t.map((t=>e[t]))]}function Qs(e,t){return Vs(e,t.map((e=>1)),t)}function js(e,t,n){qe(Fs(t,n),(()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`))}function Hs(e,t){if(Fs(e,t))return null;const n=[];for(let r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((e=>n.push(e))),n}function Ws(e,t){const n=[];for(let r=t-e;r<t;++r)n.push(r);return n}const Ys=hi({max_:function(e,t=null,n=!1){const r={x:li(e,"x","max")},i={reductionIndices:t,keepDims:n};return sr.runKernel("Max",r,i)}}),Ks=hi({min_:function(e,t=null,n=!1){const r={x:li(e,"x","min")},i={axis:t,keepDims:n};return sr.runKernel("Min",r,i)}}),$s=hi({pow_:function(e,t){let n=li(e,"base","pow"),r=li(t,"exp","pow");[n,r]=Zn(n,r);const i={a:n,b:r};return sr.runKernel("Pow",i)}});function zs(e,t){if((ht(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&ht(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return fi(e,[],[],t)}const qs=hi({sqrt_:function(e){const t={x:li(e,"x","sqrt","float32")};return sr.runKernel("Sqrt",t)}}),Js=hi({square_:function(e){const t=li(e,"x","square");return sr.runKernel("Square",{x:t},{})}}),Xs=hi({sum_:function(e,t=null,n=!1){let r=li(e,"x","sum");"bool"===r.dtype&&(r=Ki(r,"int32"));const i={x:r},o={axis:t,keepDims:n};return sr.runKernel("Sum",i,o)}});function Zs(e,t,n=null){if(0===e.rank)return Lo(e);if(1!==e.rank&&null===n)return Zs(rs(e,[-1]),t,n);if(1===e.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Xs(Lo(e),n);if(t===1/0)return Ys(Lo(e),n);if(t===-1/0)return Ks(Lo(e),n);if("euclidean"===t||2===t)return qs(Xs($s(Lo(e),zs(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&2===n.length){if(1===t)return Ys(Xs(Lo(e),n[0]),n[1]-1);if(t===1/0)return Ys(Xs(Lo(e),n[1]),n[0]);if(t===-1/0)return Ks(Xs(Lo(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return qs(Xs(Js(e),n));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const ea=hi({norm_:function(e,t="euclidean",n=null,r=!1){const i=Zs(e=li(e,"x","norm"),t,n);let o=i.shape;if(r){const t=at(n,e.shape);o=Qs(i.shape,t)}return rs(i,o)}}),ta=hi({euclideanNorm_:function(e,t=null,n=!1){return ea(e,"euclidean",t,n)}}),na=hi({exp_:function(e){const t={x:li(e,"x","exp")};return sr.runKernel("Exp",t)}}),ra=hi({expandDims_:function(e,t=0){const n=li(e,"x","expandDims","string_or_numeric");qe(t<=n.rank,(()=>"Axis must be <= rank of the tensor"));const r={input:n},i={dim:t};return sr.runKernel("ExpandDims",r,i)}}),ia=hi({expm1_:function(e){const t={x:li(e,"x","expm1")};return sr.runKernel("Expm1",t)}}),oa=hi({tile_:function(e,t){const n=li(e,"x","tile","string_or_numeric");qe(n.rank===t.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`));const r={x:n},i={reps:t};return sr.runKernel("Tile",r,i)}}),sa=hi({eye_:function(e,t,n,r="float32"){null==t&&(t=e);const i=Es([e,t],r),o=e<=t?e:t;for(let e=0;e<o;++e)i.set(1,e,e);const s=rs(i.toTensor(),[e,t]);if(null==n)return s;if(1===n.length)return oa(ra(s,0),[n[0],1,1]);if(2===n.length)return oa(ra(ra(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return oa(ra(ra(ra(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}});function aa(e,t,n){const r={shape:e,value:t,dtype:n};return sr.runKernel("Fill",{},r)}const ca=hi({floor_:function(e){const t={x:li(e,"x","floor","float32")};return sr.runKernel("Floor",t)}}),ua=hi({gather_:function(e,t,n=0,r=0){const i={x:li(e,"x","gather"),indices:li(t,"indices","gather","int32")},o={axis:n,batchDims:r};return sr.runKernel("GatherV2",i,o)}}),la=hi({greater_:function(e,t){let n=li(e,"a","greater","string_or_numeric"),r=li(t,"b","greater","string_or_numeric");[n,r]=Zn(n,r),so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("Greater",i)}}),da=hi({greaterEqual_:function(e,t){let n=li(e,"a","greaterEqual","string_or_numeric"),r=li(t,"b","greaterEqual","string_or_numeric");[n,r]=Zn(n,r),so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("GreaterEqual",i)}}),ha=hi({isNaN_:function(e){const t={x:li(e,"x","isNaN")};return sr.runKernel("IsNan",t)}}),pa=hi({leakyRelu_:function(e,t=.2){const n={x:li(e,"x","leakyRelu")},r={alpha:t};return sr.runKernel("LeakyRelu",n,r)}}),fa=hi({less_:function(e,t){let n=li(e,"a","less","string_or_numeric"),r=li(t,"b","less","string_or_numeric");[n,r]=Zn(n,r),so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("Less",i)}}),Aa=hi({lessEqual_:function(e,t){let n=li(e,"a","lessEqual","string_or_numeric"),r=li(t,"b","lessEqual","string_or_numeric");[n,r]=Zn(n,r),so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("LessEqual",i)}});function Ea(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:e,stop:t,num:n};return sr.runKernel("LinSpace",{},r)}const ga=hi({localResponseNormalization_:function(e,t=5,n=1,r=1,i=.5){const o=li(e,"x","localResponseNormalization");qe(4===o.rank||3===o.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${o.rank}.`)),qe(nt(t),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`));let s=o,a=!1;3===o.rank&&(a=!0,s=rs(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const c={x:s},u={depthRadius:t,bias:n,alpha:r,beta:i},l=sr.runKernel("LRN",c,u);return a?rs(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),_a=hi({log_:function(e){const t={x:li(e,"x","log","float32")};return sr.runKernel("Log",t)}}),ma=hi({log1p_:function(e){const t={x:li(e,"x","log1p")};return sr.runKernel("Log1p",t)}});function Ia(e){return sr.customGrad(e)}const Ta=hi({softplus_:function(e){const t={x:li(e,"x","softplus")};return sr.runKernel("Softplus",t)}}),Ra=hi({sub_:function(e,t){let n=li(e,"a","sub"),r=li(t,"b","sub");[n,r]=Zn(n,r);const i={a:n,b:r};return sr.runKernel("Sub",i)}}),va=hi({logSoftmax_:function(e,t=-1){const n=li(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);const r=Ia(((e,n)=>{const r=Ys(e,t,!0),i=Ra(e,r),o=Ra(Ki(i,"float32"),_a(Xs(na(i),t,!0)));return n([o]),{value:o,gradFunc:(e,n)=>{const[r]=n,i=na(r);return Ra(e,Do(Xs(e,t,!0),i))}}}));return r(n)}}),ya=hi({logSumExp_:function(e,t=null,n=!1){const r=li(e,"x","logSumExp"),i=at(t,r.shape),o=Ys(r,i,!0),s=Ra(r,o),a=na(s),c=Xs(a,i),u=_a(c),l=bo(rs(o,u.shape),u);if(n){const e=Qs(l.shape,i);return rs(l,e)}return l}}),Sa=hi({logicalAnd_:function(e,t){const n=li(e,"a","logicalAnd","bool"),r=li(t,"b","logicalAnd","bool");so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("LogicalAnd",i)}}),Ca=hi({logicalNot_:function(e){const t={x:li(e,"x","logicalNot","bool")};return sr.runKernel("LogicalNot",t)}}),Oa=hi({logicalOr_:function(e,t){const n=li(e,"a","logicalOr","bool"),r=li(t,"b","logicalOr","bool");so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("LogicalOr",i)}}),ba=hi({searchSorted_:function(e,t,n="left"){const r=li(e,"sortedSequence","searchSorted"),i=li(t,"values","searchSorted"),o=r.shape[r.shape.length-1],s=i.shape[i.shape.length-1],a=rs(r,[-1,o]),c=rs(i,[-1,s]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==c.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(et(c.shape)>=2147483648)throw new Error("values tensor size must less than 2147483648");if(a.shape[1]>=2147483648)throw new Error(`trailing dim_size must less than 2147483648 for int32 output type, was ${a.shape[1]}`);const u={sortedSequence:a,values:c},l={side:n};return sr.runKernel("SearchSorted",u,l)}});function wa(e,t){return ba(e,t,"left")}const Na=hi({maxPool_:function(e,t,n,r,i){const o=li(e,"x","maxPool");let s=o,a=!1;3===o.rank&&(a=!0,s=rs(o,[1,o.shape[0],o.shape[1],o.shape[2]])),qe(4===s.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${s.rank}.`)),qe(es(n,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`)),ns("maxPool",r,i);const c={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:i},l=sr.runKernel("MaxPool",c,u);return a?rs(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),Da=hi({maxPool3d_:function(e,t=[1,1,1],n,r,i,o="NDHWC"){const s=li(e,"x","maxPool3d");let a=s,c=!1;4===s.rank&&(c=!0,a=rs(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),qe(5===a.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`)),qe("NDHWC"===o,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`)),ns("maxPool3d",r,i);const u={x:a},l={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:o},d=sr.runKernel("MaxPool3D",u,l);return c?rs(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),La=hi({maxPoolWithArgmax_:function(e,t,n,r,i=!1){const o={x:li(e,"x","maxPoolWithArgmax")},s={filterSize:t,strides:n,pad:r,includeBatchInIndex:i},a=sr.runKernel("MaxPoolWithArgmax",o,s);return{result:a[0],indexes:a[1]}}}),Pa=hi({maximum_:function(e,t){let n=li(e,"a","maximum"),r=li(t,"b","maximum");[n,r]=Zn(n,r),"bool"===n.dtype&&(n=Ki(n,"int32"),r=Ki(r,"int32")),so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("Maximum",i)}}),ka=hi({mean_:function(e,t=null,n=!1){const r={x:li(e,"x","mean")},i={axis:t,keepDims:n};return sr.runKernel("Mean",r,i)}});function xa(e,t="float32"){if("complex64"===t){const t=xa(e,"float32"),n=xa(e,"float32");return pi(t,n)}const n=Rt(et(e),t);return sr.makeTensor(n,e,t)}function Ma(e,t="float32"){if("complex64"===t){const t=Ma(e,"float32"),n=xa(e,"float32");return pi(t,n)}const n=Tt(et(e),t);return sr.makeTensor(n,e,t)}const Ua=hi({minimum_:function(e,t){let n=li(e,"a","minimum"),r=li(t,"b","minimum");[n,r]=Zn(n,r),"bool"===n.dtype&&(n=Ki(n,"int32"),r=Ki(r,"int32")),so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("Minimum",i)}}),Ba=hi({mirrorPad_:function(e,t,n){qe("reflect"===n||"symmetric"===n,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`));const r=li(e,"x","mirrorPad");if(0===r.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");qe(t.length===r.rank,(()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`));const i="reflect"===n?1:0;for(let e=0;e<r.rank;e++)qe(2===t[e].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),qe(t[e][0]>=0&&t[e][0]<=r.shape[e]-i&&t[e][1]>=0&&t[e][1]<=r.shape[e]-i,(()=>`Padding in dimension ${e} cannot be greater than or equal to ${r.shape[e]-i} or less than 0 for input of shape ${r.shape}`));const o={paddings:t,mode:n},s={x:r};return sr.runKernel("MirrorPad",s,o)}}),Fa=hi({mod_:function(e,t){let n=li(e,"a","mod"),r=li(t,"b","mod");[n,r]=Zn(n,r);const i={a:n,b:r};return sr.runKernel("Mod",i)}}),Va=hi({multinomial_:function(e,t,n,r=!1){const i=li(e,"logits","multinomial"),o=i.size,s=i.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(s>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${s}`);n=n||Math.random();const a={logits:1===s?rs(i,[1,-1]):i},c={numSamples:t,seed:n,normalized:r},u=sr.runKernel("Multinomial",a,c);return 1===s?rs(u,[u.size]):u}}),Ga=hi({notEqual_:function(e,t){let n=li(e,"a","notEqual","string_or_numeric"),r=li(t,"b","notEqual","string_or_numeric");[n,r]=Zn(n,r),so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("NotEqual",i)}}),Qa=hi({onesLike_:function(e){const t={x:li(e,"x","onesLike")};return sr.runKernel("OnesLike",t)}}),ja=hi({pad_:function(e,t,n=0){const r=li(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:t,constantValue:n},o={x:r};return sr.runKernel("PadV2",o,i)}}),Ha=hi({spaceToBatchND_:function(e,t,n){const r=li(e,"x","spaceToBatchND");qe(r.rank>=1+t.length,(()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`)),qe(n.length===t.length,(()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`)),qe(r.shape.reduce(((e,r,i)=>i>0&&i<=t.length?e&&(r+n[i-1][0]+n[i-1][1])%t[i-1]==0:e),!0),(()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`));const i={x:r},o={blockShape:t,paddings:n};return sr.runKernel("SpaceToBatchND",i,o)}}),Wa=hi({prelu_:function(e,t){const n={x:li(e,"x","prelu"),alpha:li(t,"alpha","prelu")};return sr.runKernel("Prelu",n)}}),Ya=hi({prod_:function(e,t=null,n=!1){let r=li(e,"x","prod");"bool"===r.dtype&&(r=Ki(r,"int32"));const i={x:r},o={axis:t,keepDims:n};return sr.runKernel("Prod",i,o)}});function Ka(e){var t={exports:{}};return e(t,t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==o.g?o.g:"undefined"!=typeof self&&self;var $a=Ka((function(e){!function(e,t,n){function r(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function o(e,t){var n=new r(e),o=t&&t.state,s=n.next;return s.int32=function(){return 4294967296*n.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.alea=o}(0,e)})),za=Ka((function(e){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function o(e,t){var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.xor128=o}(0,e)})),qa=Ka((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function o(e,t){var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.xorwow=o}(0,e)})),Ja=Ka((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,i=t.i;return e=r[i],n=(e^=e>>>7)^e<<24,n^=(e=r[i+1&7])^e>>>10,n^=(e=r[i+3&7])^e>>>3,n^=(e=r[i+4&7])^e<<7,e=r[i+7&7],n^=(e^=e<<13)^e<<9,r[i]=n,t.i=i+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function o(e,t){null==e&&(e=+new Date);var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,o&&(o.x&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.xorshift7=o}(0,e)})),Xa=Ka((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,i=t.X,o=t.i;return t.w=r=r+1640531527|0,n=i[o+34&127],e=i[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=i[o]=n^e,t.i=o,n+(r^r>>>16)|0},function(e,t){var n,r,i,o,s,a=[],c=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,c=Math.max(c,t.length)),i=0,o=-32;o<c;++o)t&&(r^=t.charCodeAt((o+32)%t.length)),0===o&&(s=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(s=s+1640531527|0,i=0==(n=a[127&o]^=r+s)?i+1:0);for(i>=128&&(a[127&(t&&t.length||0)]=-1),i=127,o=512;o>0;--o)r=a[i+34&127],n=a[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,a[i]=r^n;e.w=s,e.X=a,e.i=i}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function o(e,t){null==e&&(e=+new Date);var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,o&&(o.X&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.xor4096=o}(0,e)})),Za=Ka((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function o(e,t){var n=new r(e),o=t&&t.state,s=function(){return(n.next()>>>0)/4294967296};return s.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},s.int32=n.next,s.quick=s,o&&("object"==typeof o&&i(o,n),s.state=function(){return i(n,{})}),s}t&&t.exports?t.exports=o:this.tychei=o}(0,e)})),ec=function(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}(Object.freeze({__proto__:null,default:{}})),tc=Ka((function(e){!function(t,n){var r,i=this,o=256,s=n.pow(o,6),a=n.pow(2,52),c=2*a,u=255;function l(e,u,l){var E=[],g=f(p((u=1==u?{entropy:!0}:u||{}).entropy?[e,A(t)]:null==e?function(){try{var e;return r&&(e=r.randomBytes)?e=e(o):(e=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(e)),A(e)}catch(e){var n=i.navigator,s=n&&n.plugins;return[+new Date,i,s,i.screen,A(t)]}}():e,3),E),_=new d(E),m=function(){for(var e=_.g(6),t=s,n=0;e<a;)e=(e+n)*o,t*=o,n=_.g(1);for(;e>=c;)e/=2,t/=2,n>>>=1;return(e+n)/t};return m.int32=function(){return 0|_.g(4)},m.quick=function(){return _.g(4)/4294967296},m.double=m,f(A(_.S),t),(u.pass||l||function(e,t,r,i){return i&&(i.S&&h(i,_),e.state=function(){return h(_,{})}),r?(n.random=e,t):e})(m,g,"global"in u?u.global:this==n,u.state)}function d(e){var t,n=e.length,r=this,i=0,s=r.i=r.j=0,a=r.S=[];for(n||(e=[n++]);i<o;)a[i]=i++;for(i=0;i<o;i++)a[i]=a[s=u&s+e[i%n]+(t=a[i])],a[s]=t;(r.g=function(e){for(var t,n=0,i=r.i,s=r.j,a=r.S;e--;)t=a[i=u&i+1],n=n*o+a[u&(a[i]=a[s=u&s+t])+(a[s]=t)];return r.i=i,r.j=s,n})(o)}function h(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function p(e,t){var n,r=[],i=typeof e;if(t&&"object"==i)for(n in e)try{r.push(p(e[n],t-1))}catch(e){}return r.length?r:"string"==i?e:e+"\0"}function f(e,t){for(var n,r=e+"",i=0;i<r.length;)t[u&i]=u&(n^=19*t[u&i])+r.charCodeAt(i++);return A(t)}function A(e){return String.fromCharCode.apply(0,e)}if(n.seedrandom=l,f(n.random(),t),e.exports){e.exports=l;try{r=ec}catch(e){}}}([],Math)}));tc.alea=$a,tc.xor128=za,tc.xorwow=qa,tc.xorshift7=Ja,tc.xor4096=Xa,tc.tychei=Za;var nc=tc;class rc{constructor(e,t,n,r,i){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const o=i||Math.random();this.random=nc.alea(o.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,i,o;do{r=2*this.random()-1,i=2*this.random()-1,o=r*r+i*i}while(o>=1||0===o);const s=Math.sqrt(-2*Math.log(o)/o);e=this.mean+this.stdDev*r*s,t=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(e)||(n=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class ic{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=nc.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const oc=hi({randomUniform_:function(e,t=0,n=1,r="float32",i){const o=Es(e,r),s=new ic(t,n,null,i);for(let e=0;e<o.values.length;e++)o.values[e]=s.nextValue();return o.toTensor()}});function sc(e,t,n=1,r="float32"){if(0===n)throw new Error("Cannot have a step of zero");const i={start:e,stop:t,step:n,dtype:r};return sr.runKernel("Range",{},i)}const ac=hi({reciprocal_:function(e){const t={x:li(e,"x","reciprocal")};return sr.runKernel("Reciprocal",t)}}),cc=hi({relu_:function(e){const t={x:li(e,"x","relu")};return sr.runKernel("Relu",t)}}),uc=hi({relu6_:function(e){const t={x:li(e,"x","relu6")};return sr.runKernel("Relu6",t)}}),lc=hi({reverse_:function(e,t){const n={x:li(e,"x","reverse")},r={dims:t};return sr.runKernel("Reverse",n,r)}}),dc=hi({round_:function(e){const t={x:li(e,"x","round")};return sr.runKernel("Round",t)}}),hc=hi({rsqrt_:function(e){const t={x:li(e,"x","rsqrt","float32")};return sr.runKernel("Rsqrt",t)}}),pc=hi({selu_:function(e){const t={x:li(e,"x","selu")};return sr.runKernel("Selu",t)}}),fc=hi({sign_:function(e){const t={x:li(e,"x","sign")};return sr.runKernel("Sign",t)}}),Ac=hi({sin_:function(e){const t={x:li(e,"x","sin","float32")};return sr.runKernel("Sin",t)}}),Ec=hi({sinh_:function(e){const t={x:li(e,"x","sinh")};return sr.runKernel("Sinh",t)}}),gc=hi({softmax_:function(e,t=-1){const n=li(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);const r={logits:n},i={dim:t};return sr.runKernel("Softmax",r,i)}}),_c=hi({fft_:function(e){qe("complex64"===e.dtype,(()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`));const t={input:e};return sr.runKernel("FFT",t)}}),mc=hi({ifft_:function(e){qe("complex64"===e.dtype,(()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`));const t={input:e};return sr.runKernel("IFFT",t)}}),Ic=hi({irfft_:function(e){const t=e.shape[e.shape.length-1],n=e.size/t;let r;if(t<=2){const i=rs(e,[n,t]);r=mc(i)}else{const i=[n,2*(t-1)],o=rs(no(e),[n,t]),s=rs(eo(e),[n,t]),a=lc(us(o,[0,1],[n,t-2]),1),c=Do(lc(us(s,[0,1],[n,t-2]),1),zs(-1)),u=as([o,a],1),l=as([s,c],1),d=rs(pi(u,l),[i[0],i[1]]);r=mc(d)}if(r=no(r),3===e.rank&&0!==e.shape[0]){const t=r,n=e.shape[0];r=rs(r,[n,r.shape[0]/n,r.shape[1]]),t.dispose()}return r}}),Tc=hi({split_:function(e,t,n=0){const r={x:li(e,"x","split")},i={numOrSizeSplits:t,axis:n};return sr.runKernel("SplitV",r,i)}}),Rc=hi({rfft_:function(e,t){qe("float32"===e.dtype,(()=>`The dtype for rfft() must be real value but got ${e.dtype}`));let n=e.shape[e.shape.length-1];const r=e.size/n;let i;if(null!=t&&t<n){const r=e.shape.map((e=>0)),o=e.shape.map((e=>e));o[e.shape.length-1]=t,i=us(e,r,o),n=t}else if(null!=t&&t>n){const r=e.shape.map((e=>e));r[e.shape.length-1]=t-n,i=as([e,xa(r)],e.shape.length-1),n=t}else i=e;const o=ks(i),s=rs(pi(i,o),[r,n]),a=_c(s),c=Math.floor(n/2)+1,u=no(a),l=eo(a),d=Tc(u,[c,n-c],u.shape.length-1),h=Tc(l,[c,n-c],l.shape.length-1),p=i.shape.slice();return p[i.shape.length-1]=c,rs(pi(d[0],h[0]),p)}}),vc=hi({squaredDifference_:function(e,t){let n=li(e,"a","squaredDifference"),r=li(t,"b","squaredDifference");[n,r]=Zn(n,r),so(n.shape,r.shape);const i={a:n,b:r};return sr.runKernel("SquaredDifference",i,{})}}),yc=hi({squeeze_:function(e,t){const n=li(e,"x","squeeze");return rs(n,ct(n.shape,t).newShape)}}),Sc=hi({stack_:function(e,t=0){const n=di(e,"tensors","stack","string_or_numeric");qe(n.length>=1,(()=>"Pass at least one tensor to tf.stack")),n.length>0&&qe(t<=n[0].rank,(()=>"Axis must be <= rank of the tensor"));const r=n,i={axis:t};return sr.runKernel("Pack",r,i)}}),Cc=hi({step_:function(e,t=0){const n={x:li(e,"x","step")},r={alpha:t};return sr.runKernel("Step",n,r)}}),Oc=hi({stridedSlice_:function(e,t,n,r,i=0,o=0,s=0,a=0,c=0){const u={x:li(e,"x","stridedSlice","string_or_numeric")},l={begin:t,end:n,strides:r,beginMask:i,endMask:o,ellipsisMask:s,newAxisMask:a,shrinkAxisMask:c};return sr.runKernel("StridedSlice",u,l)}}),bc=hi({tan_:function(e){const t={x:li(e,"x","tan","float32")};return sr.runKernel("Tan",t)}});function wc(e,t){Xe(e);const n=ai(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return fi(e,null,n,t)}function Nc(e,t,n){if(Xe(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const r=ai(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return fi(e,t,r,n)}const Dc=hi({topk_:function(e,t=1,n=!0){const r=li(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);const o={x:r},s={k:t,sorted:n},[a,c]=sr.runKernel("TopK",o,s);return{values:a,indices:c}}}),Lc=hi({truncatedNormal_:function(e,t=0,n=1,r,i){if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");const o=new rc(t,n,r,!0,i),s=Es(e,r);for(let e=0;e<s.values.length;e++)s.values[e]=o.nextValue();return s.toTensor()}}),Pc=hi({unique_:function(e,t=0){const n=li(e,"x","unique","string_or_numeric");qe(n.rank>0,(()=>"The input tensor must be at least 1D"));const r={x:n},i={axis:t},[o,s]=sr.runKernel("Unique",r,i);return{values:o,indices:s}}}),kc=hi({unstack_:function(e,t=0){const n=li(e,"x","unstack","string_or_numeric");qe(t>=-n.shape.length&&t<n.shape.length,(()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`));const r={value:n},i={axis:t};return sr.runKernel("Unpack",r,i)}});function xc(e,t){return ba(e,t,"right")}function Mc(e,t){const n=[];for(let e=0;e<t.length;e++)t[e]&&n.push(e);const r=Es(e,"int32"),i=Es([n.length,e.length],"int32");for(let t=0;t<n.length;t++){const o=r.indexToLoc(n[t]),s=t*e.length;i.values.set(o,s)}return i.toTensor()}const Uc=async function(e){const t=li(e,"condition","whereAsync","bool"),n=await t.data(),r=Mc(t.shape,n);return e!==t&&t.dispose(),r},Bc=hi({scatterND_:function(e,t,n){const r=li(e,"indices","scatterND","int32"),i=li(t,"updates","scatterND");lo(i,r,n);const o={indices:r,updates:i},s={shape:n};return sr.runKernel("ScatterNd",o,s)}}),Fc=hi({sparseToDense_:function(e,t,n,r=0){const i=li(e,"sparseIndices","sparseToDense","int32"),o=li(t,"sparseValues","sparseToDense","string_or_numeric"),s=li(r,"defaultValue","sparseToDense",o.dtype);!function(e,t,n,r){if("int32"!==e.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const i=e.rank>0?e.shape[0]:1,o=e.rank>1?e.shape[1]:1;if(n.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${o}.`);const s=t.size;if(0!==t.rank&&(1!==t.rank||s!==i))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${i}]`);if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(i,o,n,s);const a={sparseIndices:i,sparseValues:o,defaultValue:s},c={outputShape:n};return sr.runKernel("SparseToDense",a,c)}}),Vc=hi({gatherND_:function(e,t){const n=li(t,"indices","gatherND","int32"),r={params:li(e,"x","gatherND","string_or_numeric"),indices:n};return sr.runKernel("GatherNd",r)}});function Gc(e,t,n){const r=1-e%2,i=new Float32Array(e);for(let o=0;o<e;++o){const s=2*Math.PI*o/(e+r-1);i[o]=t-n*Math.cos(s)}return wc(i,"float32")}const Qc=hi({conv2DBackpropFilter_:function(e,t,n,r,i,o="NHWC",s){let a=e;3===e.rank&&(a=rs(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let c=t;3===c.rank&&(c=rs(t,[1,t.shape[0],t.shape[1],t.shape[2]])),qe(4===a.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`)),qe(4===c.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${c.shape}.`)),qe(4===n.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`));const u="NHWC"===o?a.shape[3]:a.shape[1],l="NHWC"===o?c.shape[3]:c.shape[1];qe(u===n[2],(()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`)),qe(l===n[3],(()=>`Error in conv2dDerFilter: depth of dy (${l}) must match output depth for filter (${n[3]}).`)),ns("conv2dDerFilter",i,s);const d={x:a,dy:c},h={strides:r,pad:i,dataFormat:o,dimRoundingMode:s,filterShape:n};return sr.runKernel("Conv2DBackpropFilter",d,h)}});function jc(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Do(e,Cc(t));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Hc(e,t){let n=t;const r=oo(e.shape,t.shape);return r.length>0&&(n=Xs(n,r)),rs(n,e.shape)}function Wc(e,t,n,r){if("linear"===t)return e;if("relu"===t)return cc(e);if("elu"===t)return Us(e);if("relu6"===t)return uc(e);if("prelu"===t)return Wa(e,n);if("leakyrelu"===t)return pa(e,r);if("sigmoid"===t)return cs(e);throw new Error(`Unknown fused activation ${t}.`)}const Yc=(e,t)=>!(e>0)||"linear"===t,Kc=hi({fusedConv2d_:function({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:a,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:l}){if(c=c||"linear",!1===Yc(sr.state.gradientDepth,c)){qe("NHWC"===i,(()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`));let d=ms(e,t,n,r,i,o,s);return null!=a&&(d=bo(d,a)),Wc(d,c,u,l)}const d=li(e,"x","conv2d","float32"),h=li(t,"filter","conv2d","float32");let p=d,f=!1;3===d.rank&&(f=!0,p=rs(d,[1,d.shape[0],d.shape[1],d.shape[2]])),qe(4===p.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`)),qe(4===h.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`)),ns("fused conv2d",r,s);const A="NHWC"===i?p.shape[3]:p.shape[1];qe(h.shape[2]===A,(()=>`Error in conv2d: depth of input (${A}) must match input depth for filter ${h.shape[2]}.`)),qe(es(n,o),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`));const E=Yo(p.shape,h.shape,n,o,r,s);let g,_;if(null!=a&&(g=li(a,"bias","fused conv2d"),[g]=Zn(g,d),"NHWC"===i?so(E.outShape,g.shape):(qe(g.shape.length<=1,(()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`)),qe(0===g.shape.length||g.shape[0]===E.outChannels||1===g.shape[0],(()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${E.outChannels})`)))),null!=u){const e=u.shape;if(qe(e.length<=1||3===e.length,(()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${e.length}.`)),1===e.length)qe(1===e[0]||e[0]===E.outChannels,(()=>`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the number of output channels (${E.outChannels}).`));else if(3===e.length)try{so(e,E.outShape)}catch(t){const n=`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the output shape of the conv2d (${E.outShape}).`;throw Error(n)}_=li(u,"prelu weights","fused conv2d")}const m=(e,t)=>{qe("NHWC"===i,(()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`));const[s,a,u,l]=t,d=jc(e,u,c);qe(Zo(o),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`));const h=[Ts(a.shape,d,s,n,r),Qc(a,d,s.shape,n,r)];if(null!=l){const e=Hc(l,d);h.push(e)}return h},I={x:p,filter:h,bias:g,preluActivationWeights:_},T={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s,activation:c,leakyreluAlpha:l};if(null==a){const e=Ia(((e,t,n)=>{let r=sr.runKernel("FusedConv2D",I,T);return n([t,e,r]),f&&(r=rs(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:m}}));return e(p,h)}{const e=Ia(((e,t,n,r)=>{let i=sr.runKernel("FusedConv2D",I,T);return r([t,e,i,n]),f&&(i=rs(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:m}}));return e(p,h,g)}}}),$c=hi({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,i,o=[1,1],s){let a=e;3===e.rank&&(a=rs(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let c=t;3===c.rank&&(c=rs(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={x:a,dy:c},l={strides:r,pad:i,dimRoundingMode:s,dilations:o,filterShape:n};return sr.runKernel("DepthwiseConv2dNativeBackpropFilter",u,l)}}),zc=hi({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,i,o=[1,1],s){let a=t,c=!1;3===t.rank&&(c=!0,a=rs(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={dy:a,filter:n},l={strides:r,pad:i,dimRoundingMode:s,dilations:o,inputShape:e},d=sr.runKernel("DepthwiseConv2dNativeBackpropInput",u,l);return c?rs(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),qc=hi({fusedDepthwiseConv2d_:function({x:e,filter:t,strides:n,pad:r,dataFormat:i="NHWC",dilations:o=[1,1],dimRoundingMode:s,bias:a,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:l}){if(!1===Yc(sr.state.gradientDepth,c)){let d=Ns(e,t,n,r,i,o,s);return null!=a&&(d=bo(d,a)),Wc(d,c,u,l)}const d=li(e,"x","depthwiseConv2d","float32"),h=li(t,"filter","depthwiseConv2d","float32");let p=d,f=!1;3===d.rank&&(f=!0,p=rs(d,[1,d.shape[0],d.shape[1],d.shape[2]])),qe(4===p.rank,(()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`)),qe(4===h.rank,(()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`)),qe(p.shape[3]===h.shape[2],(()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`)),null==o&&(o=[1,1]),qe(es(n,o),(()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`)),ns("fused depthwiseConv2d",r,s);const A=Yo(p.shape,h.shape,n,o,r,s,!0);let E,g;null!=a&&(E=li(a,"bias","fused conv2d"),[E]=Zn(E,d),so(A.outShape,E.shape)),null!=u&&(g=li(u,"prelu weights","fused depthwiseConv2d"));const _=(e,t)=>{qe(Zo(o),(()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`));const[i,a,u,l]=t,d=jc(e,u,c),h=zc(a.shape,d,i,n,r,o,s),p=$c(a,d,i.shape,n,r,o,s);return null!=l?[h,p,Hc(E,d)]:[h,p]},m={x:p,filter:h,bias:E,preluActivationWeights:g},I={strides:n,pad:r,dataFormat:i,dilations:o,dimRoundingMode:s,activation:c,leakyreluAlpha:l};if(null==a){const e=Ia(((e,t,n)=>{let r=sr.runKernel("FusedDepthwiseConv2D",m,I);return n([t,e,r]),f&&(r=rs(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:_}}));return e(p,h)}{const e=Ia(((e,t,n,r)=>{let i=sr.runKernel("FusedDepthwiseConv2D",m,I);return r([t,e,i,n]),f&&(i=rs(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:_}}));return e(p,h,E)}}}),Jc=hi({fusedMatMul_:function({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:o="linear",preluActivationWeights:s,leakyreluAlpha:a}){if(!1===Yc(sr.state.gradientDepth,o)){let c=$i(e,t,n,r);return null!=i&&(c=bo(c,i)),Wc(c,o,s,a)}let c=li(e,"a","fused matMul"),u=li(t,"b","fused matMul");[c,u]=Zn(c,u);const l=n?c.shape[c.rank-2]:c.shape[c.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],h=n?c.shape[c.rank-1]:c.shape[c.rank-2],p=r?u.shape[u.rank-2]:u.shape[u.rank-1],f=c.shape.slice(0,-2),A=u.shape.slice(0,-2),E=et(f),g=et(A);qe(l===d,(()=>`Error in fused matMul: inner shapes (${l}) and (${d}) of Tensors with shapes ${c.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`));const _=so(c.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,p]),m=rs(c,n?[E,l,h]:[E,h,l]),I=rs(u,r?[g,p,d]:[g,d,p]);let T,R;null!=i&&(T=li(i,"bias","fused matMul"),[T]=Zn(T,c),so(_,T.shape)),null!=s&&(R=li(s,"prelu weights","fused matMul"));const v=(e,t)=>{const[s,a,c,u]=t,l=jc(rs(e,c.shape),c,o);let d,h;return n||r?!n&&r?(d=$i(l,a,!1,!1),h=$i(l,s,!0,!1)):n&&!r?(d=$i(a,l,!1,!0),h=$i(s,l,!1,!1)):(d=$i(a,l,!0,!0),h=$i(l,s,!0,!0)):(d=$i(l,a,!1,!0),h=$i(s,l,!0,!1)),null!=i?[d,h,Hc(u,l)]:[d,h]},y={a:m,b:I,bias:T,preluActivationWeights:R},S={transposeA:n,transposeB:r,activation:o,leakyreluAlpha:a};if(null==i){const e=Ia(((e,t,n)=>{const r=sr.runKernel("_FusedMatMul",y,S);return n([e,t,r]),{value:rs(r,_),gradFunc:v}}));return e(m,I)}{const e=Ia(((e,t,n,r)=>{const i=sr.runKernel("_FusedMatMul",y,S);return r([e,t,i,n]),{value:rs(i,_),gradFunc:v}}));return e(m,I,T)}}});hi({hammingWindow_:function(e){return Gc(e,.54,.46)}});const Xc=hi({hannWindow_:function(e){return Gc(e,.5,.5)}}),Zc=hi({frame_:function(e,t,n,r=!1,i=0){let o=0;const s=[];for(;o+t<=e.size;)s.push(us(e,o,t)),o+=n;if(r)for(;o<e.size;){const r=o+t-e.size,a=as([us(e,o,t-r),aa([r],i)]);s.push(a),o+=n}return 0===s.length?Nc([],[0,t]):rs(as(s),[s.length,t])}});hi({stft_:function(e,t,n,r,i=Xc){var o;null==r&&(o=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(o)/Math.log(2)))));const s=Zc(e,t,n),a=Do(s,i(t));return Rc(a,r)}});const eu=hi({cropAndResize_:function(e,t,n,r,i="bilinear",o=0){const s=li(e,"image","cropAndResize"),a=li(t,"boxes","cropAndResize","float32"),c=li(n,"boxInd","cropAndResize","int32"),u=a.shape[0];qe(4===s.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${s.rank}.`)),qe(2===a.rank&&4===a.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`)),qe(1===c.rank&&c.shape[0]===u,(()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`)),qe(2===r.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`)),qe(r[0]>=1&&r[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${r}`)),qe("bilinear"===i||"nearest"===i,(()=>`method must be bilinear or nearest, but was ${i}`));const l={image:s,boxes:a,boxInd:c},d={method:i,extrapolationValue:o,cropSize:r};return sr.runKernel("CropAndResize",l,d)}}),tu=hi({flipLeftRight_:function(e){const t=li(e,"image","flipLeftRight","float32");qe(4===t.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`));const n={image:t};return sr.runKernel("FlipLeftRight",n,{})}}),nu=hi({grayscaleToRGB_:function(e){const t=li(e,"image","grayscaleToRGB"),n=t.rank-1,r=t.shape[n];qe(t.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`)),qe(1===r,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`));const i=new Array(t.rank);return i.fill(1,0,n),i[n]=3,oa(t,i)}}),ru=hi({rotateWithOffset_:function(e,t,n=0,r=.5){const i=li(e,"image","rotateWithOffset","float32");qe(4===i.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`));const o={image:i},s={radians:t,fillValue:n,center:r};return sr.runKernel("RotateWithOffset",o,s)}});function iu(e,t,n,r,i,o){null==r&&(r=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==o&&(o=0);const s=e.shape[0];return n=Math.min(n,s),qe(0<=r&&r<=1,(()=>`iouThreshold must be in [0, 1], but was '${r}'`)),qe(2===e.rank,(()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`)),qe(4===e.shape[1],(()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`)),qe(1===t.rank,(()=>"scores must be a 1D tensor")),qe(t.shape[0]===s,(()=>`scores has incompatible shape with boxes. Expected ${s}, but was ${t.shape[0]}`)),qe(0<=o&&o<=1,(()=>`softNmsSigma must be in [0, 1], but was '${o}'`)),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:o}}const ou=hi({nonMaxSuppression_:function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const o=li(e,"boxes","nonMaxSuppression","float32"),s=li(t,"scores","nonMaxSuppression","float32"),a=iu(o,s,n,r,i),c={maxOutputSize:n=a.maxOutputSize,iouThreshold:r=a.iouThreshold,scoreThreshold:i=a.scoreThreshold};return sr.runKernel("NonMaxSuppressionV3",{boxes:o,scores:s},c)}});function su(e,t,n){const r=function(e,t,n){return function(e,t,n){let r=0,i=e.length,o=0,s=!1;for(;r<i;){o=r+(i-r>>>1);const a=n(t,e[o]);a>0?r=o+1:(i=o,s=!a)}return s?r:-r-1}(e,t,n||au)}(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function au(e,t){return e>t?1:e<t?-1:0}function cu(e,t,n,r,i,o,s=!1,a=!1,c=!1){const u=[];for(let e=0;e<t.length;e++)t[e]>i&&u.push({score:t[e],boxIndex:e,suppressBeginIndex:0});u.sort(du);const l=o>0?-.5/o:0,d=[],h=[];for(;d.length<n&&u.length>0;){const t=u.pop(),{score:n,boxIndex:o,suppressBeginIndex:s}=t;if(n<i)break;let a=!1;for(let n=d.length-1;n>=s;--n){const s=uu(e,o,d[n]);if(s>=r){a=!0;break}if(t.score=t.score*lu(r,l,s),t.score<=i)break}t.suppressBeginIndex=d.length,a||(t.score===n?(d.push(o),h.push(t.score)):t.score>i&&su(u,t,du))}const p=d.length,f=n-p;a&&f>0&&(d.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));const A={selectedIndices:d};return s&&(A.selectedScores=h),c&&(A.validOutputs=p),A}function uu(e,t,n){const r=e.subarray(4*t,4*t+4),i=e.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),u=Math.min(i[0],i[2]),l=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]),p=(a-o)*(c-s),f=(d-u)*(h-l);if(p<=0||f<=0)return 0;const A=Math.max(o,u),E=Math.max(s,l),g=Math.min(a,d),_=Math.min(c,h),m=Math.max(g-A,0)*Math.max(_-E,0);return m/(p+f-m)}function lu(e,t,n){const r=Math.exp(t*n*n);return n<=e?r:0}function du(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}const hu=hi({nonMaxSuppressionWithScore_:function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=0){const s=li(e,"boxes","nonMaxSuppression"),a=li(t,"scores","nonMaxSuppression"),c=iu(s,a,n,r,i,o),u={boxes:s,scores:a},l={maxOutputSize:n=c.maxOutputSize,iouThreshold:r=c.iouThreshold,scoreThreshold:i=c.scoreThreshold,softNmsSigma:o=c.softNmsSigma},d=sr.runKernel("NonMaxSuppressionV5",u,l);return{selectedIndices:d[0],selectedScores:d[1]}}}),pu=hi({nonMaxSuppressionPadded_:function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=!1){const s=li(e,"boxes","nonMaxSuppression"),a=li(t,"scores","nonMaxSuppression"),c=iu(s,a,n,r,i,null),u={boxes:s,scores:a},l={maxOutputSize:c.maxOutputSize,iouThreshold:c.iouThreshold,scoreThreshold:c.scoreThreshold,padToMaxOutputSize:o},d=sr.runKernel("NonMaxSuppressionV4",u,l);return{selectedIndices:d[0],validOutputs:d[1]}}}),fu=hi({resizeBilinear_:function(e,t,n=!1,r=!1){const i=li(e,"images","resizeBilinear");qe(3===i.rank||4===i.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`)),qe(2===t.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`)),qe(!1===r||!1===n,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let o=i,s=!1;3===i.rank&&(s=!0,o=rs(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const a={images:o},c={alignCorners:n,halfPixelCenters:r,size:t},u=sr.runKernel("ResizeBilinear",a,c);return s?rs(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),Au=hi({resizeNearestNeighbor_:function(e,t,n=!1,r=!1){const i=li(e,"images","resizeNearestNeighbor");qe(3===i.rank||4===i.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`)),qe(2===t.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`)),qe("float32"===i.dtype||"int32"===i.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),qe(!1===r||!1===n,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let o=i,s=!1;3===i.rank&&(s=!0,o=rs(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const a={images:o},c={alignCorners:n,halfPixelCenters:r,size:t},u=sr.runKernel("ResizeNearestNeighbor",a,c);return s?rs(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),Eu=hi({threshold_:function(e,t="binary",n=!1,r=.5){const i=li(e,"image","threshold"),o=i.shape[0]*i.shape[1];let s,a,c,u,l=Do(wc([r]),255);if(qe(3===i.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`)),qe(3===i.shape[2]||1===i.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`)),qe("int32"===i.dtype||"float32"===i.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`)),qe("otsu"===t||"binary"===t,(()=>`Method must be binary or otsu, but was ${t}`)),3===i.shape[2]){[s,a,c]=Tc(i,[1,1,1],-1);const e=Do(s,.2989),t=Do(a,.587),n=Do(c,.114);u=bo(bo(e,t),n)}else u=e;"otsu"===t&&(l=function(e,t){let n,r,i,o,s,a,c=wc([-1]),u=wc([0]),l=wc([0]);for(let d=0;d<e.size-1;d++){n=us(e,0,d+1),r=us(e,d+1),s=No(Xs(n),t),a=No(Xs(r),t);const h=Xs(Do(n,sc(0,n.size)));i=No(h,Xs(n));const p=aa(r.shape,n.size),f=bo(sc(0,r.size),p),A=Do(r,f);o=No(Xs(A),Xs(r));const E=Ra(i,o),g=Ra(i,o),_=Do(s,a);l=Do(Do(_,E),g);const m=la(l,u);u=Ps(m,l,u),c=Ps(m,wc([d]),c)}return c}(ps(Ki(dc(u),"int32"),Ai([]),256),o));const d=n?Aa(u,l):la(u,l);return Ki(Do(d,255),"int32")}}),gu=hi({transform_:function(e,t,n="nearest",r="constant",i=0,o){const s=li(e,"image","transform","float32"),a=li(t,"transforms","transform","float32");qe(4===s.rank,(()=>`Error in transform: image must be rank 4,but got rank ${s.rank}.`)),qe(2===a.rank&&(a.shape[0]===s.shape[0]||1===a.shape[0])&&8===a.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),qe(null==o||2===o.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`));const c={image:s,transforms:a},u={interpolation:n,fillMode:r,fillValue:i,outputShape:o};return sr.runKernel("Transform",c,u)}});function _u(e,t=!1){return sr.tidy((()=>{qe(2===e.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`));const n=e.shape[0],r=e.shape[1];let i=sa(n),o=ss(e);const s=Nc([[1]],[1,1]);let a=ss(s);const c=n>=r?r:n;for(let e=0;e<c;++e){const t=o,c=a,u=i;[a,o,i]=sr.tidy((()=>{const t=us(o,[e,e],[n-e,1]),c=ea(t),u=us(o,[e,e],[1,1]),l=Ps(la(u,0),Nc([[-1]]),Nc([[1]])),d=Ra(u,Do(l,c)),h=No(t,d);a=1===h.shape[0]?ss(s):as([s,us(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);const p=to(No($i(l,d),c)),f=us(o,[e,0],[n-e,r]),A=Do(p,a),E=ro(a);if(0===e)o=Ra(f,$i(A,$i(E,f)));else{const t=Ra(f,$i(A,$i(E,f)));o=as([us(o,[0,0],[e,r]),t],0)}const g=ro(A),_=us(i,[0,e],[n,i.shape[1]-e]);if(0===e)i=Ra(_,$i($i(_,a),g));else{const t=Ra(_,$i($i(_,a),g));i=as([us(i,[0,0],[n,e]),t],1)}return[a,o,i]})),er([t,c,u]).forEach((e=>e.dispose()))}return!t&&n>r&&(i=us(i,[0,0],[n,r]),o=us(o,[0,0],[r,r])),[i,o]}))}var mu;hi({bandPart_:function(e,t,n){qe(t%1==0,(()=>`bandPart(): numLower must be an integer, got ${t}.`)),qe(n%1==0,(()=>`bandPart(): numUpper must be an integer, got ${n}.`));const r=li(e,"a","bandPart");qe(r.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`));const i=r.shape,[o,s]=r.shape.slice(-2);if(!(t<=o))throw new Error(`bandPart(): numLower (${t}) must not be greater than the number of rows (${o}).`);if(!(n<=s))throw new Error(`bandPart(): numUpper (${n}) must not be greater than the number of columns (${s}).`);t<0&&(t=o),n<0&&(n=s);const a=rs(sc(0,o,1,"int32"),[-1,1]),c=sc(0,s,1,"int32"),u=Ra(a,c),l=Sa(Aa(u,zs(+t,"int32")),da(u,zs(-n,"int32"))),d=xa([o,s],r.dtype);return rs(Sc(kc(rs(r,[-1,o,s])).map((e=>Ps(l,e,d)))),i)}}),hi({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,qe(null!=e&&e.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const n=e[0].shape[0];for(let t=1;t<e.length;++t)qe(e[t].shape[0]===n,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[t].shape[0]} vs. ${n})`))}else t=!0,e=Tc(e,e.shape[0],0).map((e=>yc(e,[0])));qe(e.length<=e[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`));const n=[],r=e;for(let t=0;t<e.length;++t)n.push(sr.tidy((()=>{let e=r[t];if(t>0)for(let r=0;r<t;++r){const t=Do(Xs(Do(n[r],e)),n[r]);e=Ra(e,t)}return No(e,ea(e,"euclidean"))})));return t?Sc(n,0):n}}),hi({qr_:function(e,t=!1){if(qe(e.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`)),2===e.rank)return _u(e,t);{const n=e.shape.slice(0,e.shape.length-2).reduce(((e,t)=>e*t)),r=kc(rs(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],o=[];return r.forEach((e=>{const[n,r]=_u(e,t);i.push(n),o.push(r)})),[rs(Sc(i,0),e.shape),rs(Sc(o,0),e.shape)]}}}),function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(mu||(mu={}));const Iu=hi({computeWeightedLoss_:function(e,t,n=mu.SUM_BY_NONZERO_WEIGHTS){const r=li(e,"losses","computeWeightedLoss");let i=null;null!=t&&(i=li(t,"weights","computeWeightedLoss"));const o=null==i?r:Do(r,i);if(n===mu.NONE)return o;if(n===mu.SUM)return Xs(o);if(n===mu.MEAN){if(null==i)return ka(o);{const e=r.size/i.size,t=No(Xs(o),Xs(i));return e>1?No(t,zs(e)):t}}if(n===mu.SUM_BY_NONZERO_WEIGHTS){if(null==i)return No(Xs(o),zs(r.size));{const e=Do(i,Ma(r.shape)),t=Ki(Xs(Ga(e,zs(0))),"float32");return No(Xs(o),t)}}throw Error(`Unknown reduction: ${n}`)}});hi({absoluteDifference_:function(e,t,n,r=mu.SUM_BY_NONZERO_WEIGHTS){const i=li(e,"labels","absoluteDifference"),o=li(t,"predictions","absoluteDifference");let s=null;null!=n&&(s=li(n,"weights","absoluteDifference")),Je(i.shape,o.shape,"Error in absoluteDifference: ");const a=Lo(Ra(i,o));return Iu(a,s,r)}}),hi({cosineDistance_:function(e,t,n,r,i=mu.SUM_BY_NONZERO_WEIGHTS){const o=li(e,"labels","cosineDistance"),s=li(t,"predictions","cosineDistance");let a=null;null!=r&&(a=li(r,"weights","cosineDistance")),Je(o.shape,s.shape,"Error in cosineDistance: ");const c=zs(1),u=Ra(c,Xs(Do(o,s),n,!0));return Iu(u,a,i)}}),hi({hingeLoss_:function(e,t,n,r=mu.SUM_BY_NONZERO_WEIGHTS){let i=li(e,"labels","hingeLoss");const o=li(t,"predictions","hingeLoss");let s=null;null!=n&&(s=li(n,"weights","hingeLoss")),Je(i.shape,o.shape,"Error in hingeLoss: ");const a=zs(1);i=Ra(Do(zs(2),i),a);const c=cc(Ra(a,Do(i,o)));return Iu(c,s,r)}}),hi({huberLoss_:function(e,t,n,r=1,i=mu.SUM_BY_NONZERO_WEIGHTS){const o=li(e,"labels","huberLoss"),s=li(t,"predictions","huberLoss");let a=null;null!=n&&(a=li(n,"weights","huberLoss")),Je(o.shape,s.shape,"Error in huberLoss: ");const c=zs(r),u=Lo(Ra(s,o)),l=Ua(u,c),d=Ra(u,l),h=bo(Do(zs(.5),Js(l)),Do(c,d));return Iu(h,a,i)}}),hi({logLoss_:function(e,t,n,r=1e-7,i=mu.SUM_BY_NONZERO_WEIGHTS){const o=li(e,"labels","logLoss"),s=li(t,"predictions","logLoss");let a=null;null!=n&&(a=li(n,"weights","logLoss")),Je(o.shape,s.shape,"Error in logLoss: ");const c=zs(1),u=zs(r),l=to(Do(o,_a(bo(s,u)))),d=Do(Ra(c,o),_a(bo(Ra(c,s),u))),h=Ra(l,d);return Iu(h,a,i)}}),hi({meanSquaredError_:function(e,t,n,r=mu.SUM_BY_NONZERO_WEIGHTS){const i=li(e,"labels","meanSquaredError"),o=li(t,"predictions","meanSquaredError");let s=null;null!=n&&(s=li(n,"weights","meanSquaredError")),Je(i.shape,o.shape,"Error in meanSquaredError: ");const a=vc(i,o);return Iu(a,s,r)}}),hi({sigmoidCrossEntropy_:function(e,t,n,r=0,i=mu.SUM_BY_NONZERO_WEIGHTS){let o=li(e,"multiClassLabels","sigmoidCrossEntropy");const s=li(t,"logits","sigmoidCrossEntropy");let a=null;if(null!=n&&(a=li(n,"weights","sigmoidCrossEntropy")),Je(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){const e=zs(r),t=zs(1),n=zs(.5);o=bo(Do(o,Ra(t,e)),Do(n,e))}const c=function(e,t){const n=li(e,"labels","sigmoidCrossEntropyWithLogits"),r=li(t,"logits","sigmoidCrossEntropyWithLogits");Je(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=cc(r),o=Do(r,n),s=ma(na(to(Lo(r))));return bo(Ra(i,o),s)}(o,s);return Iu(c,a,i)}}),hi({softmaxCrossEntropy_:function(e,t,n,r=0,i=mu.SUM_BY_NONZERO_WEIGHTS){let o=li(e,"onehotLabels","softmaxCrossEntropy");const s=li(t,"logits","softmaxCrossEntropy");let a=null;if(null!=n&&(a=li(n,"weights","softmaxCrossEntropy")),Je(o.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){const e=zs(r),t=zs(1),n=zs(o.shape[1]);o=bo(Do(o,Ra(t,e)),No(e,n))}const c=function(e,t,n=-1){if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${n}`);const r=Ia(((e,t,r)=>{const i=ya(t,[n],!0),o=Ra(Ki(t,"float32"),i);r([e,o]);const s=to(Do(o,e));return{value:Xs(s,[n]),gradFunc:(e,t)=>{const[r,i]=t,o=Qs(e.shape,[n]);return[Do(rs(e,o),Ra(Ki(r,"float32"),na(i))),Do(rs(e,o),Ra(na(i),Ki(r,"float32")))]}}}));return r(e,t)}(o,s);return Iu(c,a,i)}});const Tu=hi({sparseFillEmptyRows_:function(e,t,n,r){const i=li(e,"indices","sparseFillEmptyRows","int32"),o=li(t,"values","sparseFillEmptyRows"),s=li(n,"denseShape","sparseFillEmptyRows","int32"),a=li(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(2!==i.rank)throw new Error(`Indices should be Tensor2D but received shape\n        ${i.shape}`);if(1!==o.rank)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(1!==s.rank)throw new Error(`Dense shape should be Tensor1D but received shape ${s.shape}`);if(0!==a.rank)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const c={indices:i,values:o,denseShape:s,defaultValue:a},u=sr.runKernel("SparseFillEmptyRows",c);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}}),Ru=hi({sparseReshape_:function(e,t,n){const r=li(e,"inputIndices","sparseReshape","int32"),i=li(t,"inputShape","sparseReshape","int32"),o=li(n,"newShape","sparseReshape","int32");if(2!==r.rank)throw new Error(`Input indices should be Tensor2D but received shape\n        ${r.shape}`);if(1!==i.rank)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(1!==o.rank)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const s={inputIndices:r,inputShape:i,newShape:o},a=sr.runKernel("SparseReshape",s);return{outputIndices:a[0],outputShape:a[1]}}}),vu=hi({sparseSegmentMean_:function(e,t,n){const r=li(e,"data","sparseSegmentMean"),i=li(t,"indices","sparseSegmentMean","int32"),o=li(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error(`Indices should be Tensor1D but received shape\n          ${i.shape}`);if(1!==o.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n          ${o.shape}`);const s={data:r,indices:i,segmentIds:o};return sr.runKernel("SparseSegmentMean",s)}}),yu=hi({sparseSegmentSum_:function(e,t,n){const r=li(e,"data","sparseSegmentSum"),i=li(t,"indices","sparseSegmentSum","int32"),o=li(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==i.rank)throw new Error(`Indices should be Tensor1D but received shape\n         ${i.shape}`);if(1!==o.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n         ${o.shape}`);const s={data:r,indices:i,segmentIds:o};return sr.runKernel("SparseSegmentSum",s)}}),Su=hi({stringNGrams_:function(e,t,n,r,i,o,s,a){const c=li(e,"data","stringNGrams","string");if("string"!==c.dtype)throw new Error("Data must be of datatype string");if(1!==c.shape.length)throw new Error(`Data must be a vector, saw: ${c.shape}`);const u=li(t,"dataSplits","stringNGrams");if("int32"!==u.dtype)throw new Error("Data splits must be of datatype int32");const l={separator:n,nGramWidths:r,leftPad:i,rightPad:o,padWidth:s,preserveShortSequences:a},d={data:c,dataSplits:u},h=sr.runKernel("StringNGrams",d,l);return{nGrams:h[0],nGramsSplits:h[1]}}}),Cu=hi({stringSplit_:function(e,t,n=!0){const r=li(e,"input","stringSplit","string"),i=li(t,"delimiter","stringSplit","string");if(1!==r.rank)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(0!==i.rank)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const o={skipEmpty:n},s={input:r,delimiter:i},a=sr.runKernel("StringSplit",s,o);return{indices:a[0],values:a[1],shape:a[2]}}}),Ou=hi({stringToHashBucketFast_:function(e,t){const n=li(e,"input","stringToHashBucketFast","string"),r={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return sr.runKernel("StringToHashBucketFast",i,r)}}),bu={flipLeftRight:tu,grayscaleToRGB:nu,resizeNearestNeighbor:Au,resizeBilinear:fu,rotateWithOffset:ru,cropAndResize:eu,nonMaxSuppression:ou,nonMaxSuppressionAsync:async function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY){const o=li(e,"boxes","nonMaxSuppressionAsync"),s=li(t,"scores","nonMaxSuppressionAsync"),a=iu(o,s,n,r,i);n=a.maxOutputSize,r=a.iouThreshold,i=a.scoreThreshold;const c=await Promise.all([o.data(),s.data()]),u=c[0],l=c[1],{selectedIndices:d}=function(e,t,n,r,i){return cu(e,t,n,r,i,0)}(u,l,n,r,i);return o!==e&&o.dispose(),s!==t&&s.dispose(),wc(d,"int32")},nonMaxSuppressionWithScore:hu,nonMaxSuppressionWithScoreAsync:async function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=0){const s=li(e,"boxes","nonMaxSuppressionAsync"),a=li(t,"scores","nonMaxSuppressionAsync"),c=iu(s,a,n,r,i,o);n=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma;const u=await Promise.all([s.data(),a.data()]),l=u[0],d=u[1],{selectedIndices:h,selectedScores:p}=function(e,t,n,r,i,o){return cu(e,t,n,r,i,o,!0)}(l,d,n,r,i,o);return s!==e&&s.dispose(),a!==t&&a.dispose(),{selectedIndices:wc(h,"int32"),selectedScores:wc(p)}},nonMaxSuppressionPadded:pu,nonMaxSuppressionPaddedAsync:async function(e,t,n,r=.5,i=Number.NEGATIVE_INFINITY,o=!1){const s=li(e,"boxes","nonMaxSuppressionAsync"),a=li(t,"scores","nonMaxSuppressionAsync"),c=iu(s,a,n,r,i,null),u=c.maxOutputSize,l=c.iouThreshold,d=c.scoreThreshold,[h,p]=await Promise.all([s.data(),a.data()]),{selectedIndices:f,validOutputs:A}=function(e,t,n,r,i,o){return cu(e,t,n,r,i,0,!1,o,!0)}(h,p,u,l,d,o);return s!==e&&s.dispose(),a!==t&&a.dispose(),{selectedIndices:wc(f,"int32"),validOutputs:zs(A,"int32")}},threshold:Eu,transform:gu},wu={sparseFillEmptyRows:Tu,sparseReshape:Ru,sparseSegmentMean:vu,sparseSegmentSum:yu},Nu={stringNGrams:Su,stringSplit:Cu,stringToHashBucketFast:Ou},Du="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:e=>e();function Lu(e,t){const n=e[0].length;e.forEach(((e,t)=>{qe(e.length===n,(()=>`Error in concat${n}D: rank of tensors[${t}] must be the same as the rank of the rest (${n})`))})),qe(t>=0&&t<n,(()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`));const r=e[0];e.forEach(((e,i)=>{for(let o=0;o<n;o++)qe(o===t||e[o]===r[o],(()=>`Error in concat${n}D: Shape of tensors[${i}] (${e}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`))}))}function Pu(e,t){const n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}function ku(e){return e<=30?e:gt(e,Math.floor(Math.sqrt(e)))}function xu(e,t,n,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);const n=t.length;for(let r=0;r<n;++r)i=i.concat([e[r+1]/t[r],t[r]]);i=i.concat(e.slice(n+1))}return i}function Mu(e,t,n=!0){const r=[];if(n){r.push(t);for(let n=t+1;n<e;++n)n<=2*t?(r.push(n),r.push(n-(t+1))):r.push(n)}else{const n=[],i=[];for(let r=1;r<e;++r)r>=2*t+1||r%2==1?i.push(r):n.push(r);r.push(...n),r.push(0),r.push(...i)}return r}function Uu(e,t,n,r=!0){const i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let n=1;n<e.length;++n)n<=t.length?r?i.push(t[n-1]*e[n]):i.push(e[n]/t[n-1]):i.push(e[n]);return i}function Bu(e,t){const n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function Fu(e,t,n){const r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}function Vu(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const n=new Float32Array(2*e.length);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}const Gu=/->/g;function Qu(e,t){const n=[];for(let r=0;r<e.length;++r)0!==e[r].length&&-1===e[r].indexOf(t)&&-1!==t||n.push(r);return n}function ju(e){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${e}`}function Hu(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function Wu(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}function Yu(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function Ku(e,t){return`size ${e} must be non-negative, not ${t}`}function $u(e,t){return`Input to reshape is a SparseTensor with ${et(e)}\n  dense values, but the requested shape requires a multiple of ${et(t)}. inputShape=${e} outputShape= ${t}`}function zu(e,t){return`Input to reshape is a tensor with ${et(e)} dense values, but the requested shape has ${et(t)}. inputShape=${e} outputShape=${t}`}function qu(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function Ju(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}var Xu=Object.freeze({__proto__:null,segOpComputeOptimalWindowSize:function(e,t){let n,r=!1;for(e<=30?(n=e,r=!0):n=gt(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=gt(e,n+1);return n},computeOutShape:function(e,t,n){const r=[],i=e.length;for(let o=0;o<i;o++)o!==t?r.push(e[o]):r.push(n);return r},collectGatherOpShapeInfo:function(e,t,n,r){const i=t.shape.length,o=e.shape.length;if(0!==r&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (\n    ${o}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let n=0;n<r;++n)if(e.shape[n]!==t.shape[n])throw new Error(`x.shape[${n}]: ${e.shape[n]} should be equal to indices.shape[${n}]: ${t.shape[n]}.`);const s=e.shape[n],a=[];let c=1,u=1,l=1;for(let t=0;t<r;++t)a.push(e.shape[t]),c*=e.shape[t];for(let t=r;t<n;t++)a.push(e.shape[t]),u*=e.shape[t];for(let e=r;e<i;e++)a.push(t.shape[e]);for(let t=n+1;t<o;t++)a.push(e.shape[t]),l*=e.shape[t];return{batchSize:c,sliceSize:l,outerSize:u,dimSize:s,outputShape:a}}});function Zu(e){try{return e.map((e=>Dn(e)))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function el(e){return e.map((e=>Nn(e)))}var tl=Object.freeze({__proto__:null,slice_util:Oo,segment_util:Xu,fromUint8ToStringArray:Zu,fromStringArrayToUint8:el,upcastType:Xn,axesAreInnerMostDims:Fs,combineLocations:Vs,computeOutAndReduceShapes:Gs,expandShapeToKeepDim:Qs,assertAxesAreInnerMostDims:js,getAxesPermutation:Hs,getUndoAxesPermutation:function(e){return e.map(((e,t)=>[t,e])).sort(((e,t)=>e[1]-t[1])).map((e=>e[0]))},getInnerMostAxes:Ws,getBroadcastDims:io,getReductionAxes:oo,assertAndGetBroadcastShape:so,assertParamsConsistent:Lu,computeOutShape:Pu,computeDilation2DInfo:function(e,t,n,r,i="NHWC",o){return Yo(e,[...t,e[3]],n,o,r,null,null,ts(i))},computePool2DInfo:Wo,computePool3DInfo:function(e,t,n,r,i,o,s="NDHWC"){const[a,c,u]=qo(t);let l,d;if("NDHWC"===s)d="channelsLast",l=[a,c,u,e[4],e[4]];else{if("NCDHW"!==s)throw new Error(`Unknown dataFormat ${s}`);d="channelsFirst",l=[a,c,u,e[1],e[1]]}return Ko(e,l,n,r,i,!1,d,o)},computeConv2DInfo:Yo,computeConv3DInfo:Ko,computeDefaultPad:$o,tupleValuesAreOne:Zo,eitherStridesOrDilationsAreOne:es,convertConv2DDataFormat:ts,checkPadOnDimRoundingMode:ns,getFusedDyActivation:jc,getFusedBiasGradient:Hc,applyActivation:Wc,shouldFuse:Yc,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:ku,getImageCenter:function(e,t,n){return[n*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]},getReshaped:xu,getPermuted:Mu,getReshapedPermuted:Uu,getSliceBeginCoords:Bu,getSliceSize:Fu,prepareAndValidate:function(e,t){const n=e.shape.length,r=t.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(0===et(e.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const i=t.shape,o=i[i.length-1];let s=1;for(let e=0;e<i.length-1;++e)s*=i[e];const a=e.shape,c=i.slice();c.pop();let u=1;for(let e=o;e<n;++e)u*=a[e],c.push(a[e]);const l=[..._t(e.shape).map((e=>e/u)),1].slice(0,o);return[c,s,u,l]},validateUpdateShape:uo,validateInput:lo,calculateShapes:function(e,t,n){const r=t.shape.length,i=r>1?t.shape[r-1]:1,o=n.length;let s=1;for(let e=i;e<o;++e)s*=n[e];const a=i<1?1:i;return{sliceRank:i,numUpdates:et(t.shape)/a,sliceSize:s,strides:[..._t(n.slice(0,i)),1],outputSize:et(n)}},SELU_SCALEALPHA:1.7580993408473768,SELU_SCALE:1.0507009873554805,ERF_P:.3275911,ERF_A1:.254829592,ERF_A2:-.284496736,ERF_A3:1.421413741,ERF_A4:-1.453152027,ERF_A5:1.061405429,warn:kt,log:function(...e){wt().getBool("IS_TEST")||wt().getBool("PROD")||console.log(...e)},mergeRealAndImagArrays:Vu,splitRealAndImagArrays:function(e){const t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}},complexWithEvenIndex:function(e){const t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let t=0;t<e.length;t+=4)n[Math.floor(t/4)]=e[t],r[Math.floor(t/4)]=e[t+1];return{real:n,imag:r}},complexWithOddIndex:function(e){const t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let t=2;t<e.length;t+=4)n[Math.floor(t/4)]=e[t],r[Math.floor(t/4)]=e[t+1];return{real:n,imag:r}},getComplexWithIndex:function(e,t){return{real:e[2*t],imag:e[2*t+1]}},assignToTypedArray:function(e,t,n,r){e[2*r]=t,e[2*r+1]=n},exponents:function(e,t){const n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){const o=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(o),r[i]=Math.sin(o)}return{real:n,imag:r}},exponent:function(e,t,n){const r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}},decodeEinsumEquation:function(e,t){const n=((e=e.replace(/\s/g,"")).length-e.replace(Gu,"").length)/"->".length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error('Equation must contain exactly one arrow ("->").');const[r,i]=e.split("->");qe(-1===r.indexOf("..."),(()=>'The ellipsis notation ("...") is not supported yet.'));const o=r.split(","),s=o.length;if(t!==s)throw new Error(`Expected ${s} input tensors, received ${t}`);if(s>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let e=0;e<i.length;++e){const t=i[e];if(!o.some((e=>-1!==e.indexOf(t))))throw new Error(`Output subscripts contain the label ${t} not present in the input subscripts.`);-1===a.indexOf(t)&&a.push(t)}for(let e=0;e<r.length;++e){const t=r[e];-1===a.indexOf(t)&&","!==t&&a.push(t)}const c=new Array(o.length);for(let e=0;e<s;++e){if(new Set(o[e].split("")).size!==o[e].length)throw new Error(`Found duplicate axes in input component ${o[e]}. Support for duplicate axes in input is not implemented yet.`);c[e]=[];for(let t=0;t<o[e].length;++t)c[e].push(a.indexOf(o[e][t]))}const u=a.length,l=[];for(let e=i.length;e<u;++e)l.push(e);return{allDims:a,summedDims:l,idDims:c}},getEinsumPermutation:function(e,t){let n=new Array(e);n.fill(-1);for(let e=0;e<t.length;++e)n[t[e]]=e;const r=[];for(let t=0;t<e;++t)-1===n[t]&&r.push(t);return n=n.filter((e=>-1!==e)),{permutationIndices:n,expandDims:r}},checkEinsumDimSizes:function(e,t,n){const r=new Array(e);for(let e=0;e<n.length;++e){const i=n[e].shape;for(let n=0;n<t[e].length;++n)void 0===r[t[e][n]]?r[t[e][n]]=i[n]:qe(r[t[e][n]]===i[n],(()=>`Expected dimension ${r[t[e][n]]} at axis ${n} of input shaped ${JSON.stringify(i)}, but got dimension ${i[n]}`))}},getEinsumComputePath:function(e,t){const n=e,r=[];let i=0;0===e.length&&n.push(-1),i=e.length+1;for(let e=0;e<i;++e)r.push([]);const o=[];for(let e=0;e<n.length;++e){const i=Qu(t,n[e]);for(const t of i)-1===o.indexOf(t)&&(r[e].push(t),o.push(t))}return{path:n,steps:r}},isIdentityPermutation:function(e){return e.every(((e,t)=>e===t))},prepareSplitSize:function(e,t,n=0){let r=[];if("number"==typeof t)qe(e.shape[n]%t==0,(()=>"Number of splits must evenly divide the axis.")),r=new Array(t).fill(e.shape[n]/t);else{qe(t.reduce(((e,t)=>(-1===t&&(e+=1),e)),0)<=1,(()=>"There should be only one negative value in split array."));const i=t.indexOf(-1);if(-1!==i){const r=t.reduce(((e,t)=>t>0?e+t:e));t[i]=e.shape[n]-r}qe(e.shape[n]===t.reduce(((e,t)=>e+t)),(()=>"The sum of sizes must match the size of the axis dimension.")),r=t}return r},getSparseFillEmptyRowsIndicesDenseShapeMismatch:ju,getSparseFillEmptyRowsNegativeIndexErrorMessage:Hu,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:Wu,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:Yu,getSparseReshapeNegativeOutputDimErrorMessage:Ku,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:function(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"},getSparseReshapeInputOutputMultipleErrorMessage:$u,getSparseReshapeInputOutputMismatchErrorMessage:zu,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:function(){return"segment ids must be >= 0"},getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:function(){return"segment ids are not increasing"},getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:qu,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:Ju});class nl{fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}}if(wt().get("IS_BROWSER")){wt().setPlatform("browser",new nl);try{Yi.registerManager(Ui.URL_SCHEME,new Fi)}catch(qn){}try{Yi.registerManager(Si.URL_SCHEME,new Oi)}catch(qn){}}let rl;wt().get("IS_NODE")&&!wt().get("IS_BROWSER")&&wt().setPlatform("node",new class{constructor(){this.util=o(345),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=wt().global.fetch?wt().global.fetch(e,t):(null==rl&&(rl=o(683)),rl(e,t))}now(){const e=je.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}}),or();const il={buffer:Es,cast:Ki,clone:ss,print:function(e,t=!1){console.log(e.toString(t))}};var ol,sl;Qn=il,wt().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(ol||(ol={})),function(e){var t;(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(sl||(sl={}));const al={};function cl(e){return al[e]}function ul(e,t,n,r,i){const o=t.inputParams[e];if(o&&void 0!==o.inputIndexStart){const e=o.inputIndexStart,s=0===o.inputIndexEnd?void 0:void 0===o.inputIndexEnd?e+1:o.inputIndexEnd;if("tensor"===o.type)return ll(t.inputNames[o.inputIndexStart],n,r,i);if("tensors"===o.type)return t.inputNames.slice(e,s).map((e=>ll(e,n,r,i)));const a=ll(t.inputNames.slice(e)[0],n,r,i),c=a.dataSync();return"number"===o.type?c[0]:It(a.shape,c)}const s=t.attrParams[e];return s&&s.value}function ll(e,t,n,r){const[i,o]=pl(e);if(null!=r){const e=r.getHashTableHandleByName(i);if(null!=e)return e}const s=n.currentContextIds.find((e=>!!t[hl(i,e)]));return void 0!==s?t[hl(i,s)][o]:void 0}function dl(e,t){const[n,r,i]=pl(e);return[hl(n,t&&t.currentContextId),r,i]}function hl(e,t){return t?`${e}-${t}`:e}function pl(e){const t=e.split(":");if(1===t.length)return[e,0,void 0];const n=t[0],r=3===t.length?t[1]:void 0;return[n,Number(t[t.length-1]),r]}function fl(e,t,n){let r=ul("pad",e,t,n);if("explicit"===r){r=ul("explicitPaddings",e,t,n);const i=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)i[e][0]=r[2*e],i[e][1]=r[2*e+1];return i}return r}function Al(e){return e.kept?e:ss(e)}var El=Object.freeze({__proto__:null,json:[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),gl=Object.freeze({__proto__:null,json:[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),_l=Object.freeze({__proto__:null,json:[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}]}),ml=Object.freeze({__proto__:null,json:[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}]}),Il=Object.freeze({__proto__:null,json:[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]}),Tl=Object.freeze({__proto__:null,json:[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),Rl=Object.freeze({__proto__:null,json:[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}]}),vl=Object.freeze({__proto__:null,json:[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]}),yl=Object.freeze({__proto__:null,json:[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}]}),Sl=Object.freeze({__proto__:null,json:[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}]}),Cl=Object.freeze({__proto__:null,json:[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),Ol=Object.freeze({__proto__:null,json:[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}]}),bl=Object.freeze({__proto__:null,json:[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]}),wl=Object.freeze({__proto__:null,json:[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]}),Nl=Object.freeze({__proto__:null,json:[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]}),Dl=Object.freeze({__proto__:null,json:[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}]}),Ll=Object.freeze({__proto__:null,json:[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]}),Pl=Object.freeze({__proto__:null,json:[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}]}),kl=Object.freeze({__proto__:null,json:[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}]});class xl{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[].concat(...[El,gl,_l,ml,Il,Tl,Rl,vl,yl,Sl,Cl,Ol,bl,wl,Nl,Dl,Ll,Pl,kl].map((e=>e.json)));this.opMappers=e.reduce(((e,t)=>(e[t.tfOpName]=t,e)),{})}transformGraph(e,t={}){const n=e.node,r=[],i=[],o=[],s=n.reduce(((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?r.push(e[t.name]):"Const"===t.op?i.push(e[t.name]):null!=t.input&&0!==t.input.length||o.push(e[t.name]),e)),{});let a=[];const c=[];let u={},l={};null!=t&&(u=this.mapSignatureEntries(t.inputs),l=this.mapSignatureEntries(t.outputs));const d=Object.keys(s);d.forEach((e=>{const t=s[e];t.inputNames.forEach(((e,n)=>{const[r,,i]=dl(e),o=s[r];if(null!=o.outputs){const e=o.outputs.indexOf(i);if(-1!==e){const i=`${r}:${e}`;t.inputNames[n]=i}}t.inputs.push(o),o.children.push(t)}))})),0===Object.keys(l).length?d.forEach((e=>{const t=s[e];0===t.children.length&&c.push(t)})):Object.keys(l).forEach((e=>{const[t]=dl(e),n=s[t];null!=n&&(n.signatureKey=l[e],c.push(n))})),Object.keys(u).length>0?Object.keys(u).forEach((e=>{const[t]=dl(e),n=s[t];n&&(n.signatureKey=u[e],a.push(n))})):a=r;let h={};null!=e.library&&null!=e.library.function&&(h=e.library.function.reduce(((e,t)=>(e[t.signature.name]=this.mapFunction(t),e)),{}));const p={nodes:s,inputs:a,outputs:c,weights:i,placeholders:r,signature:t,functions:h};return o.length>0&&(p.initNodes=o),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce(((t,n)=>(t[e[n].name]=n,t)),{})}mapNode(e){const t=cl(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});const n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((e=>e.startsWith("^")?e.slice(1):e)),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(n.inputParams=t.inputs.reduce(((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e)),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce(((t,n)=>{const r=n.type;let i;switch(n.type){case"string":i=Ul(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Ul(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":i=Kl(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Kl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":i=Fl(e.attr,n.tfName,n.defaultValue||0),void 0===i&&n.tfDeprecatedName&&(i=Fl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":i=Yl(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Yl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":i=Bl(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Bl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":i=zl(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=zl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":i=Wl(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Wl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":i=$l(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=$l(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":i=Ql(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Ql(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":i=jl(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=jl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":i=Gl(e.attr,n.tfName,n.defaultValue),void 0===i&&n.tfDeprecatedName&&(i=Gl(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${n.type} for op: ${e.op}`)}return t[n.name]={value:i,type:r},t}),{})),n}mapFunction(e){const t=e.nodeDef,n=[];let r={};null!=t&&(r=t.reduce(((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&n.push(e[t.name]),e)),{}));const i=[],o=[];e.signature.inputArg.forEach((e=>{const[t]=dl(e.name),n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:Vl(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,i.push(n),r[t]=n})),Object.keys(r).forEach((e=>{const t=r[e];t.inputNames.forEach(((e,n)=>{const[i,,o]=dl(e),s=r[i];if(null!=s.outputs){const e=s.outputs.indexOf(o);if(-1!==e){const r=`${i}:${e}`;t.inputNames[n]=r}}t.inputs.push(s),s.children.push(t)}))}));const s=e.ret;e.signature.outputArg.forEach((e=>{const[t,n]=dl(s[e.name]),i=r[t];null!=i&&(i.defaultOutput=n,o.push(i))}));const a=this.mapArgsToSignature(e);return{nodes:r,inputs:i,outputs:o,weights:n,placeholders:[],signature:a}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce(((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e)),{}),outputs:e.signature.outputArg.reduce(((t,n)=>(t[n.name]=this.mapArgToTensorInfo(n,e.ret),t)),{})}}mapArgToTensorInfo(e,t){let n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}function Ml(e,t){const n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const t=wt().global;return void 0!==t.atob?t.atob(e):new yr(e,"base64").toString()}(e);return t?n:n.toLowerCase()}function Ul(e,t,n,r=!1){const i=e[t];return null!=i?Ml(i.s,r):n}function Bl(e,t,n){const r=e[t];return r?r.b:n}function Fl(e,t,n){const r=e[t]||{},i=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof i?i:parseInt(i,10)}function Vl(e){switch("string"==typeof e&&(e=ol[e]),e){case ol.DT_FLOAT:case ol.DT_HALF:return"float32";case ol.DT_INT32:case ol.DT_INT64:case ol.DT_INT8:case ol.DT_UINT8:return"int32";case ol.DT_BOOL:return"bool";case ol.DT_DOUBLE:return"float32";case ol.DT_STRING:return"string";default:return null}}function Gl(e,t,n){const r=e[t];return r&&r.func?r.func.name:n}function Ql(e,t,n){const r=e[t];return r&&r.type?Vl(r.type):n}function jl(e,t,n){const r=e[t];return r&&r.list&&r.list.type?r.list.type.map((e=>Vl(e))):n}function Hl(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((e=>"number"==typeof e.size?e.size:parseInt(e.size,10))):[]}function Wl(e,t,n){const r=e[t];return r&&r.shape?Hl(r.shape):n}function Yl(e,t,n){const r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((e=>"number"==typeof e?e:parseInt(e,10))):n}function Kl(e,t,n,r=!1){const i=e[t];return i&&i.list&&i.list.s?i.list.s.map((e=>Ml(e,r))):n}function $l(e,t,n){const r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((e=>Hl(e))):n}function zl(e,t,n){const r=e[t];return r&&r.list&&r.list.b?r.list.b:n}class ql{constructor(e,t,n){this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((e=>this.getInput(e))),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce(((e,t)=>(e[t]=this.getAttr(t),e)),{}))}getInput(e){return ll(e,this.tensorMap,this.context)}getAttr(e,t){const n=this.node.rawAttrs[e];if(null!=n.tensor)return ll(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Fl(this.node.rawAttrs,e,t);if(null!=n.s)return Ul(this.node.rawAttrs,e,t);if(null!=n.b)return Bl(this.node.rawAttrs,e,t);if(null!=n.shape)return Wl(this.node.rawAttrs,e,t);if(null!=n.type)return Ql(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Yl(this.node.rawAttrs,e,t);if(null!=n.list.s)return Kl(this.node.rawAttrs,e,t);if(null!=n.list.shape)return $l(this.node.rawAttrs,e,t);if(null!=n.list.b)return zl(this.node.rawAttrs,e,t);if(null!=n.list.type)return jl(this.node.rawAttrs,e,t)}return t}}function Jl(e,t,n=""){if("number"!=typeof e&&"number"!=typeof t){qe(e.length===t.length,(()=>n+` Shapes ${e} and ${t} must match`));for(let r=0;r<e.length;r++){const i=e[r],o=t[r];qe(i<0||o<0||i===o,(()=>n+` Shapes ${e} and ${t} must match`))}}}function Xl(e){return"number"!=typeof e&&!e.some((e=>e<0))}function Zl(e,t,n){let r=ed(e,n);const i=!Xl(r);if(i&&0===t.length)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(i&&t.forEach((e=>{r=ed(e.shape,r)})),!Xl(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function ed(e,t){if("number"==typeof e)return t;if("number"==typeof t)return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);const n=[];for(let r=0;r<e.length;++r){const i=e[r],o=t[r];if(i>=0&&o>=0&&i!==o)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);n[r]=i>=0?i:o}return n}class td{constructor(e,t,n,r,i,o,s){this.name=e,this.dtype=t,this.maxSize=n,this.elementShape=r,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.idTensor=zs(0),Xi(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map((e=>this.read(e)))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},\n          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),Jl(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),n.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(n.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);n.tensor=t,Xi(t),n.written=!0,this.tensors[e]=n}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach(((e,n)=>this.write(e,t[n])))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return Ai([],[0].concat(this.elementShape));const n=this.readMany(e);return Jl(this.elementShape,n[0].shape,"TensorArray shape mismatch: "),Sc(n,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(0===this.size())return Ai([],[0].concat(this.elementShape));const t=[];for(let e=0;e<this.size();e++)t.push(e);const n=this.readMany(t);return Jl(this.elementShape,n[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${n[0].shape})`),as(n,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const n=Math.max(...e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error(`Max index must be < array size (${n}  vs. ${this.maxSize})`);this.writeMany(e,kc(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let n=0;const r=e.map((e=>(n+=e,n)));if(n!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const i=0===n?0:t.size/n,o=[];Ji((()=>{t=rs(t,[1,n,i]);for(let n=0;n<e.length;++n){const s=[0,0===n?0:r[n-1],0],a=[1,e[n],i];o[n]=rs(us(t,s,a),this.elementShape)}return o}));const s=[];for(let t=0;t<e.length;t++)s[t]=t;this.writeMany(s,o)}}class nd{constructor(e,t,n,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=n,null!=e&&e.forEach((e=>{if(n!==e.dtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${e.dtype}`);Jl(t,e.shape,"TensorList shape mismatch: "),Xi(e)})),this.idTensor=zs(0),this.maxNumElements=r,Xi(this.idTensor)}get id(){return this.idTensor.id}copy(){return new nd([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,n=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(-1!==n&&this.tensors.length!==n)throw new Error(`Operation expected a list with ${n} elements but got a list with ${this.tensors.length} elements.`);Jl(e,this.elementShape,"TensorList shape mismatch: ");const r=Zl(this.elementShape,this.tensors,e);return Ji((()=>{const e=this.tensors.map((e=>rs(e,r)));return Sc(e,0)}))}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");const n=Zl(this.elementShape,this.tensors,e),r=this.tensors.pop();return Jl(r.shape,e,"TensorList shape mismatch: "),rs(r,n)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Jl(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Xi(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new nd([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let n=0;n<Math.min(this.tensors.length,e);++n)t.tensors[n]=this.tensors[n];return t}getItem(e,t,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[e])throw new Error(`element at index ${e} is null.`);Jl(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=Zl(this.elementShape,this.tensors,t);return rs(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Jl(this.elementShape,t.shape,"TensorList shape mismatch: "),Xi(t),this.tensors[e]=t}gather(e,t,n){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);Jl(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=Zl(this.elementShape,this.tensors,n);return 0===e.length?Ai([],[0].concat(r)):Ji((()=>{const t=e.map((e=>rs(this.tensors[e],r)));return Sc(t,0)}))}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Jl(this.elementShape,t,"TensorList shape mismatch: ");const n=Zl(this.elementShape,this.tensors,t);return 0===this.size()?Ai([],[0].concat(n)):Ji((()=>{const e=this.tensors.map((e=>rs(e,n)));return as(e,0)}))}}function rd(e,t,n){const[r,i]=ul("fusedOps",e,t,n),o="biasadd"===r,s=!o,a="prelu"===i,c="fusedbatchnorm"===r,u=ul("numArgs",e,t,n);if(o){if(a&&2!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&o&&1!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const l=ul("strides",e,t,n),d=fl(e,t,n),h=ul("dataFormat",e,t,n).toUpperCase(),p=ul("dilations",e,t,n);let[f,A]=ul("args",e,t,n);return s&&(A=f,f=void 0),{stride:l,pad:d,dataFormat:h,dilations:p,biasArg:f,preluArg:A,activationFunc:i,leakyreluAlpha:ul("leakyreluAlpha",e,t,n)}}function id(e,t,n){return{boxes:ul("boxes",e,t,n),scores:ul("scores",e,t,n),maxOutputSize:ul("maxOutputSize",e,t,n),iouThreshold:ul("iouThreshold",e,t,n),scoreThreshold:ul("scoreThreshold",e,t,n),softNmsSigma:ul("softNmsSigma",e,t,n)}}class od{constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=zs(0),this.tensorMap=new Map,Xi(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return zs(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),Ji((()=>{const e=kc(t),r=n.length,i=e.length;qe(r===i,(()=>`The number of elements doesn't match, keys has ${r} elements, the values has ${i} elements.`));for(let t=0;t<r;t++){const r=n[t],i=e[t];Xi(i),this.tensorMap.set(r,i)}return this.handle}))}async find(e,t){this.checkKeyAndValueTensor(e,t);const n=await e.data();return Ji((()=>{const e=[];for(let r=0;r<n.length;r++){const i=n[r],o=this.findWithDefault(i,t);e.push(o)}return Sc(e)}))}findWithDefault(e,t){const n=this.tensorMap.get(e);return null!=n?n:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}function sd(e,t,n,r){const i=((e,t,n)=>{switch(e.category){case"arithmetic":return Ji((()=>((e,t,n)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[bo(ul("a",e,t,n),ul("b",e,t,n))];case"AddN":return[xo(ul("tensors",e,t,n))];case"FloorMod":case"Mod":return[Fa(ul("a",e,t,n),ul("b",e,t,n))];case"Mul":return[Do(ul("a",e,t,n),ul("b",e,t,n))];case"RealDiv":case"Div":return[No(ul("a",e,t,n),ul("b",e,t,n))];case"DivNoNan":return[xs(ul("a",e,t,n),ul("b",e,t,n))];case"FloorDiv":return[wo(ul("a",e,t,n),ul("b",e,t,n))];case"Sub":return[Ra(ul("a",e,t,n),ul("b",e,t,n))];case"Minimum":return[Ua(ul("a",e,t,n),ul("b",e,t,n))];case"Maximum":return[Pa(ul("a",e,t,n),ul("b",e,t,n))];case"Pow":return[$s(ul("a",e,t,n),ul("b",e,t,n))];case"SquaredDifference":return[vc(ul("a",e,t,n),ul("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"basic_math":return Ji((()=>((e,t,n)=>{switch(e.op){case"Abs":case"ComplexAbs":return[Lo(ul("x",e,t,n))];case"Acos":return[Po(ul("x",e,t,n))];case"Acosh":return[ko(ul("x",e,t,n))];case"Asin":return[Vo(ul("x",e,t,n))];case"Asinh":return[Go(ul("x",e,t,n))];case"Atan":return[Qo(ul("x",e,t,n))];case"Atan2":return[jo(ul("x",e,t,n),ul("y",e,t,n))];case"Atanh":return[Ho(ul("x",e,t,n))];case"Ceil":return[gs(ul("x",e,t,n))];case"Complex":return[pi(ul("real",e,t,n),ul("imag",e,t,n))];case"Cos":return[ys(ul("x",e,t,n))];case"Cosh":return[Ss(ul("x",e,t,n))];case"Elu":return[Us(ul("x",e,t,n))];case"Erf":return[Bs(ul("x",e,t,n))];case"Exp":return[na(ul("x",e,t,n))];case"Expm1":return[ia(ul("x",e,t,n))];case"Floor":return[ca(ul("x",e,t,n))];case"Log":return[_a(ul("x",e,t,n))];case"Log1p":return[ma(ul("x",e,t,n))];case"Imag":return[eo(ul("x",e,t,n))];case"Neg":return[to(ul("x",e,t,n))];case"Reciprocal":return[ac(ul("x",e,t,n))];case"Real":return[no(ul("x",e,t,n))];case"Relu":return[cc(ul("x",e,t,n))];case"Round":return[dc(ul("x",e,t,n))];case"Selu":return[pc(ul("x",e,t,n))];case"Sigmoid":return[cs(ul("x",e,t,n))];case"Sin":return[Ac(ul("x",e,t,n))];case"Sign":return[fc(ul("x",e,t,n))];case"Sinh":return[Ec(ul("x",e,t,n))];case"Softplus":return[Ta(ul("x",e,t,n))];case"Sqrt":return[qs(ul("x",e,t,n))];case"Square":return[Js(ul("x",e,t,n))];case"Tanh":return[ls(ul("x",e,t,n))];case"Tan":return[bc(ul("x",e,t,n))];case"ClipByValue":return[_s(ul("x",e,t,n),ul("clipValueMin",e,t,n),ul("clipValueMax",e,t,n))];case"Relu6":return[uc(ul("x",e,t,n))];case"Rsqrt":return[hc(ll(e.inputNames[0],t,n))];case"Prod":return[Ya(ul("x",e,t,n),ul("axes",e,t,n))];case"LeakyRelu":return[pa(ul("x",e,t,n),ul("alpha",e,t,n))];case"Prelu":return[Wa(ul("x",e,t,n),ul("alpha",e,t,n))];case"IsNan":return[ha(ll(e.inputNames[0],t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"control":return(async(e,t,n)=>{switch(e.op){case"If":case"StatelessIf":{const r=ul("thenBranch",e,t,n),i=ul("elseBranch",e,t,n),o=ul("cond",e,t,n),s=ul("args",e,t,n);return(await o.data())[0]?n.functionMap[r].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap):n.functionMap[i].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=ul("body",e,t,n),i=ul("cond",e,t,n),o=ul("args",e,t,n),s=await n.functionMap[i].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap),a=o.map((e=>e.id));let c=await s[0].data();s.forEach((e=>{e.kept||-1!==a.indexOf(e.id)||e.dispose()}));let u=o;for(;c[0];){const e=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const t=u.map((e=>e.id));e.forEach((e=>{e.kept||-1!==a.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}));const o=await n.functionMap[i].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);c=await o[0].data(),o.forEach((e=>{e.kept||-1!==a.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}))}return u}case"LoopCond":return[Al(ul("pred",e,t,n))];case"Switch":{const r=ul("pred",e,t,n);let i=ul("data",e,t,n);return i.kept||(i=Al(i)),(await r.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{const r=e.inputNames.find((e=>void 0!==ll(e,t,n)));return r?[Al(ll(r,t,n))]:void 0}case"Enter":{const r=ul("frameName",e,t,n),i=ul("tensor",e,t,n);return n.enterFrame(r),[Al(i)]}case"Exit":{const r=ul("tensor",e,t,n);return n.exitFrame(),[Al(r)]}case"NextIteration":{const r=ul("tensor",e,t,n);return n.nextIteration(),[Al(r)]}case"TensorArrayV3":{const r=ul("size",e,t,n),i=ul("dtype",e,t,n),o=ul("elementShape",e,t,n),s=ul("dynamicSize",e,t,n),a=ul("clearAfterRead",e,t,n),c=ul("identicalElementShapes",e,t,n),u=ul("name",e,t,n),l=new td(u,i,r,o,c,s,a);return n.addTensorArray(l),[l.idTensor,zs(1)]}case"TensorArrayWriteV3":{const r=ul("tensorArrayId",e,t,n),i=ul("index",e,t,n),o=ul("tensor",e,t,n),s=n.getTensorArray(r.id);return s.write(i,o),[s.idTensor]}case"TensorArrayReadV3":{const r=ul("tensorArrayId",e,t,n),i=ul("index",e,t,n);return[n.getTensorArray(r.id).read(i)]}case"TensorArrayGatherV3":{const r=ul("tensorArrayId",e,t,n),i=ul("indices",e,t,n),o=ul("dtype",e,t,n);return[n.getTensorArray(r.id).gather(i,o)]}case"TensorArrayScatterV3":{const r=ul("tensorArrayId",e,t,n),i=ul("indices",e,t,n),o=ul("tensor",e,t,n),s=n.getTensorArray(r.id);return s.scatter(i,o),[s.idTensor]}case"TensorArrayConcatV3":{const r=ul("tensorArrayId",e,t,n),i=n.getTensorArray(r.id),o=ul("dtype",e,t,n);return[i.concat(o)]}case"TensorArraySplitV3":{const r=ul("tensorArrayId",e,t,n),i=ul("tensor",e,t,n),o=ul("lengths",e,t,n),s=n.getTensorArray(r.id);return s.split(o,i),[s.idTensor]}case"TensorArraySizeV3":{const r=ul("tensorArrayId",e,t,n);return[zs(n.getTensorArray(r.id).size(),"int32")]}case"TensorArrayCloseV3":{const r=ul("tensorArrayId",e,t,n),i=n.getTensorArray(r.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{const r=ul("tensorListId",e,t,n),i=ul("index",e,t,n),o=ul("tensor",e,t,n),s=n.getTensorList(r.id);return s.setItem(i,o),[s.idTensor]}case"TensorListGetItem":{const r=ul("tensorListId",e,t,n),i=ul("index",e,t,n),o=ul("elementShape",e,t,n),s=ul("elementDType",e,t,n);return[n.getTensorList(r.id).getItem(i,o,s)]}case"TensorListScatterV2":case"TensorListScatter":{const r=ul("indices",e,t,n),i=function(e,t,n,r){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const i=Math.max(...t);if(null!=r&&-1!==r&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);const o=new nd([],n,e.dtype,r),s=kc(e,0);return t.forEach(((e,t)=>{o.setItem(e,s[t])})),o}(ul("tensor",e,t,n),r,ul("elementShape",e,t,n),ul("numElements",e,t,n));return n.addTensorList(i),[i.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=ul("elementShape",e,t,n),i=ul("elementDType",e,t,n);let o;o="TensorListReserve"===e.op?"numElements":"maxNumElements";const s=function(e,t,n){return new nd([],e,t,n)}(r,i,ul(o,e,t,n));return n.addTensorList(s),[s.idTensor]}case"TensorListGather":{const r=ul("tensorListId",e,t,n),i=ul("indices",e,t,n),o=ul("elementShape",e,t,n),s=ul("elementDType",e,t,n);return[n.getTensorList(r.id).gather(i,s,o)]}case"TensorListStack":{const r=ul("tensorListId",e,t,n),i=ul("elementShape",e,t,n),o=ul("elementDType",e,t,n),s=ul("numElements",e,t,n);return[n.getTensorList(r.id).stack(i,o,s)]}case"TensorListFromTensor":{const r=function(e,t,n){const r=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==n)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${n}`);Jl(e.shape.slice(1),t,"TensorList shape mismatch: ");const i=kc(e);return new nd(i,t,r)}(ul("tensor",e,t,n),ul("elementShape",e,t,n),ul("elementDType",e,t,n));return n.addTensorList(r),[r.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=ul("tensorListId",e,t,n),i=n.getTensorList(r.id),o=ul("dtype",e,t,n),s=ul("elementShape",e,t,n);return[i.concat(o,s)]}case"TensorListPushBack":{const r=ul("tensorListId",e,t,n),i=ul("tensor",e,t,n),o=n.getTensorList(r.id);return o.pushBack(i),[o.idTensor]}case"TensorListPopBack":{const r=ul("tensorListId",e,t,n),i=ul("elementShape",e,t,n),o=ul("elementDType",e,t,n);return[n.getTensorList(r.id).popBack(i,o)]}case"TensorListSplit":{const r=ul("tensor",e,t,n),i=ul("elementShape",e,t,n),o=function(e,t,n){let r=0;const i=t.map((e=>(r+=e,r)));if(r!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${e.shape}`);const o=ed(e.shape.slice(1),n),s=0===r?0:e.size/r,a=Ji((()=>{const n=[];e=rs(e,[1,r,s]);for(let r=0;r<t.length;++r){const a=[0,0===r?0:i[r-1],0],c=[1,t[r],s];n[r]=rs(us(e,a,c),o)}return e.dispose(),n})),c=new nd([],n,e.dtype,t.length);for(let e=0;e<a.length;e++)c.setItem(e,a[e]);return c}(r,ul("lengths",e,t,n),i);return n.addTensorList(o),[o.idTensor]}case"TensorListLength":{const r=ul("tensorListId",e,t,n);return[zs(n.getTensorList(r.id).size(),"int32")]}case"TensorListResize":{const r=ul("tensorListId",e,t,n),i=ul("size",e,t,n),o=n.getTensorList(r.id).resize(i);return n.addTensorList(o),[o.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n);case"convolution":return Ji((()=>((e,t,n)=>{switch(e.op){case"Conv1D":{const r=ul("stride",e,t,n),i=ul("pad",e,t,n),o=ul("dataFormat",e,t,n).toUpperCase(),s=ul("dilation",e,t,n);return[Is(ul("x",e,t,n),ul("filter",e,t,n),r,i,o,s)]}case"Conv2D":{const r=ul("strides",e,t,n),i=fl(e,t,n),o=ul("dataFormat",e,t,n).toUpperCase(),s=ul("dilations",e,t,n);return[ms(ul("x",e,t,n),ul("filter",e,t,n),[r[1],r[2]],i,o,[s[1],s[2]])]}case"_FusedConv2D":{const{stride:r,pad:i,dataFormat:o,dilations:s,biasArg:a,preluArg:c,activationFunc:u,leakyreluAlpha:l}=rd(e,t,n);return[Kc({x:ul("x",e,t,n),filter:ul("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[s[1],s[2]],bias:a,activation:u,preluActivationWeights:c,leakyreluAlpha:l})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:i,dataFormat:o,dilations:s,biasArg:a,preluArg:c,activationFunc:u,leakyreluAlpha:l}=rd(e,t,n);return[qc({x:ul("x",e,t,n),filter:ul("filter",e,t,n),strides:[r[1],r[2]],pad:i,dataFormat:o,dilations:[s[1],s[2]],bias:a,activation:u,preluActivationWeights:c,leakyreluAlpha:l})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=ul("outputShape",e,t,n),i=ul("strides",e,t,n),o=fl(e,t,n);return[Rs(ul("x",e,t,n),ul("filter",e,t,n),r,[i[1],i[2]],o)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=ul("strides",e,t,n),i=fl(e,t,n),o=ul("dilations",e,t,n),s=ul("dataFormat",e,t,n).toUpperCase();return[Ns(ul("input",e,t,n),ul("filter",e,t,n),[r[1],r[2]],i,s,[o[1],o[2]])]}case"Conv3D":{const r=ul("strides",e,t,n),i=ul("pad",e,t,n),o=ul("dataFormat",e,t,n).toUpperCase(),s=ul("dilations",e,t,n);return[vs(ul("x",e,t,n),ul("filter",e,t,n),[r[1],r[2],r[3]],i,o,[s[1],s[2],s[3]])]}case"AvgPool":{const r=ul("strides",e,t,n),i=ul("pad",e,t,n),o=ul("kernelSize",e,t,n);return[is(ul("x",e,t,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPool":{const r=ul("strides",e,t,n),i=ul("pad",e,t,n),o=ul("kernelSize",e,t,n);return[Na(ul("x",e,t,n),[o[1],o[2]],[r[1],r[2]],i)]}case"MaxPoolWithArgmax":{const r=ul("strides",e,t,n),i=ul("pad",e,t,n),o=ul("kernelSize",e,t,n),s=ul("includeBatchInIndex",e,t,n),{result:a,indexes:c}=La(ul("x",e,t,n),[o[1],o[2]],[r[1],r[2]],i,s);return[a,c]}case"AvgPool3D":{const r=ul("strides",e,t,n),i=ul("pad",e,t,n),o=ul("kernelSize",e,t,n);return[os(ul("x",e,t,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"MaxPool3D":{const r=ul("strides",e,t,n),i=ul("pad",e,t,n),o=ul("kernelSize",e,t,n);return[Da(ul("x",e,t,n),[o[1],o[2],o[3]],[r[1],r[2],r[3]],i)]}case"Dilation2D":{const r=ul("strides",e,t,n),i=ul("pad",e,t,n),o=ul("dilations",e,t,n),s=r[1],a=r[2],c=o[1],u=o[2];return[Ds(ul("x",e,t,n),ul("filter",e,t,n),[s,a],i,[c,u],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"creation":return Ji((()=>((e,t,n)=>{switch(e.op){case"Fill":{const r=ul("shape",e,t,n),i=ul("dtype",e,t,n);return[aa(r,ul("value",e,t,n),i)]}case"LinSpace":return[Ea(ul("start",e,t,n),ul("stop",e,t,n),ul("num",e,t,n))];case"Multinomial":{const r=ul("logits",e,t,n),i=ul("numSamples",e,t,n),o=ul("seed",e,t,n);return[Va(r,i,o)]}case"OneHot":{const r=ul("indices",e,t,n),i=ul("depth",e,t,n),o=ul("onValue",e,t,n),s=ul("offValue",e,t,n);return[zi(r,i,o,s)]}case"Ones":return[Ma(ul("shape",e,t,n),ul("dtype",e,t,n))];case"OnesLike":return[Qa(ul("x",e,t,n))];case"RandomUniform":return[oc(ul("shape",e,t,n),ul("minval",e,t,n),ul("maxval",e,t,n),ul("dtype",e,t,n))];case"Range":return[sc(ul("start",e,t,n),ul("stop",e,t,n),ul("step",e,t,n),ul("dtype",e,t,n))];case"TruncatedNormal":{const r=ul("shape",e,t,n),i=ul("mean",e,t,n),o=ul("stdDev",e,t,n),s=ul("seed",e,t,n);return[Lc(r,i,o,ul("dtype",e,t,n),s)]}case"Zeros":return[xa(ul("shape",e,t,n),ul("dtype",e,t,n))];case"ZerosLike":return[ks(ul("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"dynamic":return(async(e,t,n)=>{switch(e.op){case"NonMaxSuppressionV5":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:s,scoreThreshold:a,softNmsSigma:c}=id(e,t,n),u=await bu.nonMaxSuppressionWithScoreAsync(r,i,o,s,a,c);return[u.selectedIndices,u.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:s,scoreThreshold:a}=id(e,t,n),c=ul("padToMaxOutputSize",e,t,n),u=await bu.nonMaxSuppressionPaddedAsync(r,i,o,s,a,c);return[u.selectedIndices,u.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:r,scores:i,maxOutputSize:o,iouThreshold:s,scoreThreshold:a}=id(e,t,n);return[await bu.nonMaxSuppressionAsync(r,i,o,s,a)]}case"Where":{const r=Ki(ul("condition",e,t,n),"bool"),i=[await Uc(r)];return r.dispose(),i}case"ListDiff":return async function(e,t){const n=li(e,"x","setdiff1d"),r=li(t,"y","setdiff1d");qe(n.dtype===r.dtype,(()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`)),qe(1===n.rank,(()=>`x should be 1D tensor, but got x (${n.shape}).`)),qe(1===r.rank,(()=>`y should be 1D tensor, but got y (${r.shape}).`));const i=await n.data(),o=await r.data(),s=new Set(o);let a=0;for(let e=0;e<i.length;e++)s.has(i[e])||a++;const c=new Vn([a],n.dtype),u=new Vn([a],"int32");for(let e=0,t=0;e<i.length;e++)s.has(i[e])||(c.values[t]=i[e],u.values[t]=e,t++);return[c.toTensor(),u.toTensor()]}(ul("x",e,t,n),ul("y",e,t,n));default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n);case"evaluation":return Ji((()=>((e,t,n)=>{switch(e.op){case"LowerBound":return[wa(ul("sortedSequence",e,t,n),ul("values",e,t,n))];case"TopKV2":{const r=ul("x",e,t,n),i=ul("k",e,t,n),o=ul("sorted",e,t,n),s=Dc(r,i,o);return[s.values,s.indices]}case"UpperBound":return[xc(ul("sortedSequence",e,t,n),ul("values",e,t,n))];case"Unique":{const r=ul("x",e,t,n),i=Pc(r);return[i.values,i.indices]}case"UniqueV2":{const r=ul("x",e,t,n),i=ul("axis",e,t,n),o=Pc(r,i);return[o.values,o.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"image":return Ji((()=>((e,t,n)=>{switch(e.op){case"ResizeBilinear":{const r=ul("images",e,t,n),i=ul("size",e,t,n),o=ul("alignCorners",e,t,n),s=ul("halfPixelCenters",e,t,n);return[bu.resizeBilinear(r,[i[0],i[1]],o,s)]}case"ResizeNearestNeighbor":{const r=ul("images",e,t,n),i=ul("size",e,t,n),o=ul("alignCorners",e,t,n),s=ul("halfPixelCenters",e,t,n);return[bu.resizeNearestNeighbor(r,[i[0],i[1]],o,s)]}case"CropAndResize":{const r=ul("image",e,t,n),i=ul("boxes",e,t,n),o=ul("boxInd",e,t,n),s=ul("cropSize",e,t,n),a=ul("method",e,t,n),c=ul("extrapolationValue",e,t,n);return[bu.cropAndResize(r,i,o,s,a,c)]}case"ImageProjectiveTransformV3":{const r=ul("images",e,t,n),i=ul("transforms",e,t,n),o=ul("outputShape",e,t,n),s=ul("fillValue",e,t,n),a=ul("interpolation",e,t,n),c=ul("fillMode",e,t,n);return[bu.transform(r,i,a.toLowerCase(),c.toLowerCase(),s,o)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"graph":return Ji((()=>((e,t,n)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const r=ul("default",e,t,n);return[ll(e.name,t,n)||r];case"Placeholder":return[ll(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[Al(ul("x",e,t,n))];case"IdentityN":return ul("x",e,t,n).map((e=>Al(e)));case"Shape":return[wc(ul("x",e,t,n).shape,"int32")];case"ShapeN":return ul("x",e,t,n).map((e=>wc(e.shape)));case"Size":return[zs(ul("x",e,t,n).size,"int32")];case"Rank":return[zs(ul("x",e,t,n).rank,"int32")];case"NoOp":return[zs(1)];case"Print":const i=ul("x",e,t,n),o=ul("data",e,t,n),s=ul("message",e,t,n),a=ul("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(s);for(let e=0;e<o.length;e++)console.log(Array.prototype.slice.call(o[e].dataSync()).slice(0,a));return[i];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"logical":return Ji((()=>((e,t,n)=>{switch(e.op){case"Equal":return[Ls(ul("a",e,t,n),ul("b",e,t,n))];case"NotEqual":return[Ga(ul("a",e,t,n),ul("b",e,t,n))];case"Greater":return[la(ul("a",e,t,n),ul("b",e,t,n))];case"GreaterEqual":return[da(ul("a",e,t,n),ul("b",e,t,n))];case"Less":return[fa(ul("a",e,t,n),ul("b",e,t,n))];case"LessEqual":return[Aa(ul("a",e,t,n),ul("b",e,t,n))];case"LogicalAnd":return[Sa(ul("a",e,t,n),ul("b",e,t,n))];case"LogicalNot":return[Ca(ul("a",e,t,n))];case"LogicalOr":return[Oa(ul("a",e,t,n),ul("b",e,t,n))];case"Select":case"SelectV2":return[Ps(ul("condition",e,t,n),ul("a",e,t,n),ul("b",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"matrices":return Ji((()=>((e,t,n)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[$i(ul("a",e,t,n),ul("b",e,t,n),ul("transposeA",e,t,n),ul("transposeB",e,t,n))];case"Einsum":return[Ms(ul("equation",e,t,n),...ul("tensors",e,t,n))];case"Transpose":return[ro(ul("x",e,t,n),ul("perm",e,t,n))];case"_FusedMatMul":const[r,i]=ul("fusedOps",e,t,n),o="biasadd"===r,s="prelu"===i,a=ul("numArgs",e,t,n),c=ul("leakyreluAlpha",e,t,n);if(o){if(s&&2!==a)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==a)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,l]=ul("args",e,t,n);return[Jc({a:ul("a",e,t,n),b:ul("b",e,t,n),transposeA:ul("transposeA",e,t,n),transposeB:ul("transposeB",e,t,n),bias:u,activation:i,preluActivationWeights:l,leakyreluAlpha:c})];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"normalization":return Ji((()=>((e,t,n)=>{switch(e.op){case"EuclideanNorm":return[ta(ul("x",e,t,n),ul("axis",e,t,n),ul("keepDims",e,t,n))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[hs(ul("x",e,t,n),ul("mean",e,t,n),ul("variance",e,t,n),ul("offset",e,t,n),ul("scale",e,t,n),ul("epsilon",e,t,n))];case"LRN":return[ga(ul("x",e,t,n),ul("radius",e,t,n),ul("bias",e,t,n),ul("alpha",e,t,n),ul("beta",e,t,n))];case"Softmax":return[gc(ul("x",e,t,n))];case"LogSoftmax":return[va(ul("x",e,t,n))];case"SparseToDense":return[Fc(ul("sparseIndices",e,t,n),ul("outputShape",e,t,n),ul("sparseValues",e,t,n),ul("defaultValue",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"reduction":return Ji((()=>((e,t,n)=>{switch(e.op){case"Max":{const r=ul("axis",e,t,n),i=ul("keepDims",e,t,n);return[Ys(ul("x",e,t,n),r,i)]}case"Mean":{const r=ul("axis",e,t,n),i=ul("keepDims",e,t,n);return[ka(ul("x",e,t,n),r,i)]}case"Min":{const r=ul("axis",e,t,n),i=ul("keepDims",e,t,n);return[Ks(ul("x",e,t,n),r,i)]}case"Sum":{const r=ul("axis",e,t,n),i=ul("keepDims",e,t,n);return[Xs(ul("x",e,t,n),r,i)]}case"All":{const r=ul("axis",e,t,n),i=ul("keepDims",e,t,n);return[Mo(ul("x",e,t,n),r,i)]}case"Any":{const r=ul("axis",e,t,n),i=ul("keepDims",e,t,n);return[Uo(ul("x",e,t,n),r,i)]}case"ArgMax":{const r=ul("axis",e,t,n);return[Bo(ul("x",e,t,n),r)]}case"ArgMin":{const r=ul("axis",e,t,n);return[Fo(ul("x",e,t,n),r)]}case"Prod":{const r=ul("axis",e,t,n),i=ul("keepDims",e,t,n);return[Ya(ul("x",e,t,n),r,i)]}case"Cumprod":{const r=ul("axis",e,t,n),i=ul("exclusive",e,t,n),o=ul("reverse",e,t,n);return[Cs(ul("x",e,t,n),r,i,o)]}case"Cumsum":{const r=ul("axis",e,t,n),i=ul("exclusive",e,t,n),o=ul("reverse",e,t,n);return[Os(ul("x",e,t,n),r,i,o)]}case"Bincount":const r=ul("x",e,t,n),i=ul("weights",e,t,n),o=ul("size",e,t,n);return[ps(r,i,o)];case"DenseBincount":{const r=ul("x",e,t,n),i=ul("weights",e,t,n),o=ul("size",e,t,n),s=ul("binaryOutput",e,t,n);return[bs(r,i,o,s)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"slice_join":return Ji((()=>((e,t,n)=>{switch(e.op){case"ConcatV2":case"Concat":{const r=ul("n",e,t,n),i=ul("axis",e,t,n);let o=ul("tensors",e,t,n);return o=o.slice(0,r),[as(o,i)]}case"Gather":{const r=ul("x",e,t,n),i=ul("indices",e,t,n);return[ua(r,Ki(i,"int32"),0)]}case"GatherV2":{const r=ul("axis",e,t,n),i=ul("batchDims",e,t,n),o=ul("x",e,t,n),s=ul("indices",e,t,n);return[ua(o,Ki(s,"int32"),r,i)]}case"Reverse":{const r=ul("dims",e,t,n),i=[];for(let e=0;e<r.length;e++)r[e]&&i.push(e);const o=ul("x",e,t,n);return[lc(o,i)]}case"ReverseV2":{const r=ul("axis",e,t,n),i=ul("x",e,t,n);return[lc(i,r)]}case"Slice":{const r=ul("begin",e,t,n),i=ul("size",e,t,n);return[us(ul("x",e,t,n),r,i)]}case"StridedSlice":{const r=ul("begin",e,t,n),i=ul("end",e,t,n),o=ul("strides",e,t,n),s=ul("beginMask",e,t,n),a=ul("endMask",e,t,n),c=ul("ellipsisMask",e,t,n),u=ul("newAxisMask",e,t,n),l=ul("shrinkAxisMask",e,t,n),d=ul("x",e,t,n);return[Oc(d,r,i,o,s,a,c,u,l)]}case"Pack":return Ji((()=>{const r=ul("axis",e,t,n),i=ul("tensors",e,t,n),o=i[0].shape,s=yc(i[0]).shape,a=i.map((e=>{const t=tt(e.shape,o);if(!t&&!tt(yc(e).shape,s))throw new Error("the input tensors shape does not match");return t?e:rs(e,o)}));return[Sc(a,r)]}));case"Unpack":{const r=ul("axis",e,t,n),i=ul("tensor",e,t,n);return kc(i,r)}case"Tile":{const r=ul("reps",e,t,n);return[oa(ul("x",e,t,n),r)]}case"Split":case"SplitV":{const r=ul("axis",e,t,n),i=ul("numOrSizeSplits",e,t,n),o=ul("x",e,t,n);return Tc(o,i,r)}case"ScatterNd":{const r=ul("indices",e,t,n),i=ul("values",e,t,n),o=ul("shape",e,t,n);return[Bc(r,i,o)]}case"GatherNd":{const r=ul("x",e,t,n),i=ul("indices",e,t,n);return[Vc(r,i)]}case"SparseToDense":{const r=ul("sparseIndices",e,t,n),i=ul("outputShape",e,t,n),o=ul("sparseValues",e,t,n),s=ul("defaultValue",e,t,n);return[Fc(r,o,i,o.dtype===s.dtype?s:Ki(s,o.dtype))]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"sparse":return Ji((()=>((e,t,n)=>{switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:i,emptyRowIndicator:o,reverseIndexMap:s}=wu.sparseFillEmptyRows(ul("indices",e,t,n),ul("values",e,t,n),ul("denseShape",e,t,n),ul("defaultValue",e,t,n));return[r,i,o,s]}case"SparseReshape":{const{outputIndices:r,outputShape:i}=wu.sparseReshape(ul("inputIndices",e,t,n),ul("inputShape",e,t,n),ul("newShape",e,t,n));return[r,i]}case"SparseSegmentMean":return[wu.sparseSegmentMean(ul("data",e,t,n),ul("indices",e,t,n),ul("segmentIds",e,t,n))];case"SparseSegmentSum":return[wu.sparseSegmentSum(ul("data",e,t,n),ul("indices",e,t,n),ul("segmentIds",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"spectral":return Ji((()=>((e,t,n)=>{switch(e.op){case"FFT":return[_c(ul("x",e,t,n))];case"IFFT":return[mc(ul("x",e,t,n))];case"RFFT":return[Rc(ul("x",e,t,n))];case"IRFFT":return[Ic(ul("x",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"string":return Ji((()=>((e,t,n)=>{switch(e.op){case"StringNGrams":{const{nGrams:r,nGramsSplits:i}=Nu.stringNGrams(ul("data",e,t,n),ul("dataSplits",e,t,n),ul("separator",e,t,n),ul("nGramWidths",e,t,n),ul("leftPad",e,t,n),ul("rightPad",e,t,n),ul("padWidth",e,t,n),ul("preserveShortSequences",e,t,n));return[r,i]}case"StringSplit":{const{indices:r,values:i,shape:o}=Nu.stringSplit(ul("input",e,t,n),ul("delimiter",e,t,n),ul("skipEmpty",e,t,n));return[r,i,o]}case"StringToHashBucketFast":return[Nu.stringToHashBucketFast(ul("input",e,t,n),ul("numBuckets",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"transformation":return Ji((()=>((e,t,n)=>{switch(e.op){case"Cast":return[Ki(ul("x",e,t,n),ul("dtype",e,t,n))];case"ExpandDims":{const r=ul("axis",e,t,n);return[ra(ul("x",e,t,n),r)]}case"Squeeze":{const r=ul("axis",e,t,n);return[yc(ul("x",e,t,n),r)]}case"Reshape":return[rs(ul("x",e,t,n),ul("shape",e,t,n))];case"MirrorPad":return[Ba(ul("x",e,t,n),ul("padding",e,t,n),ul("mode",e,t,n))];case"PadV2":case"Pad":return[ja(ul("x",e,t,n),ul("padding",e,t,n),ul("constantValue",e,t,n))];case"SpaceToBatchND":{const r=ul("blockShape",e,t,n),i=ul("paddings",e,t,n);return[Ha(ul("x",e,t,n),r,i)]}case"BatchToSpaceND":{const r=ul("blockShape",e,t,n),i=ul("crops",e,t,n);return[ds(ul("x",e,t,n),r,i)]}case"DepthToSpace":{const r=ul("blockSize",e,t,n),i=ul("dataFormat",e,t,n).toUpperCase();return[ws(ul("x",e,t,n),r,i)]}case"BroadcastTo":return[As(ul("x",e,t,n),ul("shape",e,t,n))];case"BroadcastArgs":return[fs(ul("s0",e,t,n),ul("s1",e,t,n))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n)));case"hash_table":return(async(e,t,n,r)=>{switch(e.op){case"HashTable":case"HashTableV2":{const i=ul("keyDType",e,t,n),o=ul("valueDType",e,t,n),s=new od(i,o);return r.addHashTable(e.name,s),[s.handle]}case"LookupTableImport":case"LookupTableImportV2":{const i=ul("tableHandle",e,t,n,r),o=ul("keys",e,t,n),s=ul("values",e,t,n),a=r.getHashTableById(i.id);return[await a.import(o,s)]}case"LookupTableFind":case"LookupTableFindV2":{const i=ul("tableHandle",e,t,n,r),o=ul("keys",e,t,n),s=ul("defaultValue",e,t,n),a=r.getHashTableById(i.id);return[await a.find(o,s)]}case"LookupTableSize":case"LookupTableSizeV2":{const i=ul("tableHandle",e,t,n,r);return[r.getHashTableById(i.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,n,r);case"custom":const i=cl(e.op);if(i&&i.customExecutor)return i.customExecutor(new ql(e,t,n));throw TypeError(`Custom op ${e.op} is not registered.`);default:throw TypeError(`Unknown op '${e.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,n);return Ct(i)?i.then((e=>[].concat(e))):[].concat(i)}class ad{constructor(e={},t={},n={},r={}){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=n,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map((e=>0===e.id&&0===e.iterationId?"":`${e.frameName}-${e.iterationId}`)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}function cd(e,t,n,r){const i=new Set,o=[];let s=null,a=null;const c=new Set,u=Object.keys(e).map((e=>pl(e)[0]));let l=[];null!=r&&(l=r.map((e=>pl(e.name)[0])));const d=[...t];for(;d.length>0;){const e=d.pop();(hd(e)||pd(e)||fd(e))&&null==s&&(s=e,a=s.children.map((e=>e.name)).filter((e=>i.has(e)))),i.add(e.name),null==n[e.name]&&-1===u.indexOf(e.name)&&-1===l.indexOf(e.name)&&(0!==e.inputs.length?e.inputs.forEach((e=>{c.has(e.name)||(c.add(e.name),d.push(e))})):o.push(e.name))}return{inputs:e,outputs:t,usedNodes:i,missingInputs:o,dynamicNode:s,syncInputs:a}}const ud=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],ld=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],dd=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function hd(e){return ud.indexOf(e.op)>=0}function pd(e){return ld.indexOf(e.op)>=0}function fd(e){return dd.indexOf(e.op)>=0}class Ad{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach((t=>{this._functionExecutorMap[t]=new Ad(e.functions[t],this)}))}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map((t=>e[t].map((e=>e.id))));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get outputs(){return this._outputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get inputNodes(){return this._inputs.map((e=>e.signatureKey||e.name))}get outputNodes(){return this._outputs.map((e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t}))}get functions(){return Object.keys(this._functions).reduce(((e,t)=>(e[t]=this._functions[t].signature,e)),{})}getCompilationKey(e,t){const n=e.map((e=>e.name)).sort(),r=t.map((e=>e.name)).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(e,t){const n=cd(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:i,syncInputs:o}=n;if(null!=i)throw new Error(`This execution contains the node '${i.name}', which has the dynamic op '${i.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${o}]`);if(r.length>0){const n=t.map((e=>e.name)),i=Object.keys(e);throw new Error(`Cannot compute the outputs [${n}] from the provided inputs [${i}]. Missing the following inputs: [${r}]`)}return function(e,t,n){const{usedNodes:r,inputs:i}=n,o=[],s=Object.keys(i).map((e=>pl(e)[0])).map((t=>e.nodes[t])),a=e.initNodes;s.forEach((e=>{r.has(e.name)&&o.push(e)})),e.weights.forEach((e=>{r.has(e.name)&&o.push(e)})),null!=a&&a.forEach((e=>{r.has(e.name)&&o.push(e)}));const c=new Set,u=[];for(;o.length>0;){const e=o.pop();c.add(e.name),t[e.name]||u.push(e),e.children.forEach((e=>{!c.has(e.name)&&r.has(e.name)&&e.inputs.every((e=>c.has(e.name)))&&o.push(e)}))}return u}(this.graph,this.weightMap,n)}execute(e,t){e=this.mapInputs(e);const n=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=n.map((e=>this.graph.nodes[pl(e)[0]])),i=t.map((e=>pl(e)[0]));let o=i.map((e=>this.graph.nodes[e]));this.resetIntermediateTensors(),0===o.length&&(o=this._outputs);const s=this.getCompilationKey(r,o);let a=this.compiledMap.get(s);null==a&&(a=this.compile(e,o),this.compiledMap.set(s,a));const c={},u={};return Ji((()=>{const n=new ad(this.weightMap,c,u,this.functionExecutorMap),r=Object.assign({},this.weightMap);Object.keys(e).forEach((t=>{const[n,i]=pl(t),o=[];o[i]=e[t],r[n]=o}));const o=this.getFrozenTensorIds(r),s={};for(let e=0;e<a.length;e++){const t=a[e];if(!r[t.name]){const e=sd(t,r,n,this._resourceManager);if(Ct(e))throw new Error(`The execution of the op '${t.op}' returned a promise. Please use model.executeAsync() instead.`);r[t.name]=e,this.checkTensorForDisposal(t.name,t,r,n,o,i,s)}}return null==this.parent&&n.dispose(o),t.map((e=>ll(e,r,n)))}))}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map((t=>e[t])).map((e=>e.map((e=>e.id)))));return new Set(t)}checkTensorForDisposal(e,t,n,r,i,o,s){"control"!==t.category&&-1===o.indexOf(e)&&(n[e].forEach((e=>{null!=e&&(s[e.id]=(s[e.id]||0)+t.children.length)})),t.inputs.forEach((e=>{if("control"!==e.category){const o=function(e,t,n){return t[hl(e,n.currentContextId)]}(e.name,n,r);null!=o&&o.forEach((e=>{if(e&&!e.kept&&!i.has(e.id)){const n=s[e.id];if(1===n){if(this.keepTensorForDebug){const[n,i]=dl(t.name,r);this.intermediateTensors[n]||(this.intermediateTensors[n]=[]),this.intermediateTensors[n][i]=e}else e.dispose();delete s[e.id]}else null!=n&&s[e.id]--}}))}})))}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach((e=>this.intermediateTensors[e].forEach((e=>e.dispose())))),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach((e=>{this.tensorsMap[e].forEach((e=>{!e||e.kept||e.isDisposed||this.keepIds.has(e.id)||e.dispose()}))}))}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach((e=>e.dispose())),delete this.intermediateTensors[e]}async _executeAsync(e,t,n=!1,r={},i={}){n||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepTensorForDebug=wt().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(e){console.warn(e.message)}this.resetIntermediateTensors();const o=new ad(this.weightMap,r,i,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,o,t,n);const s=t.map((e=>ll(e,this.tensorsMap,o))),a=s.map((e=>e.id)),c=Object.keys(e).map((t=>e[t].id));return this.keepIds=new Set([...a,...c,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),null==this.parent&&o.dispose(this.keepIds),s}async executeFunctionAsync(e,t,n){const r=e.reduce(((e,t,n)=>(e[this.inputs[n].name]=t,e)),{});return this._executeAsync(r,this.outputNodes,!0,t,n)}async executeWithControlFlow(e,t,n,r){const i=Object.keys(e),o=i.map((e=>this.graph.nodes[pl(e)[0]])),s=n.map((e=>pl(e)[0]));let a=s.map((e=>this.graph.nodes[e]));0===a.length&&(a=this._outputs);const{usedNodes:c,missingInputs:u,dynamicNode:l,syncInputs:d}=cd(e,a,this.weightMap,this._initNodes),h=[...o,...this.graph.weights,...this._initNodes||[]].map((e=>({node:e,contexts:t.currentContext}))),p=Object.assign({},this.weightMap);Object.keys(e).forEach((t=>{const[n,r]=pl(t),i=[];i[r]=e[t],p[n]=i}));const f={},A=this.getFrozenTensorIds(p),E={};for(;h.length>0;){const e=this.processStack(o,h,t,p,E,A,s,f,c);await Promise.all(e)}null!=l||r||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const g=a.filter((e=>!hd(e)&&!ll(e.name,p,t))).map((e=>e.name));if(g.length>0){let e="";throw null!=l&&(e=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${d}]`),new Error(`Cannot compute the outputs [${g}] from the provided inputs [${i}]. Consider providing the following inputs: [${u}]. ${e}`)}return p}processStack(e,t,n,r,i,o,s,a,c){const u=[];for(;t.length>0;){const e=t.pop();n.currentContext=e.contexts;let l="";if("Enter"===e.node.op&&ul("isConstant",e.node,r,n)&&([l]=dl(e.node.name,n)),null==r[e.node.name]){const d=sd(e.node,r,n,this._resourceManager);l||([l]=dl(e.node.name,n));const h=n.currentContext;Ct(d)?u.push(d.then((u=>(r[l]=u,n.currentContext=h,this.checkTensorForDisposal(l,e.node,r,n,o,s,a),this.processChildNodes(e.node,t,n,r,i,c),u)))):(r[l]=d,this.checkTensorForDisposal(l,e.node,r,n,o,s,a),this.processChildNodes(e.node,t,n,r,i,c))}else this.processChildNodes(e.node,t,n,r,i,c)}return u}processChildNodes(e,t,n,r,i,o){e.children.forEach((e=>{const[s]=dl(e.name,n);!i[s]&&o.has(e.name)&&("Merge"===e.op?e.inputNames.some((e=>!!ll(e,r,n)))&&(i[s]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((e=>!!ll(e,r,n)))&&(i[s]=!0,t.push({contexts:n.currentContext,node:e})))}))}dispose(){Object.keys(this.weightMap).forEach((e=>this.weightMap[e].forEach((e=>e.dispose()))))}checkInputShapeAndType(e){Object.keys(e).forEach((t=>{const n=e[t],[r]=pl(t),i=this.graph.nodes[r];if(i.attrParams.shape&&i.attrParams.shape.value){const e=i.attrParams.shape.value;qe(e.length===n.shape.length&&n.shape.every(((t,n)=>-1===e[n]||e[n]===t)),(()=>`The shape of dict['${i.name}'] provided in model.execute(dict) must be [${e}], but was [${n.shape}]`))}i.attrParams.dtype&&i.attrParams.dtype.value&&qe(n.dtype===i.attrParams.dtype.value,(()=>`The dtype of dict['${i.name}'] provided in model.execute(dict) must be ${i.attrParams.dtype.value}, but was ${n.dtype}`))}))}mapInputs(e){const t={};for(const n in e)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?t[this._signature.inputs[n].name]=e[n]:t[n]=e[n];return t}checkInputs(e){const t=Object.keys(e).filter((e=>{const[t]=pl(e);return null==this.graph.nodes[t]}));if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map((e=>null!=this._signature&&null!=this._signature.outputs&&null!=this._signature.outputs[e]?this._signature.outputs[e].name:e),{})}checkOutputs(e){e.forEach((e=>{const[t]=pl(e);if(!this.graph.nodes[t])throw new Error(`The output '${e}' is not found in the graph`)}))}}class Ed{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}class gd{constructor(e,t={}){this.modelUrl=e,this.loadOptions=t,this.version="n/a",null==t&&(this.loadOptions={}),this.resourceManager=new Ed}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}findIOHandler(){const e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=Wi(e,this.loadOptions);else{const r=(t=e,n=this.loadOptions,Ri.getLoadHandlers(t,n));if(0===r.length)r.push(Wi(e,this.loadOptions));else if(r.length>1)throw new Error(`Found more than one (${r.length}) load handlers for URL '${[e]}'`);this.handler=r[0]}var t,n}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Ct(e)?e.then((e=>this.loadSync(e))):this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let n;n=null!=this.artifacts.userDefinedMetadata&&null!=this.artifacts.userDefinedMetadata.signature?this.artifacts.userDefinedMetadata.signature:this.artifacts.signature,this.signature=n,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const r=function(e,t){const n={};let r,i=0;for(const o of t){const t=o.name,s=o.dtype,a=o.shape,c=et(a);let u;if("quantization"in o){const n=o.quantization;if("uint8"===n.dtype||"uint16"===n.dtype){if(!("min"in n)||!("scale"in n))throw new Error(`Weight ${o.name} with quantization ${n.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==n.dtype)throw new Error(`Weight ${o.name} has unknown quantization dtype ${n.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==s)throw new Error(`Weight ${o.name} is quantized with ${n.dtype} which only supports weights of type float32 not ${s}.`)}const a=Ei[n.dtype],l=e.slice(i,i+c*a),d="uint8"===n.dtype?new Uint8Array(l):new Uint16Array(l);if("float32"===s)if("uint8"===n.dtype||"uint16"===n.dtype){u=new Float32Array(d.length);for(let e=0;e<d.length;e++){const t=d[e];u[e]=t*n.scale+n.min}}else{if("float16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type float32.`);void 0===r&&(r=Ti()),u=r(d)}else{if("int32"!==s)throw new Error(`Unsupported dtype in weight '${t}': ${s}`);if("uint8"!==n.dtype&&"uint16"!==n.dtype)throw new Error(`Unsupported quantization type ${n.dtype} for weight type int32.`);u=new Int32Array(d.length);for(let e=0;e<d.length;e++){const t=d[e];u[e]=Math.round(t*n.scale+n.min)}}i+=c*a}else if("string"===s){const t=et(o.shape);u=[];for(let n=0;n<t;n++){const t=new Uint32Array(e.slice(i,i+4))[0];i+=4;const n=new Uint8Array(e.slice(i,i+t));u.push(n),i+=t}}else{const r=Ei[s],o=e.slice(i,i+c*r);if("float32"===s)u=new Float32Array(o);else if("int32"===s)u=new Int32Array(o);else if("bool"===s)u=new Uint8Array(o);else{if("complex64"!==s)throw new Error(`Unsupported dtype in weight '${t}': ${s}`);{u=new Float32Array(o);const e=new Float32Array(u.length/2),r=new Float32Array(u.length/2);for(let t=0;t<e.length;t++)e[t]=u[2*t],r[t]=u[2*t+1];const i=Ai(e,a,"float32"),s=Ai(r,a,"float32");n[t]=pi(i,s),i.dispose(),s.dispose()}}i+=c*r}"complex64"!==s&&(n[t]=Ai(u,a,s))}return n}(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new Ad(xl.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){const t=xl.Instance.transformGraph(e.modelInitializer);this.initializer=new Ad(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,t){if("string"==typeof e){const t=(n=e,Ri.getSaveHandlers(n));if(0===t.length)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new Error(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}var n;if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){return this.execute(e,this.outputNodes)}normalizeInputs(e){if(!(e instanceof jn||Array.isArray(e)))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce(((t,n,r)=>(t[n]=e[r],t)),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=this.executor.execute(e,t);return n.length>1?n:n[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const n=await this.executor.executeAsync(e,t);return n.length>1?n:n[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce(((t,n)=>(t[n]=[e[n]],t)),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function _d(e,t={}){if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==t&&(t={}),t.fromTFHub&&"string"==typeof e&&(e=function(e){return e.endsWith("/")||(e+="/"),`${e}model.json?tfjs-format=file`}(e));const n=new gd(e,t);return await n.load(),n}function md(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&qe("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the CPU backend.`))}))}const Id=Mc;class Td extends We{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new He(this,qi())}nextDataId(){return Td.nextDataId++}write(e,t,n){this.firstUse&&(this.firstUse=!1,wt().get("IS_NODE")&&kt("\n============================\nHi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. \n============================"));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&ft(n[0])){const i=n.map((e=>Nn(e)));r=this.write(i,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){this.data.get(e).refCount++}decRef(e){this.data.has(e)&&this.data.get(e).refCount--}move(e,t,n,r,i){this.data.set(e,{values:t,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:n}=this.data.get(e);return"complex64"===t?Vu(this.readSync(n.real.dataId),this.readSync(n.imag.dataId)):this.data.get(e).values}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>Dn(e)));return Es(e.shape,e.dtype,n)}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return Es(e.shape,e.dtype,t)}makeOutput(e,t,n){return qi().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:n}=this.data.get(e);null!=n&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=wn();return e(),{kernelMs:wn()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){md([e],"where");const t=this.readSync(e.dataId);return Id(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}function Rd(e){return(t,n,r,i,o)=>{const s=so(t,n),a=s.length,c=_t(s),u=ut(o,et(s)),l=t.length,d=n.length,h=_t(t),p=_t(n),f=io(t,s),A=io(n,s);if(f.length+A.length===0)for(let t=0;t<u.length;++t)u[t]=e(r[t%r.length],i[t%i.length]);else for(let t=0;t<u.length;++t){const n=St(t,a,c),o=n.slice(-l);f.forEach((e=>o[e]=0));const s=yt(o,l,h),E=n.slice(-d);A.forEach((e=>E[e]=0));const g=yt(E,d,p);u[t]=e(r[s],i[g])}return[u,s]}}function vd(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,a=n.makeTensorInfo(r.shape,"complex64");return n.data.get(a.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",o),imag:n.makeTensorInfo(i.shape,"float32",s)},a}function yd(e,t,n="float32"){if("complex64"===n)return vd({inputs:{real:yd(e,t,"float32"),imag:yd(e,t,"float32")},backend:e});const r=Rt(et(t),n);return e.makeTensorInfo(t,n,r)}function Sd(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}Td.nextDataId=0;const Cd={kernelName:"Identity",backendName:"cpu",kernelFunc:Sd};function Od(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,o=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,o)}function bd(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:o}=r;if("complex64"===o){if("complex64"===i.dtype)return Sd({inputs:{x:i},backend:n});const e=yd(n,i.shape,i.dtype),t=bd({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),r=vd({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if("complex64"===i.dtype){const e=Od({inputs:{input:i},backend:n}),t=bd({inputs:{x:e},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(e),t}if(!dt(i.dtype,o)){const e=Sd({inputs:{x:i},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:o}}if("int32"===o){const e=n.data.get(i.dataId).values,t=Int32Array.from(e);return n.makeTensorInfo(i.shape,"int32",t)}if("bool"===o){const e=n.data.get(i.dataId).values,t=bn([0],i.dtype),[r,o]=Rd(((e,t)=>e!==t?1:0))(i.shape,[],e,t,"bool");return n.makeTensorInfo(o,"bool",r)}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${o}`)}const wd={kernelName:"Cast",backendName:"cpu",kernelFunc:bd};function Nd(e,t,n,r){return null==n?({inputs:n,backend:i})=>{const{a:o,b:s}=n,a=i;md([o,s],e);const c=a.data.get(o.dataId).values,u=a.data.get(s.dataId).values,l="string"===o.dtype?Zu(c):c,d="string"===o.dtype?Zu(u):u,h=r||o.dtype,[p,f]=t(o.shape,s.shape,l,d,h);return a.makeTensorInfo(f,h,p)}:({inputs:e,backend:i})=>{const{a:o,b:s}=e,a=i;if("complex64"===o.dtype||"complex64"===s.dtype){const e=bd({inputs:{x:o},backend:a,attrs:{dtype:"complex64"}}),t=a.data.get(e.dataId),r=t.complexTensorInfos.real,i=t.complexTensorInfos.imag,c=a.data.get(r.dataId).values,u=a.data.get(i.dataId).values,l=bd({inputs:{x:s},backend:a,attrs:{dtype:"complex64"}}),d=a.data.get(l.dataId),h=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,f=a.data.get(h.dataId).values,A=a.data.get(p.dataId).values,[E,g,_]=n(o.shape,s.shape,c,u,f,A),m=a.makeTensorInfo(_,"float32",E),I=a.makeTensorInfo(_,"float32",g),T=vd({inputs:{real:m,imag:I},backend:a});return a.disposeIntermediateTensorInfo(e),a.disposeIntermediateTensorInfo(l),a.disposeIntermediateTensorInfo(m),a.disposeIntermediateTensorInfo(I),T}{const e=a.data.get(o.dataId).values,n=a.data.get(s.dataId).values,i=r||o.dtype,[c,u]=t(o.shape,s.shape,e,n,i);return a.makeTensorInfo(u,i,c)}}}function Dd(e){return(t,n,r,i,o,s)=>{const a=so(t,n),c=et(a),u=a.length,l=_t(a),d=ut("float32",c),h=ut("float32",c),p=io(t,a),f=io(n,a),A=Vu(r,i),E=Vu(o,s),g=t.length,_=_t(t),m=n.length,I=_t(n);if(p.length+f.length===0)for(let t=0;t<d.length;t++){const n=t%A.length,r=t%E.length,i=e(A[2*n],A[2*n+1],E[2*r],E[2*r+1]);d[t]=i.real,h[t]=i.imag}else for(let t=0;t<d.length;t++){const n=St(t,u,l),r=n.slice(-g);p.forEach((e=>r[e]=0));const i=yt(r,g,_),o=n.slice(-m);f.forEach((e=>o[e]=0));const s=yt(o,m,I),a=e(A[2*i],A[2*i+1],E[2*s],E[2*s+1]);d[t]=a.real,h[t]=a.imag}return[d,h,a]}}const Ld=Rd(((e,t)=>e+t)),Pd=Nd("Add",Ld,Dd(((e,t,n,r)=>({real:e+n,imag:t+r})))),kd={kernelName:"Add",backendName:"cpu",kernelFunc:Pd};function xd(e){return(t,n,r)=>{const i=ut(n,t.length);for(let n=0;n<t.length;++n)i[n]=e(t[n],r);return i}}function Md(e,t,n){return({inputs:r,attrs:i,backend:o})=>{const{x:s}=r;if(md(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");const a=o,c=a.data.get(s.dataId).values,u=et(s.shape),l=n||s.dtype,d=lt(l,u);for(let e=0;e<u;++e)d[e]=t(c[e],i);return a.makeTensorInfo(s.shape,l,d)}}const Ud=xd((e=>Math.ceil(e)));function Bd(e,t,n,r){const i=lt(n,et(t));if(r&&"string"!==n){let t=0;e.forEach((e=>{const n=et(e.shape);i.set(e.vals,t),t+=n}))}else{let r=0;e.forEach((e=>{const o="string"===n?Zu(e.vals):e.vals;let s=0;for(let n=0;n<e.shape[0];++n){const a=n*t[1]+r;for(let t=0;t<e.shape[1];++t)i[a+t]=o[s++]}r+=e.shape[1]}))}return i}const Fd=Rd(((e,t)=>e===t?1:0)),Vd=xd((e=>Math.exp(e))),Gd=xd((e=>Math.expm1(e))),Qd=xd((e=>Math.floor(e))),jd=Rd(((e,t)=>e>t?1:0)),Hd=Rd(((e,t)=>e>=t?1:0)),Wd=Rd(((e,t)=>e<t?1:0)),Yd=Rd(((e,t)=>e<=t?1:0)),Kd=xd((e=>Math.log(e))),$d=Rd(((e,t)=>Math.max(e,t))),zd=Rd(((e,t)=>Math.min(e,t))),qd=Rd(((e,t)=>e*t)),Jd=Dd(((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n}))),Xd={kernelName:"Multiply",backendName:"cpu",kernelFunc:Nd("Multiply",qd,Jd)},Zd=Rd(((e,t)=>e!==t?1:0));function eh(e,t,n,r,i){const o=t.length,s=et(t),a=_t(t),c=_t(i),u=ut(n,et(i));for(let t=0;t<s;++t){const n=St(t,o,a),i=new Array(n.length);for(let e=0;e<i.length;e++)i[e]=n[r[e]];u[yt(i,o,c)]=e[t]}return u}function th(e){const{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:o}=n;md(i,"transpose");const s=i.shape.length,a=new Array(s);for(let e=0;e<a.length;e++)a[e]=i.shape[o[e]];const c=eh(r.data.get(i.dataId).values,i.shape,i.dtype,o,a);return{dataId:r.write(c,a,i.dtype),shape:a,dtype:i.dtype}}const nh=xd((e=>1/Math.sqrt(e))),rh=xd((e=>1/(1+Math.exp(-e)))),ih=Md("Sigmoid",(e=>1/(1+Math.exp(-e)))),oh={kernelName:"Sigmoid",backendName:"cpu",kernelFunc:ih};function sh(e,t,n,r,i){const o=Ro(r,t,n),s=et(n),a=_t(r);if(o){const n=vo(t,a);return"string"===i?e.slice(n,n+s):e.subarray(n,n+s)}const c=Es(r,i,"string"===i?Zu(e):e),u=Es(n,i);for(let e=0;e<u.size;++e){const n=u.indexToLoc(e),r=n.map(((e,n)=>e+t[n]));u.set(c.get(...r),...n)}return"string"===i?el(u.values):u.values}function ah(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,size:s}=r;md(i,"slice");const[a,c]=yo(i,o,s);ho(i,a,c);const u=sh(n.data.get(i.dataId).values,a,c,i.shape,i.dtype);return n.makeTensorInfo(c,i.dtype,u)}const ch=xd((e=>Math.sqrt(e))),uh=Rd(((e,t)=>{const n=e-t;return n*n}));function lh(e,t,n,r){const i=Es(e,t.dtype);for(let e=0;e<i.size;e++){const o=i.indexToLoc(e),s=new Array(o.length);for(let e=0;e<s.length;e++)s[e]=o[e]*n[e]+r[e];i.set(t.get(...s),...o)}return i}class dh{constructor(e,t,n,r,i,o){this.separator=Nn(e),this.nGramWidths=t,this.leftPad=Nn(n),this.rightPad=Nn(r),this.padWidth=i,this.preserveShort=o}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,i,o){for(let s=0;s<i;++s){const a=this.getPadWidth(o),c=Math.max(0,a-s),u=Math.max(0,a-(i-(s+1))),l=o-(c+u),d=t+(c>0?0:s-a);let h=0;h+=c*this.leftPad.length;for(let t=0;t<l;++t)h+=e[d+t].length;h+=u*this.rightPad.length,h+=(c+u+l-1)*this.separator.length,n[r+s]=new Uint8Array(h);const p=n[r+s];let f=0;const A=e=>e.forEach((e=>p[f++]=e));for(let e=0;e<c;++e)A(this.leftPad),A(this.separator);for(let t=0;t<l-1;++t)A(e[d+t]),A(this.separator);if(l>0){A(e[d+l-1]);for(let e=0;e<u;++e)A(this.separator),A(this.rightPad)}else{for(let e=0;e<u-1;++e)A(this.rightPad),A(this.separator);A(this.rightPad)}}}compute(e,t){const n=e.length,r=t.length;if(r>0){let e=t[0];if(0!==e)throw new Error(`First split value must be 0, got ${e}`);for(let i=1;i<r;++i){let r=t[i]>=e;if(r=r&&t[i]<=n,!r)throw new Error(`Invalid split value ${t[i]}, must be in [${e}, ${n}]`);e=t[i]}if(e!==n)throw new Error(`Last split value must be data size. Expected ${n}, got ${e}`)}const i=r-1,o=lt("int32",r);if(0===n||0===r){const e=new Array(n);for(let e=0;e<=i;++e)o[e]=0;return[e,o]}o[0]=0;for(let e=1;e<=i;++e){const n=t[e]-t[e-1];let r=0;this.nGramWidths.forEach((e=>{r+=this.getNumNGrams(n,e)})),this.preserveShort&&n>0&&0===r&&(r=1),o[e]=o[e-1]+r}const s=new Array(o[i]);for(let n=0;n<i;++n){const r=t[n];let i=o[n];if(this.nGramWidths.forEach((o=>{const a=t[n+1]-t[n],c=this.getNumNGrams(a,o);this.createNGrams(e,r,s,i,c,o),i+=c})),this.preserveShort&&i===o[n]){const o=t[n+1]-t[n];if(0===o)continue;const a=o+2*this.padWidth,c=1;this.createNGrams(e,r,s,i,c,a)}}return[s,o]}}function hh(e,t,n,r){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(1===t.length){const i=t[0];let o=e.indexOf(i);for(;-1!==o;){const t=e.subarray(0,o);n&&0===t.length||r.push(t),o=(e=e.subarray(o+1)).indexOf(i)}return void(n&&0===e.length||r.push(e))}let i=0;for(let o=0;o<e.length+1;o++)if(o===e.length||-1!==t.indexOf(e[o])){const t=e.subarray(i,o);n&&0===t.length||r.push(t),i=o+1}}const ph=Rd(((e,t)=>e-t)),fh={kernelName:"Sub",backendName:"cpu",kernelFunc:Nd("Sub",ph,Dd(((e,t,n,r)=>({real:e-n,imag:t-r}))))},Ah=(e,t)=>{const n=t.value-e.value;return 0===n?e.index-t.index:n};function Eh(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){const i=r-n+1,o=t-n+1,s=Math.log(i),a=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*a*(i-a)/i)*Math.sign(o-i/2);Eh(e,t,Math.max(n,Math.floor(t-o*a/i+c)),Math.min(r,Math.floor(t+(i-o)*a/i+c)))}const i=e[t];let o=n,s=r;for(ze(e,n,t),Ah(e[r],i)>0&&ze(e,n,r);o<s;){for(ze(e,o,s),o++,s--;Ah(e[o],i)<0;)o+=1;for(;Ah(e[s],i)>0;)s-=1}0===Ah(e[n],i)?ze(e,n,s):(s+=1,ze(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}}var gh=Object.freeze({__proto__:null,simpleAbsImpl:function(e){const t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t},addImpl:Ld,bincountImpl:function(e,t,n,r,i){const o=et(r),s=Rt(i,n);for(let n=0;n<e.length;n++){const r=e[n];if(r<0)throw new Error("Input x must be non-negative!");r>=i||(s[r]+=o>0?t[n]:1)}return s},bincountReduceImpl:function(e,t,n,r=!1){const i=e.shape[0],o=e.shape[1],s=Es([i,n],t.dtype);for(let a=0;a<i;a++)for(let i=0;i<o;i++){const o=e.get(a,i);if(o<0)throw new Error("Input x must be non-negative!");o>=n||(r?s.set(1,a,o):t.size>0?s.set(s.get(a,o)+t.get(a,i),a,o):s.set(s.get(a,o)+1,a,o))}return s},ceilImpl:Ud,concatImpl:Bd,equalImpl:Fd,expImpl:Vd,expm1Impl:Gd,floorImpl:Qd,gatherNdImpl:function(e,t,n,r,i,o,s,a,c){const u=Es([r,o],n);for(let n=0;n<r;n++){const r=[];let l=0;for(let t=0;t<i;t++){const o=e[n*i+t];l+=o*s[t],r.push(o)}if(l<0||l>=c/o)throw new Error(`Invalid indices: ${r} does not index into ${a}`);for(let e=0;e<o;e++)u.values[n*o+e]=t.get(...t.indexToLoc(l*o+e))}return u},gatherV2Impl:function(e,t,n){const r=Es(n,e.dtype);for(let n=0;n<r.size;++n){const i=r.indexToLoc(n).slice(),o=i[0],s=i[2],a=t.locToIndex([o,s]);i[2]=t.values[a];const c=e.locToIndex(i);0<=c&&c<e.values.length&&(r.values[n]=e.values[c])}return r},greaterImpl:jd,greaterEqualImpl:Hd,lessImpl:Wd,lessEqualImpl:Yd,linSpaceImpl:function(e,t,n){const r=(t-e)/(n-1),i=Rt(n,"float32");i[0]=e;for(let e=1;e<i.length;e++)i[e]=i[e-1]+r;return i},logImpl:Kd,maxImpl:function(e,t,n,r){const i=ut(r,et(n));for(let n=0;n<i.length;++n){const r=n*t;let o=e[r];for(let n=0;n<t;++n){const t=e[r+n];(Number.isNaN(t)||t>o)&&(o=t)}i[n]=o}return i},maximumImpl:$d,minimumImpl:zd,multiplyImpl:qd,negImpl:function(e,t,n){const r=On(-1,n);return qd([],t,r,e,n)},notEqualImpl:Zd,prodImpl:function(e,t,n,r){const[i,o]=Gs(e,r),s=Xn(t,"int32"),a=Rt(et(i),s),c=et(o);for(let e=0;e<a.length;++e){const t=e*c;let r=1;for(let e=0;e<c;++e)r*=n[t+e];a[e]=r}return{outVals:a,outShape:i,outDtype:s}},rangeImpl:function(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return Rt(0,r);const i=Rt(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),i[0]=e;for(let e=1;e<i.length;e++)i[e]=i[e-1]+n;return i},rsqrtImpl:nh,scatterImpl:function(e,t,n,r,i,o,s,a,c,u){const l=[r/i,i],d=e.values,h=t.values;if(0===r)return Es(n,t.dtype);const p=Es(l,t.dtype);"string"==typeof c||"number"==typeof c?p.values.fill(c):"boolean"==typeof c&&p.values.fill(+c);for(let e=0;e<o;e++){const o=[];let c=0;for(let t=0;t<s;t++){const n=d[e*s+t];o.push(n),c+=n*a[t]}if(c<0||c>=r/i)throw new Error(`Invalid indices: ${o} does not index into ${n}`);for(let n=0;n<i;n++)u?p.values[c*i+n]+=h[e*i+n]:p.values[c*i+n]=0===t.rank?h[0]:h[e*i+n]}return p},sigmoidImpl:rh,sliceImpl:sh,sparseFillEmptyRowsImpl:function(e,t,n,r,i,o,s){const a=t[0],c=o[0],u=new Array(c),l=new Array(a),d=t[1];if(0===c){if(0!==a)throw new Error(ju(a));return[lt(n,0),[0,d],lt(i,0),u,l]}let h=!0,p=0;const f=new Array(c).fill(0);for(let t=0;t<a;++t){const n=e[t*d];if(n<0)throw new Error(Hu(t,n));if(n>=c)throw new Error(Wu(t,n,c));++f[n],h=h&&n>=p,p=n}let A=!0;for(let e=0;e<c;++e){const t=0===f[e];u[e]=t,A=A&&!t,f[e]=Math.max(f[e],1),e>0&&(f[e]+=f[e-1])}if(A&&h){const t=e,n=r;for(let e=0;e<a;++e)l[e]=e;return[t,[a,d],n,u,l]}{const t=f[c-1],o=lt(n,t*d),h=lt(i,t),p=new Array(c).fill(0);for(let t=0;t<a;++t){const n=e[t*d],i=p[n],s=(0===n?0:f[n-1])+i;p[n]++;for(let n=0;n<d;++n)o[s*d+n]=e[t*d+n];h[s]=r[t],l[t]=s}for(let e=0;e<c;++e)if(0===p[e]){const t=0===e?0:f[e-1];o[t*d+0]=e;for(let e=1;e<d;++e)o[t*d+e]=0;h[t]=s}return[o,[t,d],h,u,l]}},sparseReshapeImpl:function(e,t,n,r,i){const o=et(r),s=t[0],a=i.length,c=[];let u=1,l=-1;for(let e=0;e<a;++e){const t=i[e];if(-1===t){if(-1!==l)throw new Error(Yu(l,e));l=e,c.push(1)}else{if(t<0)throw new Error(Ku(e,t));u*=t,c.push(t)}}if(-1!==l){if(u<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const e=Math.trunc(o/u);if(u*e!==o)throw new Error($u(r,c));c[l]=e}if(et(c)!==o)throw new Error(zu(r,c));const d=r.length,h=[];if(d>0){h[d-1]=1;for(let e=d-2;e>=0;--e)h[e]=h[e+1]*r[e+1]}const p=[];if(a>0){p[a-1]=1;for(let e=a-2;e>=0;--e)p[e]=p[e+1]*c[e+1]}const f=lt(n,s*a);for(let t=0;t<s;++t){let n=0;for(let r=0;r<d;++r)n+=e[t*d+r]*h[r];for(let e=0;e<a;++e)f[t*a+e]=Math.trunc(n/p[e]),n%=p[e]}return[f,[s,a],c]},sparseSegmentReductionImpl:function(e,t,n,r,i,o=!1,s=0){const a=r.length,c=[t[0],e.length/t[0]],u=c[1],l=a>0?i[a-1]+1:0;if(l<0)throw new Error("segment ids must be >= 0");const d=t.slice();d[0]=l;const h=lt(n,d.reduce(((e,t)=>e*t),1));if(0===a)return l>0&&h.fill(s),[h,d];if(l<=0)throw new Error("segment ids must be >= 0");let p=0,f=1,A=0,E=i[p];for(;;){let t=0;if(f<a){if(t=i[f],E===t){++f;continue}if(E>=t)throw new Error("segment ids are not increasing")}if(E<0||E>=l)throw new Error(qu(E,l));E>A&&h.fill(s,A*u,E*u);for(let t=p;t<f;++t){const n=r[t];if(n<0||n>=c[0])throw new Error(Ju(t,r[t],c[0]));for(let t=0;t<u;t++)h[E*u+t]+=e[n*u+t]}if(o)for(let e=0;e<u;e++)h[E*u+e]/=f-p;if(p=f,++f,A=E+1,E=t,f>a)break}return A<l&&h.fill(s,A*u,l*u),[h,d]},sqrtImpl:ch,squaredDifferenceImpl:uh,stridedSliceImpl:lh,stringNGramsImpl:function(e,t,n,r,i,o,s,a){return new dh(n,r,i,o,s,a).compute(e,t)},stringSplitImpl:function(e,t,n){const r=e.length,i=[];let o=0,s=0;const a=new Array(r);for(let c=0;c<r;++c){const r=i.length;hh(e[c],t,n,i);const u=i.length-r;a[c]=u,o+=u,s=Math.max(s,u)}const c=lt("int32",2*o),u=new Array(o),l=[r,s];let d=0;for(let e=0;e<r;++e)for(let t=0;t<a[e];++t)c[2*d]=e,c[2*d+1]=t,u[d]=i[d],++d;return[c,u,l]},stringToHashBucketFastImpl:function(e,t){const n=lt("int32",e.length);for(let r=0;r<e.length;++r)n[r]=Cn(e[r]).modulo(t).getLowBitsUnsigned();return n},subImpl:ph,tileImpl:function(e,t){const n=new Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];const r=Es(n,e.dtype);for(let t=0;t<r.values.length;++t){const n=r.indexToLoc(t),i=new Array(e.rank);for(let t=0;t<i.length;t++)i[t]=n[t]%e.shape[t];const o=e.locToIndex(i);r.values[t]=e.values[o]}return r},topKImpl:function(e,t,n,r,i){const o=t[t.length-1],[s,a]=[e.length/o,o],c=ut(n,s*r),u=ut("int32",s*r);for(let t=0;t<s;t++){const n=t*a,o=e.subarray(n,n+a);let s=new Array(o.length);o.forEach(((e,t)=>s[t]={value:e,index:t})),r<s.length&&(Eh(s,r),s=s.slice(0,r)),i&&s.sort(Ah);const l=t*r,d=c.subarray(l,l+r),h=u.subarray(l,l+r);for(let e=0;e<r;e++)d[e]=s[e].value,h[e]=s[e].index}const l=t.slice();return l[l.length-1]=r,[Es(l,n,c),Es(l,"int32",u)]},transposeImpl:eh,uniqueImpl:function(e,t,n,r){const i=at(t,n)[0],o=[1,n[0],1];for(let e=0;e<i;e++)o[0]*=n[e];o[1]=n[i];for(let e=i+1;e<n.length;e++)o[2]*=n[e];const s={},a=new Int32Array(n[i]),c=new Vn(o,r,e),u=[],l=1===o[0]&&1===o[2];for(let t=0;t<n[i];t++){let n;if(l)n=e[t].toString();else{const e=[];for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)e.push(c.get(n,t,r));n=e.join(",")}if(void 0!==s[n])a[t]=s[n];else{const e=Object.keys(s).length;s[n]=e,a[t]=e,u.push(t)}}const d=o.slice();d[1]=Object.keys(s).length;const h=new Vn(d,r);u.forEach(((e,t)=>{for(let n=0;n<o[0];n++)for(let r=0;r<o[2];r++)h.set(c.get(n,e,r),n,t,r)}));const p=n.slice();return p[i]=d[1],{outputValues:h.values,outputShape:p,indices:a}}});function _h(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:o}=r,s=et(i.shape),a=st(o,s),c=et(a);qe(s===c,(()=>`The new shape (${a}) has ${c} elements and the old shape (${i.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`)),n.incRef(i.dataId);const u=n.data.get(i.dataId);if(null!=u.complexTensorInfos){const e=u.complexTensorInfos.real,t=u.complexTensorInfos.imag;e.shape=a,t.shape=a}return{dataId:i.dataId,shape:a,dtype:i.dtype}}Zi("cpu",(()=>new Td),1);const mh={kernelName:"Reshape",backendName:"cpu",kernelFunc:_h},Ih={kernelName:"ResizeBilinear",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:o,halfPixelCenters:s,size:a}=r;md(i,"resizeBilinear");const c=_t(i.shape),[u,l]=a,[d,h,p,f]=i.shape,A=n.data.get(i.dataId).values,E=new Float32Array(et([d,u,l,f])),g=[o&&u>1?h-1:h,o&&l>1?p-1:p],_=[o&&u>1?u-1:u,o&&l>1?l-1:l];let m=0;const I=g[0]/_[0],T=g[1]/_[1];for(let e=0;e<d;e++)for(let t=0;t<u;t++){let n;n=s?I*(t+.5)-.5:I*t;const r=Math.max(0,Math.floor(n)),i=n-r,o=Math.min(h-1,Math.ceil(n)),a=e*c[0]+r*c[1],u=e*c[0]+o*c[1];for(let e=0;e<l;e++){let t;t=s?T*(e+.5)-.5:T*e;const n=Math.max(0,Math.floor(t)),r=t-n,o=Math.min(p-1,Math.ceil(t)),l=a+n*c[2],d=u+n*c[2],h=a+o*c[2],g=u+o*c[2];for(let e=0;e<f;e++){const t=A[l+e],n=A[d+e],o=t+(A[h+e]-t)*r,s=o+(n+(A[g+e]-n)*r-o)*i;E[m++]=s}}}return n.makeTensorInfo([d,u,l,f],"float32",E)}},Th={kernelName:"RealDiv",backendName:"cpu",kernelFunc:Nd("RealDiv",Rd(((e,t)=>e/t)))},Rh={kernelName:"PadV2",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:o,constantValue:s}=r;md(i,"pad");const a=o.map(((e,t)=>e[0]+i.shape[t]+e[1])),c=o.map((e=>e[0])),u=n.data.get(i.dataId).values,l=et(i.shape),d=i.shape.length,h=_t(i.shape),p=et(a),f=a.length,A=_t(a),E=ut(i.dtype,p);0!==s&&E.fill(s);for(let e=0;e<l;e++)E[yt(St(e,d,h).map(((e,t)=>e+c[t])),f,A)]=u[e];return{dataId:n.write(E,a,i.dtype),shape:a,dtype:i.dtype}}},vh=Md("Elu",(e=>e>=0?e:Math.exp(e)-1)),yh=Rd(((e,t)=>e<0?t*e:e)),Sh=Md("Relu",(e=>Math.max(0,e))),Ch={kernelName:"Relu",backendName:"cpu",kernelFunc:Sh},Oh=Md("Relu6",(e=>Math.min(Math.max(0,e),6))),bh={kernelName:"Relu6",backendName:"cpu",kernelFunc:Oh};function wh(e,t,n,r,i){if("linear"===n)return Sd({inputs:{x:t},backend:e});if("relu"===n)return Sh({inputs:{x:t},backend:e});if("elu"===n)return vh({inputs:{x:t},backend:e});if("relu6"===n)return Oh({inputs:{x:t},backend:e});if("prelu"===n)return function(e){const{inputs:t,backend:n}=e,{x:r,alpha:i}=t;md([r,i],"prelu");const o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,[a,c]=yh(r.shape,i.shape,o,s,"float32");return n.makeTensorInfo(c,"float32",a)}({inputs:{x:t,alpha:r},backend:e});if("leakyrelu"===n)return function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:o}=r;md([i],"leakyRelu");const s=et(i.shape),a=n.data.get(i.dataId).values,c=ut("float32",s);for(let e=0;e<a.length;e++)c[e]=a[e]<0?o*a[e]:a[e];return n.makeTensorInfo(i.shape,"float32",c)}({inputs:{x:t},backend:e,attrs:{alpha:i}});if("sigmoid"===n)return ih({inputs:{x:t},backend:e});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}const Nh={kernelName:"FusedConv2D",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:s,preluActivationWeights:a}=t,{strides:c,pad:u,dataFormat:l,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r;let A=function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dataFormat:c,dilations:u,dimRoundingMode:l}=r;md([i,o],"conv2d");const d=ts(c),h=Yo(i.shape,o.shape,s,u,a,l,!1,d),p=h.filterHeight,f=h.filterWidth,A=h.dilationHeight,E=h.dilationWidth,g=h.padInfo.left,_=h.padInfo.top,m="channelsLast"===h.dataFormat,I=new Vn(h.outShape,i.dtype),T=_t(i.shape),R=_t(o.shape),v=T[0],y=m?T[1]:T[2],S=m?T[2]:1,C=m?1:T[1],O=I.strides[0],b=m?I.strides[1]:I.strides[2],w=m?I.strides[2]:1,N=m?1:I.strides[1],D=n.data.get(i.dataId).values,L=n.data.get(o.dataId).values,P=I.values;for(let e=0;e<h.batchSize;++e){const t=e*v,n=e*O;for(let e=0;e<h.outHeight;++e){const r=n+e*b,i=e*h.strideHeight-_;for(let e=0;e<p;++e){const n=i+e*A;if(n<0||n>=h.inHeight)continue;const o=e*R[0],s=t+n*y;for(let e=0;e<h.outWidth;++e){const t=r+e*w,n=e*h.strideWidth-g;for(let e=0;e<f;++e){const r=n+e*E;if(r<0||r>=h.inWidth)continue;const i=s+r*S;let a=o+e*R[1];for(let e=0;e<h.inChannels;++e){const n=D[i+e*C];for(let e=0;e<h.outChannels;++e)P[t+e*N]+=n*L[a+e];a+=h.outChannels}}}}}}return n.makeTensorInfo(I.shape,I.dtype,P)}({inputs:{x:i,filter:o},backend:n,attrs:{strides:c,pad:u,dataFormat:l,dilations:d,dimRoundingMode:h}});if(s){const e=A;if("NCHW"===l&&1===s.shape.length&&1!==s.shape[0]){const e=_h({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});A=Pd({inputs:{a:A,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else A=Pd({inputs:{a:A,b:s},backend:n});n.disposeIntermediateTensorInfo(e)}if(p){const e=A;if("NCHW"===l&&"prelu"===p&&1===a.shape.length&&1!==a.shape[0]){const e=_h({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});A=wh(n,A,p,e,f),n.disposeIntermediateTensorInfo(e)}else A=wh(n,A,p,a,f);n.disposeIntermediateTensorInfo(e)}return A}};function Dh(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dilations:c,dimRoundingMode:u}=r;md([i,o],"depthwiseConv2DNative");const l=_t(i.shape),d=_t(o.shape);let h=c;null==h&&(h=[1,1]),qe(es(s,h),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${h}'`));const p=Yo(i.shape,o.shape,s,h,a,u,!0),{filterHeight:f,filterWidth:A,dilationHeight:E,dilationWidth:g,padInfo:_}=p,m=_.left,I=_.top,T=p.outChannels/p.inChannels,R=new Vn(p.outShape,i.dtype),v=n.data.get(i.dataId).values,y=n.data.get(o.dataId).values,S=R.values;for(let e=0;e<p.batchSize;++e){const t=e*l[0],n=e*R.strides[0];for(let e=0;e<p.outHeight;++e){const r=n+e*R.strides[1],i=e*p.strideHeight-I;for(let e=0;e<f;++e){const n=i+e*E;if(n<0||n>=p.inHeight)continue;const o=e*d[0],s=t+n*l[1];for(let e=0;e<p.outWidth;++e){const t=r+e*R.strides[2],n=e*p.strideWidth-m;for(let e=0;e<A;++e){const r=n+e*g;if(r<0||r>=p.inWidth)continue;const i=o+e*d[1],a=s+r*p.inChannels;let c=t,u=i;for(let e=0;e<p.inChannels;++e){const t=v[a+e];for(let e=0;e<T;++e)S[c+e]+=t*y[u+e];c+=T,u+=T}}}}}}return n.makeTensorInfo(R.shape,R.dtype,R.values)}const Lh={kernelName:"DepthwiseConv2dNative",backendName:"cpu",kernelFunc:Dh},Ph={kernelName:"FusedDepthwiseConv2D",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:s,preluActivationWeights:a}=t,{strides:c,pad:u,dataFormat:l,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r;let A=Dh({inputs:{x:i,filter:o},backend:n,attrs:{strides:c,pad:u,dataFormat:l,dilations:d,dimRoundingMode:h}});if(s){const e=A;A=Pd({inputs:{a:A,b:s},backend:n}),n.disposeIntermediateTensorInfo(e)}if(p){const e=A;A=wh(n,A,p,a,f),n.disposeIntermediateTensorInfo(e)}return A}},kh={kernelName:"SpaceToBatchND",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,paddings:s}=r;md([i],"spaceToBatchND");const a=et(o),c=[[0,0]];c.push(...s);for(let e=1+o.length;e<i.shape.length;++e)c.push([0,0]);const u=Rh.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:c,constantValue:0}}),l=xu(u.shape,o,a,!1),d=Mu(l.length,o.length,!1),h=Uu(u.shape,o,a,!1),p=_h({inputs:{x:u},backend:n,attrs:{shape:l}}),f=th({inputs:{x:p},backend:n,attrs:{perm:d}}),A=_h({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),A}},xh={kernelName:"BatchToSpaceND",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,crops:s}=r;md([i],"batchToSpaceND");const a=o.reduce(((e,t)=>e*t)),c=xu(i.shape,o,a),u=Mu(c.length,o.length),l=Uu(i.shape,o,a),d=Bu(s,o.length),h=Fu(l,s,o.length),p=_h({inputs:{x:i},backend:n,attrs:{shape:c}}),f=th({inputs:{x:p},backend:n,attrs:{perm:u}}),A=_h({inputs:{x:f},backend:n,attrs:{shape:l}}),E=ah({inputs:{x:A},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(A),E}},Mh={kernelName:"StridedSlice",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,end:s,strides:a,beginMask:c,endMask:u,ellipsisMask:l,newAxisMask:d,shrinkAxisMask:h}=r;md(i,"stridedSlice");const{finalShapeSparse:p,finalShape:f,isIdentity:A,sliceDim0:E,isSimpleSlice:g,begin:_,end:m,strides:I}=So(i.shape,o,s,a,c,u,l,d,h);let T;if(A)T=_h({inputs:{x:i},backend:n,attrs:{shape:f}});else if(E||g){qe(i.shape.length>=1,(()=>`Input must have rank at least 1, got: ${i.shape.length}`));const e=po(_,m,I),t=ah({inputs:{x:i},backend:n,attrs:{begin:_,size:e}});T=_h({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else{const e=lh(p,n.bufferSync(i),I,_);T=n.makeTensorInfo(f,e.dtype,e.values)}return T}};function Uh(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,o=at(i,t[0].shape)[0];let s=Pu(t.map((e=>e.shape)),o);if(0===et(s))return n.makeTensorInfo(s,t[0].dtype,[]);const a=t.filter((e=>et(e.shape)>0));if(1===a.length)return Sd({inputs:{x:a[0]},backend:n});if(Lu(a.map((e=>e.shape)),o),"complex64"===a[0].dtype){const e=a.map((e=>Od({inputs:{input:e},backend:n}))),t=a.map((e=>function(e){const{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,o=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,o)}({inputs:{input:e},backend:n}))),r=Uh({inputs:e,backend:n,attrs:{axis:o}}),i=Uh({inputs:t,backend:n,attrs:{axis:o}}),s=vd({inputs:{real:r,imag:i},backend:n});return e.forEach((e=>n.disposeIntermediateTensorInfo(e))),t.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),s}const c=a.map((e=>{const t=et(e.shape.slice(o));return _h({inputs:{x:e},backend:n,attrs:{shape:[-1,t]}})})),u=c.map((e=>({vals:n.data.get(e.dataId).values,shape:e.shape})));s=Pu(c.map((e=>e.shape)),1);const l=1===c[0].shape[0],d=Bd(u,s,t[0].dtype,l),h=Pu(a.map((e=>e.shape)),o),p=n.makeTensorInfo(h,t[0].dtype,d);return c.forEach((e=>n.disposeIntermediateTensorInfo(e))),p}const Bh={kernelName:"Concat",backendName:"cpu",kernelFunc:Uh};function Fh(e){const{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:o}=r,s=i.shape.length,a=i.shape.slice();let c=o;return o<0&&(qe(-(s+1)<=o,(()=>`Axis must be in the interval [${-(s+1)}, ${s}]`)),c=s+o+1),a.splice(c,0,1),_h({inputs:{x:i},backend:n,attrs:{shape:a}})}const Vh={kernelName:"Pack",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(1===t.length)return Fh({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const o=t[0].shape,s=t[0].dtype;t.forEach((e=>{Je(o,e.shape,"All tensors passed to stack must have matching shapes"),qe(s===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const a=[],c=Uh({inputs:t.map((e=>{const t=Fh({inputs:{input:e},backend:n,attrs:{dim:i}});return a.push(t),t})),backend:n,attrs:{axis:i}});return a.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}},Gh={kernelName:"Conv2DBackpropInput",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{inputShape:s,strides:a,pad:c,dataFormat:u,dimRoundingMode:l}=r;md([i,o],"conv2dBackpropInput");const d=_t(o.shape),h=_t(i.shape);let p=ts(u);const f=Yo(s,o.shape,a,1,c,l,!1,p),A=new Vn(f.inShape,"float32"),E=A.values,g=n.data.get(i.dataId).values,_=n.data.get(o.dataId).values,[m,I,T]=d,{batchSize:R,filterHeight:v,filterWidth:y,inChannels:S,inHeight:C,inWidth:O,outChannels:b,outHeight:w,outWidth:N,strideHeight:D,strideWidth:L}=f;p=f.dataFormat;const P=v-1-f.padInfo.top,k=y-1-f.padInfo.left,x="channelsLast"===p,M=A.strides[0],U=x?A.strides[1]:A.strides[2],B=x?A.strides[2]:1,F=x?1:A.strides[1],V=h[0],G=x?h[1]:h[2],Q=x?h[2]:1,j=x?1:h[1];for(let e=0;e<R;++e)for(let t=0;t<S;++t)for(let n=0;n<C;++n){const r=n-P,i=Math.max(0,Math.ceil(r/D)),o=Math.min(w,(v+r)/D);for(let s=0;s<O;++s){const a=s-k,c=Math.max(0,Math.ceil(a/L)),u=Math.min(N,(y+a)/L);let l=0;for(let n=i;n<o;++n){const i=n*D-r;for(let r=c;r<u;++r){const o=V*e+G*n+Q*r,s=m*(v-1-i)+I*(y-1-(r*L-a))+T*t;for(let e=0;e<b;++e)l+=g[o+j*e]*_[s+e]}}E[M*e+U*n+B*s+F*t]=l}}return n.makeTensorInfo(A.shape,A.dtype,A.values)}},Qh={kernelName:"CropAndResize",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:o,boxInd:s}=t,{cropSize:a,method:c,extrapolationValue:u}=r,[l,d,h,p]=i.shape,f=o.shape[0],[A,E]=a,g=Es([f,A,E,p],"float32"),_=n.data.get(o.dataId).values,m=n.data.get(s.dataId).values,I=n.data.get(i.dataId).values,T=_t(i.shape),R=_t(g.shape);for(let e=0;e<f;e++){const t=4*e,n=_[t],r=_[t+1],i=_[t+2],o=_[t+3],s=m[e];if(s>=l)continue;const a=A>1?(i-n)*(d-1)/(A-1):0,f=E>1?(o-r)*(h-1)/(E-1):0;for(let t=0;t<A;t++){const l=A>1?n*(d-1)+t*a:.5*(n+i)*(d-1);if(l<0||l>d-1)for(let n=0;n<E;n++)for(let r=0;r<p;r++){const i=r+n*R[2]+t*R[1]+e*R[0];g.values[i]=u}else if("bilinear"===c){const n=Math.floor(l),i=Math.ceil(l),a=l-n;for(let c=0;c<E;c++){const l=E>1?r*(h-1)+c*f:.5*(r+o)*(h-1);if(l<0||l>h-1){for(let n=0;n<p;n++){const r=n+c*R[2]+t*R[1]+e*R[0];g.values[r]=u}continue}const d=Math.floor(l),A=Math.ceil(l),_=l-d;for(let r=0;r<p;r++){let o=r+d*T[2]+n*T[1]+s*T[0];const u=I[o];o=r+A*T[2]+n*T[1]+s*T[0];const l=I[o];o=r+d*T[2]+i*T[1]+s*T[0];const h=I[o];o=r+A*T[2]+i*T[1]+s*T[0];const p=u+(l-u)*_,f=h+(I[o]-h)*_;o=r+c*R[2]+t*R[1]+e*R[0],g.values[o]=p+(f-p)*a}}}else for(let n=0;n<E;++n){const i=E>1?r*(h-1)+n*f:.5*(r+o)*(h-1);if(i<0||i>h-1){for(let r=0;r<p;r++){const i=r+n*R[2]+t*R[1]+e*R[0];g.values[i]=u}continue}const a=Math.round(i),c=Math.round(l);for(let r=0;r<p;r++){const i=r+a*T[2]+c*T[1]+s*T[0],o=r+n*R[2]+t*R[1]+e*R[0];g.values[o]=I[i]}}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}},jh={kernelName:"Reverse",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:o}=r;md(i,"reverse");const s=i.shape.length,a=at(o,i.shape);if(0===s)return Sd({inputs:{x:i},backend:n});const c=new Vn(i.shape,i.dtype),u=n.bufferSync(i);for(let e=0;e<c.size;e++){const t=c.indexToLoc(e),n=t.slice();a.forEach((e=>n[e]=i.shape[e]-1-n[e])),c.set(u.get(...n),...t)}return n.makeTensorInfo(c.shape,c.dtype,c.values)}},Hh={kernelName:"Unpack",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:o}=r;o<0&&(o+=i.shape.length);const s=i.shape.length,a=i.shape[o],c=new Array(s-1);let u=0;for(let e=0;e<s;e++)e!==o&&(c[u++]=i.shape[e]);const l=new Array(s).fill(0),d=i.shape.slice();d[o]=1;const h=new Array(a);for(let e=0;e<h.length;e++){l[o]=e;const t=ah({inputs:{x:i},backend:n,attrs:{begin:l,size:d}});h[e]=_h({inputs:{x:t},backend:n,attrs:{shape:c}}),n.disposeIntermediateTensorInfo(t)}return h}},Wh={kernelName:"ArgMax",backendName:"cpu",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o}=r;md(i,"argMax");let s=at(o,i.shape);const a=Hs(s,i.shape.length);let c=i;const u=[];null!=a&&(c=th({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(c),s=Ws(s.length,c.shape.length)),s=[s[0]],js("argMax",s,c.shape.length);const[l,d]=Gs(c.shape,s),h=Rt(et(l),"int32"),p=et(d),f=n.data.get(c.dataId).values;for(let e=0;e<h.length;++e){const t=e*p;let n=f[t],r=0;for(let e=0;e<p;++e){const i=f[t+e];i>n&&(n=i,r=e)}h[e]=r}return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.makeTensorInfo(l,"int32",h)}},Yh={},Kh={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function $h(e,t){if(!(e in Yh)||null!=t){const n=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=null==t?function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e):t;return n.addEventListener("webglcontextlost",(t=>{t.preventDefault(),delete Yh[e]}),!1),1===e?n.getContext("webgl",Kh)||n.getContext("experimental-webgl",Kh):n.getContext("webgl2",Kh)}(e,t);if(null===n)return console.log("Could not get context for WebGL version",e),null;Yh[e]=n}const n=Yh[e];return null==n||n.isContextLost()?(delete Yh[e],$h(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Yh[e])}var zh,qh,Jh;function Xh(e,t){return[t,e]}function Zh(e){const t=et(e);return rt(Math.ceil(t/4))}function ep(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function tp(e,t){const n=e;let r,i,o,s,a,c,u,l,d,h;return 2===wt().getNumber("WEBGL_VERSION")?(r=n.R32F,i=n.R16F,o=n.RGBA16F,s=n.RGBA32F,a=n.RED,u=4,l=1,d=n.HALF_FLOAT,h=n.FLOAT,c=n.RGBA8):(r=e.RGBA,i=e.RGBA,o=e.RGBA,s=n.RGBA,a=e.RGBA,u=4,l=4,d=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,c=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:s,textureFormatFloat:a,downloadTextureFormat:c,downloadUnpackNumChannels:u,defaultNumChannels:l,textureTypeHalfFloat:d,textureTypeFloat:h}}function np(e,t){const n=t();return wt().getBool("DEBUG")&&function(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}(e,t))}(e),n}function rp(e){return!!(wt().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function ip(e,t){return hp(e,(()=>e.getExtension(t)),'Extension "'+t+'" not supported on this browser.')}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(zh||(zh={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(qh||(qh={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Jh||(Jh={}));const op=/ERROR: [0-9]+:([0-9]+):/g;function sp(e,t){const n=op.exec(t);if(null==n)return console.log(`Couldn't parse line number in error: ${t}`),void console.log(e);const r=+n[1],i=e.split("\n"),o=i.length.toString().length+2,s=i.map(((e,t)=>it((t+1).toString(),o)+e));let a=0;for(let e=0;e<s.length;e++)a=Math.max(s[e].length,a);const c=s.slice(0,r-1),u=s.slice(r-1,r),l=s.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${it(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(l.join("\n"))}function ap(e,t){if(np(e,(()=>e.validateProgram(t))),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function cp(e,t,n,r,i,o,s){const a=e.getAttribLocation(t,n);return-1!==a&&(np(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,r))),np(e,(()=>e.vertexAttribPointer(a,i,e.FLOAT,!1,o,s))),np(e,(()=>e.enableVertexAttribArray(a))),!0)}function up(e,t,n){np(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,n))),np(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)))}function lp(e,t){np(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,t))),np(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)))}function dp(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}(e,t))}function hp(e,t,n){const r=np(e,(()=>t()));if(null==r)throw new Error(n);return r}function pp(e,t=2){return et(e.slice(0,e.length-t))}function fp(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Ap(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[pp(e),...fp(e)]),t}function Ep(e){return e%2==0}function gp(e,t){if(tt(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){const n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(Ep(n)&&Ep(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&Ep(e[0])&&Ep(t[0])}let _p,mp;function Ip(e,t){return null!=e.getExtension(t)}function Tp(e){try{if(null!=$h(e))return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Rp(e){const t=tp(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}const vp=wt();function yp(){let e,t,n,r,i,o,s,a,c,u;return 2===wt().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",i="texture",o="outputColor",s="out vec4 outputColor;",a="\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",c="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",i="texture2D",o="gl_FragColor",s="",a="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",c="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:o,defineOutput:s,defineSpecialNaN:a,defineSpecialInf:c,defineRound:u}}function Sp(e,t,n="index"){const r=_t(t);return r.map(((t,i)=>`int ${e[i]} = ${n} / ${t}; ${i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${t}`:`index -= ${e[i]} * ${t}`};`)).join("")}function Cp(e,t,n="index"){const r=_t(t);return r.map(((t,i)=>`int ${e[i]} = ${n} / outShapeStrides[${i}]; ${i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * outShapeStrides[${i}]`:`index -= ${e[i]} * outShapeStrides[${i}]`};`)).join("")}function Op(e){const t=_t(e).map((e=>e.toString()));return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;\n  }\n`}vp.registerFlag("HAS_WEBGL",(()=>vp.getNumber("WEBGL_VERSION")>0)),vp.registerFlag("WEBGL_VERSION",(()=>Tp(2)?2:Tp(1)?1:0)),vp.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),vp.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===vp.get("WEBGL_VERSION"))),vp.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),vp.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),vp.registerFlag("WEBGL_PACK",(()=>vp.getBool("HAS_WEBGL"))),vp.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>vp.getBool("WEBGL_PACK"))),vp.registerFlag("WEBGL_PACK_CLIP",(()=>vp.getBool("WEBGL_PACK"))),vp.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>vp.getBool("WEBGL_PACK"))),vp.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>vp.getBool("WEBGL_PACK"))),vp.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>vp.getBool("WEBGL_PACK"))),vp.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>vp.getBool("WEBGL_PACK"))),vp.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>vp.getBool("WEBGL_PACK"))),vp.registerFlag("WEBGL_PACK_REDUCE",(()=>vp.getBool("WEBGL_PACK"))),vp.registerFlag("WEBGL_LAZILY_UNPACK",(()=>vp.getBool("WEBGL_PACK"))),vp.registerFlag("WEBGL_CONV_IM2COL",(()=>vp.getBool("WEBGL_PACK"))),vp.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>function(e){if(null==_p){const t=$h(e);_p=t.getParameter(t.MAX_TEXTURE_SIZE)}return _p}(vp.getNumber("WEBGL_VERSION")))),vp.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>function(e){if(null==mp){const t=$h(e);mp=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,mp)}(vp.getNumber("WEBGL_VERSION")))),vp.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const e=vp.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;let t;const n=$h(e);return t=Ip(n,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Ip(n,"EXT_disjoint_timer_query")?1:0,t}(e)})),vp.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>vp.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!cr())),vp.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>function(e){if(0===e)return!1;const t=$h(e);if(1===e){if(!Ip(t,"OES_texture_float"))return!1}else if(!Ip(t,"EXT_color_buffer_float"))return!1;return Rp(t)}(vp.getNumber("WEBGL_VERSION")))),vp.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!vp.getBool("WEBGL_FORCE_F16_TEXTURES")&&vp.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),vp.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>function(e){if(0===e)return!1;const t=$h(e);if(1!==e){if(Ip(t,"EXT_color_buffer_float"))return Rp(t);const e="EXT_color_buffer_half_float";if(Ip(t,e)){const n=t.getExtension(e);return function(e,t){const n=tp(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),o}(t,n)}return!1}return!!Ip(t,"OES_texture_float")&&!!Ip(t,"WEBGL_color_buffer_float")&&Rp(t)}(vp.getNumber("WEBGL_VERSION")))),vp.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>{return 2===(e=vp.getNumber("WEBGL_VERSION"))&&null!=$h(e).fenceSync;var e})),vp.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>vp.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),vp.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(e=>{if(e<0&&-1!==e)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)})),vp.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>cr()?1:-1),(e=>{if(e<0&&-1!==e)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)})),vp.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),vp.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),vp.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),vp.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128));const bp="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:wp}=tl;function Np(e,t,n){const r=[];if(e.forEach((e=>{const t=et(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push(`uniform float ${e.name}${t>1?`[${t}]`:""};`):(r.push(`uniform sampler2D ${e.name};`),r.push(`uniform int offset${e.name};`)),n.enableShapeUniforms){const{uniformShape:t}=Vp(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:r.push(`uniform int ${e.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${e.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${e.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${e.name}Shape;`)}r.push(`uniform ivec2 ${e.name}TexShape;`)}})),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;")}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach((e=>{r.push(`uniform ${e.type} ${e.name}${e.arrayIndex?`[${e.arrayIndex}]`:""};`)}));const i=r.join("\n"),o=e.map((e=>function(e,t,n=!1,r){let i="";i+=n?Lp(e,r):Dp(e,r);const o=e.shapeInfo.logicalShape,s=t.logicalShape;return o.length<=s.length&&(i+=n?function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,a=wp(e.shapeInfo.logicalShape,t.logicalShape),c=Fp(s),u=s-o;let l;const d=["x","y","z","w","u","v"];l=0===o?"":s<2&&a.length>=1?"coords = 0;":a.map((e=>`coords.${d[e+u]} = 0;`)).join("\n");let h="";h=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${d[t+u]}`)).join(", ");let p="return outputValue;";const f=1===et(e.shapeInfo.logicalShape),A=1===et(t.logicalShape);if(1!==o||f||A){if(f&&!A)p=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(a.length){const e=o-2,t=o-1;a.indexOf(e)>-1&&a.indexOf(t)>-1?p="return vec4(outputValue.x);":a.indexOf(e)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(t)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${i}() {\n      ${c} coords = getOutputCoords();\n      ${l}\n      vec4 outputValue = get${r}(${h});\n      ${p}\n    }\n  `}(e,t):function(e,t){const n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",o=t.texShape,s=e.shapeInfo.texShape,a=e.shapeInfo.logicalShape.length,c=t.logicalShape.length;if(!e.shapeInfo.isUniform&&a===c&&null==e.shapeInfo.flatOffset&&tt(s,o))return`\n      float ${i}() {\n        return sampleTexture(${n}, resultUV);\n      }\n    `;const u=Fp(c),l=wp(e.shapeInfo.logicalShape,t.logicalShape),d=c-a;let h;const p=["x","y","z","w","u","v"];h=0===a?"":c<2&&l.length>=1?"coords = 0;":l.map((e=>`coords.${p[e+d]} = 0;`)).join("\n");let f="";return f=c<2&&a>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${p[t+d]}`)).join(", "),`\n    float ${i}() {\n      ${u} coords = getOutputCoords();\n      ${h}\n      return get${r}(${f});\n    }\n  `}(e,t)),i}(e,t,n.packedInputs,n.enableShapeUniforms))).join("\n"),s=t.texShape,a=yp(),c=function(e){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${e.texture2D}(textureSampler, uv).r;\n    }\n  `}(a);let u,l,d=function(e){return`${e.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${e.varyingFs} vec2 resultUV;\n    ${e.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${e.defineSpecialNaN}\n    ${e.defineSpecialInf}\n    ${e.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${Pp}\n    ${kp}\n    ${xp}\n  `}(a);return t.isPacked?(u=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===r[0]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${r[1]}.0);\n      }\n    `:1===r[1]?n?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${r[0]}.0);\n      }\n    `:n?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);\n    }\n  `}(0,t,n);case 2:return function(e,t,n){const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(tt(e,t))return n?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));\n      }\n    `;const i=Math.ceil(e[1]/2);return n?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(e,t,n);case 3:return function(e,t,n){if(n)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),o=i*Math.ceil(e[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      int b = index / ${o};\n      index -= b * ${o};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(e,t,n);default:return function(e,t,n){if(n)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),o=i*Math.ceil(e[e.length-2]/2);let s=o,a="",c="b, r, c";for(let t=2;t<e.length-1;t++)s*=e[e.length-t-1],a=`\n      int b${t} = index / ${s};\n      index -= b${t} * ${s};\n    `+a,c=`b${t}, `+c;return`\n    ivec${e.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${r[0]}, ${r[1]}));\n      int index = resTexRC.x * ${r[1]} + resTexRC.y;\n\n      ${a}\n\n      int b = index / ${o};\n      index -= b * ${o};\n\n      int r = 2 * (index / ${i});\n      int c = imod(index, ${i}) * 2;\n\n      return ivec${e.length}(${c});\n    }\n  `}(e,t,n)}}(t.logicalShape,s,n.enableShapeUniforms),l=function(e){return`\n    void setOutput(vec4 val) {\n      ${e.output} = val;\n    }\n  `}(a)):(u=function(e,t,n){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,n){return 1===t[0]?n?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${t[1]}.0);\n      }\n    `:1===t[1]?n?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${t[0]}.0);\n      }\n    `:n?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      return resTexRC.x * ${t[1]} + resTexRC.y;\n    }\n  `}(0,t,n);case 2:return function(e,t,n){return tt(e,t)?n?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));\n      }\n    `:1===e[1]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===e[0]?n?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:n?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      int r = index / ${e[1]};\n      int c = index - r * ${e[1]};\n      return ivec2(r, c);\n    }\n  `}(e,t,n);case 3:return function(e,t,n){if(n)return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${Cp(["r","c","d"],e)}\n    return ivec3(r, c, d);\n  }\n`;const r=Sp(["r","c","d"],e);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec3(r, c, d);\n    }\n  `}(e,t,n);case 4:return function(e,t,n){if(n)return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${Cp(["r","c","d","d2"],e)}\n      return ivec4(r, c, d, d2);\n    }\n  `;const r=Sp(["r","c","d","d2"],e);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${r}\n      return ivec4(r, c, d, d2);\n    }\n  `}(e,t,n);case 5:return function(e,t){const n=Sp(["r","c","d","d2","d3"],e);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},\n                             ${t[1]}));\n\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(e,t);case 6:return function(e,t){const n=Sp(["r","c","d","d2","d3","d4"],e);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${n}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}(t.logicalShape,s,n.enableShapeUniforms),l=function(e){return`\n    void setOutput(float val) {\n      ${e.output} = vec4(val, 0, 0, 0);\n    }\n  `}(a)),n.packedInputs&&(d+=Mp),[d,c,l,i,u,o,n.userCode].join("\n")}function Dp(e,t=!1){const n=e.shapeInfo.logicalShape;switch(n.length){case 0:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[i,o]=e.shapeInfo.texShape;if(1===i&&1===o)return`\n      float ${r}() {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const s=Up(n);if(t)return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${s});\n      return sampleTexture(${n}, uv);\n    }\n  `;const[a,c]=e.shapeInfo.texShape;return`\n    float ${r}() {\n      vec2 uv = uvFromFlat(${a}, ${c}, ${s});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`\n      float ${r}(int index) {\n        ${Bp(e)}\n      }\n    `;const i=e.shapeInfo.texShape,o=i[0],s=i[1];if(1===s&&1===o)return`\n      float ${r}(int index) {\n        return sampleTexture(${n}, halfCR);\n      }\n    `;const a=Up(n);return 1===s?t?`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:1===o?t?`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${r}(int index) {\n        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${s}.0, 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:t?`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});\n      return sampleTexture(${n}, uv);\n    }\n  `:`\n    float ${r}(int index) {\n      vec2 uv = uvFromFlat(${o}, ${s}, index + ${a});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape;if(null!=o&&tt(n,o)){if(t)return`\n      float ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `;const e=o[0];return`\n    float ${i}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${o[1]}.0, ${e}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `}const{newShape:s,keptDims:a}=ct(n),c=s;if(c.length<n.length){const n=["row","col"];return`\n      ${Dp(Gp(e,c),t)}\n      float ${i}(int row, int col) {\n        return ${i}(${Qp(n,a)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${i}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));\n        ${Bp(e)}\n      }\n    `;const u=o[0],l=o[1],d=Up(r);return 1===l?t?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `:1===u?t?`\n      float ${i}(int row, int col) {\n        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col) {\n      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${l}.0, 0.5);\n      return sampleTexture(${r}, uv);\n    }\n  `:t?`\n      float ${i}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${r}Shape[1] + col + ${d};\n        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n  float ${i}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${n[1]} + col + ${d};\n    vec2 uv = uvFromFlat(${u}, ${l}, index);\n    return sampleTexture(${r}, uv);\n  }\n`}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],s=n[2],{newShape:a,keptDims:c}=ct(n),u=a;if(u.length<n.length){const n=["row","col","depth"];return`\n        ${Dp(Gp(e,u),t)}\n        float ${i}(int row, int col, int depth) {\n          return ${i}(${Qp(n,c)});\n        }\n      `}if(e.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${o}, ${s}, 1)));\n        ${Bp(e)}\n      }\n    `;const l=e.shapeInfo.texShape,d=l[0],h=l[1],p=e.shapeInfo.flatOffset;if(h===o&&null==p)return t?`\n      float ${i}(int row, int col, int depth) {\n        int stride1 = ${r}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n        float ${i}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${s}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${h}.0, ${d}.0);\n          return sampleTexture(${r}, uv);\n        }\n      `;if(h===s&&null==p)return t?`\n      float ${i}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n    float ${i}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);\n      return sampleTexture(${r}, uv);\n    }\n  `;const f=Up(r);return t?`\n    float ${i}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${r}Shape[1] * ${r}Shape[2];\n      int stride1 = ${r}Shape[2];\n      int index = row * ${o} + col * ${s} + depth + ${f};\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);\n      return sampleTexture(${r}, uv);\n    }\n    `:`\n      float ${i}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${o} + col * ${s} + depth + ${f};\n        vec2 uv = uvFromFlat(${d}, ${h}, index);\n        return sampleTexture(${r}, uv);\n      }\n  `}(e,t);case 4:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],s=n[2]*o,a=n[1]*s,{newShape:c,keptDims:u}=ct(n);if(c.length<n.length){const n=["row","col","depth","depth2"];return`\n      ${Dp(Gp(e,c),t)}\n      float ${i}(int row, int col, int depth, int depth2) {\n        return ${i}(${Qp(n,u)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${i}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${a}, ${s}, ${o}, 1)));\n        ${Bp(e)}\n      }\n    `;const l=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1],f=`int stride2 = ${r}Shape[3];`,A=`int stride1 = ${r}Shape[2] * stride2;`,E=`int stride0 = ${r}Shape[1] * stride1;`;if(p===a&&null==l)return t?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        ${f}\n        ${A}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${s}, ${o}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${h}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(p===o&&null==l)return t?`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${r}TexShape[1], ${r}TexShape[0]);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${i}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${n[1]*n[2]}, ${n[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${h}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;const g=Up(r);return t?`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${f}\n      ${A}\n      ${E}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${g});\n      return sampleTexture(${r}, uv);\n    }\n  `:`\n    float ${i}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${s} +\n          depth * ${o} + depth2;\n      vec2 uv = uvFromFlat(${h}, ${p}, index + ${g});\n      return sampleTexture(${r}, uv);\n    }\n  `}(e,t);case 5:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],o=t[3]*i,s=t[2]*o,a=t[1]*s,{newShape:c,keptDims:u}=ct(t);if(c.length<t.length){const t=["row","col","depth","depth2","depth3"];return`\n      ${Dp(Gp(e,c))}\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        return ${r}(${Qp(t,u)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${a}, ${s}, ${o}, ${i})) +\n          depth3;\n        ${Bp(e)}\n      }\n    `;const l=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1];return p===a&&null==l?`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${s}, ${o}, ${i}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:p===i&&null==l?`\n      float ${r}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]},\n               ${t[2]*t[3]}, ${t[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${r}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${a} + col * ${s} + depth * ${o} +\n          depth2 * ${i} + depth3 + ${Up(n)};\n      vec2 uv = uvFromFlat(${h}, ${p}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(e);case 6:return function(e){const t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:o}=ct(t);if(i.length<t.length){const t=["row","col","depth","depth2","depth3","depth4"];return`\n      ${Dp(Gp(e,i))}\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${r}(${Qp(t,o)});\n      }\n    `}const s=t[5],a=t[4]*s,c=t[3]*a,u=t[2]*c,l=t[1]*u;if(e.shapeInfo.isUniform)return`\n      float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${l}, ${u}, ${c}, ${a})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${s}, 1)));\n        ${Bp(e)}\n      }\n    `;const d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],f=h[1];return f===l&&null==d?`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${u}, ${c}, ${a}, ${s})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:f===s&&null==d?`\n      float ${r}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]*t[4]},\n               ${t[2]*t[3]*t[4]},\n               ${t[3]*t[4]},\n               ${t[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${p}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${r}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${l} + col * ${u} + depth * ${c} +\n          depth2 * ${a} + depth3 * ${s} + depth4 + ${Up(n)};\n      vec2 uv = uvFromFlat(${p}, ${f}, index);\n      return sampleTexture(${n}, uv);\n    }\n  `}(e);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function Lp(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){const t=e.name;return`\n    vec4 ${"get"+t.charAt(0).toUpperCase()+t.slice(1)}() {\n      return ${yp().texture2D}(${t}, halfCR);\n    }\n  `}(e);case 1:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,o=yp();if(t)return`\n    vec4 ${r}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${o.texture2D}(${n}, uv);\n    }\n  `;const s=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`\n    vec4 ${r}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${s[0]}, ${s[1]}, index);\n      return ${o.texture2D}(${n}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,s=o[0],a=o[1],c=yp();if(null!=o&&tt(n,o))return t?`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);\n\n        return ${c.texture2D}(${r}, uv);\n      }\n    `:`\n      vec4 ${i}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${s}.0);\n\n        return ${c.texture2D}(${r}, uv);\n      }\n    `;if(t)return`\n    vec4 ${i}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${c.texture2D}(${r}, uv);\n    }\n  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return`\n    vec4 ${i}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${Math.ceil(n[1]/2)}, ${u[0]}, ${u[1]}, row, col);\n      return ${c.texture2D}(${r}, uv);\n    }\n  `}(e,t);case 3:return function(e,t){const n=e.shapeInfo.logicalShape,r=e.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,s=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===n[0]){const r=[1,2],o=["b","row","col"];return`\n        ${Lp(Gp(e,n.slice(1)),t)}\n        vec4 ${i}(int b, int row, int col) {\n          return ${i}(${Qp(o,r)});\n        }\n      `}const a=yp();if(t)return`\n    vec4 ${i}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${a.texture2D}(${r}, uv);\n    }\n  `;const c=s[0],u=s[1],l=Math.ceil(n[2]/2);return`\n    vec4 ${i}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${c}, ${u}, ${l*Math.ceil(n[1]/2)}, ${l}, b, row, col);\n      return ${a.texture2D}(${r}, uv);\n    }\n  `}(e,t);default:return function(e,t){const n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=yp();if(t)return`\n    vec4 ${r}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${n}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);\n    }\n  `;const o=e.shapeInfo.logicalShape,s=o.length,a=e.shapeInfo.texShape,c=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=c[0],l=c[1],d=Math.ceil(o[s-1]/2);let h=d*Math.ceil(o[s-2]/2),p="int b, int row, int col",f=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let e=2;e<s-1;e++)p=`int b${e}, `+p,h*=o[s-e-1],f=`b${e} * ${h} + `+f;return`\n    vec4 ${r}(${p}) {\n      int index = ${f};\n      int texR = index / ${l};\n      int texC = index - texR * ${l};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${l}, ${u});\n      return ${i.texture2D}(${n}, uv);\n    }\n  `}(e,t)}}const Pp="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",kp="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",xp="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Mp="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Up(e){return`offset${e}`}function Bp(e){const t=e.name,n=et(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`\n    for (int i = 0; i < ${n}; i++) {\n      if (i == index) {\n        return ${t}[i];\n      }\n    }\n  `}function Fp(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function Vp(e,t,n){const{newShape:r,keptDims:i}=ct(t),o=t.length,s=e&&3===o&&1===t[0],a=s?t.slice(1):r,c=!e&&o>1&&!tt(t,n)&&r.length<o||s;return{useSqueezeShape:c,uniformShape:c?a:t,keptDims:i}}function Gp(e,t){const n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Qp(e,t){return t.map((t=>e[t])).join(", ")}function jp(e,t,n){const r={},i={},o={},s=[];let a,c,u,l=null,d=null;d=e.getUniformLocation(n,"NAN",!1),1===wt().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(n,"INFINITY",!1));const h=!1;for(let s=0;s<t.variableNames.length;s++){const a=t.variableNames[s];r[a]=e.getUniformLocation(n,a,h),r[`offset${a}`]=e.getUniformLocation(n,`offset${a}`,h),t.enableShapeUniforms&&(i[`${a}Shape`]=e.getUniformLocation(n,`${a}Shape`,h),o[`${a}TexShape`]=e.getUniformLocation(n,`${a}TexShape`,h))}return t.enableShapeUniforms&&(a=e.getUniformLocation(n,"outShape",h),u=e.getUniformLocation(n,"outShapeStrides",h),c=e.getUniformLocation(n,"outTexShape",h)),t.customUniforms&&t.customUniforms.forEach(((t,r)=>{s[r]=e.getUniformLocation(n,t.name,h)})),{uniformLocations:r,customUniformLocations:s,infLoc:l,nanLoc:d,inShapesLocations:i,inTexShapesLocations:o,outShapeLocation:a,outShapeStridesLocation:u,outTexShapeLocation:c}}function Hp(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach(((e,n)=>{const r=e.logicalShape,i=t[n],o=i.shape;if(!tt(r,o))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${o} must match`);if(e.isUniform&&i.isUniform)return;const s=e.texShape,a=i.isUniform?null:i.texData.texShape;if(!tt(s,a))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${s} and ${a} must match`)}))}function Wp(e){return wt().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class Yp{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=zh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=yp();this.outputShape=e,this.enableShapeUniforms=Wp(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?Cp(["r","c","d"],e):Sp(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${t.output} = result;\n      }\n    `}}class Kp{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=zh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=yp();this.outputShape=e,this.enableShapeUniforms=Wp(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?Cp(["r","c","d"],e):Sp(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${t.output} = result;\n      }\n    `}}class $p{constructor(e){this.variableNames=["A"],this.outTexUsage=qh.DOWNLOAD;const t=yp();this.outputShape=e,this.userCode=`\n      ${bp}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${t.output} = encode_float(x);\n      }\n    `}}class zp{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=qh.DOWNLOAD;const t=yp();this.outputShape=e,this.userCode=`\n      ${bp}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${t.output} = encode_float(x);\n      }\n    `}}class qp{constructor(e,t=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=yp();this.outputShape=e,this.enableShapeUniforms=Wp(this.outputShape.length);let r="result";t&&(r="floor(result * 255. + 0.5)"),this.userCode=`\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":Op(e)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / texShape[1];\n        int c = imod(flatIndex, texShape[1]);\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n        vec4 values = ${n.texture2D}(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ${n.output} = vec4(${r}, 0., 0., 0.);\n      }\n    `}}class Jp{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=yp();this.outputShape=e,this.enableShapeUniforms=Wp(this.outputShape.length);let r="",i="result";t&&(i="floor(result * 255. + 0.5)");for(let t=0;t<=1;t++)for(let i=0;i<=1;i++){const o=2*t+i;r+=`\n          localCoords = coords;\n          if(localCoords[2] + ${i} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {\n          localCoords[2] += ${i};\n          if (localCoords[1] + ${t} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {\n            localCoords[1] += ${t};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${n.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${o}] = values[0];\n            } else if (offset == 1) {\n              result[${o}] = values[1];\n            } else if (offset == 2) {\n              result[${o}] = values[2];\n            } else {\n              result[${o}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":Op(e)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${r}\n\n          ${n.output} = ${i};\n        }\n    `}}function Xp(e,t,n,r,i,o){!function(e,t){const n=wt().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0)throw new Error(`Requested texture size [${e}x${t}] is invalid.`);if(e>n||t>n)throw new Error(`Requested texture size [${e}x${t}] greater than WebGL maximum on this browser / GPU [${n}x${n}].`)}(t,n);const s=function(e){return hp(e,(()=>e.createTexture()),"Unable to create WebGLTexture.")}(e),a=e.TEXTURE_2D;return np(e,(()=>e.bindTexture(a,s))),np(e,(()=>e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE))),np(e,(()=>e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE))),np(e,(()=>e.texParameteri(a,e.TEXTURE_MIN_FILTER,e.NEAREST))),np(e,(()=>e.texParameteri(a,e.TEXTURE_MAG_FILTER,e.NEAREST))),1===wt().getNumber("WEBGL_VERSION")?np(e,(()=>e.texImage2D(a,0,r,t,n,0,i,o,null))):np(e,(()=>e.texStorage2D(a,1,r,t,n))),np(e,(()=>e.bindTexture(e.TEXTURE_2D,null))),{texture:s,texShape:[n,t]}}function Zp(e){return e.internalFormatFloat}function ef(e){return e.internalFormatHalfFloat}function tf(e){return e.downloadTextureFormat}function nf(e){return e.internalFormatPackedFloat}function rf(e){return e.internalFormatPackedHalfFloat}class of{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const t=wt().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,function(e,t){Yh[e]=t}(t,e)):this.gl=$h(t);let n="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===wt().getNumber("WEBGL_VERSION")){const e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=ip(this.gl,e),Ip(this.gl,t))this.textureHalfFloatExtension=ip(this.gl,t);else if(wt().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),Ip(this.gl,r))this.colorBufferHalfFloatExtension=ip(this.gl,r);else if(wt().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",Ip(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!Ip(this.gl,r))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(r)}this.vertexBuffer=function(e){return function(e,t){const n=hp(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return np(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),np(e,(()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW))),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}(this.gl),this.indexBuffer=function(e){return function(e,t){const n=hp(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return np(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n))),np(e,(()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW))),n}(e,new Uint16Array([0,1,2,2,1,3]))}(this.gl),this.framebuffer=function(e){return hp(e,(()=>e.createFramebuffer()),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=tp(this.gl,this.textureHalfFloatExtension)}get debug(){return wt().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;np(e,(()=>e.finish())),np(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,null))),np(e,(()=>e.deleteFramebuffer(this.framebuffer))),np(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,null))),np(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null))),np(e,(()=>e.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[i,o]=Xh(t,n);return Xp(e,i,o,Zp(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[i,o]=Xh(t,n);return Xp(e,i,o,ef(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[i,o]=Xh(t,n);return Xp(e,i,o,tf(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),function(e,t,n){np(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),n.data instanceof Uint8Array?2===wt().getNumber("WEBGL_VERSION")?np(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data))):np(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data))):2===wt().getNumber("WEBGL_VERSION")?np(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n))):np(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n))),np(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,i,o){let s,a,c;np(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),i instanceof Uint8Array?(s=new Uint8Array(n*r*4),a=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(n*r*4),a=e.FLOAT,c=o.internalFormatPackedFloat),s.set(i),2===wt().getNumber("WEBGL_VERSION")?np(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,a,s))):np(e,(()=>e.texImage2D(e.TEXTURE_2D,0,c,n,r,0,e.RGBA,a,s))),np(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[i,o]=ep(t,n);return Xp(e,i,o,rf(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,n,r){const[i,o]=ep(t,n);return Xp(e,i,o,nf(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(lp(this.gl,this.framebuffer),this.outputTexture=null),np(this.gl,(()=>this.gl.deleteTexture(e)))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>function(e,t,n,r){const[i,o]=Xh(t,n),s=new Uint8Array(t*n*4);return np(e,(()=>e.readPixels(0,0,i,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,s))),new Float32Array(s.buffer)}(this.gl,t,n,this.textureConfig)))}downloadPackedMatrixFromBuffer(e,t,n,r,i,o){return function(e,t,n,r,i,o,s,a){const c=e,u=new Float32Array(function(e,t){const[n,r]=ep(e,t);return n*r*4}(o,s));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,u),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),u}(this.gl,e,0,0,0,i,o,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return function(e,t,n){const r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);const r=function(e,t,n,r){const i=e.createBuffer();np(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i)));const o=16*t*n;return np(e,(()=>e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ))),np(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0))),np(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null))),i}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(wt().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{const e=r.clientWaitSync(i,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=i}else wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,(()=>function(e,t,n){const r=new Float32Array(t*n*4);return np(e,(()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r))),r}(this.gl,t,n)))}createProgram(e){this.throwIfDisposed();const t=this.gl;null==this.vertexShader&&(this.vertexShader=function(e){const t=yp();return function(e,t){const n=hp(e,(()=>e.createShader(e.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(np(e,(()=>e.shaderSource(n,t))),np(e,(()=>e.compileShader(n))),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,`${t.version}\n    precision highp float;\n    ${t.attribute} vec3 clipSpacePos;\n    ${t.attribute} vec2 uv;\n    ${t.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}(t));const n=function(e){return hp(e,(()=>e.createProgram()),"Unable to create WebGLProgram.")}(t);return np(t,(()=>t.attachShader(n,this.vertexShader))),np(t,(()=>t.attachShader(n,e))),function(e,t){if(np(e,(()=>e.linkProgram(t))),!wt().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,n),this.debug&&ap(t,n),this.vertexAttrsAreBound||(this.setProgram(n),this.vertexAttrsAreBound=function(e,t,n){return np(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),cp(e,t,"clipSpacePos",n,3,20,0)&&cp(e,t,"uv",n,2,20,12)}(t,this.program,this.vertexBuffer)),n}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&np(this.gl,(()=>this.gl.deleteProgram(e)))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&ap(this.gl,this.program),np(this.gl,(()=>this.gl.useProgram(e)))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?function(e,t,n){return hp(e,(()=>e.getUniformLocation(t,n)),'uniform "'+n+'" not present in program.')}(this.gl,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),np(this.gl,(()=>this.gl.getAttribLocation(e,t)))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),function(e,t,n,r){np(e,(()=>function(e,t,n){!function(e,t){const n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error(`textureUnit must be in [gl.TEXTURE0, gl.TEXTURE${n}].`)}(e,n),np(e,(()=>e.activeTexture(e.TEXTURE0+n))),np(e,(()=>e.bindTexture(e.TEXTURE_2D,t)))}(e,t,r))),np(e,(()=>e.uniform1i(n,r)))}(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();const[r,i]=ep(t,n);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&ap(this.gl,this.program),dp(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),np(e,(()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),np(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=ip(this.gl,2===wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await ot((()=>this.disposed||this.isQueryAvailable(e,wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(e,wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){const t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{const t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){const t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(n.GPU_DISJOINT_EXT)),r&&!this.disjoint}{const t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),n&&!this.disjoint}}pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){const e=function(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||ot((()=>(this.pollItems(),0===this.itemsToPoll.length)))}bindTextureToFrameBuffer(e){this.throwIfDisposed(),up(this.gl,e,this.framebuffer),this.debug&&dp(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(up(this.gl,this.outputTexture,this.framebuffer),this.debug&&dp(this.gl)):lp(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();const r=this.gl;up(r,e,this.framebuffer),this.debug&&dp(r),this.outputTexture=e,np(r,(()=>r.viewport(0,0,t,n))),np(r,(()=>r.scissor(0,0,t,n)))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),np(this.gl,(()=>this.gl.scissor(e,t,n,r)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}const{addImpl:sf,bincountImpl:af,bincountReduceImpl:cf,ceilImpl:uf,concatImpl:lf,equalImpl:df,expImpl:hf,expm1Impl:pf,floorImpl:ff,gatherNdImpl:Af,gatherV2Impl:Ef,greaterImpl:gf,greaterEqualImpl:_f,lessImpl:mf,lessEqualImpl:If,linSpaceImpl:Tf,logImpl:Rf,maxImpl:vf,maximumImpl:yf,minimumImpl:Sf,multiplyImpl:Cf,negImpl:Of,notEqualImpl:bf,prodImpl:wf,rangeImpl:Nf,rsqrtImpl:Df,scatterImpl:Lf,sigmoidImpl:Pf,simpleAbsImpl:kf,sliceImpl:xf,sparseFillEmptyRowsImpl:Mf,sparseReshapeImpl:Uf,sparseSegmentReductionImpl:Bf,sqrtImpl:Ff,stridedSliceImpl:Vf,stringNGramsImpl:Gf,stringSplitImpl:Qf,stringToHashBucketFastImpl:jf,subImpl:Hf,tileImpl:Wf,topKImpl:Yf,transposeImpl:Kf,uniqueImpl:$f}=gh;function zf(e,t){return["x","y","z","w","u","v"].slice(0,t).map((t=>`${e}.${t}`))}function qf(e,t){return 1===t?[e]:zf(e,t)}class Jf{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Wp(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=qf("rc",this.rank),t=Fp(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),i=this.getOutput(e);this.userCode=`\n        void main() {\n          ${t} rc = getOutputCoords();\n\n          if(${n}) {\n            setOutput(vec4(0));\n          } else {\n            ${r}\n\n            setOutput(vec4(${i}));\n          }\n        }\n      `}}getSourceCoordsArr(e){const t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let i=`${0===n?"r":"rp1"}, ${0===r?"c":"cp1"}`;for(let t=2;t<this.rank;t++)i=`${e[e.length-1-t]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";const t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`\n      int r = ${t[0]};\n      int c = ${t[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${n};\n      bool rEdge = rp1 >= ${r};\n    `}getOutput(e){const t=this.getSourceCoordsArr(e);return 1===this.rank?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),\n            cEdge ? 0. : getA(${t[1]}),\n            rEdge ? 0. : getA(${t[2]}),\n            rEdge || cEdge ? 0. : getA(${t[3]})`}}class Xf{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Wp(this.outputShape.length);let n="";for(let e=0;e<4;e++){let t="thisRC = rc;";e%2==1&&(t+="thisRC.z += 1;"),e>1&&(t+="thisRC.y += 1;"),n+=`\n        ${t}\n        ${e>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${e}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${e>0?"}":""}\n      `}var r,i;this.userCode=`\n      ${r=t,i=this.enableShapeUniforms,`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${i?function(e,t,n="index"){const r=e.map(((e,t)=>t)),i=function(e,t){const n=e.length,r=e.map((e=>`${t}[${e}]`)),i=new Array(n-1);i[n-2]=r[n-1];for(let e=n-3;e>=0;--e)i[e]=`(${i[e+1]} * ${r[e+1]})`;return i}(r,t);return i.map(((t,r)=>`int ${e[r]} = ${n} / ${i[r]}; ${r===i.length-1?`int ${e[r+1]} = ${n} - ${e[r]} * ${i[r]}`:`index -= ${e[r]} * ${i[r]}`};`)).join("")}(["r","c","d"],"inputShape"):Sp(["r","c","d"],r)}\n      return ivec3(r, c, d);\n    }\n  `}\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":Op(e)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};\n\n        ${n}\n\n        setOutput(result);\n      }\n    `}}class Zf{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,t,n){const r=tA(t,n),i=nA(e,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);const o=eA(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();const e=this.freeTextures[i].shift();return this.usedTextures[i].push(e),e}let s;return r===Jh.PACKED_2X2_FLOAT32?s=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Jh.PACKED_2X2_FLOAT16?s=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Jh.UNPACKED_FLOAT32?s=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Jh.UNPACKED_FLOAT16?s=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Jh.PACKED_4X1_UNSIGNED_BYTE&&(s=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(s),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),s}releaseTexture(e,t,n,r){if(null==this.freeTextures)return;const i=tA(n,r),o=nA(t,i,r);o in this.freeTextures||(this.freeTextures[o]=[]);const s=eA(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),a=wt().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==a&&this._numBytesAllocated>a?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=s):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;const c=this.usedTextures[o],u=c.indexOf(e);if(u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(u,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const e in this.freeTextures)this.freeTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));for(const e in this.usedTextures)this.usedTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function eA(e,t,n,r,i){const o=function(e,t){switch(e){case Jh.PACKED_2X2_FLOAT32:return nf(t);case Jh.PACKED_2X2_FLOAT16:return rf(t);case Jh.UNPACKED_FLOAT32:return Zp(t);case Jh.UNPACKED_FLOAT16:return ef(t);case Jh.PACKED_4X1_UNSIGNED_BYTE:return tf(t);default:throw new Error(`Unknown physical texture type ${e}`)}}(t,r);let s;if(i){const[t,n]=ep(e[0],e[1]);s=t*n}else{const[t,n]=Xh(e[0],e[1]);s=t*n}const a=function(e,t){const n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}(n,o);return s*a}function tA(e,t){if(e===qh.UPLOAD)return Jh.PACKED_2X2_FLOAT32;if(e===qh.RENDER||null==e)return function(e){return wt().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Jh.PACKED_2X2_FLOAT32:Jh.UNPACKED_FLOAT32:e?Jh.PACKED_2X2_FLOAT16:Jh.UNPACKED_FLOAT16}(t);if(e===qh.DOWNLOAD||e===qh.PIXELS)return Jh.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function nA(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}class rA{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Wp(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${t}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const iA="return abs(x);",oA="return x;";class sA{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Wp(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${t}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class aA{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Wp(this.outputShape.length);const t=e.length,n=qf("rc",t),r=Fp(t),i=function(e,t){if(1===e)return"rc";let n="";for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),o=n.slice(-2),s=t<=1?"rc":`vec2(${o.join(",")})`;this.userCode=`\n      void main() {\n        ${r} rc = getOutputCoords();\n        vec4 packedInput = getA(${i});\n\n        setOutput(getChannel(packedInput, ${s}));\n      }\n    `}}const cA=Mc,uA={},lA=wt().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class dA extends We{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!wt().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof of)t=e;else{const n=$h(wt().getNumber("WEBGL_VERSION"),e);t=new of(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const e=$h(wt().getNumber("WEBGL_VERSION"));t=new of(e),this.binaryCache=((n=wt().getNumber("WEBGL_VERSION"))in uA||(uA[n]={}),uA[n]),this.gpgpuCreatedLocally=!0}var n;this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Zf(this.gpgpu),this.numMBBeforeWarning=null==wt().global.screen?1024:wt().global.screen.height*wt().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new He(this,qi())}nextDataId(){return dA.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,t,n){if((wt().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||wt().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:qh.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){this.texData.get(e).refCount++}decRef(e){this.texData.has(e)&&this.texData.get(e).refCount--}move(e,t,n,r,i){if(wt().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:qh.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:n,dtype:r,complexTensorInfos:i,slice:o,shape:s,isPacked:a}=t;if(null!=o){let t;t=a?new sA(s,oA):new rA(s,oA);const n=this.runWebGLProgram(t,[{dataId:e,shape:s,dtype:r}],r),i=this.readSync(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;const c=null!=this.activeTimers;let u,l;return c&&(u=wn()),l="complex64"===r?Vu(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.getValuesFromTexture(e),c&&(this.downloadWaitMs+=wn()-u),this.convertAndCacheOnCPU(e,l)}async read(e){if(this.pendingRead.has(e)){const t=this.pendingRead.get(e);return new Promise((e=>t.push(e)))}const t=this.texData.get(e),{values:n,shape:r,slice:i,dtype:o,complexTensorInfos:s,isPacked:a}=t;if(null!=i){let t;t=a?new sA(r,oA):new rA(r,oA);const n=this.runWebGLProgram(t,[{dataId:e,shape:r,dtype:o}],o),i=this.read(n.dataId);return this.disposeIntermediateTensorInfo(n),i}if(null!=n)return this.convertAndCacheOnCPU(e);if(wt().getBool("DEBUG")&&!wt().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===wt().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c,u,l=null;if("complex64"!==o&&wt().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const t=this.texData.get(c.dataId);l=this.gpgpu.createBufferFromTexture(t.texture.texture,...Zh(r))}if(this.pendingRead.set(e,[]),"complex64"!==o&&await this.gpgpu.createAndWaitForFence(),"complex64"===o){const e=await Promise.all([this.read(s.real.dataId),this.read(s.imag.dataId)]);u=Vu(e[0],e[1])}else if(null==l)u=this.getValuesFromTexture(e);else{const e=et(r);u=this.gpgpu.downloadFloat32MatrixFromBuffer(l,e)}if(null!=c&&this.disposeIntermediateTensorInfo(c),null!=l){const e=this.gpgpu.gl;np(e,(()=>e.deleteBuffer(l)))}const d=this.convertAndCacheOnCPU(e,u),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach((e=>e(d))),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&qi().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,t={}){const n=this.texData.get(e),{values:r,shape:i,slice:o,dtype:s,isPacked:a,texture:c}=n;if("complex64"===s)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=o){let n;n=a?new sA(i,oA):new rA(i,oA);const r=this.runWebGLProgram(n,[{dataId:e,shape:i,dtype:s}],s),o=this.readToGPU(r,t);return this.disposeIntermediateTensorInfo(r),o}if(null==c)throw null!=r?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,t.customTexShape),l=qi().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:l},d.texture)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const n=t.map((e=>Dn(e)));return Es(e.shape,e.dtype,n)}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return Es(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){const n=e[t];if(!rp(n)){if(wt().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${n} cannot be represented on this device.`)}}}getValuesFromTexture(e){const{shape:t,dtype:n,isPacked:r}=this.texData.get(e),i=et(t);if(wt().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const n=this.decode(e),r=this.texData.get(n.dataId),o=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...Zh(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(n),o}const o=wt().getBool("WEBGL_PACK")&&!0===r,s=o?Ap(t):t,a=o?new zp(s):new $p(s),c=this.runWebGLProgram(a,[{shape:s,dtype:n,dataId:e}],"float32"),u=this.texData.get(c.dataId),l=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),l}timerAvailable(){return wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,n=[];let r=!1;null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();const i=Ze(this.activeTimers.map((e=>e.query))).filter((e=>null!=e)),o=Ze(this.activeTimers.map((e=>e.name))).filter((e=>null!=e));this.activeTimers=t,r&&(this.programTimersStack=null);const s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const e=await Promise.all(i);s.kernelMs=function(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}(e),s.getExtraProfileInfo=()=>e.map(((e,t)=>({name:o[t],ms:e}))).map((e=>`${e.name}: ${e.ms}`)).join(", ")}else s.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,s})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:wn(),endMs:null}}endTimer(e){return wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=wn(),e)}async getQueryTime(e){if(wt().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:n}=this.texData.get(e);return null!=n&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:n,texShape:r,usage:i,isPacked:o,slice:s}=this.texData.get(e),a=s&&s.origDataId||e,c=this.dataRefCount.get(a);c>1?this.dataRefCount.set(a,c-1):(this.dataRefCount.delete(a),null!=t&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,i,o)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=lA){return wt().getBool("WEBGL_CPU_FORWARD")&&e.every((e=>null==this.texData.get(e.dataId).texture&&et(e.shape)<t))}getGPGPUContext(){return this.gpgpu}where(e){kt("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return cA(e.shape,t)}packedUnaryOp(e,t,n){const r=new sA(e.shape,t),i=this.compileAndRun(r,[e],n);return qi().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const t=kf(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(wt().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,iA,e.dtype);const t=new rA(e.shape,iA),n=this.compileAndRun(t,[e]);return qi().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if("string"===t&&null!=n&&n.length>0&&ft(n[0])){const i=n.map((e=>Nn(e)));r=this.write(i,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return qi().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){const t=new aA(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new Jf(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const n=[pp(e.shape),...fp(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},i=[pp(t),...fp(t)],o=new Xf(i,n),s=[n],a=this.runWebGLProgram(o,[r],e.dtype,s,!0);return{dataId:a.dataId,shape:t,dtype:a.dtype}}decode(e,t){const n=this.texData.get(e),{isPacked:r,shape:i,dtype:o}=n;null!=t&&qe(et(i)<=t[0]*t[1]*4,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."));const s=Ap(i);let a;a=r?new Kp(s):new Yp(s);const c=[null!=t?t:Zh(s)];return{dtype:o,shape:i,dataId:this.runWebGLProgram(a,[{shape:s,dtype:o,dataId:e}],o,c,!0,t).dataId}}runWebGLProgram(e,t,n,r,i=!1,o){const s=this.makeTensorInfo(e.outputShape,n),a=this.texData.get(s.dataId);if(e.packedOutput&&(a.isPacked=!0),e.outPackingScheme===zh.DENSE){const t=null!=o?o:Zh(e.outputShape);a.texShape=t.map((e=>2*e))}if(null!=e.outTexUsage&&(a.usage=e.outTexUsage),0===et(s.shape))return a.values=ut(s.dtype,0),s;const c=[],u=t.map((t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let n=this.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&et(t.shape)<=wt().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!=!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),c.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!gp(n.shape,t.shape)){const e=t,r=t.shape;t.shape=n.shape,t=this.packedReshape(t,r),c.push(t),n=this.texData.get(t.dataId),e.shape=r}return{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);const l={shape:s.shape,texData:a,isUniform:!1},d=function(e,t,n){let r="";t.concat(n).forEach((t=>{const i=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){const o=t.texData.texShape,{useSqueezeShape:s,uniformShape:a,keptDims:c}=Vp(e.packedInputs,t.shape,o);let u="",l="",d="";if(1===a.length&&e.packedInputs){const e=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];u=`${e[0]>1}_${e[1]>1}`}else if(2!==a.length||e.packedInputs){if(a.length>2&&!e.packedInputs){const e=_t(a);d=`${e[0]===o[1]}_${e[e.length-1]===o[1]}`}}else l=`${a[0]>1}_${a[1]>1}`;const h=t.shape.length,p=2===a.length&&tt(t.shape,o),f=1===et(t.shape),A=io(t.shape,n.shape),E=!e.packedInputs&&h===n.shape.length&&tt(o,n.texData.texShape),g=e.packedInputs||a.length>2?"":`${o[0]>1}_${o[1]>1}`;r+=`${h}_${E}_${s?c:""}_${a.length}_${f}_${A}_${p}_${u}_${l}_${d}_${g}_${i}`}else{const e=t.isUniform?"uniform":t.texData.texShape;r+=`${t.shape}_${e}_${i}`}}));const i=e.userCode;let o=e.constructor.name;return o+="_"+r+"_"+i+`${wt().getNumber("WEBGL_VERSION")}`,o}(e,u,l),h=this.getAndSaveBinary(d,(()=>function(e,t,n,r){const i=n.map(((e,n)=>{const r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),o=i.map((e=>e.shapeInfo)),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=Np(i,s,t),c=function(e,t){const n=hp(e,(()=>e.createShader(e.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(np(e,(()=>e.shaderSource(n,t))),np(e,(()=>e.compileShader(n))),wt().get("ENGINE_COMPILE_ONLY"))return n;if(!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw sp(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}(e.gl,a),u=e.createProgram(c);return wt().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:c,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:s,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:t,fragmentShader:c,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:s},jp(e,t,u))}(this.gpgpu,e,u,l))),p=null!=this.activeTimers;let f;p&&(f=this.startTimer()),wt().get("ENGINE_COMPILE_ONLY")||function(e,t,n,r,i){t.program.enableShapeUniforms||(Hp(t.inShapeInfos,n),Hp([t.outShapeInfo],[r]));const o=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(o.texture,s[0],s[1]):e.setOutputMatrixTexture(o.texture,s[0],s[1]),e.setProgram(t.webGLProgram),1===wt().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach(((n,r)=>{const i=t.program.variableNames[r],o=t.uniformLocations[i],s=t.uniformLocations[`offset${i}`],a=t.inShapesLocations[`${i}Shape`],c=t.inTexShapesLocations[`${i}TexShape`];if(a){const{uniformShape:r}=Vp(t.program.packedInputs,n.shape,n.texData.texShape);switch(r.length){case 1:e.gl.uniform1iv(a,new Int32Array(r));break;case 2:e.gl.uniform2iv(a,new Int32Array(r));break;case 3:e.gl.uniform3iv(a,new Int32Array(r));break;case 4:e.gl.uniform4iv(a,new Int32Array(r))}}if(c&&e.gl.uniform2i(c,n.texData.texShape[0],n.texData.texShape[1]),null!=o)if(n.isUniform)if(et(n.shape)<2)e.gl.uniform1f(o,n.uniformValues[0]);else{let t=n.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(o,t)}else null!=n.texData.slice&&null!=s&&e.gl.uniform1i(s,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture.texture,o,r)}));const a=t.outShapeLocation;if(a)switch(r.shape.length){case 1:e.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(a,new Int32Array(r.shape))}if(t.outShapeStridesLocation){const n=_t(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n))}}t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i&&t.program.customUniforms.forEach(((n,r)=>{const o=t.customUniformLocations[r],s=i[r];if("float"===n.type)e.gl.uniform1fv(o,s);else if("vec2"===n.type)e.gl.uniform2fv(o,s);else if("vec3"===n.type)e.gl.uniform3fv(o,s);else if("vec4"===n.type)e.gl.uniform4fv(o,s);else if("int"===n.type)e.gl.uniform1iv(o,s);else if("ivec2"===n.type)e.gl.uniform2iv(o,s);else if("ivec3"===n.type)e.gl.uniform3iv(o,s);else{if("ivec4"!==n.type)throw Error(`uniform type ${n.type} is not supported yet.`);e.gl.uniform4iv(o,s)}})),e.executeProgram()}(this.gpgpu,h,u,l,r),c.forEach((e=>this.disposeIntermediateTensorInfo(e))),p&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));const A=wt().get("WEBGL_FLUSH_THRESHOLD");if(A>0){const e=wn();e-this.lastGlFlushTime>A&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!wt().getBool("WEBGL_LAZILY_UNPACK")&&a.isPacked&&!1===i){const e=this.unpackTensor(s);return this.disposeIntermediateTensorInfo(s),e}return s}compileAndRun(e,t,n,r,i=!1){return n=n||t[0].dtype,this.runWebGLProgram(e,t,n,r,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(wt().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Ji((()=>{if(!wt().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=wt().getBool("DEBUG");wt().set("DEBUG",!1);const t=this.abs(zs(1e-8)).dataSync()[0];if(wt().set("DEBUG",e),t>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const t=this.texData.get(e),{shape:n,dtype:r,values:i,texture:o,usage:s,isPacked:a}=t;if(null!=o)return;const c=null!=this.activeTimers;let u;c&&(u=wn());let l=t.texShape;if(null==l&&(l=function(e,t=!1){let n=wt().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,e=e.map(((t,n)=>n>=e.length-2?$e(e[n]):e[n])),1===e.length&&(e=[2,e[0]])),2!==e.length){const t=ct(e);e=t.newShape}let r=et(e);if(e.length<=1&&r<=n)return[1,r];if(2===e.length&&e[0]<=n&&e[1]<=n)return e;if(3===e.length&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){const t=pp(e);let n=2,i=2;return e.length&&([n,i]=fp(e)),r=t*(n/2)*(i/2),rt(r).map((e=>2*e))}return rt(r)}(n,a),t.texShape=l),null!=i){const e=Ap(n);let o,s=l[1],d=l[0];const h=i instanceof Uint8Array||i instanceof Uint8ClampedArray;!a&&h||([s,d]=ep(l[0],l[1])),o=a?new Jp(e,h):new qp(e,h);const p=h?[d,s]:l,f=this.makeTensorInfo(p,r),A=this.texData.get(f.dataId);A.usage=h?qh.PIXELS:qh.UPLOAD,A.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),s,d,i);const E=[[d,s]],g=!0,_=this.runWebGLProgram(o,[f],r,E,g),m=this.texData.get(_.dataId);t.texShape=m.texShape,t.isPacked=m.isPacked,t.usage=m.usage,wt().get("ENGINE_COMPILE_ONLY")?this.disposeData(_.dataId):(t.texture=m.texture,t.values=null,this.texData.delete(_.dataId)),this.disposeIntermediateTensorInfo(f),c&&(this.uploadWaitMs+=wn()-u)}else{const e=this.acquireTexture(l,s,r,a);t.texture=e}}convertAndCacheOnCPU(e,t){const n=this.texData.get(e),{dtype:r}=n;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){const n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}throw new Error(`Unknown dtype ${t}`)}(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${e} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*pt(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(const[,t]of Object.entries(this.binaryCache)){const n=new Promise((e=>{try{this.checkCompletion_(t),e(!0)}catch(e){throw e}}));e.push(n)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await new Promise((e=>Du((()=>e())))),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw sp(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:t,customUniformLocations:n,infLoc:r,nanLoc:i,inShapesLocations:o,inTexShapesLocations:s,outShapeLocation:a,outShapeStridesLocation:c,outTexShapeLocation:u}=jp(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=i,e.inShapesLocations=o,e.inTexShapesLocations=s,e.outShapeLocation=a,e.outShapeStridesLocation=c,e.outTexShapeLocation=u}}}dA.nextDataId=0,ur()&&Zi("webgl",(()=>new dA),2);class hA{constructor(e){this.variableNames=["A"];const t=yp(),[n,r]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);\n\n        vec4 values = ${t.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class pA{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=yp(),[n,r]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${r}.0, ${n}.0);\n            vec4 values = ${t.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${t.output} = result;\n      }\n    `}}const fA={kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e;let{pixels:i}=t;const{numChannels:o}=r,s="undefined"!=typeof HTMLVideoElement&&i instanceof HTMLVideoElement,a="undefined"!=typeof HTMLImageElement&&i instanceof HTMLImageElement,[c,u]=s?[i.videoWidth,i.videoHeight]:[i.width,i.height],l=[u,c],d=[u,c,o];(a||s)&&(null==AA&&(AA=document.createElement("canvas").getContext("2d")),AA.canvas.width=c,AA.canvas.height=u,AA.drawImage(i,0,0,c,u),i=AA.canvas);const h=n.makeTensorInfo(l,"int32");n.texData.get(h.dataId).usage=qh.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);const p=wt().getBool("WEBGL_PACK")?new pA(d):new hA(d),f=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),f}};let AA;function EA(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:o}=r,s=n,a=et(i.shape),c=st(o,a),u=et(c);qe(a===u,(()=>`The new shape (${c}) has ${u} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`));const l=s.texData.get(i.dataId);return!l.isPacked||gp(i.shape,c)||null!==l.texture&&gp(l.shape,c)?(s.incRef(i.dataId),{dataId:i.dataId,shape:c,dtype:i.dtype}):function(e,t,n){const r=[pp(e.shape),...fp(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},o=[pp(t),...fp(t)],s=new Xf(o,r),a=[r],c=n.runWebGLProgram(s,[i],e.dtype,a,!0);return{dataId:c.dataId,shape:t,dtype:c.dtype}}(i,c,s)}const gA={kernelName:"Reshape",backendName:"webgl",kernelFunc:EA};class _A{constructor(e,t,n,r,i){this.variableNames=["A"],this.outputShape=[];const[o,s,a,c]=e;this.outputShape=[o,t,n,c];const u=[r&&t>1?s-1:s,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];let d;d=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/l[0]},\n          ${u[1]/l[1]});\n      const vec2 inputShapeRC = vec2(${s}.0, ${a}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${d};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class mA{constructor(e,t,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[o,s,a,c]=e;this.outputShape=[o,t,n,c];const u=[r&&t>1?s-1:s,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];let d;d=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/l[0]},\n          ${u[1]/l[1]},\n          ${u[1]/l[1]});\n      const vec3 inputShapeRC = vec3(${s}.0, ${a}.0,\n                                     ${a}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${d};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${c-1};\n        bool hasNextRow = coords.z < ${n-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}const IA={kernelName:"ResizeBilinear",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:o,halfPixelCenters:s,size:a}=r,[c,u]=a,l=wt().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new mA(i.shape,c,u,o,s):new _A(i.shape,c,u,o,s);return n.runWebGLProgram(l,[i],"float32")}};function TA(e){const{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const RA={kernelName:"Identity",backendName:"webgl",kernelFunc:TA};function vA(e){const{inputs:t,backend:n}=e,{real:r,imag:i}=t,o=n.makeTensorInfo(r.shape,"complex64"),s=n.texData.get(o.dataId),a=TA({inputs:{x:r},backend:n}),c=TA({inputs:{x:i},backend:n});return s.complexTensorInfos={real:a,imag:c},o}class yA{constructor(e,t,n){this.variableNames=["A","B"],this.outputShape=so(t,n),this.enableShapeUniforms=Wp(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${e}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}class SA{constructor(e,t,n,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=so(t,n);const i=this.outputShape.length;this.enableShapeUniforms=Wp(i);let o="";if(r)if(0===i||1===et(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(o=`\n          ${Fp(i)} coords = getOutputCoords();\n        `,1===i)this.enableShapeUniforms?o+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":o+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const e=qf("coords",i);this.enableShapeUniforms?o+=`\n            bool nextRowOutOfBounds =\n              (${e[i-2]} + 1) >= outShape[${i} - 2];\n            bool nextColOutOfBounds =\n              (${e[i-1]} + 1) >= outShape[${i} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:o+=`\n            bool nextRowOutOfBounds =\n              (${e[i-2]} + 1) >= ${this.outputShape[i-2]};\n            bool nextColOutOfBounds =\n              (${e[i-1]} + 1) >= ${this.outputShape[i-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${e}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${o}\n\n        setOutput(result);\n      }\n    `}}function CA({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:o})=>{const{x:s}=i,a=o,c=r||s.dtype;if(a.shouldExecuteOnCPU([s])&&null!=n){const e=a.texData.get(s.dataId),t=n(e.values,c);return a.makeTensorInfo(s.shape,c,t)}let u;return u=wt().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=t?new sA(s.shape,t):new rA(s.shape,e),a.runWebGLProgram(u,[s],c)}}function OA({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:o}){return({inputs:s,backend:a})=>{const{a:c,b:u}=s,l=a;if(r&&"complex64"===c.dtype){const t=l.texData.get(c.dataId),n=l.texData.get(u.dataId),[r,i]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map((t=>{const[n,r]=t,i={dataId:n.dataId,dtype:n.dtype,shape:c.shape},o={dataId:r.dataId,dtype:r.dtype,shape:u.shape},s=new yA(e,c.shape,u.shape);return l.runWebGLProgram(s,[i,o],Xn(n.dtype,r.dtype))})),o=vA({inputs:{real:r,imag:i},backend:l});return l.disposeIntermediateTensorInfo(r),l.disposeIntermediateTensorInfo(i),o}const d=o||Xn(c.dtype,u.dtype);if(("string"===c.dtype||"string"===u.dtype||l.shouldExecuteOnCPU([c,u]))&&null!=i){const e=l.texData.get(c.dataId).values,t=l.texData.get(u.dataId).values,n="string"===c.dtype?Zu(e):e,r="string"===c.dtype?Zu(t):t,[o,s]=i(c.shape,u.shape,n,r,d),a=l.makeTensorInfo(s,d);return l.texData.get(a.dataId).values=o,a}let h;return h=wt().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=t?new SA(t,c.shape,u.shape,n):new yA(e,c.shape,u.shape),l.runWebGLProgram(h,[c,u],d)}}function bA(e,t=!1){if("linear"===e)return"return x;";if("relu"===e)return t?"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n";if("elu"===e)return t?"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n":"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n":"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n";if("prelu"===e)return t?"\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n":"return (a < 0.) ? b * a : a;";if("leakyrelu"===e)return t?"\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n":"return (a < 0.) ? b * a : a;";if("sigmoid"===e)return"return 1.0 / (1.0 + exp(-1.0 * x));";throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}const wA=OA({opSnippet:"return float(a != b);",cpuKernelImpl:bf,dtype:"bool"});function NA(e){const{inputs:t,backend:n}=e,{input:r}=t;return TA({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}const DA={kernelName:"Cast",backendName:"webgl",kernelFunc:function e(t){const{inputs:n,backend:r,attrs:i}=t,{x:o}=n,{dtype:s}=i;if("complex64"===s){if("complex64"===o.dtype)return TA({inputs:{x:o},backend:r});const t=xa(o.shape),n=e({inputs:{x:o},backend:r,attrs:{dtype:"float32"}}),i=vA({inputs:{real:n,imag:t},backend:r});return t.dispose(),r.disposeIntermediateTensorInfo(n),i}if("complex64"===o.dtype){const t=NA({inputs:{input:o},backend:r}),n=e({inputs:{x:t},backend:r,attrs:{dtype:s}});return r.disposeIntermediateTensorInfo(t),n}if(!dt(o.dtype,s)){const e=TA({inputs:{x:o},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:s}}if("int32"===s)return function(e,t){const n=new rA(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(o,r);if("bool"===s){const e=r.makeTensorInfo([],"bool",ut("bool",1)),t=wA({inputs:{a:o,b:e},backend:r});return r.disposeIntermediateTensorInfo(e),t}throw new Error(`Error in Cast: failed to cast ${o.dtype} to ${s}`)}},LA=OA({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),PA={kernelName:"RealDiv",backendName:"webgl",kernelFunc:LA};class kA{constructor(e,t,n){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,i=Fp(r),o=t.map((e=>e[0])).join(","),s=t.map(((t,n)=>t[0]+e[n])).join(","),a=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?`\n      ${i} start = ${i}(${o});\n      ${i} end = ${i}(${s});\n\n      void main() {\n        ${i} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${i} coords = outC - start;\n          setOutput(getX(${a}));\n        }\n      }\n    `:`\n        int start = ${o};\n        int end = ${s};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class xA{constructor(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,n)=>t[0]+e[n]+t[1]));const r=e.length,i=Fp(r),o=t.map((e=>e[0])).join(","),s=t.map(((t,n)=>t[0]+e[n])).join(","),a=qf("rc",r),c=qf("source",r),u=`${a[r-1]} < ${this.outputShape[r-1]}`,l=1===r?"source":`vec2(${c.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${a[r-1]} += 1;\n       if(${u}) {\n      `,1===r?"":`}\n       rc = outputLoc;\n       ${a[r-2]} += 1;\n       if(${a[r-2]} < ${this.outputShape[r-2]}) {`,1===r?"":`  ${a[r-1]} += 1;\n         if(${u}) {`],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let e=0,t=1===r?2:4;e<t;e++)p+=`\n        ${d[e]}\n        if (${h}) {\n          result[${e}] = float(value);\n        } else {\n          ${i} source = rc - start;\n          result[${e}] = getChannel(getX(${c.join()}), ${l});\n        }\n      `;p+=1===r?"} ":"}}",this.userCode=`\n      const ${i} start = ${i}(${o});\n      const ${i} end = ${i}(${s});\n\n      void main() {\n        ${i} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}class MA{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}const UA=e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:o,constantValue:s}=r;if(0===et(i.shape)){const e=o.map(((e,t)=>e[0]+i.shape[t]+e[1]));return function(e){const{backend:t,attrs:n}=e,{shape:r,value:i}=n;let{dtype:o}=n;if(o=o||At(i),"string"===o){const e=lt(o,et(r));return e.fill(i),t.makeTensorInfo(r,o,e)}{const e=new MA(r,i),n=[[i]];return t.runWebGLProgram(e,[],o,n)}}({backend:n,attrs:{shape:e,value:s,dtype:i.dtype}})}const a=wt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xA(i.shape,o,s):new kA(i.shape,o,s),c=[[s]];return n.runWebGLProgram(a,[i],i.dtype,c)},BA={kernelName:"PadV2",backendName:"webgl",kernelFunc:UA};class FA{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const o=e.padInfo.top,s=e.padInfo.left,a=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,A="channelsLast"===e.dataFormat,E=A?1:2,g=A?2:3,_=A?3:1;let m="",I="";n&&(m=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,I="result = activation(result);");const T=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${m}\n\n      const ivec2 strides = ivec2(${a}, ${c});\n      const ivec2 pads = ivec2(${o}, ${s});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${_}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${E}], coords[${g}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${d}; wR++) {\n          int xR = xRCorner + wR * ${u};\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${h}; wC++) {\n            int xC = xCCorner + wC * ${l};\n\n            if (xC < 0 || xC >= ${e.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${p}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${A}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===f}) {\n\n              if (${A}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${p}) *\n                    getW(wR, wC, ${p}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${p}, xR, xC) *\n                    getW(wR, wC, ${p}, d2);\n              }\n\n            } else if (${2===f}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2)\n              );\n\n              if (${A}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===f}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2),\n                getW(wR, wC, ${p} + 2, d2)\n              );\n\n              if (${A}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1),\n                  getX(batch, xR, xC, ${p} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC),\n                  getX(batch, ${p} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${T}\n        ${I}\n        setOutput(result);\n      }\n    `}}class VA{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Wp(this.outputShape.length);const{dataFormat:n}=t,r=yp(),i="channelsLast"===n,o=i?0:1,s=i?1:2,a=this.enableShapeUniforms?"if(blockIndex < outShape[1] && pos < outShape[0]) {":`if(blockIndex < ${e[1]} && pos < ${e[0]}) {`;let c="";for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)c+=`\n          blockIndex = rc.y + ${t};\n          pos = rc.x + ${e};\n\n          ${a}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${o}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${s}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${i}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*e+t}] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*e+t}] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${c}\n\n        ${r.output} = result;\n      }\n    `}}class GA{constructor(e,t,n,r=!1,i=!1,o=!1,s=null,a=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=Wp(this.outputShape.length);const u=r?e[1]:e[2],l=Math.ceil(u/2),d=r?"i * 2, rc.y":"rc.y, i * 2",h=i?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let A="",E="";s&&(A=a?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${s}\n        }`:c?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${s}\n        }`:`vec4 activation(vec4 x) {\n          ${s}\n        }`,E="result = activation(result);");const g=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let _="rc.x",m="rc.x";e[0]<t[0]?_=`int(min(float(rc.x), ${e[0]-1}.))`:t[0]<e[0]&&(m=`int(min(float(rc.x), ${t[0]-1}.))`),this.userCode=`\n      ${A}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${l}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ${l}; i++) {\n          int batchA = ${_};\n          int batchB = ${m};\n          vec4 a = getMatrixA(batchA, ${d});\n          vec4 b = getMatrixB(batchB, ${h});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${p[0]} * ${f[0]});\n          result += (${p[1]} * ${f[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${g}\n\n        ${E}\n\n        setOutput(result);\n      }\n    `}}class QA{constructor(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=so(t,n),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${e}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const jA="return a * b;";function HA(e){const{inputs:t,backend:n}=e,{a:r,b:i}=t,o=Xn(r.dtype,i.dtype);if("complex64"===r.dtype){const e=n.texData.get(r.dataId),t=n.texData.get(i.dataId),o=new QA("return areal * breal - aimag * bimag;",r.shape,i.shape),s=new QA("return areal * bimag + aimag * breal;",r.shape,i.shape),a=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:i.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:i.shape}],c=n.runWebGLProgram(o,a,"float32"),u=n.runWebGLProgram(s,a,"float32"),l=vA({inputs:{real:c,imag:u},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),l}if(n.shouldExecuteOnCPU([r,i])){const e=n.texData.get(r.dataId),t=n.texData.get(i.dataId),[s,a]=Cf(r.shape,i.shape,e.values,t.values,o),c=n.makeTensorInfo(a,o);return n.texData.get(c.dataId).values=s,c}let s;return s=wt().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new SA(jA,r.shape,i.shape):new yA(jA,r.shape,i.shape),n.runWebGLProgram(s,[r,i],o)}const WA={kernelName:"Multiply",backendName:"webgl",kernelFunc:HA};class YA{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];const s=4*Math.floor(n/4),a=n%4;let c="sumValue += dot(values, ones);";if(null!=t){const e=1/t;c=`sumValue += dot(values * ${nt(e)?e.toPrecision(2):e}, ones);`}let u="";i%n>0&&(u=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${u}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${s}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${c}\n        }\n\n        int inIdx = inOffset + ${s};\n        if (${1===a}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${c}\n        } else if (${2===a}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${c}\n        } else if (${3===a}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${c}\n        }\n        setOutput(sumValue);\n      }\n    `}}class KA{constructor(e,t){this.variableNames=["x"];const{windowSize:n,batchSize:r,inSize:i,outSize:o}=e;this.outputShape=[r,o];let s="0.0",a="";"prod"===t?s="1.0":"min"===t?(s="1.0 / 1e-20",a="min"):"max"===t&&(s="-1.0 / 1e-20",a="max");let c=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===t?c="sumValue":"prod"===t?c="prodValue":"all"===t?c="allValue":"any"===t&&(c="anyValue");const u=4*Math.floor(n/4),l=n%4;let d=`\n      if (${"sum"===t}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===t}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${a}(values, minMaxValue);\n        if (${"min"===t} || ${"max"===t}) {\n          minMaxValue = ${a}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,h="vec4";"all"===t?(s="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(s="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");let p="";i%n>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${i}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${s};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${p}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        vec4 minMaxValue = vec4(${s});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${d}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===l}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${d}\n        } else if (${2===l}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${d}\n        } else if (${3===l}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${d}\n        }\n        setOutput(${c});\n      }\n    `}}function $A(e,t,n,r){const i=function(e){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const n=t.length?t[t.length-1].outSize:e[1],r=ku(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape);let o=e;for(let s=0;s<i.length;s++){const{inSize:a,windowSize:c,outSize:u}=i[s];let l,d;l="mean"===n?0===s?new YA({windowSize:c,inSize:a,batchSize:e.shape[0],outSize:u},a):new YA({windowSize:c,inSize:a,batchSize:e.shape[0],outSize:u}):new KA({windowSize:c,inSize:a,batchSize:e.shape[0],outSize:u},n),d=o,o=r.runWebGLProgram(l,[o],t),d.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(d)}return o}class zA{constructor(e,t){this.variableNames=["A"];const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;const r=Fp(this.rank),i=function(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t);for(let t=0;t<e.length;t++)r[e[t]]=n[t];return r.join()}(t);this.userCode=`\n    void main() {\n      ${r} resRC = getOutputCoords();\n      setOutput(getA(${i}));\n    }\n    `}}class qA{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const n=new Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=Fp(this.rank),i=zf("rc",this.rank),o=new Array(this.rank);for(let e=0;e<t.length;e++)o[t[e]]=i[e];const s=`vec2(${o.slice(-2).join()})`,a=`++${i[this.rank-1]} < ${n[this.rank-1]}`,c=`getChannel(getA(${o.join()}), ${s})`;this.userCode=`\n    void main() {\n      ${r} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${c};\n      if(${a}) {\n        result[1] = ${c};\n      }\n      --${i[this.rank-1]};\n      if(++${i[this.rank-2]} < ${n[this.rank-2]}) {\n        result[2] = ${c};\n        if(${a}) {\n          result[3] = ${c};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function JA(e,t,n){const r=wt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new qA(e.shape,t):new zA(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function XA(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o,keepDims:s}=r;return function(e,t,n,r){const i=t,o=e.shape.length,s=at(i,e.shape);let a=s;const c=Hs(a,o),u=null!=c;let l=e;u&&(l=JA(e,c,r),a=Ws(a.length,o)),js("sum",a,o);const[d,h]=Gs(l.shape,a);let p=d;n&&(p=Qs(d,s));const f=et(h),A=EA({inputs:{x:l},attrs:{shape:[et(e.shape)/f,f]},backend:r}),E=$A(A,Xn(e.dtype,"int32"),"sum",r),g=EA({inputs:{x:E},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(A),r.disposeIntermediateTensorInfo(E),u&&r.disposeIntermediateTensorInfo(l),g}(i,o,s,n)}function ZA(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:o}=r,s=n,a=i.shape.length,c=new Array(a);for(let e=0;e<c.length;e++)c[e]=i.shape[o[e]];let u;if(s.shouldExecuteOnCPU([i])){const e=s.texData.get(i.dataId).values,t=Kf(e,i.shape,i.dtype,o,c);u=s.makeTensorInfo(c,i.dtype),s.texData.get(u.dataId).values=t}else u=JA(i,o,s);return u}function eE({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:c=null}){const u=e.shape.length,l=t.shape.length,d=n?e.shape[u-2]:e.shape[u-1],h=r?t.shape[l-1]:t.shape[l-2],p=n?e.shape[u-1]:e.shape[u-2],f=r?t.shape[l-2]:t.shape[l-1],A=e.shape.slice(0,-2),E=t.shape.slice(0,-2),g=et(A),_=et(E),m=so(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([p,f]);qe(d===h,(()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`));const I=n?[g,d,p]:[g,p,d],T=r?[_,f,h]:[_,h,f],R=EA({inputs:{x:e},backend:i,attrs:{shape:I}}),v=EA({inputs:{x:t},backend:i,attrs:{shape:T}}),y=[R,v],S=Math.max(g,_),C=n?R.shape[1]:R.shape[2],O=null!=o,b=null!=s,w="leakyrelu"===c,N=null!=c?bA(c,!0):null;let D;if((1===p||1===f)&&C>1e3&&!1===(O||b||w||null!=N)){let e=R,t=v;n&&(e=ZA({inputs:{x:R},backend:i,attrs:{perm:[0,2,1]}}),y.push(e)),r&&(t=ZA({inputs:{x:v},backend:i,attrs:{perm:[0,2,1]}}),y.push(t));const o=1===f;let s=e;1!==f&&(s=EA({inputs:{x:e},backend:i,attrs:{shape:[S,C,1]}}),y.push(s));const a=1===f?2:1;let c=t;o&&(c=EA({inputs:{x:t},backend:i,attrs:{shape:[S,1,C]}}),y.push(c));const u=HA({inputs:{a:s,b:c},backend:i});D=XA({inputs:{x:u},backend:i,attrs:{axis:a,keepDims:!0}}),y.push(u)}else{const c=Xn(e.dtype,t.dtype),u=new GA(I,T,[S,p,f],n,r,O,N,b,w),l=[R,v];if(null!=o&&l.push(o),b&&l.push(s),w){const e=i.makeTensorInfo([],"float32",On(a,"float32"));l.push(e),y.push(e)}D=i.runWebGLProgram(u,l,c)}const L=EA({inputs:{x:D},backend:i,attrs:{shape:m}});y.push(D);for(const e of y)i.disposeIntermediateTensorInfo(e);return L}function tE({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:a=null}){const c=e.shape,u=r.texData.get(e.dataId),l=n.inChannels,d=c[0]*c[1]*c[2],h=n.outChannels,p="channelsLast"===n.dataFormat;let f;const A=[];if(null!=o&&!p&&3===o.shape.length){const e=ZA({inputs:{x:o},backend:r,attrs:{perm:[1,2,0]}});A.push(e),o=e}if((1!==d&&1!==h||!(l>1e3))&&u.isPacked&&p&&null!=u.texture&&c[2]%2!=0&&tt(u.shape.slice(-3),c.slice(-3))){const l=c[0]*c[1]*(c[2]+1),d={dataId:e.dataId,shape:[1,l,n.inChannels],dtype:e.dtype},h=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,qe(gp(u.shape,d.shape),(()=>`packed reshape ${u.shape} to ${d.shape} isn't free`));const p=EA({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});A.push(p);const E=eE({a:d,b:p,backend:r,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:o,leakyreluAlpha:s}),g=r.texData.get(E.dataId);qe(g.isPacked,(()=>"batchMatMul result is expected to be packed")),u.shape=h,g.shape=n.outShape,f=TA({inputs:{x:E},backend:r}),f.shape=n.outShape,A.push(E)}else{const c=p?e:ZA({inputs:{x:e},backend:r,attrs:{perm:[0,2,3,1]}}),u=c.shape,l=EA({inputs:{x:c},backend:r,attrs:{shape:[1,u[0]*u[1]*u[2],n.inChannels]}}),d=EA({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),h=eE({a:l,b:d,transposeA:!1,transposeB:!1,backend:r,bias:i,activation:a,preluActivationWeights:o,leakyreluAlpha:s}),E=EA({inputs:{x:h},backend:r,attrs:{shape:[n.batchSize,n.outHeight,n.outWidth,n.outChannels]}});f=p?E:ZA({inputs:{x:E},backend:r,attrs:{perm:[0,3,1,2]}}),p||(A.push(c),A.push(E)),A.push(l),A.push(d),A.push(h)}for(const e of A)r.disposeIntermediateTensorInfo(e);return f}function nE({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:a=null}){const{filterWidth:c,filterHeight:u,inChannels:l,outWidth:d,outHeight:h,dataFormat:p}=n,f="channelsLast"===p,A=c*u*l,E=h*d,g=[A,E],_=[];if(null!=o&&!f&&3===o.shape.length){const e=ZA({inputs:{x:o},backend:r,attrs:{perm:[1,2,0]}});_.push(e),o=e}const m=EA({inputs:{x:e},backend:r,attrs:{shape:e.shape.slice(1)}}),I=EA({inputs:{x:t},backend:r,attrs:{shape:[1,A,et(t.shape)/A]}});_.push(m),_.push(I);const T=new VA(g,n),R=[m.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],v=r.runWebGLProgram(T,[m],"float32",R),y=EA({inputs:{x:v},backend:r,attrs:{shape:[1,g[0],g[1]]}});_.push(v),_.push(y);const S=null!=i,C=null!=o,O="leakyrelu"===a,b=a?bA(a,!0):null,w=new GA(y.shape,I.shape,[1,E,n.outChannels],!0,!1,S,b,C,O),N=[y,I];if(i&&N.push(i),C&&N.push(o),O){const e=r.makeTensorInfo([],"float32",On(s,"float32"));N.push(e),_.push(e)}const D=r.runWebGLProgram(w,N,"float32"),L=EA({inputs:{x:D},backend:r,attrs:{shape:[1,h,d,n.outChannels]}}),P=f?L:ZA({inputs:{x:L},backend:r,attrs:{perm:[0,3,1,2]}});f||_.push(L),_.push(D);for(const e of _)r.disposeIntermediateTensorInfo(e);return P}const rE={kernelName:"FusedConv2D",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:s,preluActivationWeights:a}=t,{strides:c,pad:u,dataFormat:l,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=r,A=ts(l),E=Yo(i.shape,o.shape,c,d,u,h,!1,A);let g;const _=[];if(1!==E.filterHeight||1!==E.filterWidth||1!==E.dilationHeight||1!==E.dilationWidth||1!==E.strideHeight||1!==E.strideWidth||"SAME"!==E.padInfo.type&&"VALID"!==E.padInfo.type)if(wt().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])g=nE({x:i,filter:o,convInfo:E,backend:n,bias:s,activation:p,preluActivationWeights:a,leakyreluAlpha:f});else{const e=null!=s,t=null!=a,r="leakyrelu"===p,c=p?bA(p,!1):null,u=new FA(E,e,c,t,r),d=[i,o],h=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){const t=EA({inputs:{x:e},backend:n,attrs:{shape:[e.shape[0],1,1]}});return _.push(t),t}return e};if(e&&d.push(h(s,l)),t&&d.push(h(a,l)),r){const e=n.makeTensorInfo([],"float32",On(f,"float32"));d.push(e),_.push(e)}g=n.runWebGLProgram(u,d,"float32")}else g=tE({x:i,filter:o,convInfo:E,backend:n,bias:s,activation:p,preluActivationWeights:a,leakyreluAlpha:f});const m=EA({inputs:{x:g},backend:n,attrs:{shape:E.outShape}});return _.push(g),_.forEach((e=>n.disposeIntermediateTensorInfo(e))),m}};class iE{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wp(this.outputShape.length);const o=e.filterHeight,s=e.filterWidth,a=e.outChannels/e.inChannels;let c="",u="";n&&(c=r?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`\n          float activation(float x) {\n            ${n}\n          }\n        `,u="result = activation(result);");const l=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${c}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${a};\n        int q = d2 - d1 * ${a};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${o}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${s}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${l}\n        ${u}\n        setOutput(result);\n      }\n    `}}class oE{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Wp(this.outputShape.length);const o=e.outChannels/e.inChannels,s=e.padInfo.left,a=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,l=e.filterWidth,d=l;let h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let e=0;e<l;e++)h+=`\n          vec4 xTexelC${2*e};\n          int xTexelC${2*e}Ready;\n          vec4 xTexelC${2*e+1};\n          int xTexelC${2*e+1}Ready;\n          vec4 xC${e};`;h+=`\n    for (int r = 0; r < ${u}; r++) {\n      `;for(let e=0;e<l;e++)h+=`\n          xTexelC${2*e} = vec4(0.0);\n          xTexelC${2*e}Ready = 0;\n          xTexelC${2*e+1} = vec4(0.0);\n          xTexelC${2*e+1}Ready = 0;\n          xC${e} = vec4(0.0);`;h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let e=0;e<(d+1)/2;e++){const t=2*e;if(h+=`\n          xC = xCCorner + ${t*c};\n          `,1===a){if(t<l&&(s%2==1?(h+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n              `,h+=1===c&&t>0?`\n                xC${t} = vec4(xTexelC${t-2}.zw, xTexelC${t}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${t} = vec4(previous.zw, xTexelC${t}.xy);\n                  } else {\n                    xC${t} = vec4(0.0, 0.0, xTexelC${t}.xy);\n                  }\n                  `):h+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                xC${t} = xTexelC${t};\n                `,t+1<l)){const e=s%2==0?$e(c):c;c%2==0&&s%2==1||c%2!=0&&s%2!=1?(h+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${e};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                    xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${t+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${t+1}Ready = 1;\n                  }\n                  `,c>1&&(h+=`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                      xTexelC${t} = getX(batch, xR, xCOffset, d1);\n                      xTexelC${t}Ready = 1;\n                    }\n                    `),h+=`\n                  xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.xy);\n                  `):h+=1===e?`\n                    xC${t+1} = xTexelC${t};\n                    `:`\n                    xCOffset = xC + ${e};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                      xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${t+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${t+1}Ready = 1;\n                    }\n\n                    xC${t+1} = xTexelC${t+1};\n                    `}}else t<l&&(s%2==1?(h+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${t+1}Ready == 0) {\n                  xTexelC${t+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${t+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${t+1}Ready = 1;\n                }\n\n                xC${t} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n              `,t+1<l&&(h+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${t+1} = vec4(xTexelC${t+1}.xy, final.xy);\n                `)):(h+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                  xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t+1}.zw = vec2(0.);\n                  }\n                  xTexelC${t+1}Ready = 1;\n                }\n\n                xC${t} = vec4(\n                  xTexelC${t}.xy, xTexelC${t+1}.xy);\n              `,t+1<l&&(h+=`\n                  xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n                `)));t<l&&(h+=`\n            wTexel = getW(r, ${t}, d1, q);\n            dotProd += xC${t} * vec4(wTexel.xz, wTexel.xz);\n          `,t+1<l&&(h+=`\n              wTexel = getW(r, ${t+1}, d1, q);\n              dotProd += xC${t+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}h+="\n    }\n  ",h+="\n      }\n    ";let p="",f="";n&&(p=r?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${n}\n        }`:i?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${n}\n        }`:`vec4 activation(vec4 x) {\n          ${n}\n        }`,f="result = activation(result);");const A=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${p}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${o};\n        int q = d2 - d1 * ${o};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${h}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${A}\n        ${f}\n        setOutput(result);\n      }\n    `}}const sE={kernelName:"FusedDepthwiseConv2D",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o,bias:s,preluActivationWeights:a}=t,{strides:c,pad:u,dilations:l,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=r,f=[];let A=l;null==A&&(A=[1,1]),qe(es(c,A),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${A}'`));const E=Yo(i.shape,o.shape,c,A,u,d,!0),g=wt().getBool("WEBGL_PACK_DEPTHWISECONV")&&E.strideWidth<=2&&E.outChannels/E.inChannels==1,_=h?bA(h,g):null,m=[i,o],I=null!=s,T=null!=a,R="leakyrelu"===h;if(I&&m.push(s),T&&m.push(a),R){const e=n.makeTensorInfo([],"float32",On(p,"float32"));m.push(e),f.push(e)}let v;v=g?new oE(E,I,_,T,R):new iE(E,I,_,T,R);const y=[[E.padInfo.top,E.padInfo.left],[E.strideHeight,E.strideWidth],[E.dilationHeight,E.dilationWidth],[E.inHeight,E.inWidth]],S=n.runWebGLProgram(v,m,"float32",y);return f.forEach((e=>n.disposeIntermediateTensorInfo(e))),S}},aE="return a + b;",cE={kernelName:"Add",backendName:"webgl",kernelFunc:OA({opSnippet:aE,packedOpSnippet:aE,supportsComplex:!0,cpuKernelImpl:sf})},uE={kernelName:"SpaceToBatchND",backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,paddings:s}=r;qe(i.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const a=o.reduce(((e,t)=>e*t)),c=[[0,0]];c.push(...s);for(let e=1+o.length;e<i.shape.length;++e)c.push([0,0]);const u=[],l=UA({inputs:{x:i},backend:n,attrs:{paddings:c,constantValue:0}}),d=xu(l.shape,o,a,!1),h=Mu(d.length,o.length,!1),p=Uu(l.shape,o,a,!1),f=EA({inputs:{x:l},backend:n,attrs:{shape:d}}),A=ZA({inputs:{x:f},backend:n,attrs:{perm:h}}),E=EA({inputs:{x:A},backend:n,attrs:{shape:p}});return u.push(l),u.push(f),u.push(A),u.forEach((e=>n.disposeIntermediateTensorInfo(e))),E}},lE={kernelName:"DepthwiseConv2dNative",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dilations:c,dimRoundingMode:u}=r;let l=c;null==l&&(l=[1,1]),qe(es(s,l),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${s} and dilations '${l}'`));const d=Yo(i.shape,o.shape,s,l,a,u,!0);let h;h=wt().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels==1?new oE(d):new iE(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[i,o],"float32",p)}};class dE{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=Fp(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=function(e){if(1===e)return"sourceLoc";if(e<=6)return hE.slice(0,e).map((e=>"sourceLoc."+e)).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}(this.rank);let r;const i=e.map(((e,t)=>`sourceLoc.${hE[t]} = start[${t}] + coords.${hE[t]};`));r=`\n        ${t} sourceLoc;\n        ${t} coords = getOutputCoords();\n        ${i.join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${r}\n        setOutput(getSource(${n}));\n      }\n    `}}const hE=["x","y","z","w","u","v"];class pE{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=Fp(this.rank),n=qf("coords",this.rank),r=qf("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":`vec2(${r.slice(-2).join()})`,o=`getChannel(getSource(${r.join()}), ${i})`,s=`\n      result.x = ${o};\n      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {\n        ++${r[this.rank-1]};\n        result.y = ${o};\n        --${r[this.rank-1]};\n      }\n    `,a=1===this.rank?"":`\n      --${n[this.rank-1]};\n      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {\n        ++${r[this.rank-2]};\n        result.z = ${o};\n        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {\n          ++${r[this.rank-1]};\n          result.w = ${o};\n        }\n      }\n    `,c=this.rank<=4?`sourceLoc = coords +\n            ${t}(${e.map(((e,t)=>`start[${t}]`)).join()});`:e.map(((e,t)=>`${r[t]} = ${n[t]} + start[${t}];`)).join("\n");this.userCode=`\n      void main() {\n        ${t} coords = getOutputCoords();\n        ${t} sourceLoc;\n        ${c}\n        vec4 result = vec4(0.);\n        ${s}\n        ${a}\n        setOutput(result);\n      }\n    `}}function fE(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,size:s}=r,[a,c]=yo(i,o,s);if(ho(i,a,c),0===et(c))return n.makeTensorInfo(c,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||"string"===i.dtype){const e=n.texData.get(i.dataId),t=xf(e.values,a,c,i.shape,i.dtype);return n.makeTensorInfo(c,i.dtype,t)}const{isPacked:u}=n.texData.get(i.dataId),l=Ro(i.shape,a,c);if(u||!l){const e=wt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new pE(c):new dE(c),t=[a];return n.runWebGLProgram(e,[i],i.dtype,t)}return n.uploadToGPU(i.dataId),function(e,t,n,r){const i=r.texData.get(e.dataId),o=r.makeTensorInfo(n,e.dtype),s=r.texData.get(o.dataId);Object.assign(s,i),s.refCount=1,s.shape=n,s.dtype=e.dtype;let a=vo(t,_t(e.shape));i.slice&&(a+=i.slice.flatOffset),s.slice={flatOffset:a,origDataId:i.slice&&i.slice.origDataId||e.dataId};const c=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,c+1),o}(i,a,c,n)}const AE={kernelName:"Slice",backendName:"webgl",kernelFunc:fE},EE={kernelName:"BatchToSpaceND",backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:o,crops:s}=r;qe(i.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const a=o.reduce(((e,t)=>e*t)),c=xu(i.shape,o,a),u=Mu(c.length,o.length),l=Uu(i.shape,o,a),d=Bu(s,o.length),h=Fu(l,s,o.length),p=[],f=EA({inputs:{x:i},backend:n,attrs:{shape:c}}),A=ZA({inputs:{x:f},backend:n,attrs:{perm:u}}),E=EA({inputs:{x:A},backend:n,attrs:{shape:l}}),g=fE({inputs:{x:E},backend:n,attrs:{begin:d,size:h}});return p.push(f),p.push(A),p.push(E),p.forEach((e=>n.disposeIntermediateTensorInfo(e))),g}},gE={kernelName:"Relu6",backendName:"webgl",kernelFunc:CA({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"})};class _E{constructor(e,t,n){this.variableNames=["x"],this.outputShape=n;const r=n.length,i=Fp(n.length),o=Fp(n.length);let s="";if(1===r)s="coords * strides + begin";else{let e=0;s=n.map(((t,r)=>(e++,1===n.length?`coords * strides[${r}] + begin[${r}]`:`coords[${e-1}] * strides[${r}] + begin[${r}]`))).join(",")}this.userCode=`\n      ${i} begin = ${i}(${e});\n      ${i} strides = ${i}(${t});\n\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${s}));\n      }\n    `}}const mE={kernelName:"StridedSlice",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:o,end:s,strides:a,beginMask:c,endMask:u,ellipsisMask:l,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:p,finalShape:f,isIdentity:A,sliceDim0:E,isSimpleSlice:g,begin:_,end:m,strides:I}=So(i.shape,o,s,a,c,u,l,d,h);let T;if(A)T=EA({inputs:{x:i},backend:n,attrs:{shape:f}});else if(E||g){qe(i.shape.length>=1,(()=>`Input must have rank at least 1, got: ${i.shape.length}`));const e=po(_,m,I),t=fE({inputs:{x:i},backend:n,attrs:{begin:_,size:e}});T=EA({inputs:{x:t},backend:n,attrs:{shape:f}}),n.disposeIntermediateTensorInfo(t)}else if(n.shouldExecuteOnCPU([i])){const e=n.readSync(i.dataId),t=Es(i.shape,i.dtype,e),r=Vf(p,t,I,_);T=n.makeTensorInfo(f,i.dtype,r.values)}else{const e=new _E(_,I,p);T=n.runWebGLProgram(e,[i],i.dtype)}const R=EA({inputs:{x:T},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(T),R}};class IE{constructor(e){this.outputShape=[],this.outputShape=Pu(e,1),this.variableNames=e.map(((e,t)=>`T${t}`));const t=new Array(e.length-1);t[0]=e[0][1];for(let n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];const n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let e=1;e<t.length;e++){const r=t[e-1];n.push(`else if (yC < ${t[e]}) setOutput(getT${e}(yR, yC-${r}));`)}const r=t.length,i=t[t.length-1];n.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${n.join("\n        ")}\n      }\n    `}}class TE{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Pu(e,t);const n=this.outputShape,r=n.length,i=Fp(r),o=qf("coords",r),s=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(((e,t)=>`T${t}`));const a=new Array(e.length-1);a[0]=e[0][t];for(let n=1;n<a.length;n++)a[n]=a[n-1]+e[n][t];const c=s[t],u=s.slice(-2),l=s.join();let d=`if (${c} < ${a[0]}) {\n        return getChannel(\n            getT0(${l}), vec2(${u.join()}));\n        }`;for(let e=1;e<a.length;e++){const t=a[e-1];d+=`\n        if (${c} < ${a[e]}  && ${c} >= ${a[e-1]}) {\n          return getChannel(\n            getT${e}(${RE(s,c,t)}),\n            vec2(${RE(u,c,t)}));\n        }`}const h=a.length,p=a[a.length-1];d+=`\n        return getChannel(\n          getT${h}(${RE(s,c,p)}),\n          vec2(${RE(u,c,p)}));`,this.userCode=`\n      float getValue(${s.map((e=>"int "+e))}) {\n        ${d}\n      }\n\n      void main() {\n        ${i} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${o}), 0., 0., 0.);\n\n        ${o[r-1]} = ${o[r-1]} + 1;\n        if (${o[r-1]} < ${n[r-1]}) {\n          result.g = getValue(${o});\n        }\n\n        ${o[r-2]} = ${o[r-2]} + 1;\n        if (${o[r-2]} < ${n[r-2]}) {\n          result.a = getValue(${o});\n        }\n\n        ${o[r-1]} = ${o[r-1]} - 1;\n        if (${o[r-2]} < ${n[r-2]} &&\n            ${o[r-1]} < ${n[r-1]}) {\n          result.b = getValue(${o});\n        }\n        setOutput(result);\n      }\n    `}}function RE(e,t,n){const r=e.indexOf(t);return e.map(((e,t)=>t===r?`${e} - ${n}`:e)).join()}function vE(e,t,n){const r=e[0].dtype;if("complex64"===r){const r=e.map((e=>NA({inputs:{input:e},backend:n}))),i=e.map((e=>function(e){const{inputs:t,backend:n}=e,{input:r}=t;return TA({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}({inputs:{input:e},backend:n}))),o=vE(r,t,n),s=vE(i,t,n),a=vA({inputs:{real:o,imag:s},backend:n});return r.forEach((e=>n.disposeIntermediateTensorInfo(e))),i.forEach((e=>n.disposeIntermediateTensorInfo(e))),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),a}let i=n.shouldExecuteOnCPU(e);if("string"===r&&(i=!0),i){const i=e.map((e=>{const r=et(e.shape.slice(t));return EA({inputs:{x:e},backend:n,attrs:{shape:[-1,r]}})})),o=i.map((e=>({vals:n.readSync(e.dataId),shape:e.shape}))),s=Pu(i.map((e=>e.shape)),1),a=1===i[0].shape[0],c=lf(o,s,r,a),u=Pu(e.map((e=>e.shape)),t),l=n.makeTensorInfo(u,r,c);return i.forEach((e=>n.disposeIntermediateTensorInfo(e))),l}if(e.length>wt().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const r=Math.floor(e.length/2),i=vE(e.slice(0,r),t,n),o=vE(e.slice(r),t,n),s=vE([i,o],t,n);return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),s}if(wt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].shape.length>1){const i=new TE(e.map((e=>e.shape)),t);return n.runWebGLProgram(i,e,r)}const{tensors2D:o,outShape:s}=function(e,t,n){const r=Pu(e.map((e=>e.shape)),t),i=e.map((e=>EA({inputs:{x:e},attrs:{shape:[-1,et(e.shape.slice(t))]},backend:n})));return{tensors2D:i,outShape:r}}(e,t,n),a=new IE(o.map((e=>e.shape))),c=n.runWebGLProgram(a,o,r);o.forEach((e=>n.disposeIntermediateTensorInfo(e)));const u=EA({inputs:{x:c},attrs:{shape:s},backend:n});return n.disposeIntermediateTensorInfo(c),u}function yE(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,o=at(i,t[0].shape)[0],s=Pu(t.map((e=>e.shape)),o);if(0===et(s))return n.makeTensorInfo(s,t[0].dtype,[]);const a=t.filter((e=>et(e.shape)>0));return 1===a.length?TA({inputs:{x:a[0]},backend:n}):(Lu(a.map((e=>e.shape)),o),vE(a,o,n))}const SE={kernelName:"Concat",backendName:"webgl",kernelFunc:yE};function CE(e){const{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:o}=t,s=o.shape.length,a=o.shape.slice();let c=i;return i<0&&(qe(-(s+1)<=i,(()=>`Axis must be in the interval [${-(s+1)}, ${s}]`)),c=s+i+1),a.splice(c,0,1),EA({inputs:{x:o},backend:r,attrs:{shape:a}})}const OE={kernelName:"Pack",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(1===t.length)return CE({inputs:{input:t[0]},backend:n,attrs:{dim:i}});const o=t[0].shape,s=t[0].dtype;t.forEach((e=>{Je(o,e.shape,"All tensors passed to stack must have matching shapes"),qe(s===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const a=[],c=yE({inputs:t.map((e=>{const t=CE({inputs:{input:e},backend:n,attrs:{dim:i}});return a.push(t),t})),backend:n,attrs:{axis:i}});return a.forEach((e=>n.disposeIntermediateTensorInfo(e))),c}};class bE{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,o="channelsLast"===e.dataFormat,s=t-1-e.padInfo.top,a=n-1-e.padInfo.left,c=o?1:2,u=o?2:3,l=o?3:1;this.userCode=`\n      const ivec2 pads = ivec2(${s}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${l}];\n\n        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${r}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${n}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${i}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${n} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n\n              if (${o}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const wE={kernelName:"Conv2DBackpropInput",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:o}=t,{inputShape:s,strides:a,pad:c,dataFormat:u,dimRoundingMode:l}=r,d=ts(u),h=Yo(s,o.shape,a,1,c,l,!1,d),p=new bE(h);return n.runWebGLProgram(p,[i,o],"float32")}},NE={kernelName:"Relu",backendName:"webgl",kernelFunc:CA({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"})},DE={kernelName:"Sigmoid",backendName:"webgl",kernelFunc:CA({opSnippet:"if (isnan(x)) return x;\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:Pf})};class LE{constructor(e,t,n,r,i){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[o,s,a,c]=e,[u]=t,[l,d]=n;this.outputShape=[u,l,d,c];const h="bilinear"===r?1:0,[p,f]=[s-1+".0",a-1+".0"],[A,E,g]=l>1?[""+(s-1)/(l-1),"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[_,m,I]=d>1?[""+(a-1)/(d-1),"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`\n      const float height_ratio = float(${A});\n      const float width_ratio = float(${_});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${o}) {\n          return;\n        }\n\n        float height_scale = ${E};\n        float width_scale = ${m};\n\n        float in_y = ${g};\n        if( in_y < 0.0 || in_y > ${p} ) {\n          setOutput(float(${i}));\n          return;\n        }\n        float in_x = ${I};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${i}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${h} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}const PE={kernelName:"CropAndResize",backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:o,boxInd:s}=t,{cropSize:a,method:c,extrapolationValue:u}=r,l=new LE(i.shape,o.shape,a,c,u);return n.runWebGLProgram(l,[i,o,s],"float32")}};class kE{constructor(e,t){this.variableNames=["x"];const n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,1===n)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${e[0]} - coord - 1));\n        }\n      `);const r=e.map(((n,r)=>(n=>-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - coords[${n}] - 1`:`coords[${n}]`)(r))).join(","),i=Fp(n);this.userCode=`\n      void main() {\n        ${i} coords = getOutputCoords();\n        setOutput(getX(${r}));\n      }\n    `}}class xE{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const n=e.length;if(n>4)throw new Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;const r=qf("rc",n),i=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,o=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,s=Fp(n);function a(n){const r=e.map(((r,i)=>function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?`${e[n]} - ${r[n]} - 1`:`${r[n]}`}(i,n)));return`getChannel(getX(${r.join(",")}), vec2(${r.slice(-2).join(",")}))`}this.userCode=1===n?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${e[0]} - rc - 1),\n            ${e[0]} - rc - 1);\n          if(${i}){\n              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),\n                ${e[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${s} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(e){return a(e)}(r.slice())};\n          if(${i}){\n            result.g = ${function(e){return e[n-1]="("+e[n-1]+" + 1)",a(e)}(r.slice())};\n          }\n          if(${o}) {\n            result.b = ${function(e){return e[n-2]="("+e[n-2]+" + 1)",a(e)}(r.slice())};\n            if(${i}) {\n              result.a = ${function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",a(e)}(r.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}const ME={kernelName:"Reverse",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:o}=r,s=i.shape.length,a=at(o,i.shape);if(0===s)return TA({inputs:{x:i},backend:n});const c=wt().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xE(i.shape,a):new kE(i.shape,a);return n.runWebGLProgram(c,[i],i.dtype)}},UE="return a - b;",BE=OA({opSnippet:UE,packedOpSnippet:UE,supportsComplex:!0,cpuKernelImpl:Hf}),FE={kernelName:"Sub",backendName:"webgl",kernelFunc:BE},VE={kernelName:"Unpack",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{value:i}=t;let{axis:o}=r;o<0&&(o+=i.shape.length);const s=i,a=s.shape.length,c=i.shape[o],u=new Array(a-1);let l=0;for(let e=0;e<a;e++)e!==o&&(u[l++]=s.shape[e]);const d=[],h=new Array(a).fill(0),p=s.shape.slice();p[o]=1;const f=new Array(c);for(let e=0;e<f.length;e++){h[o]=e;const t=fE({inputs:{x:s},backend:n,attrs:{begin:h,size:p}}),r=EA({inputs:{x:t},backend:n,attrs:{shape:u}});f[e]=r,d.push(t)}return d.forEach((e=>n.disposeIntermediateTensorInfo(e))),f}};class GE{constructor(e,t,n){this.variableNames=["A"];const{windowSize:r,batchSize:i,outSize:o}=e;n||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];const s="max"===t?">":"<",a=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${r}; i++) {\n          int inIdx = ${a};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${s} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}class QE{constructor(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,qe(e.length>2,(()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`));const i=e[e.length-1],o=Math.ceil(i/t);this.outputShape=e.slice(0,-1),o>1&&this.outputShape.push(o),r||this.variableNames.push("bestIndicesA");const s=this.outputShape,a=s.length,c=Fp(a),u=qf("coords",a);let l,d;if(1===o){d=a+1;const e=Fp(d);l=`\n        ${e} sourceLocR = ${e}(${u.join()}, 0);\n        ++${u[a-1]};\n        ${e} sourceLocG = ${e}(${u.join()}, 0);\n        ++${u[a-2]};\n        ${e} sourceLocA = ${e}(${u.join()}, 0);\n        --${u[a-1]};\n        ${e} sourceLocB = ${e}(${u.join()}, 0);\n        --${u[a-2]};`}else d=a,l=`\n        ${c} sourceLocR = coords;\n        ++${u[a-1]};\n        ${c} sourceLocG = coords;\n        ++${u[a-2]};\n        ${c} sourceLocA = coords;\n        --${u[a-1]};\n        ${c} sourceLocB = coords;\n        --${u[a-2]};`;const h=["x","y","z","w","u","v"].slice(0,d),p="."+h[d-1],f=h.map((e=>"int "+e)),A=qf("sourceLocR",d-1).concat("inIdx.r"),E=qf("sourceLocG",d-1).concat("inIdx.g"),g=qf("sourceLocB",d-1).concat("inIdx.b"),_=qf("sourceLocA",d-1).concat("inIdx.a"),m="max"===n?"greaterThan":"lessThan",I=r?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${A.join()}),\n                             getBestIndicesAChannel(${E.join()}),\n                             getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${_.join()})));`,T=`vec4(\n            getAChannel(${A.join()}),\n            hasNextCol ? getAChannel(${E.join()}) : 0.,\n            hasNextRow ? getAChannel(${g.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${_.join()}) : 0.)`,R=r?"":`\n      float getBestIndicesAChannel(${f.join()}) {\n        return getChannel(getBestIndicesA(${h.join()}),\n                                          vec2(${h.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${f.join()}) {\n        return getChannel(getA(${h.join()}),\n                               vec2(${h.slice(-2).join()}));\n      }\n      ${R}\n      void main() {\n        ${c} coords = getOutputCoords();\n        bool hasNextCol = ${u[a-1]} < ${s[a-1]-1};\n        bool hasNextRow = ${u[a-2]} < ${s[a-2]-1};\n        ${l}\n        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},\n          sourceLocB${p}, sourceLocA${p}) * ${t};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${T};\n\n        for (int i = 0; i < ${t}; i++) {\n          inIdx = srcIdx;\n          ${I}\n          vec4 candidate = ${T};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${m}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}function jE(e,t,n,r=null){let i=t.shape[0],o=t.shape[1];null!=r&&(i=r.shape[0],o=r.shape[1]);const s=ku(o),a={windowSize:s,inSize:o,batchSize:i,outSize:Math.ceil(o/s)},c=new GE(a,n,null==r),u=[t];null!=r&&u.push(r);const l=e.runWebGLProgram(c,u,"int32");if(1===l.shape[1])return l;const d=jE(e,t,n,l);return e.disposeIntermediateTensorInfo(l),d}function HE(e,t,n,r=null){const i=null!=r?r.shape:t.shape,o=ku(i[i.length-1]),s=new QE(i,o,n,null==r),a=null==r?[t]:[t,r],c=e.runWebGLProgram(s,a,"int32");if(c.shape.length===t.shape.length){const r=HE(e,t,n,c);return e.disposeIntermediateTensorInfo(c),r}return c}function WE(e,t,n,r){const i=[n];if(js("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!wt().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const n=[],o=e.texData.get(t.dataId);let s=t;null!==o&&o.isPacked&&(s=e.unpackTensor(t),n.push(s));const[a,c]=Gs(s.shape,i),u=et(c),l=EA({inputs:{x:s},backend:e,attrs:{shape:[-1,u]}});n.push(l);const d=jE(e,l,r);n.push(d);const h=EA({inputs:{x:d},backend:e,attrs:{shape:a}});return n.forEach((t=>e.disposeIntermediateTensorInfo(t))),h}return HE(e,t,r)}const YE={kernelName:"ArgMax",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:o}=r;let s=at(o,i.shape);const a=Hs(s,i.shape.length);let c=i;const u=[];null!=a&&(c=ZA({inputs:{x:i},backend:n,attrs:{perm:a}}),u.push(c),s=Ws(s.length,c.shape.length)),js("argMax",[s[0]],c.shape.length);const l=WE(n,c,s[0],"max");return u.forEach((e=>n.disposeIntermediateTensorInfo(e))),l}},KE={kernelName:"Mean",backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:n})=>{const{x:r}=e,{keepDims:i,axis:o}=t,s=n,a=r.shape.length,c=at(o,r.shape);let u=c;const l=Hs(u,a),d=null!=l,h=s.shouldExecuteOnCPU([r]),p=[];let f=r;if(d){if(h){const e=s.texData.get(f.dataId).values,t=new Array(a);for(let e=0;e<t.length;e++)t[e]=r.shape[l[e]];const n=Kf(e,r.shape,r.dtype,l,t);f=s.makeTensorInfo(t,r.dtype),s.texData.get(f.dataId).values=n}else f=JA(r,l,s);p.push(f),u=Ws(u.length,a)}js("sum",u,a);const[A,E]=Gs(f.shape,u);let g=A;i&&(g=Qs(A,c));const _=function(e,t,n,r){const i=et(t),o=EA({inputs:{x:e},attrs:{shape:[et(e.shape)/i,i]},backend:r}),s=$A(o,"float32","mean",r),a=EA({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),a}(f,E,g,s);for(const e of p)s.disposeIntermediateTensorInfo(e);return _}},$E={kernelName:"BatchMatMul",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{a:i,b:o}=t,{transposeA:s,transposeB:a}=r;return eE({a:i,b:o,transposeA:s,transposeB:a,backend:n})}};class zE{constructor(e,t,n,r=!1,i=!1){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");const o=e.filterWidth,s=e.strideHeight,a=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,l=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const f="avg"===t,A=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,E=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let g="0.0";if(f||(g="-1.0 / 1e-20"),n){const t=">=";return void(this.userCode=`\n        const ivec2 strides = ivec2(${s}, ${a});\n        const ivec2 pads = ivec2(${h}, ${p});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${l};\n              wR += ${c}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d};\n                wC += ${u}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ${t} currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${r?i?A:E:`wR * ${d} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let _=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(_="avgValue / count");const m=4*Math.floor(o/4),I=o%4,T=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${s}, ${a});\n      const ivec2 pads = ivec2(${h}, ${p});\n      const float initializationValue = ${g};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${g});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${l};\n            wR += ${c}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${m}; wC += 4) {\n            int xC = xCCorner + wC * ${u};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              getValue(batch, xR, xC + 3 * ${u}, d)\n            );\n\n            ${T}\n          }\n\n          int xC = xCCorner + ${m};\n          if (${1===I}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${T}\n          } else if (${2===I}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${T}\n          } else if (${3===I}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              initializationValue\n            );\n\n            ${T}\n          }\n        }\n        setOutput(${_});\n      }\n    `}}const qE={kernelName:"AvgPool",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t;!function(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&qe("complex64"!==e.dtype,(()=>"avgPool does not support complex64 tensors in the WebGL backend."))}))}(i);const{filterSize:o,strides:s,pad:a,dimRoundingMode:c}=r;qe(es(s,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${s} and dilations '1'`));const u=Wo(i.shape,o,s,1,a,c);if(1===u.filterWidth&&1===u.filterHeight&&tt(u.inShape,u.outShape))return TA({inputs:{x:i},backend:n});const l=new zE(u,"avg",!1);return n.runWebGLProgram(l,[i],"float32")}};class JE{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class XE{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const ZE={kernelName:"ClipByValue",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:o,clipValueMax:s}=r;let a;a=wt().getBool("WEBGL_PACK_CLIP")?new XE(i.shape):new JE(i.shape);const c=[[o],[s]];return n.runWebGLProgram(a,[i],i.dtype,c)}},eg={kernelName:"Conv2D",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i,filter:o}=t,{strides:s,pad:a,dataFormat:c,dilations:u,dimRoundingMode:l}=r,d=ts(c),h=Yo(i.shape,o.shape,s,u,a,l,!1,d);let p;if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(wt().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])p=nE({x:i,filter:o,convInfo:h,backend:n});else{const e=new FA(h);p=n.runWebGLProgram(e,[i,o],"float32")}else p=tE({x:i,filter:o,convInfo:h,backend:n});const f=EA({inputs:{x:p},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(p),f}},tg=CA({opSnippet:"if (isnan(x)) return x;\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:hf,dtype:"float32"}),ng={kernelName:"Softmax",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:o}=r,s=at([o],i.shape),a=function(e){const{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:o,keepDims:s}=r,a=i.shape.length,c=at(o,i.shape);let u=c;const l=Hs(u,a),d=null!=l,h=n.shouldExecuteOnCPU([i]);let p=i;if(d){if(h){const e=n.texData.get(p.dataId).values,t=new Array(a);for(let e=0;e<t.length;e++)t[e]=i.shape[l[e]];const r=Kf(e,i.shape,i.dtype,l,t);p=n.makeTensorInfo(t,i.dtype),n.texData.get(p.dataId).values=r}else p=JA(i,l,n);u=Ws(u.length,a)}js("max",u,a);const[f,A]=Gs(p.shape,u);let E,g=f;if(s&&(g=Qs(f,c)),h){const e=n.texData.get(p.dataId).values,t=vf(e,et(A),g,i.dtype);E=n.makeTensorInfo(g,i.dtype),n.texData.get(E.dataId).values=t}else E=function(e,t,n,r){const i=et(t),o=EA({inputs:{x:e},attrs:{shape:[et(e.shape)/i,i]},backend:r}),s=$A(o,e.dtype,"max",r),a=EA({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),a}(p,A,g,n);return d&&n.disposeIntermediateTensorInfo(p),E}({inputs:{x:i},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),c=Qs(a.shape,s),u=EA({inputs:{x:a},backend:n,attrs:{shape:c}}),l=BE({inputs:{a:i,b:u},backend:n}),d=tg({inputs:{x:l},backend:n}),h=XA({inputs:{x:d},backend:n,attrs:{axis:s,keepDims:!1}}),p=EA({inputs:{x:h},backend:n,attrs:{shape:c}}),f=LA({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),f}};Vt(mh),Vt(Ih),Vt(wd),Vt(Th),Vt(Rh),Vt(Nh),Vt(Ph),Vt(kd),Vt(kh),Vt(Lh),Vt(xh),Vt(Xd),Vt(bh),Vt(Mh),Vt(Vh),Vt(Gh),Vt(Ch),Vt(oh),Vt(Cd),Vt(Qh),Vt(jh),Vt(Bh),Vt(fh),Vt(Hh),Vt(Wh),Vt(fA),Vt(gA),Vt(IA),Vt(DA),Vt(PA),Vt(BA),Vt(rE),Vt(sE),Vt(cE),Vt(uE),Vt(lE),Vt(EE),Vt(WA),Vt(gE),Vt(mE),Vt(OE),Vt(wE),Vt(NE),Vt(DE),Vt(RA),Vt(PE),Vt(ME),Vt(SE),Vt(FE),Vt(VE),Vt(YE),Vt(KE),Vt($E),Vt(qE),Vt(ZE),Vt(eg),Vt(ng),Vt(AE);var rg={};function ig(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(1===e.length){var n=e[0];if(f(n))return og(n,null);if(A(n)&&Object.getPrototypeOf(n)===Object.prototype){var r=Object.keys(n);return og(r.map((function(e){return n[e]})),r)}}if("function"==typeof e[e.length-1]){var i=e.pop();return og(e=1===e.length&&f(e[0])?e[0]:e,null).pipe(K((function(e){return i.apply(void 0,e)})))}return og(e,null)}function og(e,t){return new C((function(n){var r=e.length;if(0!==r)for(var i=new Array(r),o=0,s=0,a=function(a){var c=W(e[a]),u=!1;n.add(c.subscribe({next:function(e){u||(u=!0,s++),i[a]=e},error:function(e){return n.error(e)},complete:function(){++o!==r&&u||(s===r&&n.next(t?t.reduce((function(e,t,n){return e[t]=i[n],e}),{}):i),n.complete())}}))},c=0;c<r;c++)a(c);else n.complete()}))}var sg="undefined"!=typeof window&&window,ag="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,cg=sg||void 0!==_e&&_e||ag;function ug(e,t){return void 0===t&&(t=null),new Eg({method:"GET",url:e,headers:t})}function lg(e,t,n){return new Eg({method:"POST",url:e,body:t,headers:n})}function dg(e,t){return new Eg({method:"DELETE",url:e,headers:t})}function hg(e,t,n){return new Eg({method:"PUT",url:e,body:t,headers:n})}function pg(e,t,n){return new Eg({method:"PATCH",url:e,body:t,headers:n})}var fg=K((function(e,t){return e.response}));function Ag(e,t){return fg(new Eg({method:"GET",url:e,responseType:"json",headers:t}))}var Eg=function(e){function t(t){var n=e.call(this)||this,r={async:!0,createXHR:function(){return this.crossDomain?function(){if(cg.XMLHttpRequest)return new cg.XMLHttpRequest;if(cg.XDomainRequest)return new cg.XDomainRequest;throw new Error("CORS is not supported by your browser")}():function(){if(cg.XMLHttpRequest)return new cg.XMLHttpRequest;var e=void 0;try{for(var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=0;n<3;n++)try{if(e=t[n],new cg.ActiveXObject(e))break}catch(e){}return new cg.ActiveXObject(e)}catch(e){throw new Error("XMLHttpRequest is not supported by your browser")}}()},crossDomain:!0,withCredentials:!1,headers:{},method:"GET",responseType:"json",timeout:0};if("string"==typeof t)r.url=t;else for(var i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return n.request=r,n}var n;return c(t,e),t.prototype._subscribe=function(e){return new gg(e,this.request)},t.create=((n=function(e){return new t(e)}).get=ug,n.post=lg,n.delete=dg,n.put=hg,n.patch=pg,n.getJSON=Ag,n),t}(C),gg=function(e){function t(t,n){var r=e.call(this,t)||this;r.request=n,r.done=!1;var i=n.headers=n.headers||{};return n.crossDomain||r.getHeader(i,"X-Requested-With")||(i["X-Requested-With"]="XMLHttpRequest"),r.getHeader(i,"Content-Type")||cg.FormData&&n.body instanceof cg.FormData||void 0===n.body||(i["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),n.body=r.serializeBody(n.body,r.getHeader(n.headers,"Content-Type")),r.send(),r}return c(t,e),t.prototype.next=function(e){this.done=!0;var t,n=this,r=n.xhr,i=n.request,o=n.destination;try{t=new _g(e,r,i)}catch(e){return o.error(e)}o.next(t)},t.prototype.send=function(){var e=this.request,t=this.request,n=t.user,r=t.method,i=t.url,o=t.async,s=t.password,a=t.headers,c=t.body;try{var u=this.xhr=e.createXHR();this.setupEvents(u,e),n?u.open(r,i,o,n,s):u.open(r,i,o),o&&(u.timeout=e.timeout,u.responseType=e.responseType),"withCredentials"in u&&(u.withCredentials=!!e.withCredentials),this.setHeaders(u,a),c?u.send(c):u.send()}catch(e){this.error(e)}},t.prototype.serializeBody=function(e,t){if(!e||"string"==typeof e)return e;if(cg.FormData&&e instanceof cg.FormData)return e;if(t){var n=t.indexOf(";");-1!==n&&(t=t.substring(0,n))}switch(t){case"application/x-www-form-urlencoded":return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&");case"application/json":return JSON.stringify(e);default:return e}},t.prototype.setHeaders=function(e,t){for(var n in t)t.hasOwnProperty(n)&&e.setRequestHeader(n,t[n])},t.prototype.getHeader=function(e,t){for(var n in e)if(n.toLowerCase()===t.toLowerCase())return e[n]},t.prototype.setupEvents=function(e,t){var n,r,i=t.progressSubscriber;function o(e){var t,n=o,r=n.subscriber,i=n.progressSubscriber,s=n.request;i&&i.error(e);try{t=new Tg(this,s)}catch(e){t=e}r.error(t)}function s(e){}function a(e){var t=a,n=t.subscriber,r=t.progressSubscriber,i=t.request;if(4===this.readyState){var o=1223===this.status?204:this.status,s="text"===this.responseType?this.response||this.responseText:this.response;if(0===o&&(o=s?200:0),o<400)r&&r.complete(),n.next(e),n.complete();else{r&&r.error(e);var c=void 0;try{c=new mg("ajax error "+o,this,i)}catch(e){c=e}n.error(c)}}}e.ontimeout=o,o.request=t,o.subscriber=this,o.progressSubscriber=i,e.upload&&"withCredentials"in e&&(i&&(n=function(e){n.progressSubscriber.next(e)},cg.XDomainRequest?e.onprogress=n:e.upload.onprogress=n,n.progressSubscriber=i),r=function(e){var t,n=r,i=n.progressSubscriber,o=n.subscriber,s=n.request;i&&i.error(e);try{t=new mg("ajax error",this,s)}catch(e){t=e}o.error(t)},e.onerror=r,r.request=t,r.subscriber=this,r.progressSubscriber=i),e.onreadystatechange=s,s.subscriber=this,s.progressSubscriber=i,s.request=t,e.onload=a,a.subscriber=this,a.progressSubscriber=i,a.request=t},t.prototype.unsubscribe=function(){var t=this.done,n=this.xhr;!t&&n&&4!==n.readyState&&"function"==typeof n.abort&&n.abort(),e.prototype.unsubscribe.call(this)},t}(T),_g=function(e,t,n){this.originalEvent=e,this.xhr=t,this.request=n,this.status=t.status,this.responseType=t.responseType||n.responseType,this.response=Ig(this.responseType,t)},mg=function(){function e(e,t,n){return Error.call(this),this.message=e,this.name="AjaxError",this.xhr=t,this.request=n,this.status=t.status,this.responseType=t.responseType||n.responseType,this.response=Ig(this.responseType,t),this}return e.prototype=Object.create(Error.prototype),e}();function Ig(e,t){switch(e){case"json":return function(e){return"response"in e?e.responseType?e.response:JSON.parse(e.response||e.responseText||"null"):JSON.parse(e.responseText||"null")}(t);case"xml":return t.responseXML;default:return"response"in t?t.response:t.responseText}}var Tg=function(e,t){return mg.call(this,"ajax timeout",e,t),this.name="AjaxTimeoutError",this},Rg=Eg.create,vg=Uint8Array,yg=Uint16Array,Sg=Uint32Array,Cg=new vg([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Og=new vg([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),bg=new vg([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),wg=function(e,t){for(var n=new yg(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new Sg(n[30]);for(r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return[n,i]},Ng=wg(Cg,2),Dg=Ng[0],Lg=Ng[1];Dg[28]=258,Lg[258]=28;for(var Pg=wg(Og,0)[0],kg=new yg(32768),xg=0;xg<32768;++xg){var Mg=(43690&xg)>>>1|(21845&xg)<<1;Mg=(61680&(Mg=(52428&Mg)>>>2|(13107&Mg)<<2))>>>4|(3855&Mg)<<4,kg[xg]=((65280&Mg)>>>8|(255&Mg)<<8)>>>1}var Ug=function(e,t,n){for(var r=e.length,i=0,o=new yg(t);i<r;++i)++o[e[i]-1];var s,a=new yg(t);for(i=0;i<t;++i)a[i]=a[i-1]+o[i-1]<<1;if(n){s=new yg(1<<t);var c=15-t;for(i=0;i<r;++i)if(e[i])for(var u=i<<4|e[i],l=t-e[i],d=a[e[i]-1]++<<l,h=d|(1<<l)-1;d<=h;++d)s[kg[d]>>>c]=u}else for(s=new yg(r),i=0;i<r;++i)e[i]&&(s[i]=kg[a[e[i]-1]++]>>>15-e[i]);return s},Bg=new vg(288);for(xg=0;xg<144;++xg)Bg[xg]=8;for(xg=144;xg<256;++xg)Bg[xg]=9;for(xg=256;xg<280;++xg)Bg[xg]=7;for(xg=280;xg<288;++xg)Bg[xg]=8;var Fg=new vg(32);for(xg=0;xg<32;++xg)Fg[xg]=5;var Vg=Ug(Bg,9,1),Gg=Ug(Fg,5,1),Qg=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},jg=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&n},Hg=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(7&t)},Wg=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof yg?yg:e instanceof Sg?Sg:vg)(n-t);return r.set(e.subarray(t,n)),r},Yg=new vg(0),Kg=function(e,t){return e[t]|e[t+1]<<8},$g=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},zg=function(e,t){return $g(e,t)+4294967296*$g(e,t+4)};function qg(e,t){return function(e,t,n){var r=e.length;if(!r||n&&!n.l&&r<5)return t||new vg(0);var i=!t||n,o=!n||n.i;n||(n={}),t||(t=new vg(3*r));var s,a=function(e){var n=t.length;if(e>n){var r=new vg(Math.max(2*n,e));r.set(t),t=r}},c=n.f||0,u=n.p||0,l=n.b||0,d=n.l,h=n.d,p=n.m,f=n.n,A=8*r;do{if(!d){n.f=c=jg(e,u,1);var E=jg(e,u+1,3);if(u+=3,!E){var g=e[(b=((s=u)/8|0)+(7&s&&1)+4)-4]|e[b-3]<<8,_=b+g;if(_>r){if(o)throw"unexpected EOF";break}i&&a(l+g),t.set(e.subarray(b,_),l),n.b=l+=g,n.p=u=8*_;continue}if(1==E)d=Vg,h=Gg,p=9,f=5;else{if(2!=E)throw"invalid block type";var m=jg(e,u,31)+257,I=jg(e,u+10,15)+4,T=m+jg(e,u+5,31)+1;u+=14;for(var R=new vg(T),v=new vg(19),y=0;y<I;++y)v[bg[y]]=jg(e,u+3*y,7);u+=3*I;var S=Qg(v),C=(1<<S)-1,O=Ug(v,S,1);for(y=0;y<T;){var b,w=O[jg(e,u,C)];if(u+=15&w,(b=w>>>4)<16)R[y++]=b;else{var N=0,D=0;for(16==b?(D=3+jg(e,u,3),u+=2,N=R[y-1]):17==b?(D=3+jg(e,u,7),u+=3):18==b&&(D=11+jg(e,u,127),u+=7);D--;)R[y++]=N}}var L=R.subarray(0,m),P=R.subarray(m);p=Qg(L),f=Qg(P),d=Ug(L,p,1),h=Ug(P,f,1)}if(u>A){if(o)throw"unexpected EOF";break}}i&&a(l+131072);for(var k=(1<<p)-1,x=(1<<f)-1,M=u;;M=u){var U=(N=d[Hg(e,u)&k])>>>4;if((u+=15&N)>A){if(o)throw"unexpected EOF";break}if(!N)throw"invalid length/literal";if(U<256)t[l++]=U;else{if(256==U){M=u,d=null;break}var B=U-254;if(U>264){var F=Cg[y=U-257];B=jg(e,u,(1<<F)-1)+Dg[y],u+=F}var V=h[Hg(e,u)&x],G=V>>>4;if(!V)throw"invalid distance";if(u+=15&V,P=Pg[G],G>3&&(F=Og[G],P+=Hg(e,u)&(1<<F)-1,u+=F),u>A){if(o)throw"unexpected EOF";break}i&&a(l+131072);for(var Q=l+B;l<Q;l+=4)t[l]=t[l-P],t[l+1]=t[l+1-P],t[l+2]=t[l+2-P],t[l+3]=t[l+3-P];l=Q}}n.l=d,n.p=M,n.b=l,d&&(c=1,n.m=p,n.d=h,n.n=f)}while(!c);return l==t.length?t:Wg(t,0,l)}(e,t)}var Jg="undefined"!=typeof TextDecoder&&new TextDecoder;try{Jg.decode(Yg,{stream:!0})}catch(qn){}function Xg(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}if(Jg)return Jg.decode(e);var i=function(e){for(var t="",n=0;;){var r=e[n++],i=(r>127)+(r>223)+(r>239);if(n+i>e.length)return[t,Wg(e,n-1)];i?3==i?(r=((15&r)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536,t+=String.fromCharCode(55296|r>>10,56320|1023&r)):t+=1&i?String.fromCharCode((31&r)<<6|63&e[n++]):String.fromCharCode((15&r)<<12|(63&e[n++])<<6|63&e[n++]):t+=String.fromCharCode(r)}}(e),o=i[0];if(i[1].length)throw"invalid utf-8 data";return o}var Zg=function(e,t){return t+30+Kg(e,t+26)+Kg(e,t+28)},e_=function(e,t,n){var r=Kg(e,t+28),i=Xg(e.subarray(t+46,t+46+r),!(2048&Kg(e,t+8))),o=t+46+r,s=$g(e,t+20),a=n&&4294967295==s?t_(e,o):[s,$g(e,t+24),$g(e,t+42)],c=a[0],u=a[1],l=a[2];return[Kg(e,t+10),c,u,i,o+Kg(e,t+30)+Kg(e,t+32),l]},t_=function(e,t){for(;1!=Kg(e,t);t+=4+Kg(e,t+2));return[zg(e,t+12),zg(e,t+4),zg(e,t+20)]};function n_(e){if(e)for(var t=0;t<e.length;t++)e[t]=~e[t];return e}var r_=function(){function e(e,t){this.jsonModel=e,this.weights=t}return e.prototype.load=function(){return t(this,void 0,void 0,(function(){var e,t,r,i;return n(this,(function(n){switch(n.label){case 0:return e={modelTopology:this.jsonModel.modelTopology,format:this.jsonModel.format,generatedBy:this.jsonModel.generatedBy,convertedBy:this.jsonModel.convertedBy},null==this.jsonModel.weightsManifest?[3,2]:[4,this.loadWeights()];case 1:t=n.sent(),r=t[0],i=t[1],e.weightSpecs=r,e.weightData=i,n.label=2;case 2:return null!=this.jsonModel.trainingConfig&&(e.trainingConfig=this.jsonModel.trainingConfig),null!=this.jsonModel.userDefinedMetadata&&(e.userDefinedMetadata=this.jsonModel.userDefinedMetadata),[2,e]}}))}))},e.prototype.loadWeights=function(){return t(this,void 0,void 0,(function(){var e,t,r,i,o,s,a,c;return n(this,(function(n){for(e=[],t=[],r=0,i=this.jsonModel.weightsManifest;r<i.length;r++){for(o=i[r],s=0,a=o.paths;s<a.length;s++){if(c=a[s],!this.weights[c])throw new Error("Error loading weights: cannot find ".concat(c));e.push(this.weights[c])}t.push.apply(t,o.weights)}return[2,[t,this.toArrayBuffer(e)]]}))}))},e.prototype.toArrayBuffer=function(e){if(Array.isArray(e)){for(var t=0,n=0,r=e;n<r.length;n++)t+=r[n].length;for(var i=new ArrayBuffer(t),o=new Uint8Array(i),s=0,a=0,c=e;a<c.length;a++)s+=c[a].copy(o,s);return i}return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)},e}();function i_(e,t){var n=new ae(0),r=new ae(0),i=new ae(0),o=new ae(0),s=Q([n,r,i,o]).pipe(K((function(e){return e.reduce((function(t,n){return t+n/e.length}),0)})));if("string"==typeof e){var a=function(e,t){return Rg({url:e,method:"GET",responseType:"arraybuffer",async:!0,progressSubscriber:new T((function(e){return t.next(e.loaded/e.total)}),(function(e){}),(function(){return t.next(1)}))}).pipe(ce(2))}(e,n).pipe(de((function(e){return o_(e.response)})),de((function(e){return s_(e,t,r).pipe(K((function(t){return{jszip:e,config:t}})))})),de((function(e){var t=e.jszip,n=e.config;return a_(t,n,i).pipe(K((function(e){return{jszip:t,config:n,jsonModel:e}})))})),de((function(e){var t=e.jszip,n=e.config,r=e.jsonModel;return c_(t,r,o).pipe(K((function(e){return{config:n,jsonModel:r,weights:e}})))})),de((function(e){var t=e.config,n=e.jsonModel,r=e.weights;return W(_d(new r_(n,r))).pipe(K((function(e){return{config:t,graphModel:e}})))})));return{model$:a,progress$:s}}return a=o_(e).pipe(de((function(e){return s_(e,t,r).pipe(K((function(t){return{jszip:e,config:t}})))})),de((function(e){var t=e.jszip,n=e.config;return a_(t,n,i).pipe(K((function(e){return{jszip:t,config:n,jsonModel:e}})))})),de((function(e){var t=e.jszip,n=e.config,r=e.jsonModel;return c_(t,r,o).pipe(K((function(e){return{config:n,jsonModel:r,weights:e}})))})),de((function(e){var t=e.config,n=e.jsonModel,r=e.weights;return W(_d(new r_(n,r))).pipe(K((function(e){return{config:t,graphModel:e}})))}))),{model$:a,progress$:s}}function o_(e){return Y(function(e){for(var t={},n=e.length-22;101010256!=$g(e,n);--n)if(!n||e.length-n>65558)throw"invalid zip file";var r=Kg(e,n+8);if(!r)return{};var i=$g(e,n+16),o=4294967295==i;if(o){if(n=$g(e,n-12),101075792!=$g(e,n))throw"invalid zip file";r=$g(e,n+32),i=$g(e,n+48)}for(var s=0;s<r;++s){var a=e_(e,i,o),c=a[0],u=a[1],l=a[2],d=a[3],h=a[4],p=a[5],f=Zg(e,p);if(i=h,c){if(8!=c)throw"unknown compression type "+c;t[d]=qg(e.subarray(f,f+u),new vg(l))}else t[d]=Wg(e,f,f+u)}return t}(new Uint8Array(e)))}function s_(e,t,n){return e[t]?ge((function(){return n.next(1),Y(JSON.parse(Xg(e[t])))})):J("Unable to retrieve model config: ".concat(t," is missing"))}function a_(e,t,n){return t?e[t.filename]?ge((function(){return n.next(1),Y(JSON.parse(Xg(n_(e[t.filename]))))})):J("Error extracting model: ".concat(t.filename," is missing")):J("Invalid model config")}function c_(e,t,n){if(!t)return J("Unable to extract weights: model is undefined");if(!t.weightsManifest)return n.next(1),Y({});for(var r=0,i=0,o=t.weightsManifest;i<o.length;i++){var s=o[i];r+=s.paths.length}for(var a=new Array(r).fill(0),c={},u=0,l=0,d=t.weightsManifest;l<d.length;l++)for(var h=function(t){if(!e[t])return{value:J("Error extracting weight: ".concat(t," is missing"))};c[t]=ge((function(){var i=e[t];return a[u]=1,n.next(a.reduce((function(e,t){return e+t}),0)/r),Y(n_(yr.from(i,i.byteOffset,i.byteLength)))})),u++},p=0,f=(s=d[l]).paths;p<f.length;p++){var A=h(f[p]);if("object"==typeof A)return A.value}return ig(c)}wt().set("WEBGL_FORCE_F16_TEXTURES",!0);var u_,l_,d_=function(){function r(){this._initialized=!1}return r.prototype.getWidth=function(){return this._modelConfig?this._modelConfig.inWidth:0},r.prototype.getHeight=function(){return this._modelConfig?this._modelConfig.inHeight:0},r.prototype.isInitialized=function(){return this._initialized},r.prototype.getOutput=function(){return this._cnnOutputData},r.prototype.initialize=function(r,i,o){return t(this,void 0,void 0,(function(){var t,s,a,c,u=this;return n(this,(function(n){switch(n.label){case 0:if(null==r)throw"Invalid parameter";return this.release(),this._videoManager=r,this._config=i?e(e({},rg),i):rg,t=i_(this._config.filename,"config.json"),s=t.model$,a=t.progress$,c=a.pipe(K((function(e){return o&&o(e)}))).subscribe(),[4,s.pipe(K((function(e){var t=e.config,n=e.graphModel;u._modelConfig=t,u._model=n;var r=xa([1,u._modelConfig.inHeight,u._modelConfig.inWidth,u._modelConfig.inChannels]),i=u._model.predict(r,{batchSize:1,verbose:!0});Array.isArray(i)?i.forEach((function(e){e.dispose()})):i.dispose(),u._cnnOutput=xa([1,u._modelConfig.inHeight,u._modelConfig.inWidth,1]),r.dispose(),u._initialized=!0})),Z((function(){return c.unsubscribe()}))).toPromise()];case 1:return n.sent(),[2]}}))}))},r.prototype.processSync=function(){var e;if(this._initialized){var t=this._videoManager.getLastBuffer();if(null!=t){var n,r=co(t),i=bu.resizeBilinear(r,[this._modelConfig.inHeight,this._modelConfig.inWidth]),o=Ki(i,"float32"),s=rs(o,[1,this._modelConfig.inHeight,this._modelConfig.inWidth,3]),a=zs(255);if(4==this._modelConfig.inChannels){var c=rs(this._cnnOutput,[1,this._modelConfig.inHeight,this._modelConfig.inWidth,1]),u=No(s,a);n=as([u,c],3),u.dispose(),c.dispose()}else n=No(s,a);var l,d=this._model.predict(n);l=Array.isArray(d)?d[2]:d,null===(e=this._cnnOutput)||void 0===e||e.dispose();var h=l.shape;if(h&&h[3]>1){var p=gc(l);this._cnnOutput=us(p,[0,0,0,1],[-1,-1,-1,1]),p.dispose(),console.log(h),this._cnnOutputData=this._cnnOutput.dataSync()}else this._cnnOutput=_s(l,0,1),this._cnnOutputData=this._cnnOutput.dataSync();Array.isArray(d)?d.forEach((function(e){e.dispose()})):d.dispose(),r.dispose(),i.dispose(),o.dispose(),s.dispose(),a.dispose(),n.dispose()}else console.error("No video frame to process")}else console.error("Foot must be initialized to track")},r.prototype.release=function(){var e,t;null===(e=this._cnnOutput)||void 0===e||e.dispose(),null===(t=this._model)||void 0===t||t.dispose(),this._initialized=!1},r}(),h_=(u_="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t,n,r;e=e||{},t||(t=void 0!==e?e:{}),t.ready=new Promise((function(e,t){n=e,r=t}));var i=Object.assign({},t),o="./this.program",s="";"undefined"!=typeof document&&document.currentScript&&(s=document.currentScript.src),u_&&(s=u_),s=0!==s.indexOf("blob:")?s.substr(0,s.replace(/[?#].*/,"").lastIndexOf("/")+1):"";var a,c=t.print||console.log.bind(console),u=t.printErr||console.warn.bind(console);Object.assign(t,i),i=null,t.thisProgram&&(o=t.thisProgram),t.wasmBinary&&(a=t.wasmBinary),t.noExitRuntime,"object"!=typeof WebAssembly&&k("no native wasm support detected");var l,d,h,p,f,A,E,g,_,m=!1,I="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function T(e,t){for(var n=t+NaN,r=t;e[r]&&!(r>=n);)++r;if(16<r-t&&e.buffer&&I)return I.decode(e.subarray(t,r));for(n="";t<r;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))n+=String.fromCharCode((31&i)<<6|o);else{var s=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|s:(7&i)<<18|o<<12|s<<6|63&e[t++])?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else n+=String.fromCharCode(i)}return n}function R(e){return e?T(p,e):""}function v(e,t,n,r){if(!(0<r))return 0;var i=n;r=n+r-1;for(var o=0;o<e.length;++o){var s=e.charCodeAt(o);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o)),127>=s){if(n>=r)break;t[n++]=s}else{if(2047>=s){if(n+1>=r)break;t[n++]=192|s>>6}else{if(65535>=s){if(n+2>=r)break;t[n++]=224|s>>12}else{if(n+3>=r)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63}t[n++]=128|s>>6&63}t[n++]=128|63&s}}return t[n]=0,n-i}function y(){var e=l.buffer;d=e,t.HEAP8=h=new Int8Array(e),t.HEAP16=f=new Int16Array(e),t.HEAP32=A=new Int32Array(e),t.HEAPU8=p=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=E=new Uint32Array(e),t.HEAPF32=g=new Float32Array(e),t.HEAPF64=_=new Float64Array(e)}var S=[],C=[],O=[];function b(){var e=t.preRun.shift();S.unshift(e)}var w,N,D,L=0,P=null;function k(e){throw t.onAbort&&t.onAbort(e),u(e="Aborted("+e+")"),m=!0,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),r(e),e}function x(){return w.startsWith("data:application/octet-stream;base64,")}if(w="libxzimgPoseEstimation.wasm",!x()){var M=w;w=t.locateFile?t.locateFile(M,s):s+M}function U(){var e=w;try{if(e==w&&a)return new Uint8Array(a);throw"both async and sync fetching of the wasm failed"}catch(e){k(e)}}function B(e){for(;0<e.length;)e.shift()(t)}function F(e){this.F=e-24,this.ta=function(e){E[this.F+4>>2]=e},this.oa=function(e){E[this.F+8>>2]=e},this.pa=function(){A[this.F>>2]=0},this.ma=function(){h[this.F+12>>0]=0},this.qa=function(){h[this.F+13>>0]=0},this.I=function(e,t){this.la(),this.ta(e),this.oa(t),this.pa(),this.ma(),this.qa()},this.la=function(){E[this.F+16>>2]=0}}var V=(e,t)=>{for(var n=0,r=e.length-1;0<=r;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n;n--)e.unshift("..");return e},G=e=>{var t="/"===e.charAt(0),n="/"===e.substr(-1);return(e=V(e.split("/").filter((e=>!!e)),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},Q=e=>{var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1);return e=t[0],t=t[1],e||t?(t&&(t=t.substr(0,t.length-1)),e+t):"."},j=e=>{if("/"===e)return"/";var t=(e=(e=G(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)};function H(){for(var e="",t=!1,n=arguments.length-1;-1<=n&&!t;n--){if("string"!=typeof(t=0<=n?arguments[n]:"/"))throw new TypeError("Arguments to path.resolve must be strings");if(!t)return"";e=t+"/"+e,t="/"===t.charAt(0)}return(t?"/":"")+(e=V(e.split("/").filter((e=>!!e)),!t).join("/"))||"."}function W(e,t){for(var n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);127>=i?n++:2047>=i?n+=2:55296<=i&&57343>=i?(n+=4,++r):n+=3}return e=v(e,n=Array(n+1),0,n.length),t&&(n.length=e),n}var Y=[];function K(e,t){Y[e]={input:[],m:[],J:t},Te(e,X)}var $,z,q,J,X={open:function(e){var t=Y[e.node.P];if(!t)throw new ce(43);e.l=t,e.seekable=!1},close:function(e){e.l.J.M(e.l)},M:function(e){e.l.J.M(e.l)},read:function(e,t,n,r){if(!e.l||!e.l.J.ca)throw new ce(60);for(var i=0,o=0;o<r;o++){try{var s=e.l.J.ca(e.l)}catch(e){throw new ce(29)}if(void 0===s&&0===i)throw new ce(6);if(null==s)break;i++,t[n+o]=s}return i&&(e.node.timestamp=Date.now()),i},write:function(e,t,n,r){if(!e.l||!e.l.J.V)throw new ce(60);try{for(var i=0;i<r;i++)e.l.J.V(e.l,t[n+i])}catch(e){throw new ce(29)}return r&&(e.node.timestamp=Date.now()),i}},Z={ca:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n"),!t)return null;e.input=W(t,!0)}return e.input.shift()},V:function(e,t){null===t||10===t?(c(T(e.m,0)),e.m=[]):0!=t&&e.m.push(t)},M:function(e){e.m&&0<e.m.length&&(c(T(e.m,0)),e.m=[])}},ee={V:function(e,t){null===t||10===t?(u(T(e.m,0)),e.m=[]):0!=t&&e.m.push(t)},M:function(e){e.m&&0<e.m.length&&(u(T(e.m,0)),e.m=[])}},te={o:null,v:function(){return te.createNode(null,"/",16895,0)},createNode:function(e,t,n,r){if(24576==(61440&n)||4096==(61440&n))throw new ce(63);return te.o||(te.o={dir:{node:{B:te.h.B,s:te.h.s,K:te.h.K,N:te.h.N,ha:te.h.ha,ja:te.h.ja,ia:te.h.ia,ga:te.h.ga,R:te.h.R},stream:{D:te.i.D}},file:{node:{B:te.h.B,s:te.h.s},stream:{D:te.i.D,read:te.i.read,write:te.i.write,Y:te.i.Y,da:te.i.da,fa:te.i.fa}},link:{node:{B:te.h.B,s:te.h.s,L:te.h.L},stream:{}},Z:{node:{B:te.h.B,s:te.h.s},stream:Ie}}),16384==(61440&(n=fe(e,t,n,r)).mode)?(n.h=te.o.dir.node,n.i=te.o.dir.stream,n.g={}):32768==(61440&n.mode)?(n.h=te.o.file.node,n.i=te.o.file.stream,n.j=0,n.g=null):40960==(61440&n.mode)?(n.h=te.o.link.node,n.i=te.o.link.stream):8192==(61440&n.mode)&&(n.h=te.o.Z.node,n.i=te.o.Z.stream),n.timestamp=Date.now(),e&&(e.g[t]=n,e.timestamp=n.timestamp),n},Ga:function(e){return e.g?e.g.subarray?e.g.subarray(0,e.j):new Uint8Array(e.g):new Uint8Array(0)},$:function(e,t){var n=e.g?e.g.length:0;n>=t||(t=Math.max(t,n*(1048576>n?2:1.125)>>>0),0!=n&&(t=Math.max(t,256)),n=e.g,e.g=new Uint8Array(t),0<e.j&&e.g.set(n.subarray(0,e.j),0))},ua:function(e,t){if(e.j!=t)if(0==t)e.g=null,e.j=0;else{var n=e.g;e.g=new Uint8Array(t),n&&e.g.set(n.subarray(0,Math.min(t,e.j))),e.j=t}},h:{B:function(e){var t={};return t.Fa=8192==(61440&e.mode)?e.id:1,t.Ia=e.id,t.mode=e.mode,t.Ka=1,t.uid=0,t.Ha=0,t.P=e.P,16384==(61440&e.mode)?t.size=4096:32768==(61440&e.mode)?t.size=e.j:40960==(61440&e.mode)?t.size=e.link.length:t.size=0,t.Ca=new Date(e.timestamp),t.Ja=new Date(e.timestamp),t.Ea=new Date(e.timestamp),t.ka=4096,t.Da=Math.ceil(t.size/t.ka),t},s:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&te.ua(e,t.size)},K:function(){throw ue[44]},N:function(e,t,n,r){return te.createNode(e,t,n,r)},ha:function(e,t,n){if(16384==(61440&e.mode)){try{var r=pe(t,n)}catch(e){}if(r)for(var i in r.g)throw new ce(55)}delete e.parent.g[e.name],e.parent.timestamp=Date.now(),e.name=n,t.g[n]=e,t.timestamp=e.parent.timestamp,e.parent=t},ja:function(e,t){delete e.g[t],e.timestamp=Date.now()},ia:function(e,t){var n,r=pe(e,t);for(n in r.g)throw new ce(55);delete e.g[t],e.timestamp=Date.now()},ga:function(e){var t,n=[".",".."];for(t in e.g)e.g.hasOwnProperty(t)&&n.push(t);return n},R:function(e,t,n){return(e=te.createNode(e,t,41471,0)).link=n,e},L:function(e){if(40960!=(61440&e.mode))throw new ce(28);return e.link}},i:{read:function(e,t,n,r,i){var o=e.node.g;if(i>=e.node.j)return 0;if(8<(e=Math.min(e.node.j-i,r))&&o.subarray)t.set(o.subarray(i,i+e),n);else for(r=0;r<e;r++)t[n+r]=o[i+r];return e},write:function(e,t,n,r,i,o){if(t.buffer===h.buffer&&(o=!1),!r)return 0;if((e=e.node).timestamp=Date.now(),t.subarray&&(!e.g||e.g.subarray)){if(o)return e.g=t.subarray(n,n+r),e.j=r;if(0===e.j&&0===i)return e.g=t.slice(n,n+r),e.j=r;if(i+r<=e.j)return e.g.set(t.subarray(n,n+r),i),r}if(te.$(e,i+r),e.g.subarray&&t.subarray)e.g.set(t.subarray(n,n+r),i);else for(o=0;o<r;o++)e.g[i+o]=t[n+o];return e.j=Math.max(e.j,i+r),r},D:function(e,t,n){if(1===n?t+=e.position:2===n&&32768==(61440&e.node.mode)&&(t+=e.node.j),0>t)throw new ce(28);return t},Y:function(e,t,n){te.$(e.node,t+n),e.node.j=Math.max(e.node.j,t+n)},da:function(e,t,n,r,i){if(32768!=(61440&e.node.mode))throw new ce(43);if(e=e.node.g,2&i||e.buffer!==d){if((0<n||n+t<e.length)&&(e=e.subarray?e.subarray(n,n+t):Array.prototype.slice.call(e,n,n+t)),n=!0,k(),!(t=void 0))throw new ce(48);h.set(e,t)}else n=!1,t=e.byteOffset;return{F:t,Ba:n}},fa:function(e,t,n,r,i){if(32768!=(61440&e.node.mode))throw new ce(43);return 2&i||te.i.write(e,t,0,r,n,!1),0}}},ne=null,re={},ie=[],oe=1,se=null,ae=!0,ce=null,ue={},le=(e,t={})=>{if(!(e=H("/",e)))return{path:"",node:null};if(8<(t=Object.assign({ba:!0,W:0},t)).W)throw new ce(32);e=V(e.split("/").filter((e=>!!e)),!1);for(var n=ne,r="/",i=0;i<e.length;i++){var o=i===e.length-1;if(o&&t.parent)break;if(n=pe(n,e[i]),r=G(r+"/"+e[i]),n.O&&(!o||o&&t.ba)&&(n=n.O.root),!o||t.aa)for(o=0;40960==(61440&n.mode);)if(n=Ce(r),r=H(Q(r),n),n=le(r,{W:t.W+1}).node,40<o++)throw new ce(32)}return{path:r,node:n}},de=e=>{for(var t;;){if(e===e.parent)return e=e.v.ea,t?"/"!==e[e.length-1]?e+"/"+t:e+t:e;t=t?e.name+"/"+t:e.name,e=e.parent}},he=(e,t)=>{for(var n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r)|0;return(e+n>>>0)%se.length},pe=(e,t)=>{var n;if(n=(n=ge(e,"x"))?n:e.h.K?0:2)throw new ce(n,e);for(n=se[he(e.id,t)];n;n=n.sa){var r=n.name;if(n.parent.id===e.id&&r===t)return n}return e.h.K(e,t)},fe=(e,t,n,r)=>(e=new Qe(e,t,n,r),t=he(e.parent.id,e.name),e.sa=se[t],se[t]=e),Ae={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},Ee=e=>{var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},ge=(e,t)=>ae?0:!t.includes("r")||292&e.mode?t.includes("w")&&!(146&e.mode)||t.includes("x")&&!(73&e.mode)?2:0:2,_e=(e,t)=>{try{return pe(e,t),20}catch(e){}return ge(e,"wx")},me=(e,t)=>(q||((q=function(){this.I={}}).prototype={},Object.defineProperties(q.prototype,{object:{get:function(){return this.node},set:function(e){this.node=e}},flags:{get:function(){return this.I.flags},set:function(e){this.I.flags=e}},position:{get:function(){return this.I.position},set:function(e){this.I.position=e}}})),e=Object.assign(new q,e),t=((e=0)=>{for(;4096>=e;e++)if(!ie[e])return e;throw new ce(33)})(t),e.A=t,ie[t]=e),Ie={open:e=>{e.i=re[e.node.P].i,e.i.open&&e.i.open(e)},D:()=>{throw new ce(70)}},Te=(e,t)=>{re[e]={i:t}},Re=(e,t)=>{var n="/"===t,r=!t;if(n&&ne)throw new ce(10);if(!n&&!r){var i=le(t,{ba:!1});if(t=i.path,(i=i.node).O)throw new ce(10);if(16384!=(61440&i.mode))throw new ce(54)}t={type:e,La:{},ea:t,ra:[]},(e=e.v(t)).v=t,t.root=e,n?ne=e:i&&(i.O=t,i.v&&i.v.ra.push(t))},ve=(e,t,n)=>{var r=le(e,{parent:!0}).node;if(!(e=j(e))||"."===e||".."===e)throw new ce(28);var i=_e(r,e);if(i)throw new ce(i);if(!r.h.N)throw new ce(63);return r.h.N(r,e,t,n)},ye=(e,t,n)=>{void 0===n&&(n=t,t=438),ve(e,8192|t,n)},Se=(e,t)=>{if(!H(e))throw new ce(44);var n=le(t,{parent:!0}).node;if(!n)throw new ce(44);t=j(t);var r=_e(n,t);if(r)throw new ce(r);if(!n.h.R)throw new ce(63);n.h.R(n,t,e)},Ce=e=>{if(!(e=le(e).node))throw new ce(44);if(!e.h.L)throw new ce(28);return H(de(e.parent),e.h.L(e))},Oe=(e,n,r)=>{if(""===e)throw new ce(44);if("string"==typeof n){var i=Ae[n];if(void 0===i)throw Error("Unknown file open mode: "+n);n=i}if(r=64&n?4095&(void 0===r?438:r)|32768:0,"object"==typeof e)var o=e;else{e=G(e);try{o=le(e,{aa:!(131072&n)}).node}catch(e){}}if(i=!1,64&n)if(o){if(128&n)throw new ce(20)}else o=ve(e,r,0),i=!0;if(!o)throw new ce(44);if(8192==(61440&o.mode)&&(n&=-513),65536&n&&16384!=(61440&o.mode))throw new ce(54);if(!i&&(r=o?40960==(61440&o.mode)?32:16384==(61440&o.mode)&&("r"!==Ee(n)||512&n)?31:ge(o,Ee(n)):44))throw new ce(r);if(512&n&&!i){if(!(r="string"==typeof(r=o)?le(r,{aa:!0}).node:r).h.s)throw new ce(63);if(16384==(61440&r.mode))throw new ce(31);if(32768!=(61440&r.mode))throw new ce(28);if(i=ge(r,"w"))throw new ce(i);r.h.s(r,{size:0,timestamp:Date.now()})}return n&=-131713,(o=me({node:o,path:de(o),flags:n,seekable:!0,position:0,i:o.i,Aa:[],error:!1})).i.open&&o.i.open(o),!t.logReadFiles||1&n||(J||(J={}),e in J||(J[e]=1)),o},be=(e,t,n)=>{if(null===e.A)throw new ce(8);if(!e.seekable||!e.i.D)throw new ce(70);if(0!=n&&1!=n&&2!=n)throw new ce(28);e.position=e.i.D(e,t,n),e.Aa=[]},we=()=>{ce||((ce=function(e,t){this.node=t,this.va=function(e){this.C=e},this.va(e),this.message="FS error"}).prototype=Error(),ce.prototype.constructor=ce,[44].forEach((e=>{ue[e]=new ce(e),ue[e].stack="<generic error, no stack>"})))},Ne=(e,t,n)=>{e=G("/dev/"+e);var r=((e,t)=>{var n=0;return e&&(n|=365),t&&(n|=146),n})(!!t,!!n);z||(z=64);var i=z++<<8|0;Te(i,{open:e=>{e.seekable=!1},close:()=>{n&&n.buffer&&n.buffer.length&&n(10)},read:(e,n,r,i)=>{for(var o=0,s=0;s<i;s++){try{var a=t()}catch(e){throw new ce(29)}if(void 0===a&&0===o)throw new ce(6);if(null==a)break;o++,n[r+s]=a}return o&&(e.node.timestamp=Date.now()),o},write:(e,t,r,i)=>{for(var o=0;o<i;o++)try{n(t[r+o])}catch(e){throw new ce(29)}return i&&(e.node.timestamp=Date.now()),o}}),ye(e,r,i)},De={},Le=void 0;function Pe(){return A[(Le+=4)-4>>2]}function ke(e){if(!(e=ie[e]))throw new ce(8);return e}var xe,Me={};function Ue(){if(!xe){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:o||"./this.program"};for(e in Me)void 0===Me[e]?delete t[e]:t[e]=Me[e];var n=[];for(e in t)n.push(e+"="+t[e]);xe=n}return xe}function Be(e){return 0==e%4&&(0!=e%100||0==e%400)}var Fe=[31,29,31,30,31,30,31,31,30,31,30,31],Ve=[31,28,31,30,31,30,31,31,30,31,30,31];function Ge(e,n,r,i){var o={string:e=>{var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);t=ze(n),v(e,p,t,n)}return t},array:e=>{var t=ze(e.length);return h.set(e,t),t}};e=t["_"+e];var s,a=[],c=0;if(i)for(var u=0;u<i.length;u++){var l=o[r[u]];l?(0===c&&(c=Ke()),a[u]=l(i[u])):a[u]=i[u]}return s=r=e.apply(null,a),0!==c&&$e(c),"string"===n?R(s):"boolean"===n?!!s:s}function Qe(e,t,n,r){e||(e=this),this.parent=e,this.v=e.v,this.O=null,this.id=oe++,this.name=t,this.mode=n,this.h={},this.i={},this.P=r}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le"),Object.defineProperties(Qe.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}}}),we(),se=Array(4096),Re(te,"/"),ve("/tmp",16895,0),ve("/home",16895,0),ve("/home/web_user",16895,0),(()=>{ve("/dev",16895,0),Te(259,{read:()=>0,write:(e,t,n,r)=>r}),ye("/dev/null",259),K(1280,Z),K(1536,ee),ye("/dev/tty",1280),ye("/dev/tty1",1536);var e=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}return()=>k("randomDevice")}();Ne("random",e),Ne("urandom",e),ve("/dev/shm",16895,0),ve("/dev/shm/tmp",16895,0)})(),(()=>{ve("/proc",16895,0);var e=ve("/proc/self",16895,0);ve("/proc/self/fd",16895,0),Re({v:()=>{var t=fe(e,"fd",16895,73);return t.h={K:(e,t)=>{var n=ie[+t];if(!n)throw new ce(8);return(e={parent:null,v:{ea:"fake"},h:{L:()=>n.path}}).parent=e}},t}},"/proc/self/fd")})();var je={__assert_fail:function(e,t,n,r){k("Assertion failed: "+R(e)+", at: "+[t?R(t):"unknown filename",n,r?R(r):"unknown function"])},__cxa_allocate_exception:function(e){return He(e+24)+24},__cxa_throw:function(e,t,n){throw new F(e).I(t,n),e},__syscall_fcntl64:function(e,t,n){Le=n;try{var r=ke(e);switch(t){case 0:var i=Pe();return 0>i?-28:me(r,i).A;case 1:case 2:case 6:case 7:return 0;case 3:return r.flags;case 4:return i=Pe(),r.flags|=i,0;case 5:return i=Pe(),f[i+0>>1]=2,0;case 16:case 8:default:return-28;case 9:return A[Ye()>>2]=28,-1}}catch(e){if(void 0===De||!(e instanceof ce))throw e;return-e.C}},__syscall_ioctl:function(e,t,n){Le=n;try{var r=ke(e);switch(t){case 21509:case 21505:case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:case 21523:case 21524:return r.l?0:-59;case 21519:if(!r.l)return-59;var i=Pe();return A[i>>2]=0;case 21520:return r.l?-28:-59;case 21531:if(e=i=Pe(),!r.i.na)throw new ce(59);return r.i.na(r,t,e);default:return-28}}catch(e){if(void 0===De||!(e instanceof ce))throw e;return-e.C}},__syscall_openat:function(e,t,n,r){Le=r;try{var i=t=R(t);if("/"===i.charAt(0))t=i;else{var o=-100===e?"/":ke(e).path;if(0==i.length)throw new ce(44);t=G(o+"/"+i)}var s=r?Pe():0;return Oe(t,n,s).A}catch(e){if(void 0===De||!(e instanceof ce))throw e;return-e.C}},abort:function(){k("")},emscripten_memcpy_big:function(e,t,n){p.copyWithin(e,t,t+n)},emscripten_resize_heap:function(e){var t=p.length;if(2147483648<(e>>>=0))return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);var i=Math;r=Math.max(e,r),i=i.min.call(i,2147483648,r+(65536-r%65536)%65536);e:{try{l.grow(i-d.byteLength+65535>>>16),y();var o=1;break e}catch(e){}o=void 0}if(o)return!0}return!1},environ_get:function(e,t){var n=0;return Ue().forEach((function(r,i){var o=t+n;for(i=E[e+4*i>>2]=o,o=0;o<r.length;++o)h[i++>>0]=r.charCodeAt(o);h[i>>0]=0,n+=r.length+1})),0},environ_sizes_get:function(e,t){var n=Ue();E[e>>2]=n.length;var r=0;return n.forEach((function(e){r+=e.length+1})),E[t>>2]=r,0},fd_close:function(e){try{var t=ke(e);if(null===t.A)throw new ce(8);t.U&&(t.U=null);try{t.i.close&&t.i.close(t)}catch(e){throw e}finally{ie[t.A]=null}return t.A=null,0}catch(e){if(void 0===De||!(e instanceof ce))throw e;return e.C}},fd_read:function(e,t,n,r){try{e:{var i=ke(e);e=t;for(var o=t=0;o<n;o++){var s=E[e>>2],a=E[e+4>>2];e+=8;var c=i,u=s,l=a,d=void 0,p=h;if(0>l||0>d)throw new ce(28);if(null===c.A)throw new ce(8);if(1==(2097155&c.flags))throw new ce(8);if(16384==(61440&c.node.mode))throw new ce(31);if(!c.i.read)throw new ce(28);var f=void 0!==d;if(f){if(!c.seekable)throw new ce(70)}else d=c.position;var A=c.i.read(c,p,u,l,d);f||(c.position+=A);var g=A;if(0>g){var _=-1;break e}if(t+=g,g<a)break}_=t}return E[r>>2]=_,0}catch(e){if(void 0===De||!(e instanceof ce))throw e;return e.C}},fd_seek:function(e,t,n,r,i){try{if(t=n+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*n:NaN,isNaN(t))return 61;var o=ke(e);return be(o,t,r),D=[o.position>>>0,(N=o.position,1<=+Math.abs(N)?0<N?(0|Math.min(+Math.floor(N/4294967296),4294967295))>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],A[i>>2]=D[0],A[i+4>>2]=D[1],o.U&&0===t&&0===r&&(o.U=null),0}catch(e){if(void 0===De||!(e instanceof ce))throw e;return e.C}},fd_write:function(e,t,n,r){try{e:{var i=ke(e);e=t;for(var o=t=0;o<n;o++){var s=E[e>>2],a=E[e+4>>2];e+=8;var c=i,u=s,l=a,d=void 0,p=h;if(0>l||0>d)throw new ce(28);if(null===c.A)throw new ce(8);if(0==(2097155&c.flags))throw new ce(8);if(16384==(61440&c.node.mode))throw new ce(31);if(!c.i.write)throw new ce(28);c.seekable&&1024&c.flags&&be(c,0,2);var f=void 0!==d;if(f){if(!c.seekable)throw new ce(70)}else d=c.position;var A=c.i.write(c,p,u,l,d,void 0);f||(c.position+=A);var g=A;if(0>g){var _=-1;break e}t+=g}_=t}return E[r>>2]=_,0}catch(e){if(void 0===De||!(e instanceof ce))throw e;return e.C}},strftime_l:function(e,t,n,r){return function(e,t,n,r){function i(e,t,n){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function o(e,t){return i(e,t,"0")}function s(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function a(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function c(e){var t=e.G;for(e=new Date(new Date(e.H+1900,0,1).getTime());0<t;){var n=e.getMonth(),r=(Be(e.getFullYear())?Fe:Ve)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return n=new Date(e.getFullYear()+1,0,4),t=a(new Date(e.getFullYear(),0,4)),n=a(n),0>=s(t,e)?0>=s(n,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var u=A[r+40>>2];for(var l in r={ya:A[r>>2],xa:A[r+4>>2],S:A[r+8>>2],X:A[r+12>>2],T:A[r+16>>2],H:A[r+20>>2],u:A[r+24>>2],G:A[r+28>>2],Ma:A[r+32>>2],wa:A[r+36>>2],za:u?R(u):""},n=R(n),u={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(l,"g"),u[l]);var d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),p="January February March April May June July August September October November December".split(" ");for(l in u={"%a":function(e){return d[e.u].substring(0,3)},"%A":function(e){return d[e.u]},"%b":function(e){return p[e.T].substring(0,3)},"%B":function(e){return p[e.T]},"%C":function(e){return o((e.H+1900)/100|0,2)},"%d":function(e){return o(e.X,2)},"%e":function(e){return i(e.X,2," ")},"%g":function(e){return c(e).toString().substring(2)},"%G":function(e){return c(e)},"%H":function(e){return o(e.S,2)},"%I":function(e){return 0==(e=e.S)?e=12:12<e&&(e-=12),o(e,2)},"%j":function(e){for(var t=0,n=0;n<=e.T-1;t+=(Be(e.H+1900)?Fe:Ve)[n++]);return o(e.X+t,3)},"%m":function(e){return o(e.T+1,2)},"%M":function(e){return o(e.xa,2)},"%n":function(){return"\n"},"%p":function(e){return 0<=e.S&&12>e.S?"AM":"PM"},"%S":function(e){return o(e.ya,2)},"%t":function(){return"\t"},"%u":function(e){return e.u||7},"%U":function(e){return o(Math.floor((e.G+7-e.u)/7),2)},"%V":function(e){var t=Math.floor((e.G+7-(e.u+6)%7)/7);if(2>=(e.u+371-e.G-2)%7&&t++,t)53==t&&(4==(n=(e.u+371-e.G)%7)||3==n&&Be(e.H)||(t=1));else{t=52;var n=(e.u+7-e.G-1)%7;(4==n||5==n&&Be(e.H%400-1))&&t++}return o(t,2)},"%w":function(e){return e.u},"%W":function(e){return o(Math.floor((e.G+7-(e.u+6)%7)/7),2)},"%y":function(e){return(e.H+1900).toString().substring(2)},"%Y":function(e){return e.H+1900},"%z":function(e){var t=0<=(e=e.wa);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":function(e){return e.za},"%%":function(){return"%"}},n=n.replace(/%%/g,"\0\0"),u)n.includes(l)&&(n=n.replace(new RegExp(l,"g"),u[l](r)));return(l=W(n=n.replace(/\0\0/g,"%"),!1)).length>t?0:(h.set(l,e),l.length-1)}(e,t,n,r)}};!function(){function e(e){t.asm=e.exports,l=t.asm.memory,y(),C.unshift(t.asm.__wasm_call_ctors),L--,t.monitorRunDependencies&&t.monitorRunDependencies(L),0==L&&P&&(e=P,P=null,e())}function n(t){e(t.instance)}function i(e){return(a||"function"!=typeof fetch?Promise.resolve().then((function(){return U()})):fetch(w,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+w+"'";return e.arrayBuffer()})).catch((function(){return U()}))).then((function(e){return WebAssembly.instantiate(e,o)})).then((function(e){return e})).then(e,(function(e){u("failed to asynchronously prepare wasm: "+e),k(e)}))}var o={env:je,wasi_snapshot_preview1:je};if(L++,t.monitorRunDependencies&&t.monitorRunDependencies(L),t.instantiateWasm)try{return t.instantiateWasm(o,e)}catch(e){return u("Module.instantiateWasm callback failed with error: "+e),!1}(a||"function"!=typeof WebAssembly.instantiateStreaming||x()||"function"!=typeof fetch?i(n):fetch(w,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,o).then(n,(function(e){return u("wasm streaming compile failed: "+e),u("falling back to ArrayBuffer instantiation"),i(n)}))}))).catch(r)}(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.__wasm_call_ctors).apply(null,arguments)};var He=t._malloc=function(){return(He=t._malloc=t.asm.malloc).apply(null,arguments)};t._free=function(){return(t._free=t.asm.free).apply(null,arguments)},t._xzimgInitializeCamera=function(){return(t._xzimgInitializeCamera=t.asm.xzimgInitializeCamera).apply(null,arguments)},t._xzimgPoseEstimationInitializeFacePose=function(){return(t._xzimgPoseEstimationInitializeFacePose=t.asm.xzimgPoseEstimationInitializeFacePose).apply(null,arguments)},t._xzimgPoseEstimationInitialize=function(){return(t._xzimgPoseEstimationInitialize=t.asm.xzimgPoseEstimationInitialize).apply(null,arguments)},t._xzimgPoseEstimationRelease=function(){return(t._xzimgPoseEstimationRelease=t.asm.xzimgPoseEstimationRelease).apply(null,arguments)},t._xzimgPoseEstimationPrepareCrop=function(){return(t._xzimgPoseEstimationPrepareCrop=t.asm.xzimgPoseEstimationPrepareCrop).apply(null,arguments)},t._xzimgPoseEstimationEstimateFacePose=function(){return(t._xzimgPoseEstimationEstimateFacePose=t.asm.xzimgPoseEstimationEstimateFacePose).apply(null,arguments)},t._xzimgGetHeatmapsLocations=function(){return(t._xzimgGetHeatmapsLocations=t.asm.xzimgGetHeatmapsLocations).apply(null,arguments)},t._xzimgEstimateRigidPose=function(){return(t._xzimgEstimateRigidPose=t.asm.xzimgEstimateRigidPose).apply(null,arguments)},t._xzimgEstimateGetSimilarity=function(){return(t._xzimgEstimateGetSimilarity=t.asm.xzimgEstimateGetSimilarity).apply(null,arguments)},t._xzimgWarpAffine=function(){return(t._xzimgWarpAffine=t.asm.xzimgWarpAffine).apply(null,arguments)},t._xzimgMatchRecKeypsInit=function(){return(t._xzimgMatchRecKeypsInit=t.asm.xzimgMatchRecKeypsInit).apply(null,arguments)},t._xzimgMatchRecKeyps=function(){return(t._xzimgMatchRecKeyps=t.asm.xzimgMatchRecKeyps).apply(null,arguments)},t._xzimgEstimateInitNonRigidPose=function(){return(t._xzimgEstimateInitNonRigidPose=t.asm.xzimgEstimateInitNonRigidPose).apply(null,arguments)},t._xzimgEstimateNonRigidPose=function(){return(t._xzimgEstimateNonRigidPose=t.asm.xzimgEstimateNonRigidPose).apply(null,arguments)},t._xzimgEstimateBodyNonRigidPose=function(){return(t._xzimgEstimateBodyNonRigidPose=t.asm.xzimgEstimateBodyNonRigidPose).apply(null,arguments)},t._xzimgEstimateNonRigidPoseBase=function(){return(t._xzimgEstimateNonRigidPoseBase=t.asm.xzimgEstimateNonRigidPoseBase).apply(null,arguments)},t._xzimgEstimateGetNumVertices=function(){return(t._xzimgEstimateGetNumVertices=t.asm.xzimgEstimateGetNumVertices).apply(null,arguments)},t._xzimgEstimateGetDenseVertices=function(){return(t._xzimgEstimateGetDenseVertices=t.asm.xzimgEstimateGetDenseVertices).apply(null,arguments)};var We,Ye=t.___errno_location=function(){return(Ye=t.___errno_location=t.asm.__errno_location).apply(null,arguments)},Ke=t.stackSave=function(){return(Ke=t.stackSave=t.asm.stackSave).apply(null,arguments)},$e=t.stackRestore=function(){return($e=t.stackRestore=t.asm.stackRestore).apply(null,arguments)},ze=t.stackAlloc=function(){return(ze=t.stackAlloc=t.asm.stackAlloc).apply(null,arguments)};function qe(){function e(){if(!We&&(We=!0,t.calledRun=!0,!m)){if(t.noFSInit||$||($=!0,we(),t.stdin=t.stdin,t.stdout=t.stdout,t.stderr=t.stderr,t.stdin?Ne("stdin",t.stdin):Se("/dev/tty","/dev/stdin"),t.stdout?Ne("stdout",null,t.stdout):Se("/dev/tty","/dev/stdout"),t.stderr?Ne("stderr",null,t.stderr):Se("/dev/tty1","/dev/stderr"),Oe("/dev/stdin",0),Oe("/dev/stdout",1),Oe("/dev/stderr",1)),ae=!1,B(C),n(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;){var e=t.postRun.shift();O.unshift(e)}B(O)}}if(!(0<L)){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)b();B(S),0<L||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),e()}),1)):e())}}if(t.___cxa_is_pointer_type=function(){return(t.___cxa_is_pointer_type=t.asm.__cxa_is_pointer_type).apply(null,arguments)},t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.dynCall_jiji).apply(null,arguments)},t.dynCall_viijii=function(){return(t.dynCall_viijii=t.asm.dynCall_viijii).apply(null,arguments)},t.dynCall_iiiiij=function(){return(t.dynCall_iiiiij=t.asm.dynCall_iiiiij).apply(null,arguments)},t.dynCall_iiiiijj=function(){return(t.dynCall_iiiiijj=t.asm.dynCall_iiiiijj).apply(null,arguments)},t.dynCall_iiiiiijj=function(){return(t.dynCall_iiiiiijj=t.asm.dynCall_iiiiiijj).apply(null,arguments)},t.ccall=Ge,t.cwrap=function(e,n,r,i){var o=(r=r||[]).every((e=>"number"===e||"boolean"===e));return"string"!==n&&o&&!i?t["_"+e]:function(){return Ge(e,n,r,arguments)}},t.setValue=function(e,t,n="i8"){switch(n.endsWith("*")&&(n="*"),n){case"i1":case"i8":h[e>>0]=t;break;case"i16":f[e>>1]=t;break;case"i32":A[e>>2]=t;break;case"i64":D=[t>>>0,(N=t,1<=+Math.abs(N)?0<N?(0|Math.min(+Math.floor(N/4294967296),4294967295))>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],A[e>>2]=D[0],A[e+4>>2]=D[1];break;case"float":g[e>>2]=t;break;case"double":_[e>>3]=t;break;case"*":E[e>>2]=t;break;default:k("invalid type for setValue: "+n)}},t.getValue=function(e,t="i8"){switch(t.endsWith("*")&&(t="*"),t){case"i1":case"i8":return h[e>>0];case"i16":return f[e>>1];case"i32":case"i64":return A[e>>2];case"float":return g[e>>2];case"double":return _[e>>3];case"*":return E[e>>2];default:k("invalid type for getValue: "+t)}return null},P=function e(){We||qe(),We||(P=e)},t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);0<t.preInit.length;)t.preInit.pop()();return qe(),e.ready}),p_={modelFilename:"",featuresFilename:"",objFilename:"",fovY:50,detection_score_t:.2,tracking_score_t:.4,footToDetect:"RIGHT_FOOT",filteringLevel:2,filteringShift:.5};function f_(e,t){e.length;var n=function(e,t){var n=e.length/2,r=R_(n,t),i=r[0],o=r[1],s=[e[i],e[i+n]],a=[e[o],e[o+n]],c=[(s[0]+a[0])/2,(s[1]+a[1])/2],u=-Math.atan2(s[1]-a[1],a[0]-s[0]),l=Math.sqrt((s[0]-a[0])*(s[0]-a[0])+(s[1]-a[1])*(s[1]-a[1]));return[c[0],c[1],u,l]}(e,t),r=n[0],i=n[1],o=n[2],s=n[3],a=[Math.cos(o),Math.sin(o)],c=[-a[1],a[0]],u=s/1,l=s/2;return[r+a[0]*u+c[0]*l,i+a[1]*u+c[1]*l,r+a[0]*u-c[0]*l,i+a[1]*u-c[1]*l,r-a[0]*u-c[0]*l,i-a[1]*u-c[1]*l,r-a[0]*u+c[0]*l,i-a[1]*u+c[1]*l]}function A_(e,t,n,r,i,o,s,a){for(var c=e.length/2,u=new Float32Array(2*c),l=0;l<c;l++)u[l]=(e[l]-i)/s,u[l+c]=(e[l+c]-r)/o;for(var d=f_(u,a),h=d[0],p=d[1],f=d[2]-h,A=d[3]-p,E=d[6]-h,g=d[7]-p,_=f*f+A*A,m=E*E+g*g,I=new Float32Array(n*t),T=0;T<t;T++)for(var R=0;R<n;R++){var v=R-h,y=T-p,S=v*f+y*A,C=v*E+y*g;S>0&&C>0&&S<_&&C<m||(I[T*n+R]=1)}return I}function E_(e,t,n,r){var i=new Float32Array(6);return i[0]=r,i[1]=0,i[2]=t,i[3]=0,i[4]=n,i[5]=e,i}function g_(e,t){for(var n=1e4,r=1e4,i=-1e4,o=-1e4,s=0;s<t;s++){var a=e[s],c=e[t+s];a>i&&(i=a),c>o&&(o=c),a<n&&(n=a),c<r&&(r=c)}return[Math.floor(n),Math.floor(i+1),Math.floor(r),Math.floor(o+1)]}function __(e,t){var n=0,r=e.length;if(6==r&&"RIGHT_FOOT"==t){for(var i=3;i<r;i++)n+=e[i];n/=3}else if(6==r&&"LEFT_FOOT"==t){for(i=0;i<3;i++)n+=e[i];n/=3}else{for(i=0;i<r;i++)n+=e[i];n/=r}return n}function m_(e,t,n){for(var r=new Uint8ClampedArray(e*t*4),i=e*t,o=0;o<i;o++){var s=n[o],a=4*o;r[a+0]=Math.round(255*s),r[a+1]=Math.round(255*s),r[a+2]=Math.round(255*s),r[a+3]=255}return new ImageData(r,t,e)}function I_(e,t,n,r){for(var i=new Uint8ClampedArray(e*t*4),o=e*t,s=0;s<o;s++){for(var a=s*n,c=r[a],u=1;u<n;u++){var l=r[a+u];c=Math.max(c,l)}var d=4*s;i[d+0]=Math.round(255*(1-c)),i[d+1]=Math.round(255*(1-c)),i[d+2]=Math.round(255*(1-c)),i[d+3]=255}return new ImageData(i,t,e)}function T_(e,t,n,r){var i=Float32Array.from(e),o=e.length/2;if(n)for(var s=0;s<o;s++)i[s+o]=r-1-i[s+o];for(s=0;s<o;s++){var a=i[s],c=i[s+o];i[s]=t[0]*a+t[1]*c+t[2],i[s+o]=t[3]*a+t[4]*c+t[5]}return i}function R_(e,t){if(void 0===t&&(t="face"),"face"==t){if(5==e)return[0,1];if(19==e)return[6,11];if(21==e)return[17,20];if(51==e)return[19,28];if(68==e)return[36,45];if(16==e)return[6,9]}return"eye"==t?[0,1]:6==e&&"RIGHT_FOOT"==t?[3,5]:6==e&&"LEFT_FOOT"==t?[0,2]:18!=e||"RIGHT_FOOT"!=t&&"LEFT_FOOT"!=t?13!=e||"RIGHT_FOOT"!=t&&"LEFT_FOOT"!=t?"hand"==t&&8==e?[7,0]:(console.error("no type or number of feature match"),[0,1]):[0,6]:[0,9]}function v_(e,t){var n=e.length/2,r=R_(n,t),i=r[0],o=r[1],s=[e[i],e[i+n]],a=[e[o],e[o+n]],c=[(4*s[0]+a[0])/5,(4*s[1]+a[1])/5],u=-Math.atan2(s[1]-a[1],a[0]-s[0]);return[c[0],c[1],u]}function y_(e,t,n){for(var r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],c=n[5],u=e.width,l=e.height,d=4*e.width,h=t.width,p=t.height,f=4*t.width,A=0;A<p;A++)for(var E=i*A+o,g=a*A+c,_=A*f,m=0;m<h;m++){var I=4*m,T=Math.floor(E),R=Math.floor(g),v=E-T,y=g-R,S=void 0,C=void 0;if(T>0&&T<u-1&&R>0&&R<l-1){for(var O=R*d+4*T,b=0;b<3;b++,O++){var w=e.data[O];S=w+v*(e.data[O+4]-w),C=e.data[O+d]+v*(e.data[O+d+4]-e.data[O+d]),t.data[_+I+b]=S+y*(C-S)}t.data[_+I+3]=255}else{for(b=0;b<3;b++)t.data[_+I+b]=0;t.data[_+I+3]=255}E+=r,g+=s}return t}function S_(e,t){var n,r;return{crop:e>t?[(r=0)/t,(n=(e-t)/2)/e,1,(e-n)/e]:[(r=(t-e)/2)/t,(n=0)/e,(t-r)/t,1],deltaY:r,deltaX:n}}function C_(e,t){var n,r,i,o,s,a=e.length/2;o=(n=v_(e,t))[0],i=n[1],s=n[2];var c=null;if(6==a&&"RIGHT_FOOT"==t)c=[e[3],e[4],e[5],e[3+a],e[4+a],e[5+a]];else{if(6!=a||"LEFT_FOOT"!=t)return console.error("missing case"),null;c=[e[0],e[1],e[2],e[0+a],e[1+a],e[2+a]]}return r=g_(c,3),[o,i,Math.sqrt((r[1]-r[0])*(r[1]-r[0])+(r[3]-r[2])*(r[3]-r[2])),s]}function O_(e,t,n,r,i,o,s){var a,c,u=e.length/2;6!=u&&13!=u&&18!=u&&console.log("foot detection should return 6 features");var l=null,d=0;6==u?((a=v_(e,s))[0],a[1],d=a[2],l=g_("RIGHT_FOOT"==s?[e[3],e[4],e[5],e[3+u],e[4+u],e[5+u]]:[e[0],e[1],e[2],e[0+u],e[1+u],e[2+u]],3)):((c=v_(e,s))[0],c[1],d=c[2],l=g_(e,u)),l[2],l[0],l[3],l[1];var h=Math.cos(d),p=Math.sin(d),f=Math.sqrt((l[1]-l[0])*(l[1]-l[0])+(l[3]-l[2])*(l[3]-l[2])),A=(f+=.25*f)/Math.max(n,t),E=t/2,g=n/2,_=(l[0]+l[1])/2-(h*A*E-p*A*g),m=(l[2]+l[3])/2-(p*A*E+h*A*g);if(null!=o){var I=Math.sqrt((_-o[2])*(_-o[2])+(m-o[5])*(m-o[5])),T=1;I>20&&(T=.1),I>=10&&I<=20&&(T=1-.09*(I-5)),_=(1-T)*_+T*o[2],m=(1-T)*m+T*o[5],d=Math.abs(d-o[6])>1?(1-T)*d-T*o[6]:(1-T)*d+T*o[6],A=(1-T)*A+T*o[7],h=Math.cos(d),p=Math.sin(d)}return[h*A,-p*A,_,p*A,h*A,m,d,A]}function b_(e,t){var n=e._malloc(4*t.length);return e.HEAPF32.set(t,n/4),n}function w_(e,t,n){var r=new Float32Array(n),i=t/4;return r.set(e.HEAPF32.subarray(i,i+n)),r.slice()}function N_(e,t,n){var r=new Uint32Array(t.data.buffer),i=r.length,o=n/4;e.HEAPU32.subarray(o,o+i).set(r)}function D_(e,t,n,r){var i=e._malloc(28);return e.setValue(i,n,"i32"),e.setValue(i+4,r,"i32"),e.setValue(i+8,t,"i32"),e.setValue(i+12,0,"i32"),e.setValue(i+16,4,"i32"),e.setValue(i+20,0,"i32"),e.setValue(i+24,0,"i32"),i}function L_(e,t){for(var n=e.length/2,r=t.length/2,i=n+r,o=new Float32Array(e.length+t.length),s=0;s<n;s++)o[s]=e[s],o[s+i]=e[s+n];for(s=0;s<r;s++)o[s+n]=t[s],o[s+i+n]=t[s+r];return o}function P_(e,t,n){var r=new Float32Array(2*t),i=new Float32Array(2*n),o=e.length/2;t+n!=o&&console.log("ERROR (separateShapes): shapes not correct dims");for(var s=0;s<t;s++)r[s]=e[s],r[s+t]=e[s+o];for(s=0;s<n;s++)i[s]=e[s+t],i[s+n]=e[s+o+t];return[r,i]}function k_(e,t,n,r,i){var o=e.cwrap("xzimgMatchRecKeyps","number",["number","number","number","number","number"]),s=r.length/2;N_(e,t,n);for(var a=D_(e,n,t.width,t.height),c=b_(e,r),u=b_(e,r.slice()),l=e._malloc(4*s),d=0;d<s;d++)e.setValue(l+4*d,1,"float"),i.length>d&&0==i[d]&&e.setValue(l+4*d,-1,"float");var h=e._malloc(16);o(a,c,u,s,l,h);var p=w_(e,l,s),f=w_(e,u,r.length),A=w_(e,h,4);for(d=0;d<s;d++)0==p[d]&&(f[d]=r[d],f[d+s]=r[d+s]);return e._free(a),e._free(c),e._free(u),e._free(l),e._free(h),[f,A,p]}function x_(e,t,n,r){var i=b_(e,t),o=b_(e,n),s=e._malloc(16);e.cwrap("xzimgEstimateGetSimilarity","number",["number","number","number","number"])(i,o,t.length/2,s);var a=w_(e,s,4);return e._free(i),e._free(o),e._free(s),a}function M_(e,t,n,r,i){var o=t/4,s=new Float32Array(18);s.set(e.HEAPF32.subarray(o,o+18)),s[9]+=n[2]*s[11]/r,s[10]+=n[3]*s[11]/i,e.HEAPF32.set(s,t/4)}function U_(e,t,n,r,i,o,s){void 0===i&&(i=null);for(var a=new Float32Array(2),c=n.length/2,u=0,l=0;l<c;l++)(null==i||i[l]>0)&&(a[0]+=r[l]-n[l],a[1]+=r[l+c]-n[l+c],u+=1);u>0&&(a[0]/=u,a[1]/=u);var d=t/4,h=new Float32Array(18);h.set(e.HEAPF32.subarray(d,d+18)),h[9]+=a[0]*h[11]/o,h[10]+=a[1]*h[11]/s,e.HEAPF32.set(h,t/4)}function B_(e,t,n,r,i){void 0===i&&(i=!1);var o=function(e,t,n,r){for(var i=new Float32Array(r).fill(0),o=new Int32Array(2*r),s=t*n,a=0;a<s;a++)for(var c=0;c<r;c++){var u=e[a*r+c];u>i[c]&&(i[c]=u,o[c]=a%n,o[r+c]=Math.floor(a/n))}return[o,i]}(e,t,n,r),s=function(e,t,n,r,i){for(var o=[-r*i-i,-r*i,-r*i+i,-i,0,i,r*i-i,r*i,r*i+i],s=new Float32Array(i),a=new Float32Array(2*i),c=0;c<i;c++){var u=t[c],l=t[i+c];a[c]=u,a[i+c]=l;var d=l*r*i+u*i+c,h=0;h=0;for(var p=0;p<9;p++)h+=e[d+o[p]];h/=9,s[c]=h;var f=Math.min(u+2,r-1),A=Math.max(u-2,0),E=Math.min(l+2,n-1),g=Math.max(l-2,0),_=0,m=0,I=l*r*i+A*i+c,T=l*r*i+f*i+c;for(p=0;p<9;p++)_+=e[I+o[p]],m+=e[T+o[p]];var R=2*(2*h-((_/=9)+(m/=9)));if(Math.abs(R)>1e-5){var v=2*(m-_)/R;a[c]+=v}var y=0,S=0,C=g*r*i+u*i+c,O=E*r*i+u*i+c;for(p=0;p<9;p++)y+=e[C+o[p]],S+=e[O+o[p]];R=2*(2*h-((y/=9)+(S/=9))),Math.abs(R)>1e-5&&(v=2*(S-y)/R,a[i+c]+=v)}return[a,s]}(e,o[0],t,n,r),a=s[0],c=s[1];if(i)for(var u=0;u<r;u++)a[u]=n-1-a[u];return[a,c]}function F_(e,t,n,r,i,o,s){var a,c,u,l=new Float32Array([1,0,0,0,-1,0,0,0,-1]),d=Math.cos(e+Math.PI/2),h=Math.sin(e+Math.PI/2),p=(i+o)/2*s/t;return[(a=new Float32Array([d,-h,0,h,d,0,0,0,1]),c=l,(u=new Float32Array(9))[0]=a[0]*c[0]+a[1]*c[3]+a[2]*c[6],u[1]=a[0]*c[1]+a[1]*c[4]+a[2]*c[7],u[2]=a[0]*c[2]+a[1]*c[5]+a[2]*c[8],u[3]=a[3]*c[0]+a[4]*c[3]+a[5]*c[6],u[4]=a[3]*c[1]+a[4]*c[4]+a[5]*c[7],u[5]=a[3]*c[2]+a[4]*c[5]+a[5]*c[8],u[6]=a[6]*c[0]+a[7]*c[3]+a[8]*c[6],u[7]=a[6]*c[1]+a[7]*c[4]+a[8]*c[7],u[8]=a[6]*c[2]+a[7]*c[5]+a[8]*c[8],u),new Float32Array([p*n/i,p*r/o,p])]}function V_(e,t){var n,r,i,o,s={vertices:new Float32Array,uvs:new Float32Array,faces:new Uint16Array},a=e.match(/^v( -?\d+(\.\d+)?){3}$/gm);if(a){var c=a.map((function(e){var t=e.split(" ");return t.shift(),t.map((function(e){return+e}))})),u=(n=[]).concat.apply(n,c);s.vertices=new Float32Array(u)}var l=e.match(/^vt( -?\d+(\.\d+)?){2}$/gm);if(l){var d=l.map((function(e){var t=e.split(" ");return t.shift(),t.map((function(e){return+e}))})),h=(r=[]).concat.apply(r,d);s.uvs=new Float32Array(h)}var p=e.match(/^f( \d+\/\d*\/\d*){3}$/gm);if(p){var f=p.map((function(e){var t=e.split(" ");return t.shift(),[+t[0].split("/")[0]-1,+t[1].split("/")[0]-1,+t[2].split("/")[0]-1]})),A=(i=[]).concat.apply(i,f);if(s.faces=new Uint16Array(A),t){var E=p.map((function(e){var t=e.split(" ");return t.shift(),[+t[0].split("/")[1]-1,+t[1].split("/")[1]-1,+t[2].split("/")[1]-1]})),g=new Uint16Array((o=[]).concat.apply(o,E)),_=s.uvs;s.uvs=new Float32Array(_.length);for(var m=0;m<g.length;m++){var I=g[m],T=_[2*I],R=_[2*I+1],v=s.faces[m];s.uvs[2*v]=T,s.uvs[2*v+1]=R}}}if(t){for(m=0;m<s.faces.length;m+=3){var y=s.faces[m];s.faces[m]=s.faces[m+1],s.faces[m+1]=y}for(m=0;m<s.vertices.length;m+=3)s.vertices[m]=-s.vertices[m]}return s}!function(e){e.Detection="DETECTION",e.Detected="DETECTED",e.Tracking="TRACKING"}(l_||(l_={}));var G_,Q_=function(){function e(e,t){this._trackingState=l_.Detection,this._type=0,this._R=Float32Array.from(e),this._t=Float32Array.from(t),this._trackingState=l_.Detection}return e.prototype.setTrackingState=function(e){this._trackingState=e},e.prototype.getTrackingState=function(){return this._trackingState},e.prototype.isDetected=function(){return this._trackingState==l_.Tracking},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e},enumerable:!1,configurable:!0}),e.prototype.setRt=function(e,t){this._R=e.slice(0),this._t=t.slice(0)},e.prototype.R=function(){return this._R},e.prototype.t=function(){return this._t},e.prototype.getPosition=function(){return[this._t[0],this._t[1],this._t[2]]},e.prototype.getRotation=function(){return[[this._R[0],this._R[1],this._R[2]],[this._R[3],this._R[4],this._R[5]],[this._R[6],this._R[7],this._R[8]]]},e.prototype.reset=function(){this._R=new Float32Array([1,0,0,0,-1,0,0,0,-1]),this._t=new Float32Array([0,0,0])},e.getQuatFromRotMat=function(e){var t=new Float32Array(4);return t[0]=Math.sqrt(Math.max(0,1+e[0]+e[4]+e[8]))/2,t[1]=Math.sqrt(Math.max(0,1+e[0]-e[4]-e[8]))/2,t[2]=Math.sqrt(Math.max(0,1-e[0]+e[4]-e[8]))/2,t[3]=Math.sqrt(Math.max(0,1-e[0]-e[4]+e[8]))/2,t[1]=e[7]-e[5]<0?-Math.abs(t[1]):Math.abs(t[1]),t[2]=e[2]-e[6]<0?-Math.abs(t[2]):Math.abs(t[2]),t[3]=e[3]-e[1]<0?-Math.abs(t[3]):Math.abs(t[3]),t},e.getRotMatFromQuat=function(e){var t=new Float32Array(9);return t[0]=1-2*e[2]*e[2]-2*e[3]*e[3],t[1]=2*e[1]*e[2]-2*e[3]*e[0],t[2]=2*e[1]*e[3]+2*e[2]*e[0],t[3]=2*e[1]*e[2]+2*e[3]*e[0],t[4]=1-2*e[1]*e[1]-2*e[3]*e[3],t[5]=2*e[2]*e[3]-2*e[1]*e[0],t[6]=2*e[1]*e[3]-2*e[2]*e[0],t[7]=2*e[2]*e[3]+2*e[1]*e[0],t[8]=1-2*e[1]*e[1]-2*e[2]*e[2],t},e.slerp=function(e,t,n){var r,i,o=new Float32Array(4),s=e[1]*t[1]+e[2]*t[2]+e[3]*t[3]+e[0]*t[0],a=Math.abs(s);if(a>=.99999)r=1-n,i=n;else{var c=Math.acos(a),u=Math.sin(c);r=Math.sin((1-n)*c)/u,i=Math.sin(n*c)/u}return s<0&&(i=-i),o[1]=r*e[1]+i*t[1],o[2]=r*e[2]+i*t[2],o[3]=r*e[3]+i*t[3],o[0]=r*e[0]+i*t[0],o},e.getCameraMat=function(e,t,n){var r=n/2/Math.tan(e*Math.PI/180/2),i=r,o=(t-1)/2,s=(n-1)/2,a=new Float32Array(9);return a[0]=i,a[2]=o,a[4]=r,a[5]=s,a[8]=1,a},e.getCameraParams=function(e,t,n){var r=n/2/Math.tan(e*Math.PI/180/2);return[r,r,(t-1)/2,(n-1)/2]},e.MatMultVec=function(e,t){var n=new Float32Array(3);return n[0]=e[0]*t[0]+e[1]*t[1]+e[2]*t[2],n[1]=e[3]*t[0]+e[4]*t[1]+e[5]*t[2],n[2]=e[6]*t[0]+e[7]*t[1]+e[8]*t[2],n},e.MatMult=function(e,t){var n=new Float32Array(9);return n[0]=e[0]*t[0]+e[1]*t[3]+e[2]*t[6],n[1]=e[0]*t[1]+e[1]*t[4]+e[2]*t[7],n[2]=e[0]*t[2]+e[1]*t[5]+e[2]*t[8],n[3]=e[3]*t[0]+e[4]*t[3]+e[5]*t[6],n[4]=e[3]*t[1]+e[4]*t[4]+e[5]*t[7],n[5]=e[3]*t[2]+e[4]*t[5]+e[5]*t[8],n[6]=e[6]*t[0]+e[7]*t[3]+e[8]*t[6],n[7]=e[6]*t[1]+e[7]*t[4]+e[8]*t[7],n[8]=e[6]*t[2]+e[7]*t[5]+e[8]*t[8],n},e.prototype.project=function(t,n){for(var r=new Float32Array(t.length/3*2),i=0;i<t.length/3;i++){var o=e.MatMultVec(this._R,new Float32Array([t[3*i],t[3*i+1],t[3*i+2]])),s=new Float32Array(3);s[0]=o[0]+this._t[0],s[1]=o[1]+this._t[1],s[2]=o[2]+this._t[2];var a=n[6]*s[0]+n[7]*s[1]+n[8]*s[2];r[2*i]=(n[0]*s[0]+n[1]*s[1]+n[2]*s[2])/a,r[2*i+1]=(n[3]*s[0]+n[4]*s[1]+n[5]*s[2])/a}return r},e.prototype.transform=function(t,n){for(var r=new Float32Array(t.length/3*2),i=0;i<t.length/3;i++){var o=e.MatMultVec(this._R,new Float32Array([t[3*i],t[3*i+1],t[3*i+2]]));r[3*i+0]=o[0]+this._t[0],r[3*i+1]=o[1]+this._t[1],r[3*i+2]=o[2]+this._t[2]}return r},e}(),j_=function(){function e(e){this.NB_BUFFERS=6,this._poses=[],this._nbFramesDelay=0,this._interpolation=0,this._filteringLevel=2,this._filterThreshold=-1,e>=0&&e<this.NB_BUFFERS?this._nbFramesDelay=this._nbFramesDelay:console.error("Invalid frames delay, delay must be less than ",this.NB_BUFFERS)}return e.prototype.setNbFramesDelay=function(e){this._nbFramesDelay=e},e.prototype.setInterpolation=function(e){this._interpolation=e},e.prototype.setFilteringLevel=function(e){this._filteringLevel=e},e.prototype.setFilterThreshold=function(e){this._filterThreshold=e},e.prototype.reset=function(){this._poses=[]},e.prototype.setPose=function(e){this._poses.length===this.NB_BUFFERS&&(this._poses=this._poses.slice(0,-1)),this._poses=r([e],this._poses,!0)},e.prototype.getPose=function(){return this._poses.length>0?this._nbFramesDelay<this._poses.length?this._poses[this._nbFramesDelay]:this._poses[this._poses.length-1]:null},e.prototype.getInterpolatedPoseAtDelay=function(e){if(e>0&&e+1<this._poses.length){var t=this._poses[e-1],n=this._poses[e],r=this._poses[e+1];if(t.getTrackingState()!==l_.Tracking||r.getTrackingState()!==l_.Tracking)return n;for(var i=Q_.getQuatFromRotMat(t.R()),o=Q_.getQuatFromRotMat(r.R()),s=Q_.slerp(i,o,.5),a=Q_.getRotMatFromQuat(s),c=t.t(),u=r.t(),l=new Float32Array(3),d=0;d<3;d++)l[d]=.5*c[d]+.5*u[d];var h=new Q_(a,l);return h.setTrackingState(n.getTrackingState()),h.type=n.type,h}return this._poses.length>0?this.getPose():this.getLastPose()},e.prototype.dst=function(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])+(e[2]-t[2])*(e[2]-t[2]))},e.prototype.mvts=function(e,t,n){return(this.dst(e,t)+this.dst(t,n))/2},e.prototype.getInterpolatedPose=function(){if(1==this._filteringLevel)return this.getInterpolatedPoseAtDelay(this._nbFramesDelay);if(2==this._filteringLevel){var e=this.getInterpolatedPoseAtDelay(this._nbFramesDelay-1),t=this.getInterpolatedPoseAtDelay(this._nbFramesDelay+1);if(null==e||null==t)return this.getInterpolatedPoseAtDelay(this._nbFramesDelay);if(e.getTrackingState()!==l_.Tracking||t.getTrackingState()!==l_.Tracking)return this.getInterpolatedPoseAtDelay(this._nbFramesDelay);var n=this._poses[this._nbFramesDelay],r=e.t(),i=t.t();if(this._filterThreshold>0){var o=this.dst(r,n.t()),s=this.dst(i,n.t());if(o>this._filterThreshold||s>this._filterThreshold)return n}for(var a=Q_.getQuatFromRotMat(e.R()),c=Q_.getQuatFromRotMat(t.R()),u=Q_.slerp(a,c,this._interpolation),l=Q_.getRotMatFromQuat(u),d=new Float32Array(3),h=0;h<3;h++)d[h]=(1-this._interpolation)*r[h]+this._interpolation*i[h];var p=new Q_(l,d);return p.setTrackingState(n.getTrackingState()),p.type=n.type,p}return this.getLastPose()},e.prototype.updateDelay=function(e){e!=this._nbFramesDelay&&(e>=0&&e<this.NB_BUFFERS?this._nbFramesDelay=e:console.error("Invalid frames delay, delay must be less than ",this.NB_BUFFERS))},e.prototype.getLastPose=function(){return this._poses.length>0?this._poses[0]:null},e}();!function(e){e.Left="LEFT_FOOT",e.Right="RIGHT_FOOT",e.Both="BOTH_FOOT",e.Single="SINGLE_FOOT"}(G_||(G_={}));var H_,W_=function(){function r(){this._initialized=!1,this._currentWidth=0,this._currentHeight=0,this._trackingState=l_.Detection,this._useWasmForHeatmaps=!0,this._useWasmForPose=!0,this._float_size=4,this._bufferHeatmaps=null,this._bufferKeypsDet=null,this._bufferFeatureScores=null,this._bufferInOutPose_L=null,this._bufferInOutPose_R=null,this._bufferSimToImage=null,this._bufferKeyps3D_R=null,this._bufferKeyps3D_L=null,this._footToDetect=G_.Right,this._leftFootState=l_.Detection,this._rightFootState=l_.Detection,this._bufferKeypsTrack_L=null,this._bufferKeypsTrack_R=null,this._bufferHeatmaps_L=null,this._bufferHeatmaps_R=null,this._fastMovements_L=!1,this._fastMovements_R=!1,this._cnnOutputDataInvMask=null,this._debug=!1,this._debugInitialized=!1,this._reproj_t=15,this._reproj_fast_t=30,this._time_e=0,this._isDetected=!1}return r.prototype.getDebugImage=function(){return this._debugInitialized?this._debugImage:null},r.prototype.isDetected=function(){return this._isDetected},r.prototype.getPosition=function(e){void 0===e&&(e=G_.Right);var t=null;return(t=e==G_.Right?this._poseManager_R.getInterpolatedPose():this._poseManager_L.getInterpolatedPose())?t.getPosition():null},r.prototype.getRotation=function(e){void 0===e&&(e=G_.Right);var t=null;return(t=e==G_.Right?this._poseManager_R.getInterpolatedPose():this._poseManager_L.getInterpolatedPose())?t.getRotation():null},r.prototype.getPose=function(e){return void 0===e&&(e=G_.Right),e==G_.Right?this._pose_L:this._pose_R},r.prototype.getInterpolatedPose=function(e){return void 0===e&&(e=G_.Right),e==G_.Right?this._poseManager_R.getInterpolatedPose():this._poseManager_L.getInterpolatedPose()},r.prototype.isInitialized=function(){return this._initialized},r.prototype.initialize=function(r,i,o){return t(this,void 0,void 0,(function(){var t,s,a,c,u,l,d,h,p,f,A,E,g=this;return n(this,(function(n){switch(n.label){case 0:if(null==r)throw"Invalid parameter";return this.release(),this._videoManager=r,this._config=i?e(e({},p_),i):p_,"BOTH"!==this._config.footToDetect&&"BOTH_FEET"!==this._config.footToDetect||(this._footToDetect=G_.Both),this._poseManager_R=new j_(this._videoManager.getNbFramesDelay()),this._poseManager_R.setInterpolation(this._config.filteringShift),this._poseManager_R.setFilteringLevel(this._config.filteringLevel),this._poseManager_R.setFilterThreshold(.1),this._poseManager_L=new j_(this._videoManager.getNbFramesDelay()),this._poseManager_L.setInterpolation(this._config.filteringShift),this._poseManager_L.setFilteringLevel(this._config.filteringLevel),this._poseManager_L.setFilterThreshold(.1),t=new ae(0),s=W(h_({locateFile:function(e,t){return g._config.poseEstimationWasmFilename||t+e}})).pipe((_=function(){return t.next(1)},function(e){return e.lift(new Ae(_,void 0,void 0))})),a=i_(this._config.modelFilename,"config.json"),c=a.model$,u=a.progress$,l=i_(this._config.featuresFilename,"config.json"),d=l.model$,h=l.progress$,p=function(e,t){var n=new ae(0),r=n.asObservable();if("string"==typeof e)return{model$:i=Rg({url:e,method:"GET",responseType:"text",async:!0,progressSubscriber:new T((function(e){return n.next(e.loaded/e.total)}),(function(e){}),(function(){return n.next(1)}))}).pipe(ce(2),K((function(e){return V_(e.response,!1)}))),progress$:r};var i=ge((function(){return n.next(1),Y(V_(function(e){var t,n,r="",i=0,o=new Uint8Array(e);for(i=0;i<o.length;i++)if(o[i]<128)r+=String.fromCharCode(o[i]);else{o[i]<224?(t=(63&o[i])<<6,n=i+1):o[i]<240?(t=(31&o[i])<<12,n=i+2):o[i]<248?(t=(15&o[i])<<18,n=i+3):o[i]<252?(t=(7&o[i])<<24,n=i+4):(t=(3&o[i])<<30,n=i+5);do{t|=(127&o[++i])<<6*(n-i)}while(i!=n);r+=String.fromCharCode(t)}return r}(e),!1))}));return{model$:i,progress$:r}}(this._config.objFilename),f=p.model$,A=p.progress$,E=Q([t,u,h,A]).pipe(K((function(e){return e.reduce((function(t,n){return t+n/e.length}),0)})),K((function(e){return o&&o(e)}))).subscribe(),[4,ig({poseModule:s,model:c,features:d,footObjModel:f}).pipe(K((function(e){g._poseModule=e.poseModule,g._footObjModel=e.footObjModel,g._tfFootDetector=e.model.graphModel,g._footDetectorConfig=e.model.config,g._tfFootFeatures=e.features.graphModel,g._footFeaturesConfig=e.features.config,console.log("(DEBUG) XZIMG BACKEND",sr.backendName);var t=xa([1,g._footDetectorConfig.inHeight,g._footDetectorConfig.inWidth,3]),n=g._tfFootDetector.predict(t);g._footDetectorShape=n.shape,n.dispose(),t.dispose(),t=xa([1,g._footFeaturesConfig.inHeight,g._footFeaturesConfig.inWidth,3]),(n=g._tfFootFeatures.predict(t)).dispose(),t.dispose(),t=xa([2,g._footFeaturesConfig.inHeight,g._footFeaturesConfig.inWidth,3]),n=g._tfFootFeatures.predict(t),g._footFeaturesShape=n.shape,n.dispose(),t.dispose();var r=Math.max(g._footDetectorShape[1]*g._footDetectorShape[2]*g._footDetectorShape[3],g._footFeaturesShape[1]*g._footFeaturesShape[2]*g._footFeaturesShape[3]),i=Math.max(g._footDetectorShape[3],g._footFeaturesShape[3]),o=function(e,t){var n=[54,210,295,415,416,425,463,582,644,721,726,730,813];18==t&&(n=[54,210,295,406,415,416,417,423,425,463,518,582,644,657,721,726,730,813]);for(var r=n.length,i=new Array(3*r),o=0;o<r;o++){var s=n[o];i[3*o]=e[3*s],i[3*o+1]=e[3*s+1],i[3*o+2]=e[3*s+2]}var a=new Array(3*r);for(o=0;o<r;o++)a[3*o]=-i[3*o],a[3*o+1]=i[3*o+1],a[3*o+2]=i[3*o+2];return[i,a]}(g._footObjModel.vertices,g._footFeaturesShape[3]),s=o[0],a=o[1];null==g._bufferKeyps3D_R&&(g._bufferKeyps3D_R=g._poseModule._malloc(s.length*g._float_size),g._poseModule.HEAPF32.set(s,g._bufferKeyps3D_R/4)),null==g._bufferKeyps3D_L&&(g._bufferKeyps3D_L=g._poseModule._malloc(a.length*g._float_size),g._poseModule.HEAPF32.set(a,g._bufferKeyps3D_L/4)),g._bufferHeatmaps=g._poseModule._malloc(r*g._float_size),g._bufferHeatmaps_L=g._poseModule._malloc(r*g._float_size),g._bufferHeatmaps_R=g._poseModule._malloc(r*g._float_size),g._bufferKeypsDet=g._poseModule._malloc(2*g._footDetectorShape[3]*g._float_size),g._bufferKeypsTrack_L=g._poseModule._malloc(2*g._footFeaturesShape[3]*g._float_size),g._bufferKeypsTrack_R=g._poseModule._malloc(2*g._footFeaturesShape[3]*g._float_size),g._bufferFeatureScores=g._poseModule._malloc(i*g._float_size),g._bufferInOutPose_L=g._poseModule._malloc(18*g._float_size),g._bufferInOutPose_R=g._poseModule._malloc(18*g._float_size),g._bufferSimToImage=g._poseModule._malloc(8*g._float_size),g._initialized=!0})),Z((function(){return E.unsubscribe()}))).toPromise()];case 1:return n.sent(),[2]}var _}))}))},r.prototype.release=function(){this._initialized&&(this._poseModule._free(this._bufferHeatmaps),this._poseModule._free(this._bufferHeatmaps_L),this._poseModule._free(this._bufferHeatmaps_R),this._poseModule._free(this._bufferKeypsDet),this._poseModule._free(this._bufferKeypsTrack_L),this._poseModule._free(this._bufferKeypsTrack_R),this._poseModule._free(this._bufferFeatureScores),this._poseModule._free(this._bufferInOutPose_L),this._poseModule._free(this._bufferInOutPose_R),this._poseModule._free(this._bufferSimToImage),this._poseModule._free(this._bufferKeyps3D_R),this._poseModule._free(this._bufferKeyps3D_L),this._hptrImageBuffer&&this._poseModule._free(this._hptrImageBuffer))},r.prototype.trackSync=function(e){var t;if(this._initialized){var n=this._videoManager.getVideoCanvas();n.width===this._currentWidth&&n.height===this._currentHeight||(this._currentWidth=n.width,this._currentHeight=n.height,t=Q_.getCameraParams(this._config.fovY,this._currentWidth,this._currentHeight),this._fx=t[0],this._fy=t[1],this._cx=t[2],this._cy=t[3],this._poseModule.cwrap("xzimgInitializeCamera","number",["number","number","number"])(this._config.fovY,this._currentWidth,this._currentHeight)),this._poseManager_L.setNbFramesDelay(this._videoManager.getNbFramesDelay()),this._poseManager_R.setNbFramesDelay(this._videoManager.getNbFramesDelay());var r=e;null==e&&(r=this._videoManager.getLastBuffer()),null!=r?this._footToDetect===G_.Left||this._footToDetect===G_.Right?this.trackSingleFootSync(r):(this.trackBothFeetSync(r),performance.now()):console.error("No video frame to process")}else console.error("Foot must be initialized to track")},r.prototype.track=function(e){return t(this,void 0,void 0,(function(){var t,r,i;return n(this,(function(n){switch(n.label){case 0:return this._initialized?((t=this._videoManager.getVideoCanvas()).width===this._currentWidth&&t.height===this._currentHeight||(this._currentWidth=t.width,this._currentHeight=t.height,i=Q_.getCameraParams(this._config.fovY,this._currentWidth,this._currentHeight),this._fx=i[0],this._fy=i[1],this._cx=i[2],this._cy=i[3],this._poseModule.cwrap("xzimgInitializeCamera","number",["number","number","number"])(this._config.fovY,this._currentWidth,this._currentHeight)),this._poseManager_L.setNbFramesDelay(this._videoManager.getNbFramesDelay()),this._poseManager_R.setNbFramesDelay(this._videoManager.getNbFramesDelay()),r=e,null==e&&(r=this._videoManager.getLastBuffer()),null==r?(console.error("No video frame to process"),[2]):this._footToDetect!==G_.Left&&this._footToDetect!==G_.Right?[3,2]:[4,this.trackSingleFoot(r)]):(console.error("Foot must be initialized to track"),[2]);case 1:return n.sent(),[3,4];case 2:return[4,this.trackBothFeet(r)];case 3:n.sent(),performance.now(),n.label=4;case 4:return[2]}}))}))},r.prototype.trackSingleFootSync=function(e){var t=-1;if(this._trackingState===l_.Detection){var n=this.detectFeetSync(e),r=n.refinedFeatures,i=n.scores;this._initShape=r;var o=__(i,"LEFT_FOOT"),s=__(i,"RIGHT_FOOT");s>o&&s>=this._config.detection_score_t?(this._footToDetect=G_.Right,this.computePoseSync(this._trackingState,this._footToDetect),this._trackingState=l_.Detected):o>=this._config.detection_score_t&&(this._footToDetect=G_.Left,this.computePoseSync(this._trackingState,this._footToDetect),this._trackingState=l_.Detected)}else{var a;a=this._trackingState==l_.Detected?this._initShape:this._footToDetect==G_.Right?this._rightFootRecShape:this._leftFootRecShape;var c=this.detectFootFeaturesSync(e,this._trackingState,a,this._footToDetect);this._footToDetect==G_.Right?this._rightFootRecShape=c.refinedFeatures:this._leftFootRecShape=c.refinedFeatures,__(c.scores,this._footToDetect)>=this._config.tracking_score_t?(t=this.computePoseSync(this._trackingState,this._footToDetect),this._trackingState=l_.Tracking,t>this._reproj_t&&(this._trackingState=l_.Detection)):this._trackingState=l_.Detection}this._isDetected=this._trackingState===l_.Tracking,this._trackingState===l_.Detection&&(this._pose_R=new Q_(new Float32Array([1,0,0,0,-1,0,0,0,-1]),new Float32Array([0,0,0])),this._pose_L=new Q_(new Float32Array([1,0,0,0,-1,0,0,0,-1]),new Float32Array([0,0,0])),this._pose_L.setTrackingState(l_.Detection),this._pose_R.setTrackingState(l_.Detection),this._pose_R.type=0,this._pose_L.type=1),this._footToDetect==G_.Right?(this._pose_R.setTrackingState(this._trackingState),this._poseManager_R.setPose(this._pose_R)):this._footToDetect==G_.Left&&(this._pose_L.setTrackingState(this._trackingState),this._poseManager_L.setPose(this._pose_L))},r.prototype.trackSingleFoot=function(e){return t(this,void 0,void 0,(function(){var t,r,i,o,s,a,c,u;return n(this,(function(n){switch(n.label){case 0:return t=-1,this._trackingState!==l_.Detection?[3,6]:[4,this.detectFeet(e)];case 1:return r=n.sent(),i=r.refinedFeatures,o=r.scores,this._initShape=i,s=__(o,"LEFT_FOOT"),(a=__(o,"RIGHT_FOOT"))>s&&a>=this._config.detection_score_t?(this._footToDetect=G_.Right,[4,this.computePose(this._trackingState,this._footToDetect)]):[3,3];case 2:return n.sent(),this._trackingState=l_.Detected,[3,5];case 3:return s>=this._config.detection_score_t?(this._footToDetect=G_.Left,[4,this.computePose(this._trackingState,this._footToDetect)]):[3,5];case 4:n.sent(),this._trackingState=l_.Detected,n.label=5;case 5:return[3,10];case 6:return c=this._trackingState==l_.Detected?this._initShape:this._footToDetect==G_.Right?this._rightFootRecShape:this._leftFootRecShape,[4,this.detectFootFeatures(e,this._trackingState,c,this._footToDetect)];case 7:return u=n.sent(),this._footToDetect==G_.Right?this._rightFootRecShape=u.refinedFeatures:this._leftFootRecShape=u.refinedFeatures,__(u.scores,this._footToDetect)>=this._config.tracking_score_t?[4,this.computePose(this._trackingState,this._footToDetect)]:[3,9];case 8:return t=n.sent(),this._trackingState=l_.Tracking,t>this._reproj_t&&(this._trackingState=l_.Detection),[3,10];case 9:this._trackingState=l_.Detection,n.label=10;case 10:return this._isDetected=this._trackingState===l_.Tracking,this._trackingState===l_.Detection&&(this._pose_R=new Q_(new Float32Array([1,0,0,0,-1,0,0,0,-1]),new Float32Array([0,0,0])),this._pose_L=new Q_(new Float32Array([1,0,0,0,-1,0,0,0,-1]),new Float32Array([0,0,0])),this._pose_L.setTrackingState(l_.Detection),this._pose_R.setTrackingState(l_.Detection),this._pose_R.type=0,this._pose_L.type=1),this._footToDetect==G_.Right?(this._pose_R.setTrackingState(this._trackingState),this._poseManager_R.setPose(this._pose_R)):this._footToDetect==G_.Left&&(this._pose_L.setTrackingState(this._trackingState),this._poseManager_L.setPose(this._pose_L)),[2]}}))}))},r.prototype.trackBothFeetSync=function(e){var t=-1;if(this._rightFootState!=l_.Detection&&this._leftFootState!=l_.Detection){var n=this.detectBothFeetFeaturesSync(e,this._leftFootState,this._rightFootState,this._leftFootState==l_.Detected?this._initShape:this._leftFootRecShape,this._rightFootState==l_.Detected?this._initShape:this._rightFootRecShape);console.log(n);var r=__(n.scores_R,"RIGHT_FOOT");this._rightFootRecShape=n.refinedFeatures_R;var i=__(n.scores_L,"LEFT_FOOT");this._leftFootRecShape=n.refinedFeatures_L;var o=this._config.tracking_score_t;this._fastMovements_R&&(o=.1);var s=this._reproj_t;this._fastMovements_R&&(s=this._reproj_fast_t),r>=o?(t=this.computePoseSync(this._rightFootState,"RIGHT_FOOT"),this._rightFootState=l_.Tracking,t>s&&(this._rightFootState=l_.Detection)):this._rightFootState=l_.Detection,o=this._config.tracking_score_t,this._fastMovements_L&&(o=.1),s=this._reproj_t,this._fastMovements_L&&(s=this._reproj_fast_t),i>=o?(t=this.computePoseSync(this._leftFootState,"LEFT_FOOT"),this._leftFootState=l_.Tracking,t>s&&(this._leftFootState=l_.Detection)):this._leftFootState=l_.Detection}else if(this._rightFootState!==l_.Detection&&this._leftFootState===l_.Detection){var a=this.detectFootFeaturesSync(e,this._rightFootState,this._rightFootState==l_.Detected?this._initShape:this._rightFootRecShape,"RIGHT_FOOT");this._rightFootRecShape=a.refinedFeatures,r=__(a.scores,"RIGHT_FOOT"),o=this._config.tracking_score_t,this._fastMovements_R&&(o=.1),s=this._reproj_t,this._fastMovements_R&&(s=this._reproj_fast_t),r>=o?(t=this.computePoseSync(this._rightFootState,"RIGHT_FOOT"),this._rightFootState=l_.Tracking,t>s&&(this._rightFootState=l_.Detection)):this._rightFootState=l_.Detection,a=this.detectFeetSync(e),this._initShape=a.refinedFeatures,i=__(a.scores,"LEFT_FOOT"),r=__(a.scores,"RIGHT_FOOT");var c=!1;if(!this._fastMovements_R&&null!=this._cnnOutputDataInvMask){var u=B_(this._cnnOutputDataInvMask,this._footDetectorShape[1],this._footDetectorShape[2],this._footDetectorShape[3],!1);u[0];var l=__(p=u[1],"LEFT_FOOT"),d=__(p,"RIGHT_FOOT");r>i&&r>d+.1&&l>d&&(c=!0)}c&&r>this._config.detection_score_t?(this.invertFoot(),this.computePoseSync(this._rightFootState,"RIGHT_FOOT"),this._rightFootRecShape=a.refinedFeatures,this._rightFootState=l_.Detected):i>=this._config.detection_score_t&&(this.computePoseSync(this._leftFootState,"LEFT_FOOT"),this._leftFootRecShape=a.refinedFeatures,this._leftFootState=l_.Detected)}else if(this._leftFootState!==l_.Detection&&this._rightFootState===l_.Detection){var h=this.detectFootFeaturesSync(e,this._leftFootState,this._leftFootState==l_.Detected?this._initShape:this._leftFootRecShape,"LEFT_FOOT");if(this._leftFootRecShape=h.refinedFeatures,i=__(h.scores,"LEFT_FOOT"),o=this._config.tracking_score_t,this._fastMovements_L&&(o=.1),s=this._reproj_t,this._fastMovements_L&&(s=this._reproj_fast_t),i>=o?(t=this.computePoseSync(this._leftFootState,"LEFT_FOOT"),this._leftFootState=l_.Tracking,t>s&&(this._leftFootState=l_.Detection)):this._leftFootState=l_.Detection,h=this.detectFeetSync(e),this._initShape=h.refinedFeatures,r=__(h.scores,"RIGHT_FOOT"),i=__(h.scores,"LEFT_FOOT"),c=!1,!this._fastMovements_L&&null!=this._cnnOutputDataInvMask){var p,f=B_(this._cnnOutputDataInvMask,this._footDetectorShape[1],this._footDetectorShape[2],this._footDetectorShape[3],!1);f[0],l=__(p=f[1],"LEFT_FOOT"),d=__(p,"RIGHT_FOOT"),i>r&&i>l+.1&&d>l&&(c=!0)}c&&i>this._config.detection_score_t?(this.invertFoot(),this.computePoseSync(this._leftFootState,"LEFT_FOOT"),this._leftFootRecShape=h.refinedFeatures,this._leftFootState=l_.Detected):r>=this._config.detection_score_t&&(this.computePoseSync(this._rightFootState,"RIGHT_FOOT"),this._rightFootRecShape=h.refinedFeatures,this._rightFootState=l_.Detected)}else if(this._leftFootState===l_.Detection||this._rightFootState===l_.Detection){this._fastMovements_L=!0,this._fastMovements_R=!0;var A=this._poseModule.cwrap("xzimgMatchRecKeypsInit","number",["number"]);null==this._hptrImageBuffer&&(this._hptrImageBuffer=this._poseModule._malloc(e.width*e.height*4)),N_(this._poseModule,e,this._hptrImageBuffer);var E=D_(this._poseModule,this._hptrImageBuffer,e.width,e.height);A(E),this._poseModule._free(E);var g=this.detectFeetSync(e);this._initShape=g.refinedFeatures;var _=__(g.scores,"LEFT_FOOT"),m=__(g.scores,"RIGHT_FOOT");_>=this._config.detection_score_t&&(this.computePoseSync(this._trackingState,"LEFT_FOOT"),this._leftFootState=l_.Detected),m>=this._config.detection_score_t&&(this.computePoseSync(this._trackingState,"RIGHT_FOOT"),this._rightFootState=l_.Detected),this._rightFootState!=l_.Detection&&this._leftFootState!=l_.Detection&&this.bothFeetSamePlaceInit()&&(this._rightFootState==l_.Detected?this._rightFootState=l_.Detection:this._leftFootState=l_.Detection)}this._leftFootState===l_.Detection&&(this._pose_L=new Q_(new Float32Array([1,0,0,0,-1,0,0,0,-1]),new Float32Array([0,0,0]))),this._rightFootState==l_.Detection&&(this._pose_R=new Q_(new Float32Array([1,0,0,0,-1,0,0,0,-1]),new Float32Array([0,0,0]))),this._pose_R.setTrackingState(this._rightFootState),this._pose_R.type=0,this._poseManager_R.setPose(this._pose_R),this._pose_L.setTrackingState(this._leftFootState),this._pose_L.type=1,this._poseManager_L.setPose(this._pose_L)},r.prototype.trackBothFeet=function(e){return t(this,void 0,void 0,(function(){var t,r,i,o,s,a,c,u,l,d,h,p,f,A,E,g,_,m,I;return n(this,(function(n){switch(n.label){case 0:return t=-1,this._rightFootState==l_.Detection||this._leftFootState==l_.Detection?[3,8]:[4,this.detectBothFeetFeatures(e,this._leftFootState,this._rightFootState,this._leftFootState==l_.Detected?this._initShape:this._leftFootRecShape,this._rightFootState==l_.Detected?this._initShape:this._rightFootRecShape)];case 1:return r=n.sent(),l=__(r.scores_R,"RIGHT_FOOT"),this._rightFootRecShape=r.refinedFeatures_R,a=__(r.scores_L,"LEFT_FOOT"),this._leftFootRecShape=r.refinedFeatures_L,c=this._config.tracking_score_t,this._fastMovements_R&&(c=.1),u=this._reproj_t,this._fastMovements_R&&(u=this._reproj_fast_t),l>=c?[4,this.computePose(this._rightFootState,"RIGHT_FOOT")]:[3,3];case 2:return t=n.sent(),this._rightFootState=l_.Tracking,t>u&&(this._rightFootState=l_.Detection),[3,4];case 3:this._rightFootState=l_.Detection,n.label=4;case 4:return c=this._config.tracking_score_t,this._fastMovements_L&&(c=.1),u=this._reproj_t,this._fastMovements_L&&(u=this._reproj_fast_t),a>=c?[4,this.computePose(this._leftFootState,"LEFT_FOOT")]:[3,6];case 5:return t=n.sent(),this._leftFootState=l_.Tracking,t>u&&(this._leftFootState=l_.Detection),[3,7];case 6:this._leftFootState=l_.Detection,n.label=7;case 7:return[3,34];case 8:return this._rightFootState===l_.Detection||this._leftFootState!==l_.Detection?[3,18]:[4,this.detectFootFeatures(e,this._rightFootState,this._rightFootState==l_.Detected?this._initShape:this._rightFootRecShape,"RIGHT_FOOT")];case 9:return i=n.sent(),this._rightFootRecShape=i.refinedFeatures,l=__(i.scores,"RIGHT_FOOT"),c=this._config.tracking_score_t,this._fastMovements_R&&(c=.1),u=this._reproj_t,this._fastMovements_R&&(u=this._reproj_fast_t),l>=c?[4,this.computePose(this._rightFootState,"RIGHT_FOOT")]:[3,11];case 10:return t=n.sent(),this._rightFootState=l_.Tracking,t>u&&(this._rightFootState=l_.Detection),[3,12];case 11:this._rightFootState=l_.Detection,n.label=12;case 12:return[4,this.detectFeet(e)];case 13:return i=n.sent(),this._initShape=i.refinedFeatures,a=__(i.scores,"LEFT_FOOT"),l=__(i.scores,"RIGHT_FOOT"),d=!1,this._fastMovements_R||null==this._cnnOutputDataInvMask||((o=B_(this._cnnOutputDataInvMask,this._footDetectorShape[1],this._footDetectorShape[2],this._footDetectorShape[3],!1))[0],p=o[1],f=__(p,"LEFT_FOOT"),A=__(p,"RIGHT_FOOT"),l>a&&l>A+.1&&f>A&&(d=!0)),d&&l>this._config.detection_score_t?(this.invertFoot(),[4,this.computePose(this._rightFootState,"RIGHT_FOOT")]):[3,15];case 14:return n.sent(),this._rightFootRecShape=i.refinedFeatures,this._rightFootState=l_.Detected,[3,17];case 15:return a>=this._config.detection_score_t?[4,this.computePose(this._leftFootState,"LEFT_FOOT")]:[3,17];case 16:n.sent(),this._leftFootRecShape=i.refinedFeatures,this._leftFootState=l_.Detected,n.label=17;case 17:return[3,34];case 18:return this._leftFootState===l_.Detection||this._rightFootState!==l_.Detection?[3,28]:[4,this.detectFootFeatures(e,this._leftFootState,this._leftFootState==l_.Detected?this._initShape:this._leftFootRecShape,"LEFT_FOOT")];case 19:return s=n.sent(),this._leftFootRecShape=s.refinedFeatures,a=__(s.scores,"LEFT_FOOT"),c=this._config.tracking_score_t,this._fastMovements_L&&(c=.1),u=this._reproj_t,this._fastMovements_L&&(u=this._reproj_fast_t),a>=c?[4,this.computePose(this._leftFootState,"LEFT_FOOT")]:[3,21];case 20:return t=n.sent(),this._leftFootState=l_.Tracking,t>u&&(this._leftFootState=l_.Detection),[3,22];case 21:this._leftFootState=l_.Detection,n.label=22;case 22:return[4,this.detectFeet(e)];case 23:return s=n.sent(),this._initShape=s.refinedFeatures,l=__(s.scores,"RIGHT_FOOT"),a=__(s.scores,"LEFT_FOOT"),d=!1,this._fastMovements_L||null==this._cnnOutputDataInvMask||((h=B_(this._cnnOutputDataInvMask,this._footDetectorShape[1],this._footDetectorShape[2],this._footDetectorShape[3],!1))[0],p=h[1],f=__(p,"LEFT_FOOT"),A=__(p,"RIGHT_FOOT"),a>l&&a>f+.1&&A>f&&(d=!0)),d&&a>this._config.detection_score_t?(this.invertFoot(),[4,this.computePose(this._leftFootState,"LEFT_FOOT")]):[3,25];case 24:return n.sent(),this._leftFootRecShape=s.refinedFeatures,this._leftFootState=l_.Detected,[3,27];case 25:return l>=this._config.detection_score_t?[4,this.computePose(this._rightFootState,"RIGHT_FOOT")]:[3,27];case 26:n.sent(),this._rightFootRecShape=s.refinedFeatures,this._rightFootState=l_.Detected,n.label=27;case 27:return[3,34];case 28:return this._leftFootState!==l_.Detection&&this._rightFootState!==l_.Detection?[3,34]:(this._fastMovements_L=!0,this._fastMovements_R=!0,E=this._poseModule.cwrap("xzimgMatchRecKeypsInit","number",["number"]),null==this._hptrImageBuffer&&(this._hptrImageBuffer=this._poseModule._malloc(e.width*e.height*4)),N_(this._poseModule,e,this._hptrImageBuffer),g=D_(this._poseModule,this._hptrImageBuffer,e.width,e.height),E(g),this._poseModule._free(g),[4,this.detectFeet(e)]);case 29:return _=n.sent(),this._initShape=_.refinedFeatures,m=__(_.scores,"LEFT_FOOT"),I=__(_.scores,"RIGHT_FOOT"),m>=this._config.detection_score_t?[4,this.computePose(this._trackingState,"LEFT_FOOT")]:[3,31];case 30:n.sent(),this._leftFootState=l_.Detected,n.label=31;case 31:return I>=this._config.detection_score_t?[4,this.computePose(this._trackingState,"RIGHT_FOOT")]:[3,33];case 32:n.sent(),this._rightFootState=l_.Detected,n.label=33;case 33:this._rightFootState!=l_.Detection&&this._leftFootState!=l_.Detection&&this.bothFeetSamePlaceInit()&&(this._rightFootState==l_.Detected?this._rightFootState=l_.Detection:this._leftFootState=l_.Detection),n.label=34;case 34:return this._leftFootState===l_.Detection&&(this._pose_L=new Q_(new Float32Array([1,0,0,0,-1,0,0,0,-1]),new Float32Array([0,0,0]))),this._rightFootState==l_.Detection&&(this._pose_R=new Q_(new Float32Array([1,0,0,0,-1,0,0,0,-1]),new Float32Array([0,0,0]))),this._pose_R.setTrackingState(this._rightFootState),this._pose_R.type=0,this._poseManager_R.setPose(this._pose_R),this._pose_L.setTrackingState(this._leftFootState),this._pose_L.type=1,this._poseManager_L.setPose(this._pose_L),[2]}}))}))},r.prototype.detectFeetSync=function(e){var t,n,r,i,o=S_(this._currentWidth,this._currentHeight),s=o.crop,a=o.deltaY,c=o.deltaX,u=co(e),l=Ki(u,"float32"),d=rs(l,[1,this._currentHeight,this._currentWidth,3]),h=bu.cropAndResize(d,[s],[0],[this._footDetectorConfig.inHeight,this._footDetectorConfig.inWidth]),p=zs(255),f=No(h,p),A=null;if(this._footToDetect==G_.Both&&(this._leftFootState===l_.Tracking||this._rightFootState===l_.Tracking)){var E=A_(this._leftFootState===l_.Tracking?this._leftFootRecShape:this._rightFootRecShape,this._footDetectorConfig.inHeight,this._footDetectorConfig.inWidth,a,c,(this._currentHeight-2*a)/this._footDetectorConfig.inWidth,(this._currentWidth-2*c)/this._footDetectorConfig.inHeight,this._leftFootState===l_.Tracking?"LEFT_FOOT":"RIGHT_FOOT");this._debug&&(this._debugInitialized=!0,this._debugImage=m_(this._footDetectorConfig.inHeight,this._footDetectorConfig.inWidth,E));var g=wc(E,"float32");A=rs(g,[1,this._footDetectorConfig.inHeight,this._footDetectorConfig.inWidth,1]),g.dispose()}var _=this._tfFootDetector.predict(f);if(null!=A){var m=Ra(1,A),I=Do(_,m);this._cnnOutputDataInvMask=I.dataSync(),m.dispose(),I.dispose();var T=Do(_,A);_.dispose(),_=T,A.dispose()}var R,v,y=null!==(n=null==_?void 0:_.shape[3])&&void 0!==n?n:this._footDetectorConfig.outChannels,S=null!==(r=null==_?void 0:_.shape[1])&&void 0!==r?r:this._footDetectorConfig.outHeight,C=null!==(i=null==_?void 0:_.shape[2])&&void 0!==i?i:this._footDetectorConfig.outWidth,O=_.dataSync();R=(t=B_(O,S,C,y))[0],v=t[1];var b=this._bufferKeypsDet/4;this._poseModule.HEAPF32.subarray(b,b+2*y).set(R),this._debug&&(this._debugInitialized=!0,this._debugImage=I_(_.shape[1],_.shape[2],_.shape[3],O)),u.dispose(),l.dispose(),p.dispose(),h.dispose(),f.dispose(),d.dispose(),_.dispose();var w=Math.min(this._currentWidth,this._currentHeight),N=w/this._footDetectorConfig.inWidth,D=w/this._footDetectorConfig.inHeight;return this._simToImage_Det=E_(a,c,D,N),{refinedFeatures:T_(R,this._simToImage_Det,!1,_.shape[1]),scores:v}},r.prototype.detectFeet=function(e){var r,i,o;return t(this,void 0,void 0,(function(){var t,s,a,c,u,l,d,h,p,f,A,E,g,_,m,I,T,R,v,y,S,C,O,b,w,N,D,L,P;return n(this,(function(n){switch(n.label){case 0:return t=S_(this._currentWidth,this._currentHeight),s=t.crop,a=t.deltaY,c=t.deltaX,u=co(e),l=Ki(u,"float32"),d=rs(l,[1,this._currentHeight,this._currentWidth,3]),h=bu.cropAndResize(d,[s],[0],[this._footDetectorConfig.inHeight,this._footDetectorConfig.inWidth]),p=zs(255),f=No(h,p),A=null,this._footToDetect!=G_.Both||this._leftFootState!==l_.Tracking&&this._rightFootState!==l_.Tracking||(E=A_(this._leftFootState===l_.Tracking?this._leftFootRecShape:this._rightFootRecShape,this._footDetectorConfig.inHeight,this._footDetectorConfig.inWidth,a,c,(this._currentHeight-2*a)/this._footDetectorConfig.inWidth,(this._currentWidth-2*c)/this._footDetectorConfig.inHeight,this._leftFootState===l_.Tracking?"LEFT_FOOT":"RIGHT_FOOT"),this._debug&&(this._debugInitialized=!0,this._debugImage=m_(this._footDetectorConfig.inHeight,this._footDetectorConfig.inWidth,E)),g=wc(E,"float32"),A=rs(g,[1,this._footDetectorConfig.inHeight,this._footDetectorConfig.inWidth,1]),g.dispose()),_=this._tfFootDetector.predict(f),null==A?[3,2]:(m=Ra(1,A),I=Do(_,m),T=this,[4,I.data()]);case 1:T._cnnOutputDataInvMask=n.sent(),m.dispose(),I.dispose(),R=Do(_,A),_.dispose(),_=R,A.dispose(),n.label=2;case 2:return v=null!==(r=null==_?void 0:_.shape[3])&&void 0!==r?r:this._footDetectorConfig.outChannels,y=null!==(i=null==_?void 0:_.shape[1])&&void 0!==i?i:this._footDetectorConfig.outHeight,S=null!==(o=null==_?void 0:_.shape[2])&&void 0!==o?o:this._footDetectorConfig.outWidth,[4,_.data()];case 3:return C=n.sent(),P=B_(C,y,S,v),O=P[0],b=P[1],w=this._bufferKeypsDet/4,this._poseModule.HEAPF32.subarray(w,w+2*v).set(O),this._debug&&(this._debugInitialized=!0,this._debugImage=I_(_.shape[1],_.shape[2],_.shape[3],C)),u.dispose(),l.dispose(),p.dispose(),h.dispose(),f.dispose(),d.dispose(),_.dispose(),N=Math.min(this._currentWidth,this._currentHeight),D=N/this._footDetectorConfig.inWidth,L=N/this._footDetectorConfig.inHeight,this._simToImage_Det=E_(a,c,L,D),[2,{refinedFeatures:T_(O,this._simToImage_Det,!1,_.shape[1]),scores:b}]}}))}))},r.prototype.detectFootFeaturesSync=function(e,t,n,r){var i,o,s,a,c,u,l,d,h,p,f="LEFT_FOOT"==r?this._simToImage_L:this._simToImage_R,A=new Int32Array(n.length/2);A.fill(1),t!=l_.Detected?(h=(i=k_(this._poseModule,e,this._hptrImageBuffer,n,A))[0],p=i[1],Math.sqrt(p[2]*p[2]+p[3]*p[3])>10?"LEFT_FOOT"==r?this._fastMovements_L=!0:this._fastMovements_R=!0:"LEFT_FOOT"==r?this._fastMovements_L=!1:this._fastMovements_R=!1,"LEFT_FOOT"==r?M_(this._poseModule,this._bufferInOutPose_L,p,this._fx,this._fy):"RIGHT_FOOT"==r&&M_(this._poseModule,this._bufferInOutPose_R,p,this._fx,this._fy)):h=n,f=O_(h,this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight,this._currentWidth,this._currentHeight,t==l_.Detected?null:f,r);var E=new ImageData(this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight);E=y_(e,E,f);var g=co(E),_=Ki(g,"float32"),m=rs(_,[1,this._footFeaturesConfig.inHeight,this._footFeaturesConfig.inWidth,3]),I=zs(255),T=No(m,I),R=null;R="LEFT_FOOT"==r?lc(T,1):T;var v,y,S=this._tfFootFeatures.predict(R),C=S.dataSync();if(this._useWasmForHeatmaps){var O=this._poseModule.cwrap("xzimgGetHeatmapsLocations","number",["number","number","number","number","number","number","number","number"]),b=(N=null!==(s=null==S?void 0:S.shape[3])&&void 0!==s?s:this._footFeaturesConfig.outChannels)*(D=null!==(a=null==S?void 0:S.shape[1])&&void 0!==a?a:this._footFeaturesConfig.outHeight)*(L=null!==(c=null==S?void 0:S.shape[2])&&void 0!==c?c:this._footFeaturesConfig.outWidth),w="LEFT_FOOT"==r?this._bufferHeatmaps_L/4:this._bufferHeatmaps_R/4;this._poseModule.HEAPF32.subarray(w,w+b).set(C),O("LEFT_FOOT"==r?this._bufferHeatmaps_L:this._bufferHeatmaps_R,D,L,N,0,2,"LEFT_FOOT"==r?this._bufferKeypsTrack_L:this._bufferKeypsTrack_R,this._bufferFeatureScores),y=new Float32Array(this._poseModule.HEAPF32.buffer,"LEFT_FOOT"==r?this._bufferKeypsTrack_L:this._bufferKeypsTrack_R,2*N),v=new Float32Array(this._poseModule.HEAPF32.buffer,this._bufferFeatureScores,N)}else{var N,D,L,P=(N=null!==(u=null==S?void 0:S.shape[3])&&void 0!==u?u:this._footFeaturesConfig.outChannels)*(D=null!==(l=null==S?void 0:S.shape[1])&&void 0!==l?l:this._footFeaturesConfig.outHeight)*(L=null!==(d=null==S?void 0:S.shape[2])&&void 0!==d?d:this._footFeaturesConfig.outWidth);y=(o=B_(C,D,L,N))[0],v=o[1],w="LEFT_FOOT"==r?this._bufferKeypsTrack_L/4:this._bufferKeypsTrack_R/4,this._poseModule.HEAPF32.subarray(w,w+2*N).set(y),w="LEFT_FOOT"==r?this._bufferHeatmaps_L/4:this._bufferHeatmaps_R/4,this._poseModule.HEAPF32.subarray(w,w+P).set(C)}g.dispose(),_.dispose(),I.dispose(),T.dispose(),m.dispose(),S.dispose(),"LEFT_FOOT"==r&&R.dispose();var k=T_(y,f,"LEFT_FOOT"==r,S.shape[1]);return"LEFT_FOOT"==r?this._simToImage_L=f:this._simToImage_R=f,{refinedFeatures:k,scores:v}},r.prototype.detectFootFeatures=function(e,r,i,o){var s,a,c,u,l,d;return t(this,void 0,void 0,(function(){var t,h,p,f,A,E,g,_,m,I,T,R,v,y,S,C,O,b,w,N,D,L,P,k,x;return n(this,(function(n){switch(n.label){case 0:return t="LEFT_FOOT"==o?this._simToImage_L:this._simToImage_R,(p=new Int32Array(i.length/2)).fill(1),r!=l_.Detected?(k=k_(this._poseModule,e,this._hptrImageBuffer,i,p),h=k[0],f=k[1],Math.sqrt(f[2]*f[2]+f[3]*f[3])>10?"LEFT_FOOT"==o?this._fastMovements_L=!0:this._fastMovements_R=!0:"LEFT_FOOT"==o?this._fastMovements_L=!1:this._fastMovements_R=!1,"LEFT_FOOT"==o?M_(this._poseModule,this._bufferInOutPose_L,f,this._fx,this._fy):"RIGHT_FOOT"==o&&M_(this._poseModule,this._bufferInOutPose_R,f,this._fx,this._fy)):h=i,t=O_(h,this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight,this._currentWidth,this._currentHeight,r==l_.Detected?null:t,o),A=new ImageData(this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight),A=y_(e,A,t),E=co(A),g=Ki(E,"float32"),_=rs(g,[1,this._footFeaturesConfig.inHeight,this._footFeaturesConfig.inWidth,3]),m=zs(255),I=No(_,m),T=null,T="LEFT_FOOT"==o?lc(I,1):I,[4,(R=this._tfFootFeatures.predict(T)).data()];case 1:return v=n.sent(),this._useWasmForHeatmaps?(C=this._poseModule.cwrap("xzimgGetHeatmapsLocations","number",["number","number","number","number","number","number","number","number"]),b=null!==(s=null==R?void 0:R.shape[3])&&void 0!==s?s:this._footFeaturesConfig.outChannels,w=null!==(a=null==R?void 0:R.shape[1])&&void 0!==a?a:this._footFeaturesConfig.outHeight,N=null!==(c=null==R?void 0:R.shape[2])&&void 0!==c?c:this._footFeaturesConfig.outWidth,O=b*w*N,L="LEFT_FOOT"==o?this._bufferHeatmaps_L/4:this._bufferHeatmaps_R/4,this._poseModule.HEAPF32.subarray(L,L+O).set(v),C("LEFT_FOOT"==o?this._bufferHeatmaps_L:this._bufferHeatmaps_R,w,N,b,0,2,"LEFT_FOOT"==o?this._bufferKeypsTrack_L:this._bufferKeypsTrack_R,this._bufferFeatureScores),S=new Float32Array(this._poseModule.HEAPF32.buffer,"LEFT_FOOT"==o?this._bufferKeypsTrack_L:this._bufferKeypsTrack_R,2*b),y=new Float32Array(this._poseModule.HEAPF32.buffer,this._bufferFeatureScores,b)):(b=null!==(u=null==R?void 0:R.shape[3])&&void 0!==u?u:this._footFeaturesConfig.outChannels,w=null!==(l=null==R?void 0:R.shape[1])&&void 0!==l?l:this._footFeaturesConfig.outHeight,N=null!==(d=null==R?void 0:R.shape[2])&&void 0!==d?d:this._footFeaturesConfig.outWidth,D=b*w*N,x=B_(v,w,N,b),S=x[0],y=x[1],L="LEFT_FOOT"==o?this._bufferKeypsTrack_L/4:this._bufferKeypsTrack_R/4,this._poseModule.HEAPF32.subarray(L,L+2*b).set(S),L="LEFT_FOOT"==o?this._bufferHeatmaps_L/4:this._bufferHeatmaps_R/4,this._poseModule.HEAPF32.subarray(L,L+D).set(v)),E.dispose(),g.dispose(),m.dispose(),I.dispose(),_.dispose(),R.dispose(),"LEFT_FOOT"==o&&T.dispose(),P=T_(S,t,"LEFT_FOOT"==o,R.shape[1]),"LEFT_FOOT"==o?this._simToImage_L=t:this._simToImage_R=t,[2,{refinedFeatures:P,scores:y}]}}))}))},r.prototype.detectBothFeetFeaturesSync=function(e,t,n,r,i){var o,s,a,c,u,l,d,h;if(t!=l_.Detected&&n!=l_.Detected){var p=new Int32Array(r.length);p.fill(1);var f=k_(this._poseModule,e,this._hptrImageBuffer,L_(r,i),p),A=f[0];f[1];var E=f[2];d=(o=P_(A,r.length/2,i.length/2))[0],h=o[1];var g=E.slice(0,r.length/2),_=E.slice(r.length/2,r.length),m=x_(this._poseModule,r,d),I=x_(this._poseModule,i,h);Math.sqrt(m[2]*m[2]+m[3]*m[3])>10?this._fastMovements_L=!0:this._fastMovements_L=!1,Math.sqrt(I[2]*I[2]+I[3]*I[3])>10?this._fastMovements_R=!0:this._fastMovements_R=!1,U_(this._poseModule,this._bufferInOutPose_L,r,d,g,this._fx,this._fy),U_(this._poseModule,this._bufferInOutPose_R,i,h,_,this._fx,this._fy)}else d=r,h=i;this._simToImage_L=O_(d,this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight,this._currentWidth,this._currentHeight,t==l_.Detected?null:this._simToImage_L,"LEFT_FOOT");var T=new ImageData(this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight);T=y_(e,T,this._simToImage_L),this._simToImage_R=O_(h,this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight,this._currentWidth,this._currentHeight,n==l_.Detected?null:this._simToImage_R,"RIGHT_FOOT");var R=new ImageData(this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight);R=y_(e,R,this._simToImage_R);var v=co(T),y=Ki(v,"float32"),S=rs(y,[1,this._footFeaturesConfig.inHeight,this._footFeaturesConfig.inWidth,3]),C=zs(255),O=No(S,C),b=lc(O,1);v=co(R),y=Ki(v,"float32"),S=rs(y,[1,this._footFeaturesConfig.inHeight,this._footFeaturesConfig.inWidth,3]);var w,N,D,L,P=No(S,C),k=as([b,P]),x=this._tfFootFeatures.predict(k),M=kc(x,0),U=M[0].dataSync(),B=M[1].dataSync(),F=null!==(c=null==x?void 0:x.shape[3])&&void 0!==c?c:this._footFeaturesConfig.outChannels,V=null!==(u=null==x?void 0:x.shape[1])&&void 0!==u?u:this._footFeaturesConfig.outHeight,G=null!==(l=null==x?void 0:x.shape[2])&&void 0!==l?l:this._footFeaturesConfig.outWidth,Q=F*V*G,j=U,H=B;w=(s=B_(j,V,G,F,!1))[0],D=s[1],N=(a=B_(H,V,G,F,!1))[0],L=a[1];var W=this._bufferKeypsTrack_L/4,Y=this._poseModule.HEAPF32.subarray(W,W+2*F);return Y.set(w),W=this._bufferKeypsTrack_R/4,(Y=this._poseModule.HEAPF32.subarray(W,W+2*F)).set(N),W=this._bufferHeatmaps_L/4,(Y=this._poseModule.HEAPF32.subarray(W,W+Q)).set(j),W=this._bufferHeatmaps_R/4,(Y=this._poseModule.HEAPF32.subarray(W,W+Q)).set(H),v.dispose(),y.dispose(),C.dispose(),O.dispose(),b.dispose(),P.dispose(),S.dispose(),x.dispose(),M.forEach((function(e){return e.dispose()})),k.dispose(),{refinedFeatures_L:T_(w,this._simToImage_L,!0,x.shape[1]),refinedFeatures_R:T_(N,this._simToImage_R,!1,x.shape[1]),scores_L:D,scores_R:L}},r.prototype.detectBothFeetFeatures=function(e,r,i,o,s){var a,c,u;return t(this,void 0,void 0,(function(){var t,l,d,h,p,f,A,E,g,_,m,I,T,R,v,y,S,C,O,b,w,N,D,L,P,k,x,M,U,B,F,V,G,Q,j,H,W,Y,K,$;return n(this,(function(n){switch(n.label){case 0:return r!=l_.Detected&&i!=l_.Detected?((d=new Int32Array(o.length)).fill(1),h=k_(this._poseModule,e,this._hptrImageBuffer,L_(o,s),d),p=h[0],h[1],f=h[2],Y=P_(p,o.length/2,s.length/2),t=Y[0],l=Y[1],A=f.slice(0,o.length/2),E=f.slice(o.length/2,o.length),g=x_(this._poseModule,o,t),_=x_(this._poseModule,s,l),Math.sqrt(g[2]*g[2]+g[3]*g[3])>10?this._fastMovements_L=!0:this._fastMovements_L=!1,Math.sqrt(_[2]*_[2]+_[3]*_[3])>10?this._fastMovements_R=!0:this._fastMovements_R=!1,U_(this._poseModule,this._bufferInOutPose_L,o,t,A,this._fx,this._fy),U_(this._poseModule,this._bufferInOutPose_R,s,l,E,this._fx,this._fy)):(t=o,l=s),this._simToImage_L=O_(t,this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight,this._currentWidth,this._currentHeight,r==l_.Detected?null:this._simToImage_L,"LEFT_FOOT"),m=new ImageData(this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight),m=y_(e,m,this._simToImage_L),this._simToImage_R=O_(l,this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight,this._currentWidth,this._currentHeight,i==l_.Detected?null:this._simToImage_R,"RIGHT_FOOT"),I=new ImageData(this._footFeaturesConfig.inWidth,this._footFeaturesConfig.inHeight),I=y_(e,I,this._simToImage_R),T=co(m),R=Ki(T,"float32"),v=rs(R,[1,this._footFeaturesConfig.inHeight,this._footFeaturesConfig.inWidth,3]),y=zs(255),S=No(v,y),C=lc(S,1),T=co(I),R=Ki(T,"float32"),v=rs(R,[1,this._footFeaturesConfig.inHeight,this._footFeaturesConfig.inWidth,3]),O=No(v,y),b=as([C,O]),w=this._tfFootFeatures.predict(b),[4,(N=kc(w,0))[0].data()];case 1:return D=n.sent(),[4,N[1].data()];case 2:return L=n.sent(),P=null!==(a=null==w?void 0:w.shape[3])&&void 0!==a?a:this._footFeaturesConfig.outChannels,k=null!==(c=null==w?void 0:w.shape[1])&&void 0!==c?c:this._footFeaturesConfig.outHeight,x=null!==(u=null==w?void 0:w.shape[2])&&void 0!==u?u:this._footFeaturesConfig.outWidth,M=P*k*x,Q=L,K=B_(G=D,k,x,P,!1),U=K[0],F=K[1],$=B_(Q,k,x,P,!1),B=$[0],V=$[1],j=this._bufferKeypsTrack_L/4,this._poseModule.HEAPF32.subarray(j,j+2*P).set(U),j=this._bufferKeypsTrack_R/4,this._poseModule.HEAPF32.subarray(j,j+2*P).set(B),j=this._bufferHeatmaps_L/4,this._poseModule.HEAPF32.subarray(j,j+M).set(G),j=this._bufferHeatmaps_R/4,this._poseModule.HEAPF32.subarray(j,j+M).set(Q),T.dispose(),R.dispose(),y.dispose(),S.dispose(),C.dispose(),O.dispose(),v.dispose(),w.dispose(),N.forEach((function(e){return e.dispose()})),b.dispose(),H=T_(U,this._simToImage_L,!0,w.shape[1]),W=T_(B,this._simToImage_R,!1,w.shape[1]),[2,{refinedFeatures_L:H,refinedFeatures_R:W,scores_L:F,scores_R:V}]}}))}))},r.prototype.computePoseSync=function(e,t){var n=-1,r=null;if(this._useWasmForPose&&(r=this._poseModule.cwrap("xzimgEstimateRigidPose","number",["number","number","number","number","number","number","number","number","number","number","number","number"])),e==l_.Detection){var i=C_(this._initShape,t),o=i[0],s=i[1],a=i[2],c=F_(i[3],a,o-this._cx,s-this._cy,this._fx,this._fy,2.4),u=c[0],l=c[1];"LEFT_FOOT"==t?this._pose_L=new Q_(u,l):"RIGHT_FOOT"==t&&(this._pose_R=new Q_(u,l));var d=(f="LEFT_FOOT"==t?this._bufferInOutPose_L:this._bufferInOutPose_R)/4;return(A=this._poseModule.HEAPF32.subarray(d,d+9)).set(u),(A=this._poseModule.HEAPF32.subarray(d+9,d+12)).set(l),-1}if(e==l_.Detected||e==l_.Tracking){if(this._useWasmForPose){var h=1;e==l_.Detected&&(h=0);var p=3;"LEFT_FOOT"!=t||this._fastMovements_L||(p=1),"RIGHT_FOOT"!=t||this._fastMovements_R||(p=1);var f="LEFT_FOOT"==t?this._bufferInOutPose_L:this._bufferInOutPose_R,A=(d=this._bufferSimToImage/4,this._poseModule.HEAPF32.subarray(d,d+8)),E="LEFT_FOOT"==t?this._simToImage_L:this._simToImage_R,g=Float32Array.from(E);"LEFT_FOOT"==t&&(g[2]+=g[1]*(this._footFeaturesShape[1]-1),g[5]+=g[4]*(this._footFeaturesShape[1]-1),g[1]=-g[1],g[4]=-g[4]),A.set(g),-1==(n=r("LEFT_FOOT"==t?this._bufferHeatmaps_L:this._bufferHeatmaps_R,this._footFeaturesShape[1],this._footFeaturesShape[2],this._footFeaturesShape[3],0,this._bufferSimToImage,null,"LEFT_FOOT"==t?this._bufferKeyps3D_L:this._bufferKeyps3D_R,h,3,p,f))&&(n=1e4),"LEFT_FOOT"==t?this._pose_L=new Q_(new Float32Array(this._poseModule.HEAPF32.buffer,f,9),new Float32Array(this._poseModule.HEAPF32.buffer,f+9*this._float_size,3)):this._pose_R=new Q_(new Float32Array(this._poseModule.HEAPF32.buffer,f,9),new Float32Array(this._poseModule.HEAPF32.buffer,f+9*this._float_size,3))}return n}return-1},r.prototype.computePose=function(e,r){return t(this,void 0,void 0,(function(){var t,i,o,s,a,c,u,l,d,h,p,f,A,E,g,_,m;return n(this,(function(n){return t=-1,i=null,this._useWasmForPose&&(i=this._poseModule.cwrap("xzimgEstimateRigidPose","number",["number","number","number","number","number","number","number","number","number","number","number","number"])),e==l_.Detection?(o=C_(this._initShape,r),s=o[0],a=o[1],c=o[2],u=o[3],l=F_(u,c,s-this._cx,a-this._cy,this._fx,this._fy,2.4),d=l[0],h=l[1],"LEFT_FOOT"==r?this._pose_L=new Q_(d,h):"RIGHT_FOOT"==r&&(this._pose_R=new Q_(d,h)),A="LEFT_FOOT"==r?this._bufferInOutPose_L:this._bufferInOutPose_R,E=A/4,(g=this._poseModule.HEAPF32.subarray(E,E+9)).set(d),(g=this._poseModule.HEAPF32.subarray(E+9,E+12)).set(h),[2,-1]):e==l_.Detected||e==l_.Tracking?(this._useWasmForPose&&(p=1,e==l_.Detected&&(p=0),f=3,"LEFT_FOOT"!=r||this._fastMovements_L||(f=1),"RIGHT_FOOT"!=r||this._fastMovements_R||(f=1),A="LEFT_FOOT"==r?this._bufferInOutPose_L:this._bufferInOutPose_R,E=this._bufferSimToImage/4,g=this._poseModule.HEAPF32.subarray(E,E+8),_="LEFT_FOOT"==r?this._simToImage_L:this._simToImage_R,m=Float32Array.from(_),"LEFT_FOOT"==r&&(m[2]+=m[1]*(this._footFeaturesShape[1]-1),m[5]+=m[4]*(this._footFeaturesShape[1]-1),m[1]=-m[1],m[4]=-m[4]),g.set(m),-1==(t=i("LEFT_FOOT"==r?this._bufferHeatmaps_L:this._bufferHeatmaps_R,this._footFeaturesShape[1],this._footFeaturesShape[2],this._footFeaturesShape[3],0,this._bufferSimToImage,null,"LEFT_FOOT"==r?this._bufferKeyps3D_L:this._bufferKeyps3D_R,p,3,f,A))&&(t=1e4),"LEFT_FOOT"==r?this._pose_L=new Q_(new Float32Array(this._poseModule.HEAPF32.buffer,A,9),new Float32Array(this._poseModule.HEAPF32.buffer,A+9*this._float_size,3)):this._pose_R=new Q_(new Float32Array(this._poseModule.HEAPF32.buffer,A,9),new Float32Array(this._poseModule.HEAPF32.buffer,A+9*this._float_size,3))),[2,t]):[2,-1]}))}))},r.prototype.invertFoot=function(){var e,t,n,r,i,o,s;e=[this._rightFootRecShape,this._leftFootRecShape],this._rightFootRecShape=e[0],this._rightFootRecShape=e[1],t=[this._bufferInOutPose_R,this._bufferInOutPose_L],this._bufferInOutPose_L=t[0],this._bufferInOutPose_R=t[1],n=[this._pose_L,this._pose_R],this._pose_R=n[0],this._pose_L=n[1],r=[this._poseManager_L,this._poseManager_R],this._poseManager_R=r[0],this._poseManager_L=r[1],i=[this._simToImage_R,this._simToImage_L],this._simToImage_L=i[0],this._simToImage_R=i[1],o=[this._rightFootState,this._leftFootState],this._leftFootState=o[0],this._rightFootState=o[1],s=[this._bufferHeatmaps_L,this._bufferHeatmaps_R],this._bufferHeatmaps_R=s[0],this._bufferHeatmaps_L=s[1]},r.prototype.dst=function(e,t,n,r){return Math.sqrt((e-n)*(e-n)+(t-r)*(t-r))},r.prototype.bothFeetSamePlaceInit=function(){var e=this._initShape.length/2,t=0;return t+=this.dst(this._initShape[0],this._initShape[e],this._initShape[4],this._initShape[4+e]),t+=this.dst(this._initShape[1],this._initShape[1+e],this._initShape[3],this._initShape[3+e]),(t+=this.dst(this._initShape[2],this._initShape[2+e],this._initShape[5],this._initShape[5+e]))/3<this.dst(this._initShape[0],this._initShape[e],this._initShape[2],this._initShape[2+e])/5},r.prototype.bothFeetSamePlace=function(){var e=f_(this._leftFootRecShape,"LEFT_FOOT"),t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=e[6],c=e[7],u=f_(this._rightFootRecShape,"RIGHT_FOOT"),l=u[0],d=u[1],h=u[2],p=u[3],f=u[4],A=u[5],E=u[6],g=u[7],_=this.dst(t,n,a,c)/4;return this.dst(t,n,l,d)<_&&this.dst(r,i,h,p)<_&&this.dst(o,s,f,A)<_&&this.dst(a,c,E,g)<_},r}(),Y_=(H_="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t,n,r;e=e||{},t||(t=void 0!==e?e:{}),t.ready=new Promise((function(e,t){n=e,r=t}));let i=null;var o=null,s=null,a=null,c=null,u=!1,l={},d=null,h=[];t.preinitializedWebGLContext=t.canvas.getContext("webgl",{alpha:!1}),t.process=function(){};let p=new class{get Nh(){switch(this.type){case"Timer":return this.Hh;case"RAF":return this.zh;case"Oscillator":return this.vh}}constructor(){this.vh=this.zh=this.Hh=!1,this.type="RAF",this.Sh=1e3/33}add(e){this.Ih=e}start(){switch(this.type){case"Timer":if(!this.Hh){this.Hh=!0;const e=()=>{setTimeout((()=>{this.Ih&&this.Ih(),this.Hh&&e()}),this.Sh)};e()}break;case"RAF":if(!this.zh){this.zh=!0;const e=t=>{requestAnimationFrame((n=>{n-t<=this.Sh?this.zh&&e(t):this.Ih&&(this.Ih(),e(n))}))};e(performance.now())}break;case"Oscillator":if(!this.vh){i=i||new AudioContext,this.vh=!0;const e=i.createGain();let t;e.gain.value=0,e.connect(i.destination);const n=()=>{this.Ih&&this.Ih(),t&&t.disconnect(),this.Yh=t=i.createOscillator(),t.connect(e),this.vh&&(t.onended=n,t.start(),t.stop(i.currentTime+this.Sh/1e3))};n()}}}stop(){switch(this.type){case"Timer":this.Hh=!1;break;case"RAF":this.zh=!1;break;case"Oscillator":this.vh=!1,this.Yh&&(this.Yh.onended=null,this.Yh=void 0)}}};t.setFps=function(e){p.Sh=1e3/e},p.add((function(){var e=t.video,n=t.context;const r=t.pi;e&&n&&r&&e.readyState===e.HAVE_ENOUGH_DATA&&(e=t.canvas.width,n=t.canvas.height,t.canvasWidth===e&&t.canvasHeight===n||(t.canvasWidth=e,t.canvasHeight=n,Vr(e,n)),t._processFrameVideo(0,t.video.videoWidth,t.video.videoHeight,t.ji),t._render())})),t.startLoop=function(){p.start()},t.endLoop=function(){p.stop()},t.takeScreenshot=function(){Fr(),p.Nh||t._render()},t.startVideoRecording=function(e){if(u)throw"Video recording already started!";if(u=!0,null==d||function(e){var t=l;return Object.keys(t).length===Object.keys(e).length&&Object.keys(t).every((n=>e.hasOwnProperty(n)&&t[n]===e[n]))}(e)){const n={};e.mimeType&&(n.mimeType=e.mimeType),d=new MediaRecorder(t.canvas.captureStream(),n),l=Object.assign({},e),d.ondataavailable=function(e){h.push(e.data)}}d.start()},t.finishVideoRecording=function(e){if(!u)throw"Video recording not started!";d.onstop=function(){e(new Blob(h,{type:l.mimeType||"video/webm"})),h=[],u=!1},d.stop()},t.processFrameRawPixels=function(e,n,r,i){var o=t._malloc(e.length);o&&(t.HEAPU8.set(e,o),t._processFrameRawPixels(o,n,r,i),p.Nh||t._render(),t._free(o))},t.setFaceTrackingModel=function(e){t.faceTrackingModelByteArray=e},t.switchEffectByteArray=function(e,n,r){if(s){var i=t._malloc(r.length);i&&(t.HEAPU8.set(r,i),s(n,i,r.length,e),p.Nh||t._render())}},t.switchEffect=function(e,n,r,i){var o=new XMLHttpRequest;o.open("GET",r,!0),o.responseType="arraybuffer",o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){var r=new Uint8Array(o.response);t.switchEffectByteArray(e,n,r),i&&i()}},o.send(null)},t.clearEffect=function(e){a&&(a(e),p.Nh||t._render())},t.moveGameObject=function(e,n){c&&(c(e,n),p.Nh||t._render())},t.setMirror=function(e){t.ji=!!e},t.startVideo=function(e,n){if(t.video)console.log("video already running");else{t.ti=!1,t.wj=n,t.ji=!!e;var r=document.createElement("video");r.muted=!0,r.loop=!0,r.controls=!0,r.setAttribute("playsinline","playsinline"),r.style.width="100%",r.style.height="100%",(e=document.createElement("div")).appendChild(r),e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style["z-index"]="-1",document.body.appendChild(e),t.gi=e,or=t.video=r,e=t.wj||!0,t.Ki(),navigator.mediaDevices.getUserMedia({video:e}).then((function(e){try{r.srcObject=e}catch(t){r.src=URL.createObjectURL(e)}t.Mi(),setTimeout((function(){r.play()}),50)})).catch((function(){t.Li()})),r.addEventListener("loadedmetadata",(function(){var e=document.createElement("canvas"),n=e.getContext("2d");t.pi=e,t.context=n,n=320/r.videoWidth,e.width=Math.floor(r.videoWidth*n),e.height=Math.floor(r.videoHeight*n),t.$h=t._malloc(e.width*e.height*4),t.Ui()}))}},t.shutdown=function(){t.stopVideo(),Br(),t.Ti()},t.setVideoElement=function(e,n){function r(){var n=document.createElement("canvas"),i=n.getContext("2d");t.pi=n,t.context=i,i=320/e.videoWidth,n.width=Math.floor(e.videoWidth*i),n.height=Math.floor(e.videoHeight*i),t.$h=t._malloc(n.width*n.height*4),e.removeEventListener("loadedmetadata",r)}t.ji=!!n,t.ti=!0,or=t.video=e,e.readyState===e.HAVE_ENOUGH_DATA?r():e.addEventListener("loadedmetadata",r)},t.stopVideo=function(){if(t.gi&&(t.gi.parentNode.removeChild(t.gi),t.gi=null),t.video){if(!t.ti){var e=t.video.srcObject.getVideoTracks();e&&0<e.length&&e[0].stop(),t.video.pause()}or=t.video=null}t.pi=null,t.$h&&t._free(t.$h),t.$h=0,t.context=null},t.touchOccurred=function(e){Gr(e.x,e.y,e.type)},t.setOffscreenRenderingEnabled=function(e){!function(e){var t=p;if(t.type!==e){var n=t.Hh|t.vh|t.zh;t.stop(),t.type=e,n&&t.start()}}(e?"Oscillator":"RAF")},t.Oi=function(e,n,r,i){if(t.apiObject.onFaceTracked){for(var o=[],s=0;s<i;s++){var a={detected:!1,translation:[],rotation:[],poseMatrix:[],landmarks:[],landmarks2d:[],faceRect:[]},c=n+s*r,u=c+e.translationOffset,l=c+e.rotationOffset,d=c+e.poseMatrixOffset,h=c+e.landmarksOffset,p=c+e.landmarks2DOffset,f=c+e.faceRectOffset;for(a.detected=!!t.HEAP32[c/Float32Array.BYTES_PER_ELEMENT],c=0;3>c;c++)a.translation.push(t.HEAPF32[u/Float32Array.BYTES_PER_ELEMENT+c]),a.rotation.push(t.HEAPF32[l/Float32Array.BYTES_PER_ELEMENT+c]);for(c=0;16>c;c++)a.poseMatrix.push(t.HEAPF32[d/Float32Array.BYTES_PER_ELEMENT+c]);for(c=0;204>c;c++)a.landmarks.push(t.HEAPF32[h/Float32Array.BYTES_PER_ELEMENT+c]),136>c&&a.landmarks2d.push(t.HEAPF32[p/Float32Array.BYTES_PER_ELEMENT+c]);for(c=0;4>c;c++)a.faceRect.push(t.HEAPF32[f/Float32Array.BYTES_PER_ELEMENT+c]);o.push(a)}t.apiObject.onFaceTracked(o)}},t.Ui=function(){t.apiObject.onVideoStarted&&t.apiObject.onVideoStarted()},t.Nj=function(){t.apiObject.onInitialize&&t.apiObject.onInitialize()},t.Pi=function(e){t.apiObject.onFaceVisibilityChanged&&t.apiObject.onFaceVisibilityChanged(e)},t.Qi=function(e){t.apiObject.onImageVisibilityChanged&&t.apiObject.onImageVisibilityChanged(e)},t.Mi=function(){t.apiObject.onCameraPermissionGranted&&t.apiObject.onCameraPermissionGranted()},t.Li=function(){t.apiObject.onCameraPermissionDenied&&t.apiObject.onCameraPermissionDenied()},t.Ki=function(){t.apiObject.onCameraPermissionAsked&&t.apiObject.onCameraPermissionAsked()},t.Si=function(e,n,r){var i=document.createElement("canvas"),o=i.getContext("2d");i.width=n,i.height=r;for(var s=o.getImageData(0,0,i.width,i.height),a=s.data,c=0;c<r;c++)for(var u=0;u<n;u++){var l=4*((r-c-1)*n+u),d=4*(c*n+u);a[d]=t.HEAPU8[e+l+2],a[d+1]=t.HEAPU8[e+l+1],a[d+2]=t.HEAPU8[e+l+0],a[d+3]=t.HEAPU8[e+l+3]}o.putImageData(s,0,0),t.apiObject.onScreenshotTakenCanvas&&t.apiObject.onScreenshotTakenCanvas(i),t.apiObject.onScreenshotTaken&&t.apiObject.onScreenshotTaken(i.toDataURL("image/png"))},t.Ji=function(e){t.apiObject.onAnimationTransitionedToState&&t.apiObject.onAnimationTransitionedToState(e)},t.Ni=function(e,n){t.apiObject.onError&&t.apiObject.onError(e,n)},t.Ri=function(e){t.apiObject.onNumberOfFacesVisibleChanged&&t.apiObject.onNumberOfFacesVisibleChanged(e)},t.Ti=function(){t.apiObject.onShutdown&&t.apiObject.onShutdown()},t.noInitialRun=!0,t.onRuntimeInitialized=function(){s=wr("switchEffect",null,["string","number","number","number"]),a=wr("clearEffect",null,["string"]),c=wr("moveGameObject",null,["string","string"]),t.pushConsoleLog=wr("pushConsoleLog","boolean",["string","int"]),t.changeParameterFloat=wr("changeParameterFloat",null,["string","string","string","number"]),t.changeParameterVector=wr("changeParameterVector",null,"string string string number number number number".split(" ")),t.changeParameterBool=wr("changeParameterBool",null,["string","string","string","boolean"]),t.changeParameterTexture=wr("changeParameterTexture",null,"string string string number number number number".split(" ")),t.fireTrigger=wr("fireTrigger",null,["string"]),t.setFaceDetectionSensitivity=wr("setFaceDetectionSensitivity",null,["number"]),t.showStats=wr("showStats",null,["number"]),t.simulatePhysics=wr("simulatePhysics",null,["number"]),t.showColliders=wr("showColliders",null,["number"]),t.setLicenseKey=wr("setLicenseKey",null,["string"]),t.setLicenseKey(t.licenseKey),o=t.xzimg,Ur(t.canvasWidth,t.canvasHeight)};var f=Object.assign({},t),A="";"undefined"!=typeof document&&document.currentScript&&(A=document.currentScript.src),H_&&(A=H_),A=0!==A.indexOf("blob:")?A.substr(0,A.replace(/[?#].*/,"").lastIndexOf("/")+1):"";var E=console.log.bind(console),g=console.warn.bind(console);Object.assign(t,f),f=null;var _=!1;"object"!=typeof WebAssembly&&z("no native wasm support detected");var m,I,T,R,v,y,S,C,O,b,w,N=!1,D="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function L(e,t,n){var r=t+n;for(n=t;e[n]&&!(n>=r);)++n;if(16<n-t&&e.buffer&&D)return D.decode(e.subarray(t,n));for(r="";t<n;){var i=e[t++];if(128&i){var o=63&e[t++];if(192==(224&i))r+=String.fromCharCode((31&i)<<6|o);else{var s=63&e[t++];65536>(i=224==(240&i)?(15&i)<<12|o<<6|s:(7&i)<<18|o<<12|s<<6|63&e[t++])?r+=String.fromCharCode(i):(i-=65536,r+=String.fromCharCode(55296|i>>10,56320|1023&i))}}else r+=String.fromCharCode(i)}return r}function P(e,t){return e?L(v,e,t):""}function k(e,t,n,r){if(!(0<r))return 0;var i=n;r=n+r-1;for(var o=0;o<e.length;++o){var s=e.charCodeAt(o);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o)),127>=s){if(n>=r)break;t[n++]=s}else{if(2047>=s){if(n+1>=r)break;t[n++]=192|s>>6}else{if(65535>=s){if(n+2>=r)break;t[n++]=224|s>>12}else{if(n+3>=r)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63}t[n++]=128|s>>6&63}t[n++]=128|63&s}}return t[n]=0,n-i}function x(e,t,n){return k(e,v,t,n)}function M(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);127>=r?t++:2047>=r?t+=2:55296<=r&&57343>=r?(t+=4,++n):t+=3}return t}function U(){var e=m.buffer;T=e,t.HEAP8=R=new Int8Array(e),t.HEAP16=y=new Int16Array(e),t.HEAP32=C=new Int32Array(e),t.HEAPU8=v=new Uint8Array(e),t.HEAPU16=S=new Uint16Array(e),t.HEAPU32=O=new Uint32Array(e),t.HEAPF32=b=new Float32Array(e),t.HEAPF64=w=new Float64Array(e)}var B,F,V=[],G=[],Q=[],j=[],H=!1,W=0,Y=0,K=null,$=null;function z(e){throw g(e="Aborted("+e+")"),N=!0,I=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),r(e),e}function q(){return F.startsWith("data:application/octet-stream;base64,")}if(F="deepar.wasm",!q()){var J=F;F=t.locateFile?t.locateFile(J,A):A+J}function X(){try{throw"both async and sync fetching of the wasm failed"}catch(e){z(e)}}var Z={744264:(e,n,r,i,o,s)=>{var a=document.createElement("canvas"),c=a.getContext("2d");a.width=n,a.height=r,e=new Uint8ClampedArray(t.HEAPU8.subarray(e,e+a.width*a.height*4)),e=new ImageData(e,a.width,a.height),c.putImageData(e,0,0),e=(c=document.createElement("canvas")).getContext("2d"),c.width=o,c.height=s,e.drawImage(a,0,0,c.width,c.height),o=e.getImageData(0,0,c.width,c.height),o=new Uint8Array(o.data.buffer),t.HEAPU8.set(o,i)},745138:(e,n,r,i,o,s)=>{var a=document.createElement("canvas"),c=a.getContext("2d");a.width=n,a.height=r,e=new Uint8ClampedArray(t.HEAPU8.subarray(e,e+a.width*a.height*4)),e=new ImageData(e,a.width,a.height),c.putImageData(e,0,0),e=(c=document.createElement("canvas")).getContext("2d"),c.width=o,c.height=s,e.drawImage(a,0,0,c.width,c.height),o=e.getImageData(0,0,c.width,c.height),o=new Uint8Array(o.data.buffer),t.HEAPU8.set(o,i)},746012:()=>{console.log("License key not valid")},746049:(e,n,r)=>{t.Si(e,n,r)},746092:e=>{t.Ri(e)},746139:(e,n,r,i,o,s,a,c,u)=>{t.Oi({translationOffset:e,rotationOffset:n,poseMatrixOffset:r,landmarksOffset:i,landmarks2DOffset:o,faceRectOffset:s},a,c,u)},746323:(e,n)=>{t.Ni(P(e),P(n))},746380:e=>{t.Pi(!!e)},746421:e=>{t.Qi(!!e)},746465:(e,n)=>{e=P(e,n),t.Ji(e)},746546:()=>{alert("DeepAR license not valid")},746580:()=>{t.endLoop()},746601:()=>or.videoWidth,746643:()=>or.videoHeight,746686:()=>{var e=t.faceTrackingModelByteArray;if(!e)return 0;var n=t._malloc(e.length);return t.HEAPU8.set(e,n),n},746880:()=>{var e=qn,t=M(e)+1,n=Qr(t);return x(e,n,t),n},747034:()=>{var e=Jn,t=M(e)+1,n=Qr(t);return x(e,n,t),n},747193:()=>{var e=Xn,t=M(e)+1,n=Qr(t);return x(e,n,t),n},747359:()=>{var e=er,t=M(e)+1,n=Qr(t);return x(e,n,t),n},747522:()=>{var e=tr,t=M(e)+1,n=Qr(t);return x(e,n,t),n},747690:()=>{var e=Zn,t=M(e)+1,n=Qr(t);return x(e,n,t),n},747855:()=>{var e=nr,t=M(e)+1,n=Qr(t);return x(e,n,t),n},748017:()=>{var e=rr,t=M(e)+1,n=Qr(t);return x(e,n,t),n},748178:()=>{var e=ir,t=M(e)+1,n=Qr(t);return x(e,n,t),n}};function ee(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function te(e){for(;0<e.length;)e.shift()(t)}function ne(e){if(!(e instanceof ee||"unwind"==e))throw e}var re=[],ie=0,oe=0;function se(e){this.Vh=e,this.rh=e-24,this.Aj=function(e){O[this.rh+4>>2]=e},this.vh=function(){return O[this.rh+4>>2]},this.yj=function(e){O[this.rh+8>>2]=e},this.bj=function(){return O[this.rh+8>>2]},this.zj=function(){C[this.rh>>2]=0},this.mi=function(e){R[this.rh+12>>0]=e?1:0},this.Nh=function(){return 0!=R[this.rh+12>>0]},this.ni=function(e){R[this.rh+13>>0]=e?1:0},this.vi=function(){return 0!=R[this.rh+13>>0]},this.Yh=function(e,t){this.zh(0),this.Aj(e),this.yj(t),this.zj(),this.mi(!1),this.ni(!1)},this.Hh=function(){C[this.rh>>2]+=1},this.mj=function(){var e=C[this.rh>>2];return C[this.rh>>2]=e-1,1===e},this.zh=function(e){O[this.rh+16>>2]=e},this.Ih=function(){return O[this.rh+16>>2]},this.Sh=function(){if(Zr(this.vh()))return O[this.Vh>>2];var e=this.Ih();return 0!==e?e:this.Vh}}function ae(e){return jr(new se(e).rh)}function ce(e){return B.get(e)}var ue={};function le(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function de(e){return this.fromWireType(C[e>>2])}var he={},pe={},fe={};function Ae(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return 48<=t&&57>=t?"_"+e:e}function Ee(e,t){return e=Ae(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function ge(e){var t=Error,n=Ee(e,(function(t){this.name=e,this.message=t,void 0!==(t=Error(t).stack)&&(this.stack=this.toString()+"\n"+t.replace(/^Error(:[^\n]*)?\n/,""))}));return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},n}var _e=void 0;function me(e){throw new _e(e)}function Ie(e,t,n){function r(t){(t=n(t)).length!==e.length&&me("Mismatched type converter count");for(var r=0;r<e.length;++r)Ce(e[r],t[r])}e.forEach((function(e){fe[e]=t}));var i=Array(t.length),o=[],s=0;t.forEach(((e,t)=>{pe.hasOwnProperty(e)?i[t]=pe[e]:(o.push(e),he.hasOwnProperty(e)||(he[e]=[]),he[e].push((()=>{i[t]=pe[e],++s===o.length&&r(i)})))})),0===o.length&&r(i)}function Te(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var Re=void 0;function ve(e){for(var t="";v[e];)t+=Re[v[e++]];return t}var ye=void 0;function Se(e){throw new ye(e)}function Ce(e,t,n={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var r=t.name;if(e||Se('type "'+r+'" must have a positive integer typeid pointer'),pe.hasOwnProperty(e)){if(n.gj)return;Se("Cannot register type '"+r+"' twice")}pe[e]=t,delete fe[e],he.hasOwnProperty(e)&&(t=he[e],delete he[e],t.forEach((e=>e())))}function Oe(e){Se(e.qh.th.sh.name+" instance already deleted")}var be=!1;function we(){}function Ne(e){--e.count.value,0===e.count.value&&(e.wh?e.Ah.Gh(e.wh):e.th.sh.Gh(e.rh))}function De(e,t,n){return t===n?e:void 0===n.Bh||null===(e=De(e,t,n.Bh))?null:n.Xi(e)}var Le={},Pe=[];function ke(){for(;Pe.length;){var e=Pe.pop();e.qh.Qh=!1,e.delete()}}var xe=void 0,Me={};function Ue(e,t){return t.th&&t.rh||me("makeClassHandle requires ptr and ptrType"),!!t.Ah!=!!t.wh&&me("Both smartPtrType and smartPtr must be specified"),t.count={value:1},Be(Object.create(e,{qh:{value:t}}))}function Be(e){return"undefined"==typeof FinalizationRegistry?(Be=e=>e,e):(be=new FinalizationRegistry((e=>{Ne(e.qh)})),Be=e=>{var t=e.qh;return t.wh&&be.register(e,{qh:t},e),e},we=e=>{be.unregister(e)},Be(e))}function Fe(){}function Ve(e,t,n){if(void 0===e[t].uh){var r=e[t];e[t]=function(){return e[t].uh.hasOwnProperty(arguments.length)||Se("Function '"+n+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].uh+")!"),e[t].uh[arguments.length].apply(this,arguments)},e[t].uh=[],e[t].uh[r.Zh]=r}}function Ge(e,n,r){t.hasOwnProperty(e)?((void 0===r||void 0!==t[e].uh&&void 0!==t[e].uh[r])&&Se("Cannot register public name '"+e+"' twice"),Ve(t,e,e),t.hasOwnProperty(r)&&Se("Cannot register multiple overloads of a function with the same number of arguments ("+r+")!"),t[e].uh[r]=n):(t[e]=n,void 0!==r&&(t[e].Yj=r))}function Qe(e,t,n,r,i,o,s,a){this.name=e,this.constructor=t,this.Rh=n,this.Gh=r,this.Bh=i,this.$i=o,this.Xh=s,this.Xi=a,this.jj=[]}function je(e,t,n){for(;t!==n;)t.Xh||Se("Expected null or instance of "+n.name+", got an instance of "+t.name),e=t.Xh(e),t=t.Bh;return e}function He(e,t){return null===t?(this.hi&&Se("null is not a valid "+this.name),0):(t.qh||Se('Cannot pass "'+at(t)+'" as a '+this.name),t.qh.rh||Se("Cannot pass deleted object as a pointer of type "+this.name),je(t.qh.rh,t.qh.th.sh,this.sh))}function We(e,t){if(null===t){if(this.hi&&Se("null is not a valid "+this.name),this.bi){var n=this.ki();return null!==e&&e.push(this.Gh,n),n}return 0}if(t.qh||Se('Cannot pass "'+at(t)+'" as a '+this.name),t.qh.rh||Se("Cannot pass deleted object as a pointer of type "+this.name),!this.ai&&t.qh.th.ai&&Se("Cannot convert argument of type "+(t.qh.Ah?t.qh.Ah.name:t.qh.th.name)+" to parameter type "+this.name),n=je(t.qh.rh,t.qh.th.sh,this.sh),this.bi)switch(void 0===t.qh.wh&&Se("Passing raw pointer to smart pointer is illegal"),this.qj){case 0:t.qh.Ah===this?n=t.qh.wh:Se("Cannot convert argument of type "+(t.qh.Ah?t.qh.Ah.name:t.qh.th.name)+" to parameter type "+this.name);break;case 1:n=t.qh.wh;break;case 2:if(t.qh.Ah===this)n=t.qh.wh;else{var r=t.clone();n=this.lj(n,it((function(){r.delete()}))),null!==e&&e.push(this.Gh,n)}break;default:Se("Unsupporting sharing policy")}return n}function Ye(e,t){return null===t?(this.hi&&Se("null is not a valid "+this.name),0):(t.qh||Se('Cannot pass "'+at(t)+'" as a '+this.name),t.qh.rh||Se("Cannot pass deleted object as a pointer of type "+this.name),t.qh.th.ai&&Se("Cannot convert argument of type "+t.qh.th.name+" to parameter type "+this.name),je(t.qh.rh,t.qh.th.sh,this.sh))}function Ke(e,t,n,r){this.name=e,this.sh=t,this.hi=n,this.ai=r,this.bi=!1,this.Gh=this.lj=this.ki=this.yi=this.qj=this.ij=void 0,void 0!==t.Bh?this.toWireType=We:(this.toWireType=r?He:Ye,this.xh=null)}function $e(e,n,r){t.hasOwnProperty(e)||me("Replacing nonexistant public symbol"),void 0!==t[e].uh&&void 0!==r?t[e].uh[r]=n:(t[e]=n,t[e].Zh=r)}function ze(e,n){var r=(e=ve(e)).includes("j")?function(e,n){var r=[];return function(){if(r.length=0,Object.assign(r,arguments),e.includes("j")){var i=t["dynCall_"+e];i=r&&r.length?i.apply(null,[n].concat(r)):i.call(null,n)}else i=ce(n).apply(null,r);return i}}(e,n):ce(n);return"function"!=typeof r&&Se("unknown function pointer with signature "+e+": "+n),r}var qe=void 0;function Je(e){var t=ve(e=Yr(e));return jr(e),t}function Xe(e,t){var n=[],r={};throw t.forEach((function e(t){r[t]||pe[t]||(fe[t]?fe[t].forEach(e):(n.push(t),r[t]=!0))})),new qe(e+": "+n.map(Je).join([", "]))}function Ze(e,t){for(var n=[],r=0;r<e;r++)n.push(O[t+4*r>>2]);return n}function et(e,t,n,r,i){var o=t.length;2>o&&Se("argTypes array size mismatch! Must at least get return value and 'this' types!");var s=null!==t[1]&&null!==n,a=!1;for(n=1;n<t.length;++n)if(null!==t[n]&&void 0===t[n].xh){a=!0;break}var c="void"!==t[0].name,u="",l="";for(n=0;n<o-2;++n)u+=(0!==n?", ":"")+"arg"+n,l+=(0!==n?", ":"")+"arg"+n+"Wired";e="return function "+Ae(e)+"("+u+") {\nif (arguments.length !== "+(o-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(o-2)+" args!');\n}\n",a&&(e+="var destructors = [];\n");var d=a?"destructors":"null";for(u="throwBindingError invoker fn runDestructors retType classParam".split(" "),r=[Se,r,i,le,t[0],t[1]],s&&(e+="var thisWired = classParam.toWireType("+d+", this);\n"),n=0;n<o-2;++n)e+="var arg"+n+"Wired = argType"+n+".toWireType("+d+", arg"+n+"); // "+t[n+2].name+"\n",u.push("argType"+n),r.push(t[n+2]);if(s&&(l="thisWired"+(0<l.length?", ":"")+l),e+=(c?"var rv = ":"")+"invoker(fn"+(0<l.length?", ":"")+l+");\n",a)e+="runDestructors(destructors);\n";else for(n=s?1:2;n<t.length;++n)o=1===n?"thisWired":"arg"+(n-2)+"Wired",null!==t[n].xh&&(e+=o+"_dtor("+o+"); // "+t[n].name+"\n",u.push(o+"_dtor"),r.push(t[n].xh));return c&&(e+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),u.push(e+"}\n"),function(e){var t=Function;if(!(t instanceof Function))throw new TypeError("new_ called with constructor type "+typeof t+" which is not a function");var n=Ee(t.name||"unknownFunctionName",(function(){}));return n.prototype=t.prototype,n=new n,(e=t.apply(n,e))instanceof Object?e:n}(u).apply(null,r)}var tt=[],nt=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function rt(e){4<e&&0==--nt[e].li&&(nt[e]=void 0,tt.push(e))}var it=e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=tt.length?tt.pop():nt.length;return nt[t]={li:1,value:e},t}};function ot(e,t,n){switch(t){case 0:return function(e){return this.fromWireType((n?R:v)[e])};case 1:return function(e){return this.fromWireType((n?y:S)[e>>1])};case 2:return function(e){return this.fromWireType((n?C:O)[e>>2])};default:throw new TypeError("Unknown integer type: "+e)}}function st(e,t){var n=pe[e];return void 0===n&&Se(t+" has unknown type "+Je(e)),n}function at(e){if(null===e)return"null";var t=typeof e;return"object"===t||"array"===t||"function"===t?e.toString():""+e}function ct(e,t){switch(t){case 2:return function(e){return this.fromWireType(b[e>>2])};case 3:return function(e){return this.fromWireType(w[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function ut(e,t,n){switch(t){case 0:return n?function(e){return R[e]}:function(e){return v[e]};case 1:return n?function(e){return y[e>>1]}:function(e){return S[e>>1]};case 2:return n?function(e){return C[e>>2]}:function(e){return O[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}var lt,dt="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function ht(e,t){for(var n=e>>1,r=n+t/2;!(n>=r)&&S[n];)++n;if(32<(n<<=1)-e&&dt)return dt.decode(v.subarray(e,n));for(n="",r=0;!(r>=t/2);++r){var i=y[e+2*r>>1];if(0==i)break;n+=String.fromCharCode(i)}return n}function pt(e,t,n){if(void 0===n&&(n=2147483647),2>n)return 0;var r=t;n=(n-=2)<2*e.length?n/2:e.length;for(var i=0;i<n;++i)y[t>>1]=e.charCodeAt(i),t+=2;return y[t>>1]=0,t-r}function ft(e){return 2*e.length}function At(e,t){for(var n=0,r="";!(n>=t/4);){var i=C[e+4*n>>2];if(0==i)break;++n,65536<=i?(i-=65536,r+=String.fromCharCode(55296|i>>10,56320|1023&i)):r+=String.fromCharCode(i)}return r}function Et(e,t,n){if(void 0===n&&(n=2147483647),4>n)return 0;var r=t;n=r+n-4;for(var i=0;i<e.length;++i){var o=e.charCodeAt(i);if(55296<=o&&57343>=o&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++i)),C[t>>2]=o,(t+=4)+4>n)break}return C[t>>2]=0,t-r}function gt(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);55296<=r&&57343>=r&&++n,t+=4}return t}function _t(e){var t=M(e)+1,n=Qr(t);return n&&k(e,R,n,t),n}function mt(e,t){if(Dt=e,Lt=t,Nt)if(Ot||(W+=1,Ot=!0),0==e)bt=function(){var e=0|Math.max(0,yt+t-lt());setTimeout(St,e)};else if(1==e)bt=function(){Ht(St)};else if(2==e){if("undefined"==typeof setImmediate){var n=[];addEventListener("message",(e=>{"setimmediate"!==e.data&&"setimmediate"!==e.data.target||(e.stopPropagation(),n.shift()())}),!0),setImmediate=function(e){n.push(e),postMessage("setimmediate","*")}}bt=function(){setImmediate(St)}}}function It(e){throw I=e,_||0<W||(Kr(),te(Q),Wr(0),Kn[1].length&&$n(1,10),Kn[2].length&&$n(2,10),H=!0),I=e,_||0<W||(N=!0),new ee(e)}function Tt(){if(!(_||0<W))try{It(I)}catch(e){ne(e)}}function Rt(e){if(!H&&!N)try{e(),Tt()}catch(e){ne(e)}}lt=()=>performance.now();var vt,yt,St,Ct,Ot=!1,bt=null,wt=0,Nt=null,Dt=0,Lt=0,Pt=0,kt=[],xt={},Mt=!1,Ut=!1,Bt=[],Ft=!1,Vt=void 0,Gt=void 0;function Qt(){return!!Mt&&((document.exitFullscreen||document.cancelFullScreen||document.mozCancelFullScreen||document.msExitFullscreen||document.webkitCancelFullScreen||function(){}).apply(document,[]),!0)}var jt=0;function Ht(e){if("function"==typeof requestAnimationFrame)requestAnimationFrame(e);else{var t=Date.now();if(0===jt)jt=t+1e3/60;else for(;t+2>=jt;)jt+=1e3/60;setTimeout(e,Math.max(jt-t,0))}}function Wt(e){return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",bmp:"image/bmp",ogg:"audio/ogg",wav:"audio/wav",mp3:"audio/mpeg"}[e.substr(e.lastIndexOf(".")+1)]}var Yt=[];function Kt(){var e=t.canvas;Yt.forEach((function(t){t(e.width,e.height)}))}function $t(e,n,r){n&&r?(e.xj=n,e.fj=r):(n=e.xj,r=e.fj);var i=n,o=r;if(t.forcedAspectRatio&&0<t.forcedAspectRatio&&(i/o<t.forcedAspectRatio?i=Math.round(o*t.forcedAspectRatio):o=Math.round(i/t.forcedAspectRatio)),(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===e.parentNode&&"undefined"!=typeof screen){var s=Math.min(screen.width/i,screen.height/o);i=Math.round(i*s),o=Math.round(o*s)}Gt?(e.width!=i&&(e.width=i),e.height!=o&&(e.height=o),void 0!==e.style&&(e.style.removeProperty("width"),e.style.removeProperty("height"))):(e.width!=n&&(e.width=n),e.height!=r&&(e.height=r),void 0!==e.style&&(i!=n||o!=r?(e.style.setProperty("width",i+"px","important"),e.style.setProperty("height",o+"px","important")):(e.style.removeProperty("width"),e.style.removeProperty("height"))))}var zt,qt,Jt,Xt,Zt,en=!1,tn=0,nn=0,rn=0,on={alpha:!1,depth:!1,stencil:!1,antialias:!1},sn={},an=1,cn=[],un=[],ln=[],dn=[],hn=[],pn=[],fn=[],An=[],En=[],gn={},_n=4;function mn(e){yn||(yn=e)}function In(e){for(var t=an++,n=e.length;n<t;n++)e[n]=null;return t}function Tn(e,t,n){for(var r="",i=0;i<e;++i){var o=n?C[n+4*i>>2]:-1;r+=P(C[t+4*i>>2],0>o?void 0:o)}return r}function Rn(e,n){if(t.preinitializedWebGLContext){var r=t.preinitializedWebGLContext;n.ii=1}else e.vh||(e.vh=e.getContext,e.getContext=function(t,n){return"webgl"==t==(n=e.vh(t,n))instanceof WebGLRenderingContext?n:null}),r=e.getContext("webgl",n);return r?function(e,t){var n=In(An),r={Sj:n,attributes:t,version:t.ii,Jh:e};return e.canvas&&(e.canvas.Ci=r),An[n]=r,(void 0===t.Yi||t.Yi)&&function(e){if(e||(e=Sn),!e.hj){e.hj=!0;var t=e.Jh;!function(e){var t=e.getExtension("ANGLE_instanced_arrays");t&&(e.vertexAttribDivisor=function(e,n){t.vertexAttribDivisorANGLE(e,n)},e.drawArraysInstanced=function(e,n,r,i){t.drawArraysInstancedANGLE(e,n,r,i)},e.drawElementsInstanced=function(e,n,r,i,o){t.drawElementsInstancedANGLE(e,n,r,i,o)})}(t),function(e){var t=e.getExtension("OES_vertex_array_object");t&&(e.createVertexArray=function(){return t.createVertexArrayOES()},e.deleteVertexArray=function(e){t.deleteVertexArrayOES(e)},e.bindVertexArray=function(e){t.bindVertexArrayOES(e)},e.isVertexArray=function(e){return t.isVertexArrayOES(e)})}(t),function(e){var t=e.getExtension("WEBGL_draw_buffers");t&&(e.drawBuffers=function(e,n){t.drawBuffersWEBGL(e,n)})}(t),t.yh=t.getExtension("EXT_disjoint_timer_query"),t.Wj=t.getExtension("WEBGL_multi_draw"),(t.getSupportedExtensions()||[]).forEach((function(e){e.includes("lose_context")||e.includes("debug")||t.getExtension(e)}))}}(r),n}(r,n):0}function vn(e){Sn=An[e],t.Uh=Lr=Sn&&Sn.Jh}var yn,Sn,Cn={},On=[],bn={},wn=0,Nn=[];function Dn(e,t,n,r){for(var i=0;i<e;i++){var o=Lr[n](),s=o&&In(r);o?(o.name=s,r[s]=o):mn(1282),C[t+4*i>>2]=s}}function Ln(e,t,n,r,i,o,s,a){t=un[t],(e=Lr[e](t,n))&&(r=a&&x(e.name,a,r),i&&(C[i>>2]=r),o&&(C[o>>2]=e.size),s&&(C[s>>2]=e.type))}function Pn(e,t){O[e>>2]=t,O[e+4>>2]=(t-O[e>>2])/4294967296}function kn(e,t,n){if(t){var r=void 0;switch(e){case 36346:r=1;break;case 36344:return void(0!=n&&1!=n&&mn(1280));case 36345:r=0;break;case 34466:var i=Lr.getParameter(34467);r=i?i.length:0}if(void 0===r)switch(i=Lr.getParameter(e),typeof i){case"number":r=i;break;case"boolean":r=i?1:0;break;case"string":return void mn(1280);case"object":if(null===i)switch(e){case 34964:case 35725:case 34965:case 36006:case 36007:case 32873:case 34229:case 34068:r=0;break;default:return void mn(1280)}else{if(i instanceof Float32Array||i instanceof Uint32Array||i instanceof Int32Array||i instanceof Array){for(e=0;e<i.length;++e)switch(n){case 0:C[t+4*e>>2]=i[e];break;case 2:b[t+4*e>>2]=i[e];break;case 4:R[t+e>>0]=i[e]?1:0}return}try{r=0|i.name}catch(t){return mn(1280),void g("GL_INVALID_ENUM in glGet"+n+"v: Unknown object returned from WebGL getParameter("+e+")! (error: "+t+")")}}break;default:return mn(1280),void g("GL_INVALID_ENUM in glGet"+n+"v: Native code calling glGet"+n+"v("+e+") and it returns "+i+" of type "+typeof i+"!")}switch(n){case 1:Pn(t,r);break;case 0:C[t>>2]=r;break;case 2:b[t>>2]=r;break;case 4:R[t>>0]=r?1:0}}else mn(1281)}function xn(e){var t=M(e)+1,n=Qr(t);return x(e,n,t),n}function Mn(e){return"]"==e.slice(-1)&&e.lastIndexOf("[")}function Un(e){var t,n=e.Oh,r=e.fi;if(!n)for(e.Oh=n={},e.Ai={},t=0;t<Lr.getProgramParameter(e,35718);++t){var i=Lr.getActiveUniform(e,t),o=i.name;i=i.size;var s=Mn(o);s=0<s?o.slice(0,s):o;var a=e.ei;for(e.ei+=i,r[s]=[i,a],o=0;o<i;++o)n[a]=o,e.Ai[a++]=s}}function Bn(e){var t=Lr.ri;if(t){var n=t.Oh[e];return"number"==typeof n&&(t.Oh[e]=n=Lr.getUniformLocation(t,t.Ai[e]+(0<n?"["+n+"]":""))),n}mn(1282)}function Fn(e,t,n,r){if(n)if(Un(e=un[e]),"number"==typeof(e=Lr.getUniform(e,Bn(t)))||"boolean"==typeof e)switch(r){case 0:C[n>>2]=e;break;case 2:b[n>>2]=e}else for(t=0;t<e.length;t++)switch(r){case 0:C[n+4*t>>2]=e[t];break;case 2:b[n+4*t>>2]=e[t]}else mn(1281)}function Vn(e,t,n,r){if(n)if(e=Lr.getVertexAttrib(e,t),34975==t)C[n>>2]=e&&e.name;else if("number"==typeof e||"boolean"==typeof e)switch(r){case 0:C[n>>2]=e;break;case 2:b[n>>2]=e;break;case 5:C[n>>2]=Math.fround(e)}else for(t=0;t<e.length;t++)switch(r){case 0:C[n+4*t>>2]=e[t];break;case 2:b[n+4*t>>2]=e[t];break;case 5:C[n+4*t>>2]=Math.fround(e[t])}else mn(1281)}function Gn(e,t,n,r,i){e=1==(e-=5120)?v:4==e?C:6==e?b:5==e||28922==e?O:S;var o=31-Math.clz32(e.BYTES_PER_ELEMENT),s=_n;return e.subarray(i>>o,i+r*(n*({5:3,6:4,8:2,29502:3,29504:4}[t-6402]||1)*(1<<o)+s-1&-s)>>o)}var Qn=[],jn=[],Hn={};function Wn(){if(!Yn){var e,t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:"./this.program"};for(e in Hn)void 0===Hn[e]?delete t[e]:t[e]=Hn[e];var n=[];for(e in t)n.push(e+"="+t[e]);Yn=n}return Yn}var Yn,Kn=[null,[],[]];function $n(e,t){var n=Kn[e];0===t||10===t?((1===e?E:g)(L(n,0)),n.length=0):n.push(t)}var zn,qn=null,Jn=null,Xn=null,Zn=null,er=null,tr=null,nr=null,rr=null,ir=null,or=null,sr=null,ar=null,cr=null,ur=null,lr=null,dr=null,hr=null,pr=null,fr=null,Ar=null,Er=null,gr=null,_r=null,mr=null,Ir=null;function Tr(e){return 0==e%4&&(0!=e%100||0==e%400)}function Rr(e,t){for(var n=0,r=0;r<=t;n+=e[r++]);return n}var vr=[31,29,31,30,31,30,31,31,30,31,30,31],yr=[31,28,31,30,31,30,31,31,30,31,30,31];function Sr(e,t){for(e=new Date(e.getTime());0<t;){var n=e.getMonth(),r=(Tr(e.getFullYear())?vr:yr)[n];if(!(t>r-e.getDate())){e.setDate(e.getDate()+t);break}t-=r-e.getDate()+1,e.setDate(1),11>n?e.setMonth(n+1):(e.setMonth(0),e.setFullYear(e.getFullYear()+1))}return e}function Cr(e,t){var n=Array(M(e)+1);return e=k(e,n,0,n.length),t&&(n.length=e),n}function Or(e,t,n,r){function i(e,t,n){for(e="number"==typeof e?e.toString():e||"";e.length<t;)e=n[0]+e;return e}function o(e,t){return i(e,t,"0")}function s(e,t){function n(e){return 0>e?-1:0<e?1:0}var r;return 0===(r=n(e.getFullYear()-t.getFullYear()))&&0===(r=n(e.getMonth()-t.getMonth()))&&(r=n(e.getDate()-t.getDate())),r}function a(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function c(e){e=Sr(new Date(e.Mh+1900,0,1),e.Lh);var t=new Date(e.getFullYear()+1,0,4),n=a(new Date(e.getFullYear(),0,4));return t=a(t),0>=s(n,e)?0>=s(t,e)?e.getFullYear()+1:e.getFullYear():e.getFullYear()-1}var u=C[r+40>>2];for(var l in r={tj:C[r>>2],sj:C[r+4>>2],ci:C[r+8>>2],oi:C[r+12>>2],di:C[r+16>>2],Mh:C[r+20>>2],Ch:C[r+24>>2],Lh:C[r+28>>2],$j:C[r+32>>2],rj:C[r+36>>2],uj:u?P(u):""},n=P(n),u={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"})n=n.replace(new RegExp(l,"g"),u[l]);var d="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),h="January February March April May June July August September October November December".split(" ");for(l in u={"%a":function(e){return d[e.Ch].substring(0,3)},"%A":function(e){return d[e.Ch]},"%b":function(e){return h[e.di].substring(0,3)},"%B":function(e){return h[e.di]},"%C":function(e){return o((e.Mh+1900)/100|0,2)},"%d":function(e){return o(e.oi,2)},"%e":function(e){return i(e.oi,2," ")},"%g":function(e){return c(e).toString().substring(2)},"%G":function(e){return c(e)},"%H":function(e){return o(e.ci,2)},"%I":function(e){return 0==(e=e.ci)?e=12:12<e&&(e-=12),o(e,2)},"%j":function(e){return o(e.oi+Rr(Tr(e.Mh+1900)?vr:yr,e.di-1),3)},"%m":function(e){return o(e.di+1,2)},"%M":function(e){return o(e.sj,2)},"%n":function(){return"\n"},"%p":function(e){return 0<=e.ci&&12>e.ci?"AM":"PM"},"%S":function(e){return o(e.tj,2)},"%t":function(){return"\t"},"%u":function(e){return e.Ch||7},"%U":function(e){return o(Math.floor((e.Lh+7-e.Ch)/7),2)},"%V":function(e){var t=Math.floor((e.Lh+7-(e.Ch+6)%7)/7);if(2>=(e.Ch+371-e.Lh-2)%7&&t++,t)53==t&&(4==(n=(e.Ch+371-e.Lh)%7)||3==n&&Tr(e.Mh)||(t=1));else{t=52;var n=(e.Ch+7-e.Lh-1)%7;(4==n||5==n&&Tr(e.Mh%400-1))&&t++}return o(t,2)},"%w":function(e){return e.Ch},"%W":function(e){return o(Math.floor((e.Lh+7-(e.Ch+6)%7)/7),2)},"%y":function(e){return(e.Mh+1900).toString().substring(2)},"%Y":function(e){return e.Mh+1900},"%z":function(e){var t=0<=(e=e.rj);return e=Math.abs(e)/60,(t?"+":"-")+String("0000"+(e/60*100+e%60)).slice(-4)},"%Z":function(e){return e.uj},"%%":function(){return"%"}},n=n.replace(/%%/g,"\0\0"),u)n.includes(l)&&(n=n.replace(new RegExp(l,"g"),u[l](r)));return(l=Cr(n=n.replace(/\0\0/g,"%"),!1)).length>t?0:(R.set(l,e),l.length-1)}function br(e,n,r,i){var o={string:e=>{var t=0;if(null!=e&&0!==e){var n=1+(e.length<<2);x(e,t=Jr(n),n)}return t},array:e=>{var t=Jr(e.length);return R.set(e,t),t}};e=t["_"+e];var s=[],a=0;if(i)for(var c=0;c<i.length;c++){var u=o[r[c]];u?(0===a&&(a=zr()),s[c]=u(i[c])):s[c]=i[c]}return function(e){return 0!==a&&qr(a),"string"===n?P(e):"boolean"===n?!!e:e}(r=e.apply(null,s))}function wr(e,n,r,i){var o=(r=r||[]).every((e=>"number"===e||"boolean"===e));return"string"!==n&&o&&!i?t["_"+e]:function(){return br(e,n,r,arguments)}}_e=t.InternalError=ge("InternalError");for(var Nr=Array(256),Dr=0;256>Dr;++Dr)Nr[Dr]=String.fromCharCode(Dr);Re=Nr,ye=t.BindingError=ge("BindingError"),Fe.prototype.isAliasOf=function(e){if(!(this instanceof Fe&&e instanceof Fe))return!1;var t=this.qh.th.sh,n=this.qh.rh,r=e.qh.th.sh;for(e=e.qh.rh;t.Bh;)n=t.Xh(n),t=t.Bh;for(;r.Bh;)e=r.Xh(e),r=r.Bh;return t===r&&n===e},Fe.prototype.clone=function(){if(this.qh.rh||Oe(this),this.qh.Wh)return this.qh.count.value+=1,this;var e=Be,t=Object,n=t.create,r=Object.getPrototypeOf(this),i=this.qh;return(e=e(n.call(t,r,{qh:{value:{count:i.count,Qh:i.Qh,Wh:i.Wh,rh:i.rh,th:i.th,wh:i.wh,Ah:i.Ah}}}))).qh.count.value+=1,e.qh.Qh=!1,e},Fe.prototype.delete=function(){this.qh.rh||Oe(this),this.qh.Qh&&!this.qh.Wh&&Se("Object already scheduled for deletion"),we(this),Ne(this.qh),this.qh.Wh||(this.qh.wh=void 0,this.qh.rh=void 0)},Fe.prototype.isDeleted=function(){return!this.qh.rh},Fe.prototype.deleteLater=function(){return this.qh.rh||Oe(this),this.qh.Qh&&!this.qh.Wh&&Se("Object already scheduled for deletion"),Pe.push(this),1===Pe.length&&xe&&xe(ke),this.qh.Qh=!0,this},t.getInheritedInstanceCount=function(){return Object.keys(Me).length},t.getLiveInheritedInstances=function(){var e,t=[];for(e in Me)Me.hasOwnProperty(e)&&t.push(Me[e]);return t},t.flushPendingDeletes=ke,t.setDelayFunction=function(e){xe=e,Pe.length&&xe&&xe(ke)},Ke.prototype.aj=function(e){return this.yi&&(e=this.yi(e)),e},Ke.prototype.si=function(e){this.Gh&&this.Gh(e)},Ke.prototype.argPackAdvance=8,Ke.prototype.readValueFromPointer=de,Ke.prototype.deleteObject=function(e){null!==e&&e.delete()},Ke.prototype.fromWireType=function(e){function t(){return this.bi?Ue(this.sh.Rh,{th:this.ij,rh:n,Ah:this,wh:e}):Ue(this.sh.Rh,{th:this,rh:e})}var n=this.aj(e);if(!n)return this.si(e),null;var r=function(e,t){for(void 0===t&&Se("ptr should not be undefined");e.Bh;)t=e.Xh(t),e=e.Bh;return Me[t]}(this.sh,n);if(void 0!==r)return 0===r.qh.count.value?(r.qh.rh=n,r.qh.wh=e,r.clone()):(r=r.clone(),this.si(e),r);if(r=this.sh.$i(n),!(r=Le[r]))return t.call(this);r=this.ai?r.Wi:r.pointerType;var i=De(n,this.sh,r.sh);return null===i?t.call(this):this.bi?Ue(r.sh.Rh,{th:r,rh:i,Ah:this,wh:e}):Ue(r.sh.Rh,{th:r,rh:i})},qe=t.UnboundTypeError=ge("UnboundTypeError"),t.count_emval_handles=function(){for(var e=0,t=5;t<nt.length;++t)void 0!==nt[t]&&++e;return e},t.get_first_emval=function(){for(var e=5;e<nt.length;++e)if(void 0!==nt[e])return nt[e];return null},t.requestFullscreen=function(e,n){!function(e,n){function r(){Mt=!1;var e=i.parentNode;(document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement)===e?(i.exitFullscreen=Qt,Vt&&i.requestPointerLock(),Mt=!0,Gt?("undefined"!=typeof SDL&&(C[SDL.screen>>2]=8388608|O[SDL.screen>>2]),$t(t.canvas),Kt()):$t(i)):(e.parentNode.insertBefore(i,e),e.parentNode.removeChild(e),Gt?("undefined"!=typeof SDL&&(C[SDL.screen>>2]=-8388609&O[SDL.screen>>2]),$t(t.canvas),Kt()):$t(i)),t.onFullScreen&&t.onFullScreen(Mt),t.onFullscreen&&t.onFullscreen(Mt)}void 0===(Vt=e)&&(Vt=!0),void 0===(Gt=n)&&(Gt=!1);var i=t.canvas;Ft||(Ft=!0,document.addEventListener("fullscreenchange",r,!1),document.addEventListener("mozfullscreenchange",r,!1),document.addEventListener("webkitfullscreenchange",r,!1),document.addEventListener("MSFullscreenChange",r,!1));var o=document.createElement("div");i.parentNode.insertBefore(o,i),o.appendChild(i),o.requestFullscreen=o.requestFullscreen||o.mozRequestFullScreen||o.msRequestFullscreen||(o.webkitRequestFullscreen?()=>o.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT):null)||(o.webkitRequestFullScreen?()=>o.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):null),o.requestFullscreen()}(e,n)},t.requestAnimationFrame=function(e){Ht(e)},t.setCanvasSize=function(e,n,r){$t(t.canvas,e,n),r||Kt()},t.pauseMainLoop=function(){bt=null,wt++},t.resumeMainLoop=function(){wt++;var e=Dt,n=Lt,r=Nt;Nt=null,function(e){function n(){return!(r<wt&&(--W,Tt(),1))}!Nt||z("emscripten_set_main_loop: there can only be one main loop function at once: call emscripten_cancel_main_loop to cancel the previous one before setting a new one with different parameters."),Nt=e;var r=wt;Ot=!1,St=function(){if(!N)if(0<kt.length){var r=Date.now(),i=kt.shift();if(i.Rj(i.Oj),Ct){var o=Ct,s=0==o%1?o-1:Math.floor(o);Ct=i.Pj?s:(8*o+(s+.5))/9}E('main loop blocker "'+i.name+'" took '+(Date.now()-r)+" ms"),t.setStatus&&(r=t.statusMessage||"Please wait...",o=xt.Qj,(i=Ct)?i<o?t.setStatus(r+" ("+(o-i)+"/"+o+")"):t.setStatus(r):t.setStatus("")),n()&&setTimeout(St,0)}else n()&&(Pt=Pt+1|0,1==Dt&&1<Lt&&0!=Pt%Lt?bt():(0==Dt&&(yt=lt()),N||t.preMainLoop&&!1===t.preMainLoop()||(Rt(e),t.postMainLoop&&t.postMainLoop()),n()&&("object"==typeof SDL&&SDL.audio&&SDL.audio.kj&&SDL.audio.kj(),bt())))}}(r),mt(e,n),bt()},t.getUserMedia=function(){window.getUserMedia||(window.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia),window.getUserMedia(void 0)},t.createContext=function(e,n,r,i){return function(e,n,r,i){if(n&&t.Uh&&e==t.canvas)return t.Uh;var o;if(n){var s={antialias:!1,alpha:!1,ii:1};if(i)for(var a in i)s[a]=i[a];if(void 0!==Cn&&(o=Rn(e,s)))var c=An[o].Jh}else c=e.getContext("2d");return c?(r&&(n||void 0===Lr||z("cannot set in module if GLctx is used, but we are a non-GL context that would replace it"),t.Uh=c,n&&vn(o),t.vj=n,Bt.forEach((function(e){e()})),function(){function e(){Ut=document.pointerLockElement===t.canvas||document.mozPointerLockElement===t.canvas||document.webkitPointerLockElement===t.canvas||document.msPointerLockElement===t.canvas}if(t.preloadPlugins||(t.preloadPlugins=[]),!zt){zt=!0;try{qt=!0}catch(e){qt=!1,g("warning: no blob constructor, cannot create blobs with mimetypes")}Jt="undefined"!=typeof MozBlobBuilder?MozBlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:qt?null:g("warning: no BlobBuilder"),Xt="undefined"!=typeof window?window.URL?window.URL:window.webkitURL:void 0,t.wi||void 0!==Xt||(g("warning: Browser does not support creating object URLs. Built-in browser image decoding will not be available."),t.wi=!0),t.preloadPlugins.push({canHandle:function(e){return!t.wi&&/\.(jpg|jpeg|png|bmp)$/i.test(e)},handle:function(e,t,n,r){var i=null;if(qt)try{(i=new Blob([e],{type:Wt(t)})).size!==e.length&&(i=new Blob([new Uint8Array(e).buffer],{type:Wt(t)}))}catch(e){!function(e){vt||(vt={}),vt[e]||(vt[e]=1,g(e))}("Blob constructor present but fails: "+e+"; falling back to blob builder")}i||((i=new Jt).append(new Uint8Array(e).buffer),i=i.getBlob());var o=Xt.createObjectURL(i),s=new Image;s.onload=()=>{s.complete||z("Image "+t+" could not be decoded");var r=document.createElement("canvas");r.width=s.width,r.height=s.height,r.getContext("2d").drawImage(s,0,0),Xt.revokeObjectURL(o),n&&n(e)},s.onerror=()=>{E("Image "+o+" could not be decoded"),r&&r()},s.src=o}}),t.preloadPlugins.push({canHandle:function(e){return!t.Xj&&e.substr(-4)in{".ogg":1,".wav":1,".mp3":1}},handle:function(e,t,n,r){function i(){s||(s=!0,n&&n(e))}function o(){s||(s=!0,new Audio,r&&r())}var s=!1;if(!qt)return o();try{var a=new Blob([e],{type:Wt(t)})}catch(e){return o()}a=Xt.createObjectURL(a);var c=new Audio;c.addEventListener("canplaythrough",(()=>i()),!1),c.onerror=function(){if(!s){g("warning: browser could not fully decode audio "+t+", trying slower base64 approach");for(var n="",r=0,o=0,a=0;a<e.length;a++)for(r=r<<8|e[a],o+=8;6<=o;){var u=r>>o-6&63;o-=6,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[u]}2==o?(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&r)<<4],n+="=="):4==o&&(n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&r)<<2],n+="="),c.src="data:audio/x-"+t.substr(-3)+";base64,"+n,i()}},c.src=a,function(e){W+=1,setTimeout((function(){--W,Rt(e)}),1e4)}((function(){i()}))}});var n=t.canvas;n&&(n.requestPointerLock=n.requestPointerLock||n.mozRequestPointerLock||n.webkitRequestPointerLock||n.msRequestPointerLock||(()=>{}),n.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock||document.msExitPointerLock||(()=>{}),n.exitPointerLock=n.exitPointerLock.bind(document),document.addEventListener("pointerlockchange",e,!1),document.addEventListener("mozpointerlockchange",e,!1),document.addEventListener("webkitpointerlockchange",e,!1),document.addEventListener("mspointerlockchange",e,!1),t.elementPointerLock&&n.addEventListener("click",(e=>{!Ut&&t.canvas.requestPointerLock&&(t.canvas.requestPointerLock(),e.preventDefault())}),!1))}}()),c):null}(e,n,r,i)};for(var Lr,Pr=0;32>Pr;++Pr)Nn.push(Array(Pr));var kr=new Float32Array(288);for(Pr=0;288>Pr;++Pr)Qn[Pr]=kr.subarray(0,Pr+1);var xr=new Int32Array(288);for(Pr=0;288>Pr;++Pr)jn[Pr]=xr.subarray(0,Pr+1);(sr=document.createElement("canvas")).style.display="none",ar=sr.getContext("2d",{willReadFrequently:!0}),zn=t.segmentationModel;var Mr={j:function(e,t,n,r){z("Assertion failed: "+P(e)+", at: "+[t?P(t):"unknown filename",n,r?P(r):"unknown function"])},o:function(e){return Qr(e+24)+24},l:function(e){return(e=new se(e)).Nh()||(e.mi(!0),ie--),e.ni(!1),re.push(e),e.Hh(),e.Sh()},z:function(){$r(0);var e=re.pop();if(e.mj()&&!e.vi()){var t=e.bj();t&&ce(t)(e.Vh),ae(e.Vh)}oe=0},a:function(){var e=oe;if(!e)return Hr(0),0;var t=new se(e);t.zh(e);var n=t.vh();if(!n)return Hr(0),e;for(var r=0;r<arguments.length;r++){var i=arguments[r];if(0===i||i===n)break;if(Xr(i,n,t.rh+16))return Hr(i),e}return Hr(n),e},c:function(){var e=oe;if(!e)return Hr(0),0;var t=new se(e);t.zh(e);var n=t.vh();if(!n)return Hr(0),e;for(var r=0;r<arguments.length;r++){var i=arguments[r];if(0===i||i===n)break;if(Xr(i,n,t.rh+16))return Hr(i),e}return Hr(n),e},g:function(){var e=oe;if(!e)return Hr(0),0;var t=new se(e);t.zh(e);var n=t.vh();if(!n)return Hr(0),e;for(var r=0;r<arguments.length;r++){var i=arguments[r];if(0===i||i===n)break;if(Xr(i,n,t.rh+16))return Hr(i),e}return Hr(n),e},p:ae,mb:function(){var e=re.pop();e||z("no exception to throw");var t=e.Vh;throw e.vi()||(re.push(e),e.ni(!0),e.mi(!1),ie++),oe=t,t},I:function(e,t,n){throw new se(e).Yh(t,n),oe=e,ie++,e},dc:function(){return ie},d:function(e){throw oe||(oe=e),e},Na:function(){return 0},kc:function(){return 0},lc:function(){},Df:function(e){var t=ue[e];delete ue[e];var n=t.ki,r=t.Gh,i=t.ui,o=i.map((e=>e.ej)).concat(i.map((e=>e.oj)));Ie([e],o,(e=>{var o={};return i.forEach(((t,n)=>{var r=e[n],s=t.cj,a=t.dj,c=e[n+i.length],u=t.nj,l=t.pj;o[t.Zi]={read:e=>r.fromWireType(s(a,e)),write:(e,t)=>{var n=[];u(l,e,c.toWireType(n,t)),le(n)}}})),[{name:t.name,fromWireType:function(e){var t,n={};for(t in o)n[t]=o[t].read(e);return r(e),n},toWireType:function(e,t){for(var i in o)if(!(i in t))throw new TypeError('Missing field:  "'+i+'"');var s=n();for(i in o)o[i].write(s,t[i]);return null!==e&&e.push(r,s),s},argPackAdvance:8,readValueFromPointer:de,xh:r}]}))},Vb:function(){},Ef:function(e,t,n,r,i){var o=Te(n);Ce(e,{name:t=ve(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?r:i},argPackAdvance:8,readValueFromPointer:function(e){if(1===n)var r=R;else if(2===n)r=y;else{if(4!==n)throw new TypeError("Unknown boolean type size: "+t);r=C}return this.fromWireType(r[e>>o])},xh:null})},Ze:function(e,t,n,r,i,o,s,a,c,u,l,d,h){l=ve(l),o=ze(i,o),a&&(a=ze(s,a)),u&&(u=ze(c,u)),h=ze(d,h);var p=Ae(l);Ge(p,(function(){Xe("Cannot construct "+l+" due to unbound types",[r])})),Ie([e,t,n],r?[r]:[],(function(t){if(t=t[0],r)var n=t.sh,i=n.Rh;else i=Fe.prototype;t=Ee(p,(function(){if(Object.getPrototypeOf(this)!==s)throw new ye("Use 'new' to construct "+l);if(void 0===c.Kh)throw new ye(l+" has no accessible constructor");var e=c.Kh[arguments.length];if(void 0===e)throw new ye("Tried to invoke ctor of "+l+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(c.Kh).toString()+") parameters instead!");return e.apply(this,arguments)}));var s=Object.create(i,{constructor:{value:t}});t.prototype=s;var c=new Qe(l,t,s,h,n,o,a,u);n=new Ke(l,c,!0,!1),i=new Ke(l+"*",c,!1,!1);var d=new Ke(l+" const*",c,!1,!0);return Le[e]={pointerType:i,Wi:d},$e(p,t),[n,i,d]}))},ae:function(e,t,n,r,i,o){0<t||z();var s=Ze(t,n);i=ze(r,i),Ie([],[e],(function(e){var n="constructor "+(e=e[0]).name;if(void 0===e.sh.Kh&&(e.sh.Kh=[]),void 0!==e.sh.Kh[t-1])throw new ye("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.sh.Kh[t-1]=()=>{Xe("Cannot construct "+e.name+" due to unbound types",s)},Ie([],s,(function(r){return r.splice(1,0,null),e.sh.Kh[t-1]=et(n,r,null,i,o),[]})),[]}))},W:function(e,t,n,r,i,o,s,a){var c=Ze(n,r);t=ve(t),o=ze(i,o),Ie([],[e],(function(e){function r(){Xe("Cannot call "+i+" due to unbound types",c)}var i=(e=e[0]).name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),a&&e.sh.jj.push(t);var u=e.sh.Rh,l=u[t];return void 0===l||void 0===l.uh&&l.className!==e.name&&l.Zh===n-2?(r.Zh=n-2,r.className=e.name,u[t]=r):(Ve(u,t,i),u[t].uh[n-2]=r),Ie([],c,(function(r){return r=et(i,r,e,o,s),void 0===u[t].uh?(r.Zh=n-2,u[t]=r):u[t].uh[n-2]=r,[]})),[]}))},Cf:function(e,t){Ce(e,{name:t=ve(t),fromWireType:function(e){e||Se("Cannot use deleted val. handle = "+e);var t=nt[e].value;return rt(e),t},toWireType:function(e,t){return it(t)},argPackAdvance:8,readValueFromPointer:de,xh:null})},dg:function(e,t,n,r){function i(){}n=Te(n),t=ve(t),i.values={},Ce(e,{name:t,constructor:i,fromWireType:function(e){return this.constructor.values[e]},toWireType:function(e,t){return t.value},argPackAdvance:8,readValueFromPointer:ot(t,n,r),xh:null}),Ge(t,i)},Zf:function(e,t,n){var r=st(e,"enum");t=ve(t),e=r.constructor,r=Object.create(r.constructor.prototype,{value:{value:n},constructor:{value:Ee(r.name+"_"+t,(function(){}))}}),e.values[n]=r,e[t]=r},Pa:function(e,t,n){n=Te(n),Ce(e,{name:t=ve(t),fromWireType:function(e){return e},toWireType:function(e,t){return t},argPackAdvance:8,readValueFromPointer:ct(t,n),xh:null})},jf:function(e,t,n,r,i,o){var s=Ze(t,n);e=ve(e),i=ze(r,i),Ge(e,(function(){Xe("Cannot call "+e+" due to unbound types",s)}),t-1),Ie([],s,(function(n){return $e(e,et(e,[n[0],null].concat(n.slice(1)),null,i,o),t-1),[]}))},N:function(e,t,n,r,i){t=ve(t),-1===i&&(i=4294967295),i=Te(n);var o=e=>e;if(0===r){var s=32-8*n;o=e=>e<<s>>>s}n=t.includes("unsigned")?function(e,t){return t>>>0}:function(e,t){return t},Ce(e,{name:t,fromWireType:o,toWireType:n,argPackAdvance:8,readValueFromPointer:ut(t,i,0!==r),xh:null})},E:function(e,t,n){function r(e){var t=O;return new i(T,t[1+(e>>=2)],t[e])}var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];Ce(e,{name:n=ve(n),fromWireType:r,argPackAdvance:8,readValueFromPointer:r},{gj:!0})},Oa:function(e,t){var n="std::string"===(t=ve(t));Ce(e,{name:t,fromWireType:function(e){var t=O[e>>2],r=e+4;if(n)for(var i=r,o=0;o<=t;++o){var s=r+o;if(o==t||0==v[s]){if(i=P(i,s-i),void 0===a)var a=i;else a+=String.fromCharCode(0),a+=i;i=s+1}}else{for(a=Array(t),o=0;o<t;++o)a[o]=String.fromCharCode(v[r+o]);a=a.join("")}return jr(e),a},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var r="string"==typeof t;r||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||Se("Cannot pass non-string to std::string");var i=n&&r?M(t):t.length,o=Qr(4+i+1),s=o+4;if(O[o>>2]=i,n&&r)x(t,s,i+1);else if(r)for(r=0;r<i;++r){var a=t.charCodeAt(r);255<a&&(jr(s),Se("String has UTF-16 code units that do not fit in 8 bits")),v[s+r]=a}else for(r=0;r<i;++r)v[s+r]=t[r];return null!==e&&e.push(jr,o),o},argPackAdvance:8,readValueFromPointer:de,xh:function(e){jr(e)}})},ka:function(e,t,n){if(n=ve(n),2===t)var r=ht,i=pt,o=ft,s=()=>S,a=1;else 4===t&&(r=At,i=Et,o=gt,s=()=>O,a=2);Ce(e,{name:n,fromWireType:function(e){for(var n,i=O[e>>2],o=s(),c=e+4,u=0;u<=i;++u){var l=e+4+u*t;u!=i&&0!=o[l>>a]||(c=r(c,l-c),void 0===n?n=c:(n+=String.fromCharCode(0),n+=c),c=l+t)}return jr(e),n},toWireType:function(e,r){"string"!=typeof r&&Se("Cannot pass non-string to C++ string type "+n);var s=o(r),c=Qr(4+s+t);return O[c>>2]=s>>a,i(r,c+4,s+t),null!==e&&e.push(jr,c),c},argPackAdvance:8,readValueFromPointer:de,xh:function(e){jr(e)}})},Uf:function(e,t,n,r,i,o){ue[e]={name:ve(t),ki:ze(n,r),Gh:ze(i,o),ui:[]}},Qa:function(e,t,n,r,i,o,s,a,c,u){ue[e].ui.push({Zi:ve(t),ej:n,cj:ze(r,i),dj:o,oj:s,nj:ze(a,c),pj:u})},Ff:function(e,t){Ce(e,{Tj:!0,name:t=ve(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},nc:function(){return!0},ec:function(){throw 1/0},wd:rt,Hd:function(e){4<e&&(nt[e].li+=1)},ld:function(e,t){return e=(e=st(e,"_emval_take_value")).readValueFromPointer(t),it(e)},oc:function(e,t){e=new Date(1e3*(O[e>>2]+4294967296*C[e+4>>2])),C[t>>2]=e.getUTCSeconds(),C[t+4>>2]=e.getUTCMinutes(),C[t+8>>2]=e.getUTCHours(),C[t+12>>2]=e.getUTCDate(),C[t+16>>2]=e.getUTCMonth(),C[t+20>>2]=e.getUTCFullYear()-1900,C[t+24>>2]=e.getUTCDay(),C[t+28>>2]=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},pc:function(e,t){e=new Date(1e3*(O[e>>2]+4294967296*C[e+4>>2])),C[t>>2]=e.getSeconds(),C[t+4>>2]=e.getMinutes(),C[t+8>>2]=e.getHours(),C[t+12>>2]=e.getDate(),C[t+16>>2]=e.getMonth(),C[t+20>>2]=e.getFullYear()-1900,C[t+24>>2]=e.getDay();var n=new Date(e.getFullYear(),0,1);C[t+28>>2]=(e.getTime()-n.getTime())/864e5|0,C[t+36>>2]=-60*e.getTimezoneOffset();var r=new Date(e.getFullYear(),6,1).getTimezoneOffset();n=n.getTimezoneOffset(),C[t+32>>2]=0|(r!=n&&e.getTimezoneOffset()==Math.min(n,r))},qc:function(e){var t=new Date(C[e+20>>2]+1900,C[e+16>>2],C[e+12>>2],C[e+8>>2],C[e+4>>2],C[e>>2],0),n=C[e+32>>2],r=t.getTimezoneOffset(),i=new Date(t.getFullYear(),0,1),o=new Date(t.getFullYear(),6,1).getTimezoneOffset(),s=i.getTimezoneOffset(),a=Math.min(s,o);return 0>n?C[e+32>>2]=Number(o!=s&&a==r):0<n!=(a==r)&&(o=Math.max(s,o),t.setTime(t.getTime()+6e4*((0<n?a:o)-r))),C[e+24>>2]=t.getDay(),C[e+28>>2]=(t.getTime()-i.getTime())/864e5|0,C[e>>2]=t.getSeconds(),C[e+4>>2]=t.getMinutes(),C[e+8>>2]=t.getHours(),C[e+12>>2]=t.getDate(),C[e+16>>2]=t.getMonth(),C[e+20>>2]=t.getYear(),t.getTime()/1e3|0},rc:function e(t,n,r){e.Vi||(e.Vi=!0,function(e,t,n){function r(e){return(e=e.toTimeString().match(/\(([A-Za-z ]+)\)$/))?e[1]:"GMT"}var i=(new Date).getFullYear(),o=new Date(i,0,1),s=new Date(i,6,1);i=o.getTimezoneOffset();var a=s.getTimezoneOffset();C[e>>2]=60*Math.max(i,a),C[t>>2]=Number(i!=a),e=r(o),t=r(s),e=_t(e),t=_t(t),a<i?(O[n>>2]=e,O[n+4>>2]=t):(O[n>>2]=t,O[n+4>>2]=e)}(t,n,r))},L:function(){z("")},Hc:function(e,n,r){if(!t.Th){if(!window.AudioContext){if(!window.webkitAudioContext)return;window.AudioContext=window.webkitAudioContext}t.Th=new AudioContext}for(var i=new ArrayBuffer(n),o=new Uint8Array(i),s=0;s<n;s++)o[s]=v[s+e];t.Th.decodeAudioData(i,(function(e){t.Ph&&(t.Ph.stop(),t.Ph=null);var n=t.Th.createBufferSource();t.Ph=n,n.loop=r,n.buffer=e,n.connect(t.Th.destination),n.start(0)}))},wc:function(){t.Th&&t.Ph&&(t.Ph.stop(),t.Ph=null)},Pb:function(e){try{var t=Function('return (function() {}.constructor("return this")( ));')()}catch(e){t=window}var n;for(n in t)if(8==n.length&&116==n.charCodeAt(7)&&101==n.charCodeAt(5)&&117==n.charCodeAt(3)&&100==n.charCodeAt(0)){var r=n;break}for(var i in t[r])if(6==i.length&&110==i.charCodeAt(5)&&100==i.charCodeAt(0)){var o=i;break}return t[r][o].charCodeAt(e)},nb:function(e,t,n,r,i){if(62e3!=e)n=0;else{if(t)for(;;){if(12321==(e=C[t>>2]))on.alpha=0<C[t+4>>2];else if(12325==e)on.depth=0<C[t+4>>2];else if(12326==e)on.stencil=0<C[t+4>>2];else if(12337==e)e=C[t+4>>2],on.antialias=0<e;else if(12338==e)e=C[t+4>>2],on.antialias=1==e;else if(12544==e)on.Uj=12547!=C[t+4>>2];else if(12344==e)break;t+=8}n&&r||i?(i&&(C[i>>2]=1),n&&0<r&&(C[n>>2]=62002),n=1):n=0}return n},Aa:function(e,n,r,i){if(62e3!=e)return 0;for(e=1;;){if(12440!=(n=C[i>>2])){if(12344==n)break;return 0}e=C[i+4>>2],i+=8}return 2!=e?0:(on.ii=e-1,on.Vj=0,0!=(Zt=Rn(t.canvas,on))?(vn(Zt),t.vj=!0,Bt.forEach((function(e){e()})),vn(null),62004):0)},Ba:function(e,t){return 62e3!=e||62002!=t?0:62006},za:function(e,t){return 62e3!=e||62004!=t?0:(Sn===An[e=Zt]&&(Sn=null),"object"==typeof JSEvents&&JSEvents.Zj(An[e].Jh.canvas),An[e]&&An[e].Jh.canvas&&(An[e].Jh.canvas.Ci=void 0),An[e]=null,tn==t&&(tn=0),1)},ya:function(e,t){return 62e3!=e?0:(62006!=t||(nn==t&&(nn=0),rn==t&&(rn=0)),1)},pb:function(){return 62e3},ob:function(e,t,n){return 62e3!=e?0:(t&&(C[t>>2]=1),n&&(C[n>>2]=4),en=!0,1)},Q:function(e,t,n,r){return 62e3!=e||0!=r&&62004!=r||0!=n&&62006!=n||0!=t&&62006!=t?0:(vn(r?Zt:null),tn=r,rn=t,nn=n,1)},Z:function(e,t){if(62e3!=e)return 0;if(sn[t])return sn[t];switch(t){case 12371:e=_t("Emscripten");break;case 12372:e=_t("1.4 Emscripten EGL");break;case 12373:e=_t("");break;case 12429:e=_t("OpenGL_ES");break;default:return 0}return sn[t]=e},xa:function(){return en&&t.Uh&&!t.Uh.isContextLost()?1:0},lb:function(e,t){return 62e3!=e?0:(0==t?mt(0,0):mt(1,t),1)},ng:function(e){return 62e3!=e?0:(rn=nn=tn=0,en=!1,1)},u:function(e,t,n){var r;for(On.length=0,n>>=2;r=v[t++];)n+=105!=r&n,On.push(105==r?C[n]:w[n++>>1]),++n;return Z[e].apply(null,On)},Rb:function(e,t,n,r,i,o,s,a){function c(){if(s){var e=0;if(l.statusText){var t=M(l.statusText)+1;e=Jr(t),x(l.statusText,e,t)}ce(s)(d,r,l.status,e)}}var u=P(e);e=P(t),n=P(n);var l=new XMLHttpRequest;l.open(e,u,!0),l.responseType="arraybuffer";var d=function(){var e=wn;return wn++,e}();return l.onload=function(){if(200<=l.status&&300>l.status||0===l.status&&"http"!=u.substr(0,4).toLowerCase()){var e=new Uint8Array(l.response),t=Qr(e.length);v.set(e,t),o&&ce(o)(d,r,t,e.length),i&&jr(t)}else c();delete bn[d]},l.onerror=function(){c(),delete bn[d]},l.onprogress=function(e){a&&ce(a)(d,r,e.loaded,e.lengthComputable||void 0===e.lengthComputable?e.total:0)},l.onabort=function(){delete bn[d]},"POST"==e?(l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.send(n)):l.send(null),bn[d]=l,d},ja:function(){return Date.now()},Sc:function(e){_=!1,W=0,It(e)},gc:function(){return 2147483648},_:lt,gf:function(e){Lr.activeTexture(e)},ff:function(e,t){Lr.attachShader(un[e],pn[t])},yf:function(e,t){Lr.yh.beginQueryEXT(e,En[t])},ef:function(e,t,n){Lr.bindAttribLocation(un[e],t,P(n))},df:function(e,t){Lr.bindBuffer(e,cn[t])},cf:function(e,t){Lr.bindFramebuffer(e,ln[t])},bf:function(e,t){Lr.bindRenderbuffer(e,dn[t])},af:function(e,t){Lr.bindTexture(e,hn[t])},qf:function(e){Lr.bindVertexArray(fn[e])},$e:function(e,t,n,r){Lr.blendColor(e,t,n,r)},_e:function(e){Lr.blendEquation(e)},Ye:function(e,t){Lr.blendEquationSeparate(e,t)},Xe:function(e,t){Lr.blendFunc(e,t)},We:function(e,t,n,r){Lr.blendFuncSeparate(e,t,n,r)},Ve:function(e,t,n,r){Lr.bufferData(e,n?v.subarray(n,n+t):t,r)},Ue:function(e,t,n,r){Lr.bufferSubData(e,t,v.subarray(r,r+n))},Te:function(e){return Lr.checkFramebufferStatus(e)},Se:function(e){Lr.clear(e)},Re:function(e,t,n,r){Lr.clearColor(e,t,n,r)},Qe:function(e){Lr.clearDepth(e)},Pe:function(e){Lr.clearStencil(e)},Oe:function(e,t,n,r){Lr.colorMask(!!e,!!t,!!n,!!r)},Ne:function(e){Lr.compileShader(pn[e])},Me:function(e,t,n,r,i,o,s,a){Lr.compressedTexImage2D(e,t,n,r,i,o,a?v.subarray(a,a+s):null)},Le:function(e,t,n,r,i,o,s,a,c){Lr.compressedTexSubImage2D(e,t,n,r,i,o,s,c?v.subarray(c,c+a):null)},Ke:function(e,t,n,r,i,o,s,a){Lr.copyTexImage2D(e,t,n,r,i,o,s,a)},Je:function(e,t,n,r,i,o,s,a){Lr.copyTexSubImage2D(e,t,n,r,i,o,s,a)},Ie:function(){var e=In(un),t=Lr.createProgram();return t.name=e,t.Fh=t.Dh=t.Eh=0,t.ei=1,un[e]=t,e},He:function(e){var t=In(pn);return pn[t]=Lr.createShader(e),t},Ge:function(e){Lr.cullFace(e)},Fe:function(e,t){for(var n=0;n<e;n++){var r=C[t+4*n>>2],i=cn[r];i&&(Lr.deleteBuffer(i),i.name=0,cn[r]=null)}},Ee:function(e,t){for(var n=0;n<e;++n){var r=C[t+4*n>>2],i=ln[r];i&&(Lr.deleteFramebuffer(i),i.name=0,ln[r]=null)}},De:function(e){if(e){var t=un[e];t?(Lr.deleteProgram(t),t.name=0,un[e]=null):mn(1281)}},Af:function(e,t){for(var n=0;n<e;n++){var r=C[t+4*n>>2],i=En[r];i&&(Lr.yh.deleteQueryEXT(i),En[r]=null)}},Ce:function(e,t){for(var n=0;n<e;n++){var r=C[t+4*n>>2],i=dn[r];i&&(Lr.deleteRenderbuffer(i),i.name=0,dn[r]=null)}},Be:function(e){if(e){var t=pn[e];t?(Lr.deleteShader(t),pn[e]=null):mn(1281)}},Ae:function(e,t){for(var n=0;n<e;n++){var r=C[t+4*n>>2],i=hn[r];i&&(Lr.deleteTexture(i),i.name=0,hn[r]=null)}},pf:function(e,t){for(var n=0;n<e;n++){var r=C[t+4*n>>2];Lr.deleteVertexArray(fn[r]),fn[r]=null}},ze:function(e){Lr.depthFunc(e)},ye:function(e){Lr.depthMask(!!e)},xe:function(e,t){Lr.depthRange(e,t)},we:function(e,t){Lr.detachShader(un[e],pn[t])},ve:function(e){Lr.disable(e)},ue:function(e){Lr.disableVertexAttribArray(e)},te:function(e,t,n){Lr.drawArrays(e,t,n)},lf:function(e,t,n,r){Lr.drawArraysInstanced(e,t,n,r)},mf:function(e,t){for(var n=Nn[e],r=0;r<e;r++)n[r]=C[t+4*r>>2];Lr.drawBuffers(n)},se:function(e,t,n,r){Lr.drawElements(e,t,n,r)},kf:function(e,t,n,r,i){Lr.drawElementsInstanced(e,t,n,r,i)},re:function(e){Lr.enable(e)},qe:function(e){Lr.enableVertexAttribArray(e)},xf:function(e){Lr.yh.endQueryEXT(e)},pe:function(){Lr.finish()},oe:function(){Lr.flush()},ne:function(e,t,n,r){Lr.framebufferRenderbuffer(e,t,n,dn[r])},me:function(e,t,n,r,i){Lr.framebufferTexture2D(e,t,n,hn[r],i)},le:function(e){Lr.frontFace(e)},ke:function(e,t){Dn(e,t,"createBuffer",cn)},ie:function(e,t){Dn(e,t,"createFramebuffer",ln)},Bf:function(e,t){for(var n=0;n<e;n++){var r=Lr.yh.createQueryEXT();if(!r){for(mn(1282);n<e;)C[t+4*n++>>2]=0;break}var i=In(En);r.name=i,En[i]=r,C[t+4*n>>2]=i}},he:function(e,t){Dn(e,t,"createRenderbuffer",dn)},ge:function(e,t){Dn(e,t,"createTexture",hn)},of:function(e,t){Dn(e,t,"createVertexArray",fn)},je:function(e){Lr.generateMipmap(e)},fe:function(e,t,n,r,i,o,s){Ln("getActiveAttrib",e,t,n,r,i,o,s)},ee:function(e,t,n,r,i,o,s){Ln("getActiveUniform",e,t,n,r,i,o,s)},de:function(e,t,n,r){var i=(e=Lr.getAttachedShaders(un[e])).length;for(i>t&&(i=t),C[n>>2]=i,t=0;t<i;++t)C[r+4*t>>2]=pn.indexOf(e[t])},ce:function(e,t){return Lr.getAttribLocation(un[e],P(t))},be:function(e,t){kn(e,t,4)},$d:function(e,t,n){n?C[n>>2]=Lr.getBufferParameter(e,t):mn(1281)},_d:function(){var e=Lr.getError()||yn;return yn=0,e},Zd:function(e,t){kn(e,t,2)},Yd:function(e,t,n,r){((e=Lr.getFramebufferAttachmentParameter(e,t,n))instanceof WebGLRenderbuffer||e instanceof WebGLTexture)&&(e=0|e.name),C[r>>2]=e},Xd:function(e,t){kn(e,t,0)},Vd:function(e,t,n,r){null===(e=Lr.getProgramInfoLog(un[e]))&&(e="(unknown error)"),t=0<t&&r?x(e,r,t):0,n&&(C[n>>2]=t)},Wd:function(e,t,n){if(n)if(e>=an)mn(1281);else if(e=un[e],35716==t)null===(e=Lr.getProgramInfoLog(e))&&(e="(unknown error)"),C[n>>2]=e.length+1;else if(35719==t){if(!e.Fh)for(t=0;t<Lr.getProgramParameter(e,35718);++t)e.Fh=Math.max(e.Fh,Lr.getActiveUniform(e,t).name.length+1);C[n>>2]=e.Fh}else if(35722==t){if(!e.Dh)for(t=0;t<Lr.getProgramParameter(e,35721);++t)e.Dh=Math.max(e.Dh,Lr.getActiveAttrib(e,t).name.length+1);C[n>>2]=e.Dh}else if(35381==t){if(!e.Eh)for(t=0;t<Lr.getProgramParameter(e,35382);++t)e.Eh=Math.max(e.Eh,Lr.getActiveUniformBlockName(e,t).length+1);C[n>>2]=e.Eh}else C[n>>2]=Lr.getProgramParameter(e,t);else mn(1281)},sf:function(e,t,n){n?Pn(n,"boolean"==typeof(e=Lr.yh.getQueryObjectEXT(En[e],t))?e?1:0:e):mn(1281)},uf:function(e,t,n){var r;n?(r="boolean"==typeof(e=Lr.yh.getQueryObjectEXT(En[e],t))?e?1:0:e,C[n>>2]=r):mn(1281)},rf:function(e,t,n){n?Pn(n,"boolean"==typeof(e=Lr.yh.getQueryObjectEXT(En[e],t))?e?1:0:e):mn(1281)},tf:function(e,t,n){var r;n?(r="boolean"==typeof(e=Lr.yh.getQueryObjectEXT(En[e],t))?e?1:0:e,C[n>>2]=r):mn(1281)},vf:function(e,t,n){n?C[n>>2]=Lr.yh.getQueryEXT(e,t):mn(1281)},Ud:function(e,t,n){n?C[n>>2]=Lr.getRenderbufferParameter(e,t):mn(1281)},Sd:function(e,t,n,r){null===(e=Lr.getShaderInfoLog(pn[e]))&&(e="(unknown error)"),t=0<t&&r?x(e,r,t):0,n&&(C[n>>2]=t)},Rd:function(e,t,n,r){e=Lr.getShaderPrecisionFormat(e,t),C[n>>2]=e.rangeMin,C[n+4>>2]=e.rangeMax,C[r>>2]=e.precision},Qd:function(e,t,n,r){(e=Lr.getShaderSource(pn[e]))&&(t=0<t&&r?x(e,r,t):0,n&&(C[n>>2]=t))},Td:function(e,t,n){n?35716==t?(null===(e=Lr.getShaderInfoLog(pn[e]))&&(e="(unknown error)"),C[n>>2]=e?e.length+1:0):35720==t?(e=Lr.getShaderSource(pn[e]),C[n>>2]=e?e.length+1:0):C[n>>2]=Lr.getShaderParameter(pn[e],t):mn(1281)},Pd:function(e){var t=gn[e];if(!t){switch(e){case 7939:t=(t=Lr.getSupportedExtensions()||[]).concat(t.map((function(e){return"GL_"+e}))),t=xn(t.join(" "));break;case 7936:case 7937:case 37445:case 37446:(t=Lr.getParameter(e))||mn(1280),t=t&&xn(t);break;case 7938:t=xn("OpenGL ES 2.0 ("+Lr.getParameter(7938)+")");break;case 35724:var n=(t=Lr.getParameter(35724)).match(/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/);null!==n&&(3==n[1].length&&(n[1]+="0"),t="OpenGL ES GLSL ES "+n[1]+" ("+t+")"),t=xn(t);break;default:mn(1280)}gn[e]=t}return t},Od:function(e,t,n){n?b[n>>2]=Lr.getTexParameter(e,t):mn(1281)},Nd:function(e,t,n){n?C[n>>2]=Lr.getTexParameter(e,t):mn(1281)},Kd:function(e,t){if(t=P(t),e=un[e]){Un(e);var n=e.Oh,r=0,i=t,o=Mn(t);if(0<o&&(r=parseInt(t.slice(o+1))>>>0,i=t.slice(0,o)),(i=e.fi[i])&&r<i[0]&&(n[r+=i[1]]=n[r]||Lr.getUniformLocation(e,t)))return r}else mn(1281);return-1},Md:function(e,t,n){Fn(e,t,n,2)},Ld:function(e,t,n){Fn(e,t,n,0)},Gd:function(e,t,n){n?C[n>>2]=Lr.getVertexAttribOffset(e,t):mn(1281)},Jd:function(e,t,n){Vn(e,t,n,2)},Id:function(e,t,n){Vn(e,t,n,5)},Fd:function(e,t){Lr.hint(e,t)},Ed:function(e){return(e=cn[e])?Lr.isBuffer(e):0},Dd:function(e){return Lr.isEnabled(e)},Cd:function(e){return(e=ln[e])?Lr.isFramebuffer(e):0},Bd:function(e){return(e=un[e])?Lr.isProgram(e):0},zf:function(e){return(e=En[e])?Lr.yh.isQueryEXT(e):0},Ad:function(e){return(e=dn[e])?Lr.isRenderbuffer(e):0},zd:function(e){return(e=pn[e])?Lr.isShader(e):0},yd:function(e){return(e=hn[e])?Lr.isTexture(e):0},nf:function(e){return(e=fn[e])?Lr.isVertexArray(e):0},xd:function(e){Lr.lineWidth(e)},vd:function(e){e=un[e],Lr.linkProgram(e),e.Oh=0,e.fi={}},ud:function(e,t){3317==e&&(_n=t),Lr.pixelStorei(e,t)},td:function(e,t){Lr.polygonOffset(e,t)},wf:function(e,t){Lr.yh.queryCounterEXT(En[e],t)},sd:function(e,t,n,r,i,o,s){(s=Gn(o,i,n,r,s))?Lr.readPixels(e,t,n,r,i,o,s):mn(1280)},rd:function(){},qd:function(e,t,n,r){Lr.renderbufferStorage(e,t,n,r)},pd:function(e,t){Lr.sampleCoverage(e,!!t)},od:function(e,t,n,r){Lr.scissor(e,t,n,r)},nd:function(){mn(1280)},md:function(e,t,n,r){t=Tn(t,n,r),Lr.shaderSource(pn[e],t)},kd:function(e,t,n){Lr.stencilFunc(e,t,n)},jd:function(e,t,n,r){Lr.stencilFuncSeparate(e,t,n,r)},id:function(e){Lr.stencilMask(e)},hd:function(e,t){Lr.stencilMaskSeparate(e,t)},gd:function(e,t,n){Lr.stencilOp(e,t,n)},fd:function(e,t,n,r){Lr.stencilOpSeparate(e,t,n,r)},ed:function(e,t,n,r,i,o,s,a,c){Lr.texImage2D(e,t,n,r,i,o,s,a,c?Gn(a,s,r,i,c):null)},dd:function(e,t,n){Lr.texParameterf(e,t,n)},cd:function(e,t,n){Lr.texParameterf(e,t,b[n>>2])},bd:function(e,t,n){Lr.texParameteri(e,t,n)},ad:function(e,t,n){Lr.texParameteri(e,t,C[n>>2])},$c:function(e,t,n,r,i,o,s,a,c){var u=null;c&&(u=Gn(a,s,i,o,c)),Lr.texSubImage2D(e,t,n,r,i,o,s,a,u)},_c:function(e,t){Lr.uniform1f(Bn(e),t)},Zc:function(e,t,n){if(288>=t)for(var r=Qn[t-1],i=0;i<t;++i)r[i]=b[n+4*i>>2];else r=b.subarray(n>>2,n+4*t>>2);Lr.uniform1fv(Bn(e),r)},Yc:function(e,t){Lr.uniform1i(Bn(e),t)},Xc:function(e,t,n){if(288>=t)for(var r=jn[t-1],i=0;i<t;++i)r[i]=C[n+4*i>>2];else r=C.subarray(n>>2,n+4*t>>2);Lr.uniform1iv(Bn(e),r)},Wc:function(e,t,n){Lr.uniform2f(Bn(e),t,n)},Vc:function(e,t,n){if(144>=t)for(var r=Qn[2*t-1],i=0;i<2*t;i+=2)r[i]=b[n+4*i>>2],r[i+1]=b[n+(4*i+4)>>2];else r=b.subarray(n>>2,n+8*t>>2);Lr.uniform2fv(Bn(e),r)},Uc:function(e,t,n){Lr.uniform2i(Bn(e),t,n)},Tc:function(e,t,n){if(144>=t)for(var r=jn[2*t-1],i=0;i<2*t;i+=2)r[i]=C[n+4*i>>2],r[i+1]=C[n+(4*i+4)>>2];else r=C.subarray(n>>2,n+8*t>>2);Lr.uniform2iv(Bn(e),r)},Rc:function(e,t,n,r){Lr.uniform3f(Bn(e),t,n,r)},Qc:function(e,t,n){if(96>=t)for(var r=Qn[3*t-1],i=0;i<3*t;i+=3)r[i]=b[n+4*i>>2],r[i+1]=b[n+(4*i+4)>>2],r[i+2]=b[n+(4*i+8)>>2];else r=b.subarray(n>>2,n+12*t>>2);Lr.uniform3fv(Bn(e),r)},Pc:function(e,t,n,r){Lr.uniform3i(Bn(e),t,n,r)},Oc:function(e,t,n){if(96>=t)for(var r=jn[3*t-1],i=0;i<3*t;i+=3)r[i]=C[n+4*i>>2],r[i+1]=C[n+(4*i+4)>>2],r[i+2]=C[n+(4*i+8)>>2];else r=C.subarray(n>>2,n+12*t>>2);Lr.uniform3iv(Bn(e),r)},Nc:function(e,t,n,r,i){Lr.uniform4f(Bn(e),t,n,r,i)},Mc:function(e,t,n){if(72>=t){var r=Qn[4*t-1],i=b;n>>=2;for(var o=0;o<4*t;o+=4){var s=n+o;r[o]=i[s],r[o+1]=i[s+1],r[o+2]=i[s+2],r[o+3]=i[s+3]}}else r=b.subarray(n>>2,n+16*t>>2);Lr.uniform4fv(Bn(e),r)},Lc:function(e,t,n,r,i){Lr.uniform4i(Bn(e),t,n,r,i)},Kc:function(e,t,n){if(72>=t)for(var r=jn[4*t-1],i=0;i<4*t;i+=4)r[i]=C[n+4*i>>2],r[i+1]=C[n+(4*i+4)>>2],r[i+2]=C[n+(4*i+8)>>2],r[i+3]=C[n+(4*i+12)>>2];else r=C.subarray(n>>2,n+16*t>>2);Lr.uniform4iv(Bn(e),r)},Jc:function(e,t,n,r){if(72>=t)for(var i=Qn[4*t-1],o=0;o<4*t;o+=4)i[o]=b[r+4*o>>2],i[o+1]=b[r+(4*o+4)>>2],i[o+2]=b[r+(4*o+8)>>2],i[o+3]=b[r+(4*o+12)>>2];else i=b.subarray(r>>2,r+16*t>>2);Lr.uniformMatrix2fv(Bn(e),!!n,i)},Ic:function(e,t,n,r){if(32>=t)for(var i=Qn[9*t-1],o=0;o<9*t;o+=9)i[o]=b[r+4*o>>2],i[o+1]=b[r+(4*o+4)>>2],i[o+2]=b[r+(4*o+8)>>2],i[o+3]=b[r+(4*o+12)>>2],i[o+4]=b[r+(4*o+16)>>2],i[o+5]=b[r+(4*o+20)>>2],i[o+6]=b[r+(4*o+24)>>2],i[o+7]=b[r+(4*o+28)>>2],i[o+8]=b[r+(4*o+32)>>2];else i=b.subarray(r>>2,r+36*t>>2);Lr.uniformMatrix3fv(Bn(e),!!n,i)},Gc:function(e,t,n,r){if(18>=t){var i=Qn[16*t-1],o=b;r>>=2;for(var s=0;s<16*t;s+=16){var a=r+s;i[s]=o[a],i[s+1]=o[a+1],i[s+2]=o[a+2],i[s+3]=o[a+3],i[s+4]=o[a+4],i[s+5]=o[a+5],i[s+6]=o[a+6],i[s+7]=o[a+7],i[s+8]=o[a+8],i[s+9]=o[a+9],i[s+10]=o[a+10],i[s+11]=o[a+11],i[s+12]=o[a+12],i[s+13]=o[a+13],i[s+14]=o[a+14],i[s+15]=o[a+15]}}else i=b.subarray(r>>2,r+64*t>>2);Lr.uniformMatrix4fv(Bn(e),!!n,i)},Fc:function(e){e=un[e],Lr.useProgram(e),Lr.ri=e},Ec:function(e){Lr.validateProgram(un[e])},Dc:function(e,t){Lr.vertexAttrib1f(e,t)},Cc:function(e,t){Lr.vertexAttrib1f(e,b[t>>2])},Bc:function(e,t,n){Lr.vertexAttrib2f(e,t,n)},Ac:function(e,t){Lr.vertexAttrib2f(e,b[t>>2],b[t+4>>2])},zc:function(e,t,n,r){Lr.vertexAttrib3f(e,t,n,r)},yc:function(e,t){Lr.vertexAttrib3f(e,b[t>>2],b[t+4>>2],b[t+8>>2])},xc:function(e,t,n,r,i){Lr.vertexAttrib4f(e,t,n,r,i)},vc:function(e,t){Lr.vertexAttrib4f(e,b[t>>2],b[t+4>>2],b[t+8>>2],b[t+12>>2])},hf:function(e,t){Lr.vertexAttribDivisor(e,t)},uc:function(e,t,n,r,i,o){Lr.vertexAttribPointer(e,t,n,!!r,i,o)},tc:function(e,t,n,r){Lr.viewport(e,t,n,r)},sc:function(e,t,n){v.copyWithin(e,t,t+n)},fc:function(e){var t=v.length;if(2147483648<(e>>>=0))return!1;for(var n=1;4>=n;n*=2){var r=t*(1+.2/n);r=Math.min(r,e+100663296);var i=Math;r=Math.max(e,r),i=i.min.call(i,2147483648,r+(65536-r%65536)%65536);e:{try{m.grow(i-T.byteLength+65535>>>16),U();var o=1;break e}catch(e){}o=void 0}if(o)return!0}return!1},mg:function(e,n){$t(t.canvas,e,n),Kt()},hc:function(e,t){var n=0;return Wn().forEach((function(r,i){var o=t+n;for(i=O[e+4*i>>2]=o,o=0;o<r.length;++o)R[i++>>0]=r.charCodeAt(o);R[i>>0]=0,n+=r.length+1})),0},ic:function(e,t){var n=Wn();O[e>>2]=n.length;var r=0;return n.forEach((function(e){r+=e.length+1})),O[t>>2]=r,0},Jf:It,La:function(){return 52},jc:function(){return 52},Ub:function(){return 70},Ma:function(e,t,n,r){for(var i=0,o=0;o<n;o++){var s=O[t>>2],a=O[t+4>>2];t+=8;for(var c=0;c<a;c++)$n(e,v[s+c]);i+=a}return O[r>>2]=i,0},bc:function e(t,n){e.xi||(e.xi=function(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return()=>(crypto.getRandomValues(e),e[0])}return()=>z("randomDevice")}());for(var r=0;r<n;r++)R[t+r>>0]=e.xi();return 0},bb:function(e){Lr.activeTexture(e)},kb:function(e,t){Lr.attachShader(un[e],pn[t])},B:function(e,t){Lr.bindBuffer(e,cn[t])},w:function(e,t){Lr.bindFramebuffer(e,ln[t])},T:function(e,t){Lr.bindRenderbuffer(e,dn[t])},F:function(e,t){Lr.bindTexture(e,hn[t])},Rf:function(e,t,n,r){Lr.blendColor(e,t,n,r)},Sf:function(e,t){Lr.blendEquationSeparate(e,t)},Tf:function(e,t,n,r){Lr.blendFuncSeparate(e,t,n,r)},Ra:function(e,t,n,r){Lr.bufferData(e,n?v.subarray(n,n+t):t,r)},Wa:function(e,t,n,r){Lr.bufferSubData(e,t,v.subarray(r,r+n))},sa:function(e){return Lr.checkFramebufferStatus(e)},Nf:function(e){Lr.clear(e)},Va:function(e,t,n,r){Lr.clearColor(e,t,n,r)},Pf:function(e){Lr.clearDepth(e)},Of:function(e){Lr.clearStencil(e)},ca:function(e,t,n,r){Lr.colorMask(!!e,!!t,!!n,!!r)},Xf:function(e){Lr.compileShader(pn[e])},qb:function(e,t,n,r,i,o,s,a){Lr.compressedTexImage2D(e,t,n,r,i,o,a?v.subarray(a,a+s):null)},ag:function(e,t,n,r,i,o,s,a,c){Lr.compressedTexSubImage2D(e,t,n,r,i,o,s,c?v.subarray(c,c+a):null)},jg:function(){var e=In(un),t=Lr.createProgram();return t.name=e,t.Fh=t.Dh=t.Eh=0,t.ei=1,un[e]=t,e},_f:function(e){var t=In(pn);return pn[t]=Lr.createShader(e),t},Xa:function(e){Lr.cullFace(e)},db:function(e,t){for(var n=0;n<e;n++){var r=C[t+4*n>>2],i=cn[r];i&&(Lr.deleteBuffer(i),i.name=0,cn[r]=null)}},ra:function(e,t){for(var n=0;n<e;++n){var r=C[t+4*n>>2],i=ln[r];i&&(Lr.deleteFramebuffer(i),i.name=0,ln[r]=null)}},jb:function(e){if(e){var t=un[e];t?(Lr.deleteProgram(t),t.name=0,un[e]=null):mn(1281)}},ua:function(e,t){for(var n=0;n<e;n++){var r=C[t+4*n>>2],i=dn[r];i&&(Lr.deleteRenderbuffer(i),i.name=0,dn[r]=null)}},$a:function(e){if(e){var t=pn[e];t?(Lr.deleteShader(t),pn[e]=null):mn(1281)}},fa:function(e,t){for(var n=0;n<e;n++){var r=C[t+4*n>>2],i=hn[r];i&&(Lr.deleteTexture(i),i.name=0,hn[r]=null)}},X:function(e){Lr.depthFunc(e)},pa:function(e){Lr.depthMask(!!e)},ib:function(e,t){Lr.detachShader(un[e],pn[t])},y:function(e){Lr.disable(e)},gb:function(e){Lr.disableVertexAttribArray(e)},Ua:function(e,t,n){Lr.drawArrays(e,t,n)},Ta:function(e,t,n,r){Lr.drawElements(e,t,n,r)},G:function(e){Lr.enable(e)},fb:function(e){Lr.enableVertexAttribArray(e)},Qf:function(){Lr.flush()},ta:function(e,t,n,r){Lr.framebufferRenderbuffer(e,t,n,dn[r])},da:function(e,t,n,r,i){Lr.framebufferTexture2D(e,t,n,hn[r],i)},Sa:function(e,t){Dn(e,t,"createBuffer",cn)},ea:function(e,t){Dn(e,t,"createFramebuffer",ln)},va:function(e,t){Dn(e,t,"createRenderbuffer",dn)},ha:function(e,t){Dn(e,t,"createTexture",hn)},ab:function(e){Lr.generateMipmap(e)},gg:function(e,t,n,r,i,o,s){Ln("getActiveAttrib",e,t,n,r,i,o,s)},fg:function(e,t,n,r,i,o,s){Ln("getActiveUniform",e,t,n,r,i,o,s)},hb:function(e,t){return Lr.getAttribLocation(un[e],P(t))},A:function(){var e=Lr.getError()||yn;return yn=0,e},kg:function(e,t){kn(e,t,2)},V:function(e,t){kn(e,t,0)},hg:function(e,t,n,r){null===(e=Lr.getProgramInfoLog(un[e]))&&(e="(unknown error)"),t=0<t&&r?x(e,r,t):0,n&&(C[n>>2]=t)},U:function(e,t,n){if(n)if(e>=an)mn(1281);else if(e=un[e],35716==t)null===(e=Lr.getProgramInfoLog(e))&&(e="(unknown error)"),C[n>>2]=e.length+1;else if(35719==t){if(!e.Fh)for(t=0;t<Lr.getProgramParameter(e,35718);++t)e.Fh=Math.max(e.Fh,Lr.getActiveUniform(e,t).name.length+1);C[n>>2]=e.Fh}else if(35722==t){if(!e.Dh)for(t=0;t<Lr.getProgramParameter(e,35721);++t)e.Dh=Math.max(e.Dh,Lr.getActiveAttrib(e,t).name.length+1);C[n>>2]=e.Dh}else if(35381==t){if(!e.Eh)for(t=0;t<Lr.getProgramParameter(e,35382);++t)e.Eh=Math.max(e.Eh,Lr.getActiveUniformBlockName(e,t).length+1);C[n>>2]=e.Eh}else C[n>>2]=Lr.getProgramParameter(e,t);else mn(1281)},Vf:function(e,t,n,r){null===(e=Lr.getShaderInfoLog(pn[e]))&&(e="(unknown error)"),t=0<t&&r?x(e,r,t):0,n&&(C[n>>2]=t)},Wf:function(e,t,n){n?35716==t?(null===(e=Lr.getShaderInfoLog(pn[e]))&&(e="(unknown error)"),C[n>>2]=e?e.length+1:0):35720==t?(e=Lr.getShaderSource(pn[e]),C[n>>2]=e?e.length+1:0):C[n>>2]=Lr.getShaderParameter(pn[e],t):mn(1281)},wa:function(e){var t=gn[e];if(!t){switch(e){case 7939:t=(t=Lr.getSupportedExtensions()||[]).concat(t.map((function(e){return"GL_"+e}))),t=xn(t.join(" "));break;case 7936:case 7937:case 37445:case 37446:(t=Lr.getParameter(e))||mn(1280),t=t&&xn(t);break;case 7938:t=xn("OpenGL ES 2.0 ("+Lr.getParameter(7938)+")");break;case 35724:var n=(t=Lr.getParameter(35724)).match(/^WebGL GLSL ES ([0-9]\.[0-9][0-9]?)(?:$| .*)/);null!==n&&(3==n[1].length&&(n[1]+="0"),t="OpenGL ES GLSL ES "+n[1]+" ("+t+")"),t=xn(t);break;default:mn(1280)}gn[e]=t}return t},eg:function(e,t){if(t=P(t),e=un[e]){Un(e);var n=e.Oh,r=0,i=t,o=Mn(t);if(0<o&&(r=parseInt(t.slice(o+1))>>>0,i=t.slice(0,o)),(i=e.fi[i])&&r<i[0]&&(n[r+=i[1]]=n[r]||Lr.getUniformLocation(e,t)))return r}else mn(1281);return-1},ig:function(e){e=un[e],Lr.linkProgram(e),e.Oh=0,e.fi={}},ga:function(e,t){3317==e&&(_n=t),Lr.pixelStorei(e,t)},la:function(e,t,n,r,i,o,s){(s=Gn(o,i,n,r,s))?Lr.readPixels(e,t,n,r,i,o,s):mn(1280)},cb:function(e,t,n,r){Lr.renderbufferStorage(e,t,n,r)},qa:function(e,t,n,r){Lr.scissor(e,t,n,r)},Yf:function(e,t,n,r){t=Tn(t,n,r),Lr.shaderSource(pn[e],t)},Za:function(e,t,n,r){Lr.stencilFuncSeparate(e,t,n,r)},Ya:function(e,t,n,r){Lr.stencilOpSeparate(e,t,n,r)},lg:function(e,t,n,r,i,o,s,a,c){Lr.texImage2D(e,t,n,r,i,o,s,a,c?Gn(a,s,r,i,c):null)},cg:function(e,t,n){Lr.texParameterf(e,t,n)},bg:function(e,t,n){Lr.texParameterf(e,t,b[n>>2])},O:function(e,t,n){Lr.texParameteri(e,t,n)},$f:function(e,t,n,r,i,o,s,a,c){var u=null;c&&(u=Gn(a,s,i,o,c)),Lr.texSubImage2D(e,t,n,r,i,o,s,a,u)},Kf:function(e,t){Lr.uniform1i(Bn(e),t)},Mf:function(e,t,n){if(288>=t)for(var r=jn[t-1],i=0;i<t;++i)r[i]=C[n+4*i>>2];else r=C.subarray(n>>2,n+4*t>>2);Lr.uniform1iv(Bn(e),r)},oa:function(e,t,n){if(72>=t){var r=Qn[4*t-1],i=b;n>>=2;for(var o=0;o<4*t;o+=4){var s=n+o;r[o]=i[s],r[o+1]=i[s+1],r[o+2]=i[s+2],r[o+3]=i[s+3]}}else r=b.subarray(n>>2,n+16*t>>2);Lr.uniform4fv(Bn(e),r)},Lf:function(e,t,n,r){if(32>=t)for(var i=Qn[9*t-1],o=0;o<9*t;o+=9)i[o]=b[r+4*o>>2],i[o+1]=b[r+(4*o+4)>>2],i[o+2]=b[r+(4*o+8)>>2],i[o+3]=b[r+(4*o+12)>>2],i[o+4]=b[r+(4*o+16)>>2],i[o+5]=b[r+(4*o+20)>>2],i[o+6]=b[r+(4*o+24)>>2],i[o+7]=b[r+(4*o+28)>>2],i[o+8]=b[r+(4*o+32)>>2];else i=b.subarray(r>>2,r+36*t>>2);Lr.uniformMatrix3fv(Bn(e),!!n,i)},ma:function(e,t,n,r){if(18>=t){var i=Qn[16*t-1],o=b;r>>=2;for(var s=0;s<16*t;s+=16){var a=r+s;i[s]=o[a],i[s+1]=o[a+1],i[s+2]=o[a+2],i[s+3]=o[a+3],i[s+4]=o[a+4],i[s+5]=o[a+5],i[s+6]=o[a+6],i[s+7]=o[a+7],i[s+8]=o[a+8],i[s+9]=o[a+9],i[s+10]=o[a+10],i[s+11]=o[a+11],i[s+12]=o[a+12],i[s+13]=o[a+13],i[s+14]=o[a+14],i[s+15]=o[a+15]}}else i=b.subarray(r>>2,r+64*t>>2);Lr.uniformMatrix4fv(Bn(e),!!n,i)},Y:function(e){e=un[e],Lr.useProgram(e),Lr.ri=e},eb:function(e,t,n,r,i,o){Lr.vertexAttribPointer(e,t,n,!!r,i,o)},_a:function(e,t,n,r){Lr.viewport(e,t,n,r)},ia:function(e,t){var n=zr();try{return ce(e)(t)}catch(e){if(qr(n),e!==e+0)throw e;$r(1,0)}},C:function(e,t,n){var r=zr();try{return ce(e)(t,n)}catch(e){if(qr(r),e!==e+0)throw e;$r(1,0)}},Ia:function(e,t,n,r){var i=zr();try{return ce(e)(t,n,r)}catch(e){if(qr(i),e!==e+0)throw e;$r(1,0)}},Ja:function(e,t,n,r){var i=zr();try{return ce(e)(t,n,r)}catch(e){if(qr(i),e!==e+0)throw e;$r(1,0)}},s:function(e){var t=zr();try{return ce(e)()}catch(e){if(qr(t),e!==e+0)throw e;$r(1,0)}},f:function(e,t){var n=zr();try{return ce(e)(t)}catch(e){if(qr(n),e!==e+0)throw e;$r(1,0)}},J:function(e,t,n){var r=zr();try{return ce(e)(t,n)}catch(e){if(qr(r),e!==e+0)throw e;$r(1,0)}},M:function(e,t,n){var r=zr();try{return ce(e)(t,n)}catch(e){if(qr(r),e!==e+0)throw e;$r(1,0)}},rb:function(e,t,n,r,i){var o=zr();try{return ce(e)(t,n,r,i)}catch(e){if(qr(o),e!==e+0)throw e;$r(1,0)}},Ca:function(e,t,n,r,i,o,s,a,c,u,l,d,h,p){var f=zr();try{return ce(e)(t,n,r,i,o,s,a,c,u,l,d,h,p)}catch(e){if(qr(f),e!==e+0)throw e;$r(1,0)}},vb:function(e,t,n,r,i){var o=zr();try{return ce(e)(t,n,r,i)}catch(e){if(qr(o),e!==e+0)throw e;$r(1,0)}},b:function(e,t,n){var r=zr();try{return ce(e)(t,n)}catch(e){if(qr(r),e!==e+0)throw e;$r(1,0)}},m:function(e,t,n,r){var i=zr();try{return ce(e)(t,n,r)}catch(e){if(qr(i),e!==e+0)throw e;$r(1,0)}},sb:function(e,t,n,r,i,o,s,a,c){var u=zr();try{return ce(e)(t,n,r,i,o,s,a,c)}catch(e){if(qr(u),e!==e+0)throw e;$r(1,0)}},r:function(e,t,n,r,i){var o=zr();try{return ce(e)(t,n,r,i)}catch(e){if(qr(o),e!==e+0)throw e;$r(1,0)}},Ka:function(e,t,n,r,i,o){var s=zr();try{return ce(e)(t,n,r,i,o)}catch(e){if(qr(s),e!==e+0)throw e;$r(1,0)}},tb:function(e,t,n,r,i,o,s,a,c,u){var l=zr();try{return ce(e)(t,n,r,i,o,s,a,c,u)}catch(e){if(qr(l),e!==e+0)throw e;$r(1,0)}},v:function(e,t,n,r,i,o){var s=zr();try{return ce(e)(t,n,r,i,o)}catch(e){if(qr(s),e!==e+0)throw e;$r(1,0)}},D:function(e,t,n,r,i,o,s){var a=zr();try{return ce(e)(t,n,r,i,o,s)}catch(e){if(qr(a),e!==e+0)throw e;$r(1,0)}},K:function(e,t,n,r,i,o,s,a){var c=zr();try{return ce(e)(t,n,r,i,o,s,a)}catch(e){if(qr(c),e!==e+0)throw e;$r(1,0)}},Ha:function(e,t,n,r,i,o,s,a,c){var u=zr();try{return ce(e)(t,n,r,i,o,s,a,c)}catch(e){if(qr(u),e!==e+0)throw e;$r(1,0)}},Ga:function(e,t,n,r,i,o,s,a,c,u){var l=zr();try{return ce(e)(t,n,r,i,o,s,a,c,u)}catch(e){if(qr(l),e!==e+0)throw e;$r(1,0)}},ba:function(e,t,n,r,i,o,s,a,c,u,l,d){var h=zr();try{return ce(e)(t,n,r,i,o,s,a,c,u,l,d)}catch(e){if(qr(h),e!==e+0)throw e;$r(1,0)}},Sb:function(e,t,n,r,i,o,s){var a=zr();try{return ci(e,t,n,r,i,o,s)}catch(e){if(qr(a),e!==e+0)throw e;$r(1,0)}},Xb:function(e,t,n,r){var i=zr();try{return ri(e,t,n,r)}catch(e){if(qr(i),e!==e+0)throw e;$r(1,0)}},$b:function(e){var t=zr();try{return ei(e)}catch(e){if(qr(t),e!==e+0)throw e;$r(1,0)}},_b:function(e,t){var n=zr();try{return ti(e,t)}catch(e){if(qr(n),e!==e+0)throw e;$r(1,0)}},Wb:function(e,t,n){var r=zr();try{return oi(e,t,n)}catch(e){if(qr(r),e!==e+0)throw e;$r(1,0)}},Qb:function(e,t,n,r,i){var o=zr();try{return ui(e,t,n,r,i)}catch(e){if(qr(o),e!==e+0)throw e;$r(1,0)}},k:function(e){var t=zr();try{ce(e)()}catch(e){if(qr(t),e!==e+0)throw e;$r(1,0)}},i:function(e,t){var n=zr();try{ce(e)(t)}catch(e){if(qr(n),e!==e+0)throw e;$r(1,0)}},$:function(e,t,n){var r=zr();try{ce(e)(t,n)}catch(e){if(qr(r),e!==e+0)throw e;$r(1,0)}},P:function(e,t,n){var r=zr();try{ce(e)(t,n)}catch(e){if(qr(r),e!==e+0)throw e;$r(1,0)}},wb:function(e,t,n,r){var i=zr();try{ce(e)(t,n,r)}catch(e){if(qr(i),e!==e+0)throw e;$r(1,0)}},e:function(e,t,n){var r=zr();try{ce(e)(t,n)}catch(e){if(qr(r),e!==e+0)throw e;$r(1,0)}},Fa:function(e,t,n,r){var i=zr();try{ce(e)(t,n,r)}catch(e){if(qr(i),e!==e+0)throw e;$r(1,0)}},Ea:function(e,t,n,r,i){var o=zr();try{ce(e)(t,n,r,i)}catch(e){if(qr(o),e!==e+0)throw e;$r(1,0)}},H:function(e,t,n,r,i,o,s){var a=zr();try{ce(e)(t,n,r,i,o,s)}catch(e){if(qr(a),e!==e+0)throw e;$r(1,0)}},R:function(e,t,n,r,i){var o=zr();try{ce(e)(t,n,r,i)}catch(e){if(qr(o),e!==e+0)throw e;$r(1,0)}},h:function(e,t,n,r){var i=zr();try{ce(e)(t,n,r)}catch(e){if(qr(i),e!==e+0)throw e;$r(1,0)}},q:function(e,t,n,r,i){var o=zr();try{ce(e)(t,n,r,i)}catch(e){if(qr(o),e!==e+0)throw e;$r(1,0)}},t:function(e,t,n,r,i,o){var s=zr();try{ce(e)(t,n,r,i,o)}catch(e){if(qr(s),e!==e+0)throw e;$r(1,0)}},ub:function(e,t,n,r,i,o,s){var a=zr();try{ce(e)(t,n,r,i,o,s)}catch(e){if(qr(a),e!==e+0)throw e;$r(1,0)}},na:function(e,t,n,r,i,o,s){var a=zr();try{ce(e)(t,n,r,i,o,s)}catch(e){if(qr(a),e!==e+0)throw e;$r(1,0)}},x:function(e,t,n,r,i,o,s,a){var c=zr();try{ce(e)(t,n,r,i,o,s,a)}catch(e){if(qr(c),e!==e+0)throw e;$r(1,0)}},If:function(e,t,n,r,i,o,s,a,c){var u=zr();try{ce(e)(t,n,r,i,o,s,a,c)}catch(e){if(qr(u),e!==e+0)throw e;$r(1,0)}},S:function(e,t,n,r,i,o,s,a,c,u,l){var d=zr();try{ce(e)(t,n,r,i,o,s,a,c,u,l)}catch(e){if(qr(d),e!==e+0)throw e;$r(1,0)}},Da:function(e,t,n,r,i,o,s,a,c,u,l,d,h){var p=zr();try{ce(e)(t,n,r,i,o,s,a,c,u,l,d,h)}catch(e){if(qr(p),e!==e+0)throw e;$r(1,0)}},aa:function(e,t,n,r,i,o,s,a,c,u,l,d,h,p,f,A){var E=zr();try{ce(e)(t,n,r,i,o,s,a,c,u,l,d,h,p,f,A)}catch(e){if(qr(E),e!==e+0)throw e;$r(1,0)}},Tb:function(e,t,n,r,i,o,s){var a=zr();try{ai(e,t,n,r,i,o,s)}catch(e){if(qr(a),e!==e+0)throw e;$r(1,0)}},Zb:function(e,t,n,r){var i=zr();try{ni(e,t,n,r)}catch(e){if(qr(i),e!==e+0)throw e;$r(1,0)}},Yb:function(e,t,n,r){var i=zr();try{ii(e,t,n,r)}catch(e){if(qr(i),e!==e+0)throw e;$r(1,0)}},ac:function(){let e=window.localStorage.getItem("k39d");e||(e=function(){let e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){let r=16*Math.random();return 0<e?(r=(e+r)%16|0,e=Math.floor(e/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),("x"===n?r:3&r|8).toString(16)}))}(),window.localStorage.setItem("k39d",e));let t=document.title;t&&0!==t.length||(t="No title");let n=navigator.vendor;n&&0!==n.length||(n="N/A");let r=navigator.platform;r&&0!==r.length||(r="N/A"),qn=e,Jn=navigator.userAgent,Xn=window.screen.width+"x"+window.screen.height,Zn=t,er=document.domain,tr="1.0.0",nr=n,ir=rr=r},mc:function(){if(console.assert(null!=Sn),console.assert(null!=or),!Sn||!or)return-1;if(null!=ur){var e=hn[ur.name];e&&(Lr.deleteTexture(e),hn[ur.name]=null,e.name=0,ur=null)}const t=(e=Sn.Jh).createTexture(),n=In(hn);return t.name=n,hn[n]=t,e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,or),ur=t,n},xb:function(e){if(null==cr)throw"Vision image has not been processed! Call processVisionImage() first.";v.set(cr.data,e)},yb:function(){if(null==or)throw"Cannot process video frame if source video is not set";sr.width===or.videoWidth&&sr.height===or.videoHeight||(sr.width=or.videoWidth,sr.height=or.videoHeight,cr=null),ar.drawImage(or,0,0,sr.width,sr.height),cr=ar.getImageData(0,0,sr.width,sr.height)},zb:function(){Lr.bindTexture(Lr.TEXTURE_2D,ur),Lr.texImage2D(Lr.TEXTURE_2D,0,Lr.RGBA,Lr.RGBA,Lr.UNSIGNED_BYTE,or)},Eb:function(e){b.set(hr,e>>2)},Db:function(e){b.set(pr,e>>2)},Bb:function(e){b.set(Ar,e>>2)},Ab:function(e){b.set(Er,e>>2)},Ib:async function(){console.log("DeepAR FootTracking initialize started."),null==lr&&(lr=new o.Foot),null==dr&&(dr=new o.VideoManager(null,or.videoWidth,or.videoHeight)),lr.isInitialized()||(await lr.initialize(dr,{poseEstimationWasmFilename:t.footTrackingConfig.poseEstimationWasmPath,modelFilename:t.footTrackingConfig.detectorPath,featuresFilename:t.footTrackingConfig.trackerPath,objFilename:t.footTrackingConfig.objPath,fovY:50,detection_score_t:.25,tracking_score_t:.35,footToDetect:"BOTH_FEET",filteringLevel:0,filteringShift:.5}),console.log("DeepAR FootTracking initialized!"))},Hb:function(){return null!=lr&&lr.isInitialized()},Fb:function(){return fr},Cb:function(){return gr},Gb:function(){if(lr.isInitialized()){dr.preProcessWithBuffer(cr),lr.trackSync();var e=lr.getInterpolatedPose("LEFT_FOOT"),t=lr.getInterpolatedPose("RIGHT_FOOT");null!=e&&e.isDetected()?(hr=e.t(),pr=e.R(),fr=!0):fr=!1,null!=t&&t.isDetected()?(Ar=t.t(),Er=t.R(),gr=!0):gr=!1}},Lb:function(){return _r.getHeight()},Mb:function(){return _r.getWidth()},Jb:function(e){b.set(Ir,e>>2)},Ob:async function(){console.log("DeepAR segmentation initialize started"),null==_r&&(_r=new o.Segmentation),null==mr&&(mr=new o.VideoManager(null)),_r.isInitialized()||(await _r.initialize(mr,{filename:zn}),console.log("DeepAR segmentation initialized"))},Nb:function(){return null!=_r&&_r.isInitialized()},Kb:function(){_r.isInitialized()&&(mr.preProcessWithBuffer(cr),_r.processSync(),Ir=_r.getOutput(),mr.postProcess())},n:function(e){return e},Gf:Or,cc:function(e,t,n,r){return Or(e,t,n,r)},Hf:function(e,t,n){for(var r=P(t),i=0;25>i;++i)r=r.replace(new RegExp("\\"+"\\!@#$^&*()+=-[]/{}|:<>?,."[i],"g"),"\\"+"\\!@#$^&*()+=-[]/{}|:<>?,."[i]);for(var o in t={"%A":"%a","%B":"%b","%c":"%a %b %d %H:%M:%S %Y","%D":"%m\\/%d\\/%y","%e":"%d","%F":"%Y-%m-%d","%h":"%b","%R":"%H\\:%M","%r":"%I\\:%M\\:%S\\s%p","%T":"%H\\:%M\\:%S","%x":"%m\\/%d\\/(?:%y|%Y)","%X":"%H\\:%M\\:%S"})r=r.replace(o,t[o]);i={"%a":"(?:Sun(?:day)?)|(?:Mon(?:day)?)|(?:Tue(?:sday)?)|(?:Wed(?:nesday)?)|(?:Thu(?:rsday)?)|(?:Fri(?:day)?)|(?:Sat(?:urday)?)","%b":"(?:Jan(?:uary)?)|(?:Feb(?:ruary)?)|(?:Mar(?:ch)?)|(?:Apr(?:il)?)|May|(?:Jun(?:e)?)|(?:Jul(?:y)?)|(?:Aug(?:ust)?)|(?:Sep(?:tember)?)|(?:Oct(?:ober)?)|(?:Nov(?:ember)?)|(?:Dec(?:ember)?)","%C":"\\d\\d","%d":"0[1-9]|[1-9](?!\\d)|1\\d|2\\d|30|31","%H":"\\d(?!\\d)|[0,1]\\d|20|21|22|23","%I":"\\d(?!\\d)|0\\d|10|11|12","%j":"00[1-9]|0?[1-9](?!\\d)|0?[1-9]\\d(?!\\d)|[1,2]\\d\\d|3[0-6]\\d","%m":"0[1-9]|[1-9](?!\\d)|10|11|12","%M":"0\\d|\\d(?!\\d)|[1-5]\\d","%n":"\\s","%p":"AM|am|PM|pm|A\\.M\\.|a\\.m\\.|P\\.M\\.|p\\.m\\.","%S":"0\\d|\\d(?!\\d)|[1-5]\\d|60","%U":"0\\d|\\d(?!\\d)|[1-4]\\d|50|51|52|53","%W":"0\\d|\\d(?!\\d)|[1-4]\\d|50|51|52|53","%w":"[0-6]","%y":"\\d\\d","%Y":"\\d\\d\\d\\d","%%":"%","%t":"\\s"};var s={Fj:0,Ej:1,Ij:2,Bj:3,Jj:4,Hj:5,Gj:6,Cj:7,Mj:8,Lj:9,Kj:10,Dj:11};for(var a in o={Fi:0,Di:1,Hi:2,Ii:3,Gi:4,Bi:5,Ei:6},t={Di:0,Hi:1,Ii:2,Gi:3,Bi:4,Ei:5,Fi:6},i)r=r.replace(a,"("+a+i[a]+")");var c=[];for(i=r.indexOf("%");0<=i;i=r.indexOf("%"))c.push(r[i+1]),r=r.replace(new RegExp("\\%"+r[i+1],"g"),"");var u=new RegExp("^"+r,"i").exec(P(e));if(u){if(a=function(){function e(e,t,n){return"number"!=typeof e||isNaN(e)?t:e>=t?e<=n?e:n:t}return{year:e(C[n+20>>2]+1900,1970,9999),month:e(C[n+16>>2],0,11),day:e(C[n+12>>2],1,31),hour:e(C[n+8>>2],0,23),min:e(C[n+4>>2],0,59),zi:e(C[n>>2],0,59)}}(),i=e=>{if(0<=(e=c.indexOf(e)))return u[e+1]},(r=i("S"))&&(a.zi=parseInt(r)),(r=i("M"))&&(a.min=parseInt(r)),r=i("H"))a.hour=parseInt(r);else if(r=i("I")){var l=parseInt(r);(r=i("p"))&&(l+="P"===r.toUpperCase()[0]?12:0),a.hour=l}if((r=i("Y"))?a.year=parseInt(r):(r=i("y"))&&(l=parseInt(r),l=(r=i("C"))?l+100*parseInt(r):l+(69>l?2e3:1900),a.year=l),(r=i("m"))?a.month=parseInt(r)-1:(r=i("b"))&&(a.month=s[r.substring(0,3).toUpperCase()]||0),r=i("d"))a.day=parseInt(r);else if(r=i("j"))for(o=parseInt(r),t=Tr(a.year),s=0;12>s;++s)o<=(r=Rr(t?vr:yr,s-1))+(t?vr:yr)[s]&&(a.day=o-r);else(r=i("a"))&&(s=r.substring(0,3).toUpperCase(),(r=i("U"))?(o=o[s],t=parseInt(r),o=0===(s=new Date(a.year,0,1)).getDay()?Sr(s,o+7*(t-1)):Sr(s,7-s.getDay()+o+7*(t-1)),a.day=o.getDate(),a.month=o.getMonth()):(r=i("W"))&&(o=t[s],t=parseInt(r),o=1===(s=new Date(a.year,0,1)).getDay()?Sr(s,o+7*(t-1)):Sr(s,7-s.getDay()+1+o+7*(t-1)),a.day=o.getDate(),a.month=o.getMonth()));return a=new Date(a.year,a.month,a.day,a.hour,a.min,a.zi,0),C[n>>2]=a.getSeconds(),C[n+4>>2]=a.getMinutes(),C[n+8>>2]=a.getHours(),C[n+12>>2]=a.getDate(),C[n+16>>2]=a.getMonth(),C[n+20>>2]=a.getFullYear()-1900,C[n+24>>2]=a.getDay(),C[n+28>>2]=Rr(Tr(a.getFullYear())?vr:yr,a.getMonth()-1)+a.getDate()-1,C[n+32>>2]=0,e+Cr(u[0]).length-1}return 0}};!function(){function e(e){t.asm=e.exports,m=t.asm.og,U(),B=t.asm.Og,G.unshift(t.asm.pg),0==--Y&&(null!==K&&(clearInterval(K),K=null),$&&(e=$,$=null,e()))}function n(t){e(t.instance)}function i(e){return("function"==typeof fetch?fetch(F,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+F+"'";return e.arrayBuffer()})).catch((function(){return X()})):Promise.resolve().then((function(){return X()}))).then((function(e){return WebAssembly.instantiate(e,o)})).then((function(e){return e})).then(e,(function(e){g("failed to asynchronously prepare wasm: "+e),z(e)}))}var o={a:Mr};if(Y++,t.instantiateWasm)try{return t.instantiateWasm(o,e)}catch(e){g("Module.instantiateWasm callback failed with error: "+e),r(e)}("function"!=typeof WebAssembly.instantiateStreaming||q()||"function"!=typeof fetch?i(n):fetch(F,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,o).then(n,(function(e){return g("wasm streaming compile failed: "+e),g("falling back to ArrayBuffer instantiation"),i(n)}))}))).catch(r)}(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.pg).apply(null,arguments)};var Ur=t._initialize=function(){return(Ur=t._initialize=t.asm.qg).apply(null,arguments)};t._setLicenseKey=function(){return(t._setLicenseKey=t.asm.rg).apply(null,arguments)};var Br=t._shutdownEngine=function(){return(Br=t._shutdownEngine=t.asm.sg).apply(null,arguments)};t._processFrameVideo=function(){return(t._processFrameVideo=t.asm.tg).apply(null,arguments)},t._processFrameRawPixels=function(){return(t._processFrameRawPixels=t.asm.ug).apply(null,arguments)};var Fr=t._takeScreenshot=function(){return(Fr=t._takeScreenshot=t.asm.vg).apply(null,arguments)};t._switchEffect=function(){return(t._switchEffect=t.asm.wg).apply(null,arguments)},t._clearEffect=function(){return(t._clearEffect=t.asm.xg).apply(null,arguments)},t._showStats=function(){return(t._showStats=t.asm.yg).apply(null,arguments)},t._simulatePhysics=function(){return(t._simulatePhysics=t.asm.zg).apply(null,arguments)},t._showColliders=function(){return(t._showColliders=t.asm.Ag).apply(null,arguments)},t._render=function(){return(t._render=t.asm.Bg).apply(null,arguments)},t._fireTrigger=function(){return(t._fireTrigger=t.asm.Cg).apply(null,arguments)},t._setFaceDetectionSensitivity=function(){return(t._setFaceDetectionSensitivity=t.asm.Dg).apply(null,arguments)},t._changeParameterFloat=function(){return(t._changeParameterFloat=t.asm.Eg).apply(null,arguments)},t._changeParameterBool=function(){return(t._changeParameterBool=t.asm.Fg).apply(null,arguments)},t._changeParameterVector=function(){return(t._changeParameterVector=t.asm.Gg).apply(null,arguments)},t._changeParameterTexture=function(){return(t._changeParameterTexture=t.asm.Hg).apply(null,arguments)};var Vr=t._reset=function(){return(Vr=t._reset=t.asm.Ig).apply(null,arguments)};t._moveGameObject=function(){return(t._moveGameObject=t.asm.Jg).apply(null,arguments)};var Gr=t._touchOccurred=function(){return(Gr=t._touchOccurred=t.asm.Kg).apply(null,arguments)};t._pushConsoleLog=function(){return(t._pushConsoleLog=t.asm.Lg).apply(null,arguments)},t._enableAutoframing=function(){return(t._enableAutoframing=t.asm.Mg).apply(null,arguments)};var Qr=t._malloc=function(){return(Qr=t._malloc=t.asm.Ng).apply(null,arguments)},jr=t._free=function(){return(jr=t._free=t.asm.Pg).apply(null,arguments)},Hr=t.setTempRet0=function(){return(Hr=t.setTempRet0=t.asm.Qg).apply(null,arguments)},Wr=t._fflush=function(){return(Wr=t._fflush=t.asm.Rg).apply(null,arguments)},Yr=t.___getTypeName=function(){return(Yr=t.___getTypeName=t.asm.Sg).apply(null,arguments)};t.__embind_initialize_bindings=function(){return(t.__embind_initialize_bindings=t.asm.Tg).apply(null,arguments)};var Kr=t.___funcs_on_exit=function(){return(Kr=t.___funcs_on_exit=t.asm.Ug).apply(null,arguments)},$r=t._setThrew=function(){return($r=t._setThrew=t.asm.Vg).apply(null,arguments)},zr=t.stackSave=function(){return(zr=t.stackSave=t.asm.Wg).apply(null,arguments)},qr=t.stackRestore=function(){return(qr=t.stackRestore=t.asm.Xg).apply(null,arguments)},Jr=t.stackAlloc=function(){return(Jr=t.stackAlloc=t.asm.Yg).apply(null,arguments)},Xr=t.___cxa_can_catch=function(){return(Xr=t.___cxa_can_catch=t.asm.Zg).apply(null,arguments)},Zr=t.___cxa_is_pointer_type=function(){return(Zr=t.___cxa_is_pointer_type=t.asm._g).apply(null,arguments)};t.dynCall_viiiij=function(){return(t.dynCall_viiiij=t.asm.$g).apply(null,arguments)},t.dynCall_vijiiii=function(){return(t.dynCall_vijiiii=t.asm.ah).apply(null,arguments)};var ei=t.dynCall_j=function(){return(ei=t.dynCall_j=t.asm.bh).apply(null,arguments)},ti=t.dynCall_ji=function(){return(ti=t.dynCall_ji=t.asm.ch).apply(null,arguments)},ni=t.dynCall_vij=function(){return(ni=t.dynCall_vij=t.asm.dh).apply(null,arguments)},ri=t.dynCall_iij=function(){return(ri=t.dynCall_iij=t.asm.eh).apply(null,arguments)};t.dynCall_iijii=function(){return(t.dynCall_iijii=t.asm.fh).apply(null,arguments)},t.dynCall_vijii=function(){return(t.dynCall_vijii=t.asm.gh).apply(null,arguments)};var ii=t.dynCall_vji=function(){return(ii=t.dynCall_vji=t.asm.hh).apply(null,arguments)},oi=t.dynCall_jii=function(){return(oi=t.dynCall_jii=t.asm.ih).apply(null,arguments)};t.dynCall_jiji=function(){return(t.dynCall_jiji=t.asm.jh).apply(null,arguments)},t.dynCall_viij=function(){return(t.dynCall_viij=t.asm.kh).apply(null,arguments)};var si,ai=t.dynCall_viijii=function(){return(ai=t.dynCall_viijii=t.asm.lh).apply(null,arguments)},ci=t.dynCall_iiiiij=function(){return(ci=t.dynCall_iiiiij=t.asm.mh).apply(null,arguments)},ui=t.dynCall_jiiii=function(){return(ui=t.dynCall_jiiii=t.asm.nh).apply(null,arguments)};function li(){0<Y||(te(V),0<Y||si||(si=!0,t.calledRun=!0,N))||(te(G),n(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),te(j))}return t.dynCall_iiiiijj=function(){return(t.dynCall_iiiiijj=t.asm.oh).apply(null,arguments)},t.dynCall_iiiiiijj=function(){return(t.dynCall_iiiiiijj=t.asm.ph).apply(null,arguments)},t.cwrap=wr,$=function e(){si||li(),si||($=e)},li(),e.ready});const K_=Y_;var $_,z_;!function(e){e[e.Start=0]="Start",e[e.Move=1]="Move",e[e.End=2]="End"}($_||($_={})),function(e){e[e.INFO=1]="INFO",e[e.WARNING=2]="WARNING",e[e.ERROR=3]="ERROR"}(z_||(z_={}));var q_="DeepAR not yet initialized.",J_=function(){function e(e){var t=this;this.module=null,this.functionsToCallOnInitialize=[],this.callbacks=e.callbacks;var n={licenseKey:e.licenseKey,canvasWidth:e.canvas.width,canvasHeight:e.canvas.height,canvas:e.canvas,segmentationModel:e.segmentationConfig&&e.segmentationConfig.modelPath||null,footTrackingConfig:Object.assign({},e.footTrackingConfig),apiObject:this.callbacks,xzimg:{Segmentation:d_,VideoManager:i,Foot:W_},locateFile:function(t,n){return e.deeparWasmPath||n+t}};K_(n).then((function(n){t.module=n,e.callbacks.onInitialize&&e.callbacks.onInitialize(),t.functionsToCallOnInitialize.forEach((function(e){return e()}))}))}return e.prototype.switchEffect=function(e,t,n,r){this.module?this.module.switchEffect(e,t,n,r):console.log(q_)},e.prototype.clearEffect=function(e){this.module?this.module.clearEffect(e):console.log(q_)},e.prototype.startVideo=function(e,t){this.module?(this.module.startVideo(e,t),this.module.startLoop()):console.log(q_)},e.prototype.stopVideo=function(){this.module?this.module.stopVideo():console.log(q_)},e.prototype.setVideoElement=function(e,t){this.module?(this.module.setVideoElement(e,t),this.module.startLoop()):console.log(q_)},e.prototype.shutdown=function(){this.module?this.module.shutdown():console.log(q_)},e.prototype.downloadFaceTrackingModel=function(e,t){var n=this,r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=new Uint8Array(r.response);n.module?(n.module.setFaceTrackingModel(e),t&&t()):n.functionsToCallOnInitialize.push((function(){n.module.setFaceTrackingModel(e),t&&t()}))}},r.send(null)},e.prototype.setFaceTrackingModel=function(e){var t=this;this.module?this.module.setFaceTrackingModel(e):this.functionsToCallOnInitialize.push((function(){t.module.setFaceTrackingModel(e)}))},e.prototype.showStats=function(e){this.module?this.module.showStats(e):console.log(q_)},e.prototype.simulatePhysics=function(e){this.module?this.module.simulatePhysics(e):console.log(q_)},e.prototype.showColliders=function(e){this.module?this.module.showColliders(e):console.log(q_)},e.prototype.processFrame=function(e,t,n,r){this.module?this.module.processFrameRawPixels(e,t,n,r):console.log(q_)},e.prototype.processImage=function(e){if(this.module){var t=document.createElement("canvas"),n=t.getContext("2d",{willReadFrequently:!0});t.width=e.width,t.height=e.height,n.drawImage(e,0,0);var r=n.getImageData(0,0,t.width,t.height),i=new Uint8Array(r.data.buffer);this.processFrame(i,e.width,e.height,!1)}else console.log(q_)},e.prototype.resume=function(){this.module?this.module.startLoop():console.log(q_)},e.prototype.pause=function(){this.module?this.module.endLoop():console.log(q_)},e.prototype.changeParameterFloat=function(e,t,n,r){this.module?this.module.changeParameterFloat(e,t,n,r):console.log(q_)},e.prototype.changeParameterBool=function(e,t,n,r){this.module?this.module.changeParameterBool(e,t,n,r):console.log(q_)},e.prototype.changeParameterVector=function(e,t,n,r,i,o,s){this.module?this.module.changeParameterVector(e,t,n,r,i,o,s):console.log(q_)},e.prototype.changeParameterTexture=function(e,t,n,r){var i=this;if(this.module){var o=new Image;o.onload=function(){var r=document.createElement("canvas"),s=r.getContext("2d",{willReadFrequently:!0});r.width=o.width,r.height=o.height,s.drawImage(o,0,0);var a=s.getImageData(0,0,r.width,r.height),c=new Uint8Array(a.data.buffer),u=i.module._malloc(c.length);i.module.HEAPU8.set(c,u),i.module.changeParameterTexture(e,t,n,u,c.length,r.width,r.height)},o.src=r}else console.log(q_)},e.prototype.takeScreenshot=function(){this.module?this.module.takeScreenshot():console.log(q_)},e.prototype.setFps=function(e){this.module?this.module.setFps(e):console.log(q_)},e.prototype.moveGameObject=function(e,t){this.module?this.module.moveGameObject(e,t):console.log(q_)},e.prototype.fireTrigger=function(e){this.module?this.module.fireTrigger(e):console.log(q_)},e.prototype.touchOccurred=function(e){this.module?(e.x/=this.module.canvasWidth,e.y/=this.module.canvasHeight,this.module.touchOccurred(e)):console.log(q_)},e.prototype.startVideoRecording=function(e){this.module?this.module.startVideoRecording(e||{}):console.log(q_)},e.prototype.finishVideoRecording=function(e){this.module?this.module.finishVideoRecording(e):console.log(q_)},e.prototype.pushConsoleLog=function(e,t){return this.module?this.module.pushConsoleLog(e,t):(console.log(q_),!1)},e.prototype.getConsoleLogs=function(){if(this.module)return this.module.getConsoleLogs();console.log(q_)},e.prototype.setFaceDetectionSensitivity=function(e){this.module?this.module.setFaceDetectionSensitivity(e):console.log(q_)},e.prototype.setOffscreenRenderingEnabled=function(e){this.module.setOffscreenRenderingEnabled(e)},e.prototype.enableAutoframing=function(e){this.module?this.module._enableAutoframing(e):console.log(q_)},e}()})();var a=s.G;function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}var u=["onInitialize"];function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){T(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function A(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I(e);if(t){var i=I(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return _(this,n)}}function _(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function T(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var R=function(e){A(n,e);var t=g(n);function n(e){var r;return h(this,n),T(m(r=t.call(this)),"params",void 0),r.params=e,r}return f(n,[{key:"_createProcessor",value:function(){return new v(this.params)}}]),n}(e.Extension),v=function(e){A(n,e);var t=g(n);function n(e){var r;h(this,n),T(m(r=t.call(this)),"name","DeepARVideoProcessor"),T(m(r),"canvas",void 0),T(m(r),"videoElement",void 0),T(m(r),"canvasTrack",void 0),T(m(r),"fps",30.1),T(m(r),"deepAR",void 0),T(m(r),"isDeepArInitialized",!1),T(m(r),"isOnTrackCalled",!1),r.canvas=document.createElement("canvas"),r.canvas.width=640,r.canvas.height=480,r.videoElement=document.createElement("video"),r.videoElement.muted=!0;var i=r.canvas.captureStream();r.canvasTrack=i.getVideoTracks()[0];var o=e.onInitialize,s=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,u);return r.deepAR=new a(d(d({},s),{},{canvas:r.canvas,callbacks:{onInitialize:function(){console.log("DeepAR initialized"),r.isDeepArInitialized=!0,r.isOnTrackCalled&&r.initializeDeepARVideo(),o&&o(r.deepAR)}}})),r}return f(n,[{key:"initializeDeepARVideo",value:function(){this.deepAR.setVideoElement(this.videoElement,!0),this.deepAR.setFps(this.fps)}},{key:"onEnableChange",value:function(e){this.context&&(e?this.output(this.canvasTrack,this.context):this.inputTrack&&this.output(this.inputTrack,this.context))}},{key:"onTrack",value:function(e,t){var n=this;this.isOnTrackCalled=!0,this.videoElement.srcObject=new MediaStream([e]),this.videoElement.play(),this.videoElement.onplaying=function(){n.canvas.width=n.videoElement.videoWidth,n.canvas.height=n.videoElement.videoHeight},this.fps=e.getSettings().frameRate||30.1,this.enabled?this.output(this.canvasTrack,t):this.output(e,t),this.isDeepArInitialized&&this.initializeDeepARVideo()}},{key:"onUnpiped",value:function(){this.deepAR.shutdown()}}]),n}(e.VideoProcessor)})(),r})(),e.exports=t()},554:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(910),a=n(593),c=function(){function e(e){var t;this._channels=new Map,this._support_apis=((t={})[s.ApiTypeChannel.kChannelCreateChannel]=this.createChannel,t[s.ApiTypeChannel.kChannelRelease]=this.release,t[s.ApiTypeChannel.kChannelJoinChannel]=this.joinChannel,t[s.ApiTypeChannel.kChannelJoinChannelWithUserAccount]=this.joinChannelWithUserAccount,t[s.ApiTypeChannel.kChannelLeaveChannel]=this.leaveChannel,t[s.ApiTypeChannel.kChannelPublish]=this.publish,t[s.ApiTypeChannel.kChannelUnPublish]=this.unPublish,t[s.ApiTypeChannel.kChannelChannelId]=this.channelId,t[s.ApiTypeChannel.kChannelRenewToken]=this.renewToken,t[s.ApiTypeChannel.kChannelSetEncryptionSecret]=this.setEncryptionSecret,t[s.ApiTypeChannel.kChannelSetEncryptionMode]=this.setEncryptionMode,t[s.ApiTypeChannel.kChannelEnableEncryption]=this.enableEncryption,t[s.ApiTypeChannel.kChannelSetClientRole]=this.setClientRole,t[s.ApiTypeChannel.kChannelSetDefaultMuteAllRemoteAudioStreams]=this.setDefaultMuteAllRemoteAudioStreams,t[s.ApiTypeChannel.kChannelSetDefaultMuteAllRemoteVideoStreams]=this.setDefaultMuteAllRemoteVideoStreams,t[s.ApiTypeChannel.kChannelMuteLocalAudioStream]=this.muteLocalAudioStream,t[s.ApiTypeChannel.kChannelMuteLocalVideoStream]=this.muteLocalVideoStream,t[s.ApiTypeChannel.kChannelMuteAllRemoteAudioStreams]=this.muteAllRemoteAudioStreams,t[s.ApiTypeChannel.kChannelAdjustUserPlaybackSignalVolume]=this.adjustUserPlaybackSignalVolume,t[s.ApiTypeChannel.kChannelMuteRemoteAudioStream]=this.muteRemoteAudioStream,t[s.ApiTypeChannel.kChannelMuteAllRemoteVideoStreams]=this.muteAllRemoteVideoStreams,t[s.ApiTypeChannel.kChannelMuteRemoteVideoStream]=this.muteRemoteVideoStream,t[s.ApiTypeChannel.kChannelSetRemoteVideoStreamType]=this.setRemoteVideoStreamType,t[s.ApiTypeChannel.kChannelSetRemoteDefaultVideoStreamType]=this.setRemoteDefaultVideoStreamType,t[s.ApiTypeChannel.kChannelAddPublishStreamUrl]=this.addPublishStreamUrl,t[s.ApiTypeChannel.kChannelRemovePublishStreamUrl]=this.removePublishStreamUrl,t[s.ApiTypeChannel.kChannelSetLiveTranscoding]=this.setLiveTranscoding,t[s.ApiTypeChannel.kChannelAddInjectStreamUrl]=this.addInjectStreamUrl,t[s.ApiTypeChannel.kChannelRemoveInjectStreamUrl]=this.removeInjectStreamUrl,t[s.ApiTypeChannel.kChannelStartChannelMediaRelay]=this.startChannelMediaRelay,t[s.ApiTypeChannel.kChannelUpdateChannelMediaRelay]=this.updateChannelMediaRelay,t[s.ApiTypeChannel.kChannelStopChannelMediaRelay]=this.stopChannelMediaRelay,t[s.ApiTypeChannel.kChannelGetConnectionState]=this.getConnectionState,t),this._engine=e}return e.prototype.callApi=function(e,t,n){var r;return i(this,void 0,void 0,(function(){return o(this,(function(i){return(0,a.printf)("callApi",e,t,n,this),[2,null===(r=this._support_apis[e])||void 0===r?void 0:r.call(this,JSON.parse(t),n)]}))}))},e.prototype.setEventHandler=function(e){this._handler=e},e.prototype.getChannel=function(e){return this._channels.get(e)},e.prototype.createChannel=function(e){return i(this,void 0,void 0,(function(){var t,n,i=this;return o(this,(function(o){switch(o.label){case 0:return t=e.channelId,this._channels.has(t)?[2]:[4,this._engine.createChannel()];case 1:return(n=o.sent()).setEventHandler((function(e,n){var o;null===(o=i._handler)||void 0===o||o.call(i,e,JSON.stringify(r(r({},JSON.parse(n)),{channelId:t})))})),this._channels.set(t,n),[2]}}))}))},e.prototype.release=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){if(t=e.channelId,!this._channels.has(t))throw"please create first";return this._channels.get(t).release(),this._channels.delete(t),[2]}))}))},e.prototype.joinChannel=function(e){var t;return i(this,void 0,void 0,(function(){var n,r,i,s,a;return o(this,(function(o){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.token,i=e.info,s=e.uid,a=e.options,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.joinChannel({token:r,channelId:n,info:i,uid:s,options:a})]}))}))},e.prototype.joinChannelWithUserAccount=function(e){var t;return i(this,void 0,void 0,(function(){var n,r,i,s;return o(this,(function(o){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.token,i=e.userAccount,s=e.options,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.joinChannelWithUserAccount({token:r,channelId:n,userAccount:i,options:s})]}))}))},e.prototype.leaveChannel=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){if(t=e.channelId,!this._channels.has(t))throw"please create first";return[2,this._channels.get(t).leaveChannel()]}))}))},e.prototype.publish=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:if(t=e.channelId,!this._channels.has(t))throw"please create first";return[4,this._channels.get(t).muteLocalAudioStream({mute:!1})];case 1:return n.sent(),[4,this._channels.get(t).muteLocalVideoStream({mute:!1})];case 2:return n.sent(),[2]}}))}))},e.prototype.unPublish=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:if(t=e.channelId,!this._channels.has(t))throw"please create first";return[4,this._channels.get(t).muteLocalAudioStream({mute:!0})];case 1:return n.sent(),[4,this._channels.get(t).muteLocalVideoStream({mute:!0})];case 2:return n.sent(),[2]}}))}))},e.prototype.channelId=function(e){var t=e.channelId;if(!this._channels.has(t))throw"please create first";return t},e.prototype.renewToken=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.token,[2,this._channels.get(t).renewToken({token:n})]}))}))},e.prototype.setEncryptionSecret=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.secret,[2,this._channels.get(t).setEncryptionSecret({secret:n})]}))}))},e.prototype.setEncryptionMode=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.encryptionMode,[2,this._channels.get(t).setEncryptionMode({encryptionMode:n})]}))}))},e.prototype.enableEncryption=function(e){return i(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.enabled,r=e.config,[2,this._channels.get(t).enableEncryption({enabled:n,config:r})]}))}))},e.prototype.setClientRole=function(e){return i(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.role,r=e.options,[2,this._channels.get(t).setClientRole({role:n,options:r})]}))}))},e.prototype.setDefaultMuteAllRemoteAudioStreams=function(e){var t;return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.mute,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.setDefaultMuteAllRemoteAudioStreams({mute:r})]}))}))},e.prototype.setDefaultMuteAllRemoteVideoStreams=function(e){var t;return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.mute,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.setDefaultMuteAllRemoteVideoStreams({mute:r})]}))}))},e.prototype.muteLocalAudioStream=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.mute,[2,this._channels.get(t).muteLocalAudioStream({mute:n})]}))}))},e.prototype.muteLocalVideoStream=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.mute,[2,this._channels.get(t).muteLocalVideoStream({mute:n})]}))}))},e.prototype.muteAllRemoteAudioStreams=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.mute,[2,this._channels.get(t).muteAllRemoteAudioStreams({mute:n})]}))}))},e.prototype.adjustUserPlaybackSignalVolume=function(e){var t;return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.uid,i=e.volume,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.adjustUserPlaybackSignalVolume({uid:r,volume:i})]}))}))},e.prototype.muteRemoteAudioStream=function(e){var t;return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.userId,i=e.mute,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.muteRemoteAudioStream({userId:r,mute:i})]}))}))},e.prototype.muteAllRemoteVideoStreams=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.mute,[2,this._channels.get(t).muteAllRemoteVideoStreams({mute:n})]}))}))},e.prototype.muteRemoteVideoStream=function(e){var t;return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.userId,i=e.mute,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.muteRemoteVideoStream({userId:r,mute:i})]}))}))},e.prototype.setRemoteVideoStreamType=function(e){var t;return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.userId,i=e.streamType,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.setRemoteVideoStreamType({userId:r,streamType:i})]}))}))},e.prototype.setRemoteDefaultVideoStreamType=function(e){var t;return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.streamType,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.setRemoteDefaultVideoStreamType({streamType:r})]}))}))},e.prototype.addPublishStreamUrl=function(e){var t;return i(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.url,i=e.transcodingEnabled,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.addPublishStreamUrl({url:r,transcodingEnabled:i})]}))}))},e.prototype.removePublishStreamUrl=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.url,[2,this._channels.get(t).removePublishStreamUrl({url:n})]}))}))},e.prototype.setLiveTranscoding=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.transcoding,[2,this._channels.get(t).setLiveTranscoding({transcoding:n})]}))}))},e.prototype.addInjectStreamUrl=function(e){return i(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(i){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.url,r=e.config,[2,this._channels.get(t).addInjectStreamUrl({url:n,config:r})]}))}))},e.prototype.removeInjectStreamUrl=function(e){return i(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){if(t=e.channelId,!this._channels.has(t))throw"please create first";return n=e.url,[2,this._channels.get(t).removeInjectStreamUrl({url:n})]}))}))},e.prototype.startChannelMediaRelay=function(e){var t;return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.configuration,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.startChannelMediaRelay({configuration:r})]}))}))},e.prototype.updateChannelMediaRelay=function(e){var t;return i(this,void 0,void 0,(function(){var n,r;return o(this,(function(i){if(n=e.channelId,!this._channels.has(n))throw"please create first";return r=e.configuration,[2,null===(t=this._channels.get(n))||void 0===t?void 0:t.updateChannelMediaRelay({configuration:r})]}))}))},e.prototype.stopChannelMediaRelay=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){if(t=e.channelId,!this._channels.has(t))throw"please create first";return[2,this._channels.get(t).stopChannelMediaRelay()]}))}))},e.prototype.getConnectionState=function(e){return i(this,void 0,void 0,(function(){var t;return o(this,(function(n){if(t=e.channelId,!this._channels.has(t))throw"please create first";return[2,this._channels.get(t).getConnectionState()]}))}))},e}();t.default=c},673:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(910),c=n(593),u=n(674),l=n(106),d=n(501),h=n(983),p=n(424),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.microphoneConfig={},t.cameraConfig={},t}return i(t,e),t.prototype.createMicrophoneAudioTrack=function(e,t,n){var r;return void 0===n&&(n=!1),o(this,void 0,void 0,(function(){var i,u=this;return s(this,(function(l){switch(l.label){case 0:if(!e)return(0,c.printf)("createMicrophoneAudioTrack",e),[2];if(this.localAudioTrack){if(!n)return[2,this.localAudioTrack];this.localAudioTrack.close(),this.localAudioTrack=void 0}return i=this,[4,p.createMicrophoneAudioTrack(this.microphoneConfig)];case 1:return i.localAudioTrack=l.sent(),null===(r=this.localAudioTrack)||void 0===r||r.on("track-ended",(function(){p.getMicrophones().then((function(e){var t;e[0]&&(null===(t=u.localAudioTrack)||void 0===t||t.setDevice(e[0].deviceId))})),t("LocalAudioStateChanged",{state:a.LOCAL_AUDIO_STREAM_STATE.LOCAL_AUDIO_STREAM_STATE_FAILED,error:a.LOCAL_AUDIO_STREAM_ERROR.LOCAL_AUDIO_STREAM_ERROR_RECORD_FAILURE})})),p.onMicrophoneChanged=function(e){return o(u,void 0,void 0,(function(){var t,n,r,i;return s(this,(function(o){switch(o.label){case 0:return"ACTIVE"!==e.state?[3,1]:(null===(n=this.localAudioTrack)||void 0===n||n.setDevice(e.device.deviceId),[3,3]);case 1:return e.device.label!==(null===(r=this.localAudioTrack)||void 0===r?void 0:r.getTrackLabel())?[3,3]:[4,p.getMicrophones()];case 2:(t=o.sent())[0]&&(null===(i=this.localAudioTrack)||void 0===i||i.setDevice(t[0].deviceId)),o.label=3;case 3:return[2]}}))}))},[2,this.localAudioTrack]}}))}))},t.prototype.recoverAudioDevice=function(){var e;return o(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return[4,p.getMicrophones()];case 1:return(t=n.sent())[0]&&(null===(e=this.localAudioTrack)||void 0===e||e.setDevice(t[0].deviceId)),[2]}}))}))},t.prototype.createCameraVideoTrack=function(e,t,n){var r,i,f;return void 0===n&&(n=!1),o(this,void 0,void 0,(function(){var o,A,E,g=this;return s(this,(function(s){switch(s.label){case 0:if(!e)return(0,c.printf)("CreateCameraVideoTrack",e),[2];if(this.localVideoTrack){if(!n)return[2,this.localVideoTrack];this.localVideoTrack.close(),this.localVideoTrack=void 0}return o=this,[4,p.createCameraVideoTrack(this.cameraConfig)];case 1:return o.localVideoTrack=s.sent(),null===(r=this.localVideoTrack)||void 0===r||r.on("track-ended",(function(){t("LocalVideoStateChanged",{localVideoState:a.LOCAL_VIDEO_STREAM_STATE.LOCAL_VIDEO_STREAM_STATE_FAILED,error:a.LOCAL_VIDEO_STREAM_ERROR.LOCAL_VIDEO_STREAM_ERROR_CAPTURE_FAILURE})})),A=new u.VideoExtension({licenseKey:"da8d4a47ef8a9c7be1e9783b9b084328bb8b09afeaf3ffe2b3786729813952d432fe260dba0e60ee",deeparWasmPath:l,segmentationConfig:{modelPath:h}}),p.registerExtensions([A]),[4,A.createProcessor()];case 2:return E=s.sent(),null===(i=this.localVideoTrack)||void 0===i||i.pipe(E).pipe(null===(f=this.localVideoTrack)||void 0===f?void 0:f.processorDestination),this.playLocalVideo(),this.deepAR=E.deepAR,[4,this.deepAR.downloadFaceTrackingModel(d)];case 3:return s.sent(),setTimeout((function(){g.testFunc()}),4e3),(0,c.printf)("DELDEL step 7"),[2,this.localVideoTrack]}}))}))},t.prototype.testFunc=function(){this.deepAR.switchEffect(0,"slot","./assets/deepar/Split_View_Look.deepar")},t.prototype.createScreenVideoTrack=function(e,t,n,r){var i,u,l,d;return void 0===r&&(r=!1),o(this,void 0,void 0,(function(){var o,h,f;return s(this,(function(s){switch(s.label){case 0:if(!e)return(0,c.printf)("createScreenVideoTrack",e),[2];if(this.localVideoTrack){if(!r)return[2,this.localVideoTrack];this.localVideoTrack.close(),this.localVideoTrack=void 0}return this.screenConfig={encoderConfig:{width:null===(i=null==n?void 0:n.dimensions)||void 0===i?void 0:i.width,height:null===(u=null==n?void 0:n.dimensions)||void 0===u?void 0:u.height,frameRate:null==n?void 0:n.frameRate,bitrateMin:null==n?void 0:n.bitrate,bitrateMax:null==n?void 0:n.bitrate}},[4,p.createScreenVideoTrack(this.screenConfig,"auto")];case 1:return void 0!==(null==(o=s.sent())?void 0:o.play)?this.localVideoTrack=o:(h=o[0],f=o[1],this.localVideoTrack=h,this.localAudioTrack=f,null===(l=this.localAudioTrack)||void 0===l||l.on("track-ended",(function(){t("LocalAudioStateChanged",{state:a.LOCAL_AUDIO_STREAM_STATE.LOCAL_AUDIO_STREAM_STATE_FAILED,error:a.LOCAL_AUDIO_STREAM_ERROR.LOCAL_AUDIO_STREAM_ERROR_RECORD_FAILURE})}))),null===(d=this.localVideoTrack)||void 0===d||d.on("track-ended",(function(){t("LocalVideoStateChanged",{localVideoState:a.LOCAL_VIDEO_STREAM_STATE.LOCAL_VIDEO_STREAM_STATE_FAILED,error:a.LOCAL_VIDEO_STREAM_ERROR.LOCAL_VIDEO_STREAM_ERROR_CAPTURE_FAILURE})})),this.playLocalVideo(),[2,this.localVideoTrack]}}))}))},t.prototype.enableLocalAudio=function(e){var t;return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,null===(t=this.localAudioTrack)||void 0===t?void 0:t.setEnabled(e)]}))}))},t.prototype.enableLocalVideo=function(e){var t;return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,null===(t=this.localVideoTrack)||void 0===t?void 0:t.setEnabled(e)]}))}))},t.prototype.muteLocalAudio=function(e){var t;return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,null===(t=this.localAudioTrack)||void 0===t?void 0:t.setMuted(e)]}))}))},t.prototype.muteLocalVideo=function(e){var t;return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,null===(t=this.localVideoTrack)||void 0===t?void 0:t.setMuted(e)]}))}))},t.prototype.adjustRecordingSignalVolume=function(e){var t;null===(t=this.localAudioTrack)||void 0===t||t.setVolume(e)},t.prototype.setAudioEncoderConfiguration=function(e){this.microphoneConfig.encoderConfig=e},t.prototype.setVideoEncoderConfiguration=function(e){var t;return o(this,void 0,void 0,(function(){var n;return s(this,(function(r){return this.cameraConfig.encoderConfig=e,void 0!==(n=null===(t=this.localVideoTrack)||void 0===t?void 0:t.setEncoderConfiguration)?[2,n.call(this.localVideoTrack,this.cameraConfig.encoderConfig)]:[2]}))}))},t.prototype.setBeautyEffect=function(e,t){var n;return o(this,void 0,void 0,(function(){var r;return s(this,(function(i){return void 0!==(r=null===(n=this.localVideoTrack)||void 0===n?void 0:n.setBeautyEffect)?[2,r.call(this.localVideoTrack,e,t)]:[2]}))}))},t.prototype.stopCameraCapture=function(){var e;void 0===this.screenConfig&&(null===(e=this.localVideoTrack)||void 0===e||e.close(),this.localVideoTrack=void 0)},t.prototype.stopScreenCapture=function(){var e;void 0!==this.screenConfig&&(null===(e=this.localVideoTrack)||void 0===e||e.close(),this.localVideoTrack=void 0,this.screenConfig=void 0)},t.prototype.setupLocalVideo=function(e){void 0===e?this.canvasMap.delete(0):(this.canvasMap.set(e.uid,e),this.setupVideo(this.localVideoTrack,e))},t.prototype.playLocalVideo=function(){this.setupVideo(this.localVideoTrack,this.canvasMap.get(0))},t}(function(){function e(){this.canvasMap=new Map}return e.prototype.setupVideo=function(e,t){if(void 0!==t){var n,r=null==e?void 0:e.getUserId;if((n=void 0===r?0:r.call(e))===t.uid){var i="cover";switch(t.renderMode){case a.RENDER_MODE_TYPE.RENDER_MODE_HIDDEN:i="cover";break;case a.RENDER_MODE_TYPE.RENDER_MODE_FIT:i="contain";break;case a.RENDER_MODE_TYPE.RENDER_MODE_ADAPTIVE:i="cover";break;case a.RENDER_MODE_TYPE.RENDER_MODE_FILL:i="fill"}for(var o=t.view,s=0;s<o.children.length;s++)o.removeChild(o.children.item(s));var c;c=0===n&&t.mirrorMode===a.VIDEO_MIRROR_MODE_TYPE.VIDEO_MIRROR_MODE_AUTO||t.mirrorMode===a.VIDEO_MIRROR_MODE_TYPE.VIDEO_MIRROR_MODE_ENABLED,null==e||e.play(o,{mirror:c,fit:i})}}},e}()),A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.remoteAudioTracks=[],t.remoteVideoTracks=[],t}return i(t,e),t.prototype.addRemoteAudioTrack=function(e){var t;e.setPlaybackDevice(null!==(t=this.audioPlaybackDeviceId)&&void 0!==t?t:""),this.remoteAudioTracks.push(e)},t.prototype.getRemoteAudioTrack=function(e){var t=this.remoteAudioTracks.findIndex((function(t){return t.getUserId()===e}));return this.remoteAudioTracks[t]},t.prototype.removeRemoteAudioTrack=function(e){var t=this.remoteAudioTracks.findIndex((function(t){return t.getUserId()===e}));this.remoteAudioTracks.splice(t,1)},t.prototype.clearRemoteAudioTracks=function(){this.remoteAudioTracks.splice(0,this.remoteAudioTracks.length)},t.prototype.addRemoteVideoTrack=function(e){this.remoteVideoTracks.push(e)},t.prototype.getRemoteVideoTrack=function(e){var t=this.remoteVideoTracks.findIndex((function(t){return t.getUserId()===e}));return this.remoteVideoTracks[t]},t.prototype.removeRemoteVideoTrack=function(e){var t=this.remoteVideoTracks.findIndex((function(t){return t.getUserId()===e}));this.remoteVideoTracks.splice(t,1)},t.prototype.clearRemoteVideoTracks=function(){this.remoteVideoTracks.splice(0,this.remoteVideoTracks.length)},t.prototype.adjustPlaybackSignalVolume=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.remoteAudioTracks.map((function(t){return t.setVolume(e)}))]}))}))},t.prototype.adjustUserPlaybackSignalVolume=function(e,t){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.remoteAudioTracks.map((function(n){if(n.getUserId()===e)return n.setVolume(t)}))]}))}))},t.prototype.enableRemoteAudio=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.remoteAudioTracks.map((function(t){return e?t.play():t.stop()}))]}))}))},t.prototype.enableRemoteVideo=function(e){return o(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){return[2,this.remoteVideoTracks.map((function(n){e?t.setupVideo(n,t.canvasMap.get(n.getUserId())):n.stop()}))]}))}))},t.prototype.setupRemoteVideo=function(e,t){void 0===t?this.canvasMap.delete(e):(this.canvasMap.set(e,t),this.setupVideo(this.getRemoteVideoTrack(e),t))},t.prototype.playRemoteVideo=function(e){this.setupVideo(this.getRemoteVideoTrack(e),this.canvasMap.get(e))},t}(f),E=function(e){function t(){var t,n,r=null!==e&&e.apply(this,arguments)||this;return r._support_apis_audio=((t={})[a.ApiTypeAudioDeviceManager.kADMEnumeratePlaybackDevices]=r.enumerateAudioPlaybackDevices,t[a.ApiTypeAudioDeviceManager.kADMSetPlaybackDevice]=r.setAudioPlaybackDevice,t[a.ApiTypeAudioDeviceManager.kADMGetPlaybackDevice]=r.getAudioPlaybackDevice,t[a.ApiTypeAudioDeviceManager.kADMGetPlaybackDeviceInfo]=r.getAudioPlaybackDeviceInfo,t[a.ApiTypeAudioDeviceManager.kADMEnumerateRecordingDevices]=r.enumerateAudioRecordingDevices,t[a.ApiTypeAudioDeviceManager.kADMSetRecordingDevice]=r.setAudioRecordingDevice,t[a.ApiTypeAudioDeviceManager.kADMGetRecordingDevice]=r.getAudioRecordingDevice,t[a.ApiTypeAudioDeviceManager.kADMGetRecordingDeviceInfo]=r.getAudioRecordingDeviceInfo,t[a.ApiTypeAudioDeviceManager.kADMSetRecordingDeviceVolume]=r.setAudioRecordingDeviceVolume,t[a.ApiTypeAudioDeviceManager.kADMGetRecordingDeviceVolume]=r.getAudioRecordingDeviceVolume,t),r._support_apis_video=((n={})[a.ApiTypeVideoDeviceManager.kVDMEnumerateVideoDevices]=r.enumerateVideoDevices,n[a.ApiTypeVideoDeviceManager.kVDMSetDevice]=r.setVideoDeviceId,n[a.ApiTypeVideoDeviceManager.kVDMGetDevice]=r.getVideoDeviceId,n),r}return i(t,e),t.prototype.callApiAudio=function(e,t,n){var r;return o(this,void 0,void 0,(function(){return s(this,(function(i){return(0,c.printf)("callApiAudio",e,t,n,this),[2,null===(r=this._support_apis_audio[e])||void 0===r?void 0:r.call(this,JSON.parse(t),n)]}))}))},t.prototype.callApiVideo=function(e,t,n){var r;return o(this,void 0,void 0,(function(){return s(this,(function(i){return(0,c.printf)("callApiVideo",e,t,n,this),[2,null===(r=this._support_apis_video[e])||void 0===r?void 0:r.call(this,JSON.parse(t),n)]}))}))},t.prototype.release=function(){var e,t;null===(e=this.localAudioTrack)||void 0===e||e.close(),this.localAudioTrack=void 0,null===(t=this.localVideoTrack)||void 0===t||t.close(),this.localVideoTrack=void 0,this.clearRemoteAudioTracks(),this.clearRemoteVideoTracks()},t.prototype.enumerateAudioPlaybackDevices=function(){var e;return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,null===(e=p.getPlaybackDevices())||void 0===e?void 0:e.then((function(e){return JSON.stringify(e.map((function(e){return{deviceId:e.deviceId,deviceName:e.label}})))}))]}))}))},t.prototype.setAudioPlaybackDevice=function(e){return o(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){switch(n.label){case 0:return this.audioPlaybackDeviceId=e.deviceId,[4,Promise.all(this.remoteAudioTracks.map((function(e){var n;return e.setPlaybackDevice(null!==(n=t.audioPlaybackDeviceId)&&void 0!==n?n:"")})))];case 1:return n.sent(),[2]}}))}))},t.prototype.getAudioPlaybackDevice=function(e){var t;return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,null!==(t=this.audioPlaybackDeviceId)&&void 0!==t?t:""]}))}))},t.prototype.getAudioPlaybackDeviceInfo=function(e){var t;return o(this,void 0,void 0,(function(){var e=this;return s(this,(function(n){return[2,null===(t=p.getPlaybackDevices())||void 0===t?void 0:t.then((function(t){var n=t.find((function(t){return t.deviceId===e.audioPlaybackDeviceId}));return JSON.stringify({deviceId:n.deviceId,deviceName:n.label})}))]}))}))},t.prototype.enumerateAudioRecordingDevices=function(){var e;return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,null===(e=p.getMicrophones())||void 0===e?void 0:e.then((function(e){return JSON.stringify(e.map((function(e){return{deviceId:e.deviceId,deviceName:e.label}})))}))]}))}))},t.prototype.setAudioRecordingDevice=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){return this.microphoneConfig.microphoneId=e.deviceId,[2]}))}))},t.prototype.getAudioRecordingDevice=function(e){var t;return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,null!==(t=this.microphoneConfig.microphoneId)&&void 0!==t?t:""]}))}))},t.prototype.setAudioRecordingDeviceVolume=function(e){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.adjustRecordingSignalVolume(e.volume)]}))}))},t.prototype.getAudioRecordingDeviceVolume=function(){var e,t;return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,null!==(t=null===(e=this.localAudioTrack)||void 0===e?void 0:e.getVolumeLevel())&&void 0!==t?t:0]}))}))},t.prototype.getAudioRecordingDeviceInfo=function(e){var t;return o(this,void 0,void 0,(function(){var e=this;return s(this,(function(n){return[2,null===(t=p.getMicrophones())||void 0===t?void 0:t.then((function(t){var n=t.find((function(t){return t.deviceId===e.microphoneConfig.microphoneId}));return JSON.stringify({deviceId:n.deviceId,deviceName:n.label})}))]}))}))},t.prototype.enumerateVideoDevices=function(){var e;return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2,null===(e=p.getCameras())||void 0===e?void 0:e.then((function(e){return JSON.stringify(e.map((function(e){return{deviceId:e.deviceId,deviceName:e.label}})))}))]}))}))},t.prototype.setVideoDeviceId=function(e){var t;return o(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return this.cameraConfig===e.deviceId?[3,2]:(this.cameraConfig.cameraId=e.deviceId,[4,p.getCameras()]);case 1:n.sent()[0]&&(null===(t=this.localVideoTrack)||void 0===t||t.setDevice(e.deviceId)),this.localAudioTrack&&this.localAudioTrack.getTrackLabel(),n.label=2;case 2:return[2]}}))}))},t.prototype.getVideoDeviceId=function(e){var t;return o(this,void 0,void 0,(function(){return s(this,(function(e){return[2,null!==(t=this.cameraConfig.cameraId)&&void 0!==t?t:""]}))}))},t}(A);t.default=E},986:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(424),s=n(673),a=n(910),c=n(593),u=n(554),l=n(424),d=function(){function e(){var e;this.channel=new u.default(this),this.deviceManager=new s.default,this._support_apis=((e={})[a.ApiTypeEngine.kEngineInitialize]=this.initialize,e[a.ApiTypeEngine.kEngineRelease]=this.release,e[a.ApiTypeEngine.kEngineSetChannelProfile]=this.setChannelProfile,e[a.ApiTypeEngine.kEngineSetClientRole]=this.setClientRole,e[a.ApiTypeEngine.kEngineJoinChannel]=this.joinChannel,e[a.ApiTypeEngine.kEngineLeaveChannel]=this.leaveChannel,e[a.ApiTypeEngine.kEngineRenewToken]=this.renewToken,e[a.ApiTypeEngine.kEngineJoinChannelWithUserAccount]=this.joinChannelWithUserAccount,e[a.ApiTypeEngine.kEngineEnableVideo]=this.enableVideo,e[a.ApiTypeEngine.kEngineDisableVideo]=this.disableVideo,e[a.ApiTypeEngine.kEngineSetVideoEncoderConfiguration]=this.setVideoEncoderConfiguration,e[a.ApiTypeEngine.kEngineSetupLocalVideo]=this.setupLocalVideo,e[a.ApiTypeEngine.kEngineSetupRemoteVideo]=this.setupRemoteVideo,e[a.ApiTypeEngine.kEngineStartPreview]=this.startPreview,e[a.ApiTypeEngine.kEngineStopPreview]=this.stopPreview,e[a.ApiTypeEngine.kEngineEnableAudio]=this.enableAudio,e[a.ApiTypeEngine.kEngineEnableLocalAudio]=this.enableLocalAudio,e[a.ApiTypeEngine.kEngineDisableAudio]=this.disableAudio,e[a.ApiTypeEngine.kEngineSetAudioProfile]=this.setAudioProfile,e[a.ApiTypeEngine.kEngineMuteLocalAudioStream]=this.muteLocalAudioStream,e[a.ApiTypeEngine.kEngineMuteAllRemoteAudioStreams]=this.muteAllRemoteAudioStreams,e[a.ApiTypeEngine.kEngineSetDefaultMuteAllRemoteAudioStreams]=this.setDefaultMuteAllRemoteAudioStreams,e[a.ApiTypeEngine.kEngineAdjustUserPlaybackSignalVolume]=this.adjustUserPlaybackSignalVolume,e[a.ApiTypeEngine.kEngineMuteRemoteAudioStream]=this.muteRemoteAudioStream,e[a.ApiTypeEngine.kEngineMuteLocalVideoStream]=this.muteLocalVideoStream,e[a.ApiTypeEngine.kEngineEnableLocalVideo]=this.enableLocalVideo,e[a.ApiTypeEngine.kEngineMuteAllRemoteVideoStreams]=this.muteAllRemoteVideoStreams,e[a.ApiTypeEngine.kEngineSetDefaultMuteAllRemoteVideoStreams]=this.setDefaultMuteAllRemoteVideoStreams,e[a.ApiTypeEngine.kEngineMuteRemoteVideoStream]=this.muteRemoteVideoStream,e[a.ApiTypeEngine.kEngineSetRemoteVideoStreamType]=this.setRemoteVideoStreamType,e[a.ApiTypeEngine.kEngineSetRemoteDefaultVideoStreamType]=this.setRemoteDefaultVideoStreamType,e[a.ApiTypeEngine.kEngineEnableAudioVolumeIndication]=this.enableAudioVolumeIndication,e[a.ApiTypeEngine.kEngineSetLogFilter]=this.setLogFilter,e[a.ApiTypeEngine.kEngineUploadLogFile]=this.uploadLogFile,e[a.ApiTypeEngine.kEngineEnableDualStreamMode]=this.enableDualStreamMode,e[a.ApiTypeEngine.kEngineAdjustRecordingSignalVolume]=this.adjustRecordingSignalVolume,e[a.ApiTypeEngine.kEngineAdjustPlaybackSignalVolume]=this.adjustPlaybackSignalVolume,e[a.ApiTypeEngine.kEngineSetRemoteSubscribeFallbackOption]=this.setRemoteSubscribeFallbackOption,e[a.ApiTypeEngine.kEngineStartScreenCaptureByDisplayId]=this.startScreenCaptureByDisplayId,e[a.ApiTypeEngine.kEngineStartScreenCaptureByScreenRect]=this.startScreenCaptureByScreenRect,e[a.ApiTypeEngine.kEngineStartScreenCaptureByWindowId]=this.startScreenCaptureByWindowId,e[a.ApiTypeEngine.kEngineStopScreenCapture]=this.stopScreenCapture,e[a.ApiTypeEngine.kEngineStartScreenCapture]=this.startScreenCapture,e[a.ApiTypeEngine.kEngineGetVersion]=this.getVersion,e[a.ApiTypeEngine.kEngineSetEncryptionSecret]=this.setEncryptionSecret,e[a.ApiTypeEngine.kEngineSetEncryptionMode]=this.setEncryptionMode,e[a.ApiTypeEngine.kEngineEnableEncryption]=this.enableEncryption,e[a.ApiTypeEngine.kEngineAddPublishStreamUrl]=this.addPublishStreamUrl,e[a.ApiTypeEngine.kEngineRemovePublishStreamUrl]=this.removePublishStreamUrl,e[a.ApiTypeEngine.kEngineSetLiveTranscoding]=this.setLiveTranscoding,e[a.ApiTypeEngine.kEngineSetBeautyEffectOptions]=this.setBeautyEffectOptions,e[a.ApiTypeEngine.kEngineAddInjectStreamUrl]=this.addInjectStreamUrl,e[a.ApiTypeEngine.kEngineStartChannelMediaRelay]=this.startChannelMediaRelay,e[a.ApiTypeEngine.kEngineUpdateChannelMediaRelay]=this.updateChannelMediaRelay,e[a.ApiTypeEngine.kEngineStopChannelMediaRelay]=this.stopChannelMediaRelay,e[a.ApiTypeEngine.kEngineRemoveInjectStreamUrl]=this.removeInjectStreamUrl,e[a.ApiTypeEngine.kEngineSendCustomReportMessage]=this.sendCustomReportMessage,e[a.ApiTypeEngine.kEngineGetConnectionState]=this.getConnectionState,e[a.ApiTypeEngine.kEngineSetParameters]=this.setParameters,e[a.ApiTypeEngine.kEngineSetAppType]=this.setAppType,e[a.ApiTypeEngine.kEngineSetCloudProxy]=this.setCloudProxy,e[a.ApiTypeEngine.kEngineCustomPublish]=this.customPublish,e[a.ApiTypeEngine.kEngineCustomUnPublish]=this.customUnPublish,e),this._reset()}return e.prototype._reset=function(){this._config={codec:"h264",mode:"rtc"},this._client=void 0,this._context=void 0,this._handler=void 0,this._enableAudio=!0,this._enableVideo=!1,this._enableLocalAudio=!0,this._enableLocalVideo=!0,this._muteLocalAudio=!1,this._muteLocalVideo=!1,this._defaultMuteAllRemoteAudioStreams=!1,this._defaultMuteAllRemoteVideoStreams=!1,this._encryptionMode=void 0,this._secret=void 0},e.prototype._addListener=function(){var e=this;if(void 0===this._client)throw"please create first";this._client.on("connection-state-change",(function(t,n,r){(0,c.printf)("connection-state-change",t,n,n),e._emitEvent("ConnectionStateChanged",{state:(0,c.ConnectionStateToNative)(t),reason:(0,c.ConnectionDisconnectedReasonToNative)(r)})})),this._client.on("user-joined",(function(t){(0,c.printf)("user-joined",t),e._emitEvent("UserJoined",{uid:t.uid,elapsed:0})})),this._client.on("user-left",(function(t,n){(0,c.printf)("user-left",t,n),e._emitEvent("UserOffline",{uid:t.uid,reason:(0,c.UserLeftReasonToNative)(n)})})),this._client.on("user-published",(function(t,n){return r(e,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:switch((0,c.printf)("user-published",t,n),n){case"audio":return[3,1];case"video":return[3,3]}return[3,5];case 1:return!this._enableAudio||this._defaultMuteAllRemoteAudioStreams?[2]:[4,this.muteRemoteAudioStream({userId:t,mute:!1})];case 2:return e.sent(),this._emitEvent("RemoteAudioStateChanged",{uid:t.uid,state:a.REMOTE_AUDIO_STATE.REMOTE_AUDIO_STATE_DECODING,reason:a.REMOTE_AUDIO_STATE_REASON.REMOTE_AUDIO_REASON_REMOTE_UNMUTED,elapsed:0}),[3,5];case 3:return!this._enableVideo||this._defaultMuteAllRemoteVideoStreams?[2]:[4,this.muteRemoteVideoStream({userId:t,mute:!1})];case 4:return e.sent(),this._emitEvent("RemoteVideoStateChanged",{uid:t.uid,state:a.REMOTE_VIDEO_STATE.REMOTE_VIDEO_STATE_DECODING,reason:a.REMOTE_VIDEO_STATE_REASON.REMOTE_VIDEO_STATE_REASON_REMOTE_UNMUTED,elapsed:0}),[3,5];case 5:return[2]}}))}))})),this._client.on("user-unpublished",(function(t,n){switch((0,c.printf)("user-unpublished",t,n),n){case"audio":e.deviceManager.removeRemoteAudioTrack(t.uid),e._emitEvent("RemoteAudioStateChanged",{uid:t.uid,state:a.REMOTE_AUDIO_STATE.REMOTE_AUDIO_STATE_STOPPED,reason:a.REMOTE_AUDIO_STATE_REASON.REMOTE_AUDIO_REASON_REMOTE_MUTED,elapsed:0});break;case"video":e.deviceManager.removeRemoteVideoTrack(t.uid),e._emitEvent("RemoteVideoStateChanged",{uid:t.uid,state:a.REMOTE_VIDEO_STATE.REMOTE_VIDEO_STATE_STOPPED,reason:a.REMOTE_VIDEO_STATE_REASON.REMOTE_VIDEO_STATE_REASON_REMOTE_MUTED,elapsed:0})}})),this._client.on("user-info-updated",(function(t,n){switch((0,c.printf)("user-info-updated",t,n),n){case"mute-audio":e._emitEvent("RemoteAudioStateChanged",{uid:t,state:a.REMOTE_AUDIO_STATE.REMOTE_AUDIO_STATE_STOPPED,reason:a.REMOTE_AUDIO_STATE_REASON.REMOTE_AUDIO_REASON_REMOTE_MUTED,elapsed:0});break;case"mute-video":case"disable-local-video":e._emitEvent("RemoteVideoStateChanged",{uid:t,state:a.REMOTE_VIDEO_STATE.REMOTE_VIDEO_STATE_STOPPED,reason:a.REMOTE_VIDEO_STATE_REASON.REMOTE_VIDEO_STATE_REASON_REMOTE_MUTED,elapsed:0});break;case"unmute-audio":e._emitEvent("RemoteAudioStateChanged",{uid:t,state:a.REMOTE_AUDIO_STATE.REMOTE_AUDIO_STATE_DECODING,reason:a.REMOTE_AUDIO_STATE_REASON.REMOTE_AUDIO_REASON_REMOTE_UNMUTED,elapsed:0});break;case"unmute-video":case"enable-local-video":e._emitEvent("RemoteVideoStateChanged",{uid:t,state:a.REMOTE_VIDEO_STATE.REMOTE_VIDEO_STATE_DECODING,reason:a.REMOTE_VIDEO_STATE_REASON.REMOTE_VIDEO_STATE_REASON_REMOTE_UNMUTED,elapsed:0})}})),this._client.on("media-reconnect-start",(function(e){(0,c.printf)("media-reconnect-start",e)})),this._client.on("media-reconnect-end",(function(e){(0,c.printf)("media-reconnect-end",e)})),this._client.on("stream-type-changed",(function(e,t){(0,c.printf)("stream-type-changed",e,t)})),this._client.on("stream-fallback",(function(t,n){(0,c.printf)("stream-fallback",t,n),e._emitEvent("RemoteSubscribeFallbackToAudioOnly",{uid:t,isFallbackOrRecover:"fallback"===n})})),this._client.on("channel-media-relay-state",(function(t,n){(0,c.printf)("channel-media-relay-state",t,n),e._emitEvent("ChannelMediaRelayStateChanged",{state:(0,c.ChannelMediaRelayStateToNative)(t),code:(0,c.ChannelMediaRelayErrorToNative)(n)})})),this._client.on("channel-media-relay-event",(function(t){(0,c.printf)("channel-media-relay-event",t),e._emitEvent("ChannelMediaRelayEvent",{code:(0,c.ChannelMediaRelayEventToNative)(t)})})),this._client.on("volume-indicator",(function(t){(0,c.printf)("volume-indicator",t);var n=0,r=t.map((function(t){var r,i,o=Math.floor(t.level/100*255);return n+=o,{uid:+t.uid,volume:o,vad:0,channelId:null!==(i=null===(r=e._client)||void 0===r?void 0:r.channelName)&&void 0!==i?i:""}}));e._emitEvent("AudioVolumeIndication",{speakers:r,speakerNumber:t.length,totalVolume:n})})),this._client.on("crypt-error",(function(){(0,c.printf)("crypt-error")})),this._client.on("token-privilege-will-expire",(function(){(0,c.printf)("token-privilege-will-expire"),e._emitEvent("TokenPrivilegeWillExpire")})),this._client.on("token-privilege-did-expire",(function(){(0,c.printf)("token-privilege-did-expire")})),this._client.on("network-quality",(function(t){var n;(0,c.printf)("network-quality",t),e._emitEvent("NetworkQuality",{uid:0,txQuality:(0,c.NetworkQualityToNative)(t.uplinkNetworkQuality),rxQuality:(0,c.NetworkQualityToNative)(t.downlinkNetworkQuality)});var r=null===(n=e._client)||void 0===n?void 0:n.getRemoteNetworkQuality();if(r)for(var i in r)e._emitEvent("NetworkQuality",{uid:+i,txQuality:(0,c.NetworkQualityToNative)(r[i].uplinkNetworkQuality),rxQuality:(0,c.NetworkQualityToNative)(r[i].downlinkNetworkQuality)})})),this._client.on("live-streaming-error",(function(t,n){(0,c.printf)("live-streaming-error",t,n),e._emitEvent("RtmpStreamingStateChanged",{url:t,state:a.RTMP_STREAM_PUBLISH_STATE.RTMP_STREAM_PUBLISH_STATE_IDLE,errCode:(0,c.RtmpStreamingErrorToNative)(n.code)})})),this._client.on("live-streaming-warning",(function(t,n){(0,c.printf)("live-streaming-warning",t,n),"LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE"===n.code?e._emitEvent("RtmpStreamingEvent",{url:t,eventCode:a.RTMP_STREAMING_EVENT.RTMP_STREAMING_EVENT_FAILED_LOAD_IMAGE}):e._emitEvent("RtmpStreamingStateChanged",{url:t,state:a.RTMP_STREAM_PUBLISH_STATE.RTMP_STREAM_PUBLISH_STATE_IDLE,errCode:(0,c.RtmpStreamingErrorToNative)(n.code)})})),this._client.on("stream-inject-status",(function(t,n,r){(0,c.printf)("stream-inject-status",t,n,r),e._emitEvent("StreamInjectedStatus",{url:r,uid:n,status:(0,c.InjectStreamEventStatusToNative)(t)})})),this._client.on("exception",(function(t){(0,c.printf)("exception",t),t.code in a.ERROR_CODE_TYPE&&e._emitEvent("Error",{err:t.code,msg:""}),"AUDIO_INPUT_LEVEL_TOO_LOW"!=t.msg&&"AUDIO_INPUT_LEVEL_TOO_LOW_RECOVER"!=t.msg||e.deviceManager.recoverAudioDevice()})),this._client.on("is-using-cloud-proxy",(function(e){(0,c.printf)("is-using-cloud-proxy",e)}))},e.prototype._emitEvent=function(e,t){var n;void 0===t&&(t={}),(0,c.printf)("_emitEvent",e,t,this._handler),null===(n=this._handler)||void 0===n||n.call(this,e,JSON.stringify(t))},e.prototype._createClient=function(){void 0===this._client&&(this._client=l.createClient(this._config),this._addListener())},e._setLogLevel=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){if(void 0!==e.level){switch(t=0,e.level){case a.LOG_LEVEL.LOG_LEVEL_NONE:t=4;break;case a.LOG_LEVEL.LOG_LEVEL_INFO:t=1;break;case a.LOG_LEVEL.LOG_LEVEL_WARN:t=2;break;case a.LOG_LEVEL.LOG_LEVEL_ERROR:case a.LOG_LEVEL.LOG_LEVEL_FATAL:t=3}return[2,l.setLogLevel(t)]}return[2]}))}))},e._setArea=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return void 0!==e?[2,l.setArea(e.map((function(e){switch(e){case a.AREA_CODE.AREA_CODE_CN:return o.AREAS.CHINA;case a.AREA_CODE.AREA_CODE_NA:return o.AREAS.NORTH_AMERICA;case a.AREA_CODE.AREA_CODE_EU:return o.AREAS.EUROPE;case a.AREA_CODE.AREA_CODE_AS:return o.AREAS.ASIA;case a.AREA_CODE.AREA_CODE_JP:return o.AREAS.JAPAN;case a.AREA_CODE.AREA_CODE_IN:return o.AREAS.INDIA;case a.AREA_CODE.AREA_CODE_GLOB:return o.AREAS.GLOBAL}})))]:[2]}))}))},e.prototype._publish=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:if(void 0===this._client)throw"please create first";return void 0===e?[2]:void 0===(null==e?void 0:e.setBeautyEffect)?[3,2]:[4,this.deviceManager.muteLocalVideo(this._muteLocalVideo)];case 1:return t.sent(),[3,4];case 2:return[4,this.deviceManager.muteLocalAudio(this._muteLocalAudio)];case 3:t.sent(),t.label=4;case 4:return[2,this._client.publish(e)]}}))}))},e.prototype.callApi=function(e,t,n){var o;return r(this,void 0,void 0,(function(){return i(this,(function(r){return(0,c.printf)("callApi",e,t,n,this),[2,null===(o=this._support_apis[e])||void 0===o?void 0:o.call(this,JSON.parse(t),n)]}))}))},e.prototype.setEventHandler=function(e){this._handler=e},e.prototype.createChannel=function(){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:if(void 0===this._context)throw"please create first";return(t=new e)._config.mode=this._config.mode,t._enableAudio=this._enableAudio,t._enableLocalAudio=this._enableLocalAudio,t._enableVideo=this._enableVideo,t._enableLocalVideo=this._enableLocalVideo,[4,t.initialize({context:this._context})];case 1:return n.sent(),[2,t]}}))}))},e.prototype.initialize=function(t,n){var o;return r(this,void 0,void 0,(function(){return i(this,(function(r){switch(r.label){case 0:return this._context=t.context,[4,e._setArea(t.context.areaCode)];case 1:return r.sent(),[4,e._setLogLevel({level:null===(o=t.context.logConfig)||void 0===o?void 0:o.level})];case 2:return r.sent(),void 0!==n&&(this._config=n),this._createClient(),[2]}}))}))},e.prototype.release=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return[4,this.leaveChannel()];case 1:return e.sent(),this.deviceManager.release(),this._reset(),[2]}}))}))},e.prototype.setChannelProfile=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:switch(e.profile){case a.CHANNEL_PROFILE_TYPE.CHANNEL_PROFILE_COMMUNICATION:t="rtc";break;case a.CHANNEL_PROFILE_TYPE.CHANNEL_PROFILE_LIVE_BROADCASTING:t="live";case a.CHANNEL_PROFILE_TYPE.CHANNEL_PROFILE_GAME:}return void 0===t||t===this._config.mode?[3,2]:[4,this.leaveChannel()];case 1:n.sent(),this.deviceManager.release(),this._config.mode=t,this._client=void 0,this._createClient(),n.label=2;case 2:return[2]}}))}))},e.prototype.setClientRole=function(e){var t;return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){if(void 0===this._client)throw"please create first";switch(e.role){case a.CLIENT_ROLE_TYPE.CLIENT_ROLE_BROADCASTER:n="host";break;case a.CLIENT_ROLE_TYPE.CLIENT_ROLE_AUDIENCE:n="audience"}switch(null===(t=e.options)||void 0===t?void 0:t.audienceLatencyLevel){case a.AUDIENCE_LATENCY_LEVEL_TYPE.AUDIENCE_LATENCY_LEVEL_LOW_LATENCY:r=o.AudienceLatencyLevelType.AUDIENCE_LEVEL_LOW_LATENCY;break;case a.AUDIENCE_LATENCY_LEVEL_TYPE.AUDIENCE_LATENCY_LEVEL_ULTRA_LOW_LATENCY:r=o.AudienceLatencyLevelType.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY}return[2,this._client.setClientRole(n,r?{level:r}:void 0)]}))}))},e.prototype.joinChannel=function(e){var t,n;return r(this,void 0,void 0,(function(){var o,s,a,c=this;return i(this,(function(u){if(void 0===this._context)throw"please create first";return o=e.channelId,s=e.token,a=e.uid,[2,null===(t=this._client)||void 0===t?void 0:t.join(null===(n=this._context)||void 0===n?void 0:n.appId,o,s,a).then((function(e){return r(c,void 0,void 0,(function(){var t=this;return i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,,3,4]),[4,this.deviceManager.createMicrophoneAudioTrack(this._enableAudio&&this._enableLocalAudio,this._emitEvent.bind(this)).then((function(e){t._iLocalAudioTrack=e}))];case 1:return n.sent(),[4,this.deviceManager.createCameraVideoTrack(this._enableVideo&&this._enableLocalVideo,this._emitEvent.bind(this)).then((function(e){t._iLocalVideoTrack=e}))];case 2:return n.sent(),[3,4];case 3:return this._emitEvent("JoinChannelSuccess",{channel:o,uid:e,elapsed:0}),[7];case 4:return[2]}}))}))}))]}))}))},e.prototype.leaveChannel=function(e){return r(this,void 0,void 0,(function(){var e=this;return i(this,(function(t){if(void 0===this._client)throw"please create first";return[2,this._client.leave().then((function(){var t;e.deviceManager.release();var n={cpuAppUsage:0,cpuTotalUsage:0,duration:0,gatewayRtt:0,lastmileDelay:0,memoryAppUsageInKbytes:0,memoryAppUsageRatio:0,memoryTotalUsageRatio:0,rxAudioBytes:0,rxAudioKBitRate:0,rxBytes:0,rxKBitRate:0,rxPacketLossRate:0,rxVideoBytes:0,rxVideoKBitRate:0,txAudioBytes:0,txAudioKBitRate:0,txBytes:0,txKBitRate:0,txPacketLossRate:0,txVideoBytes:0,txVideoKBitRate:0,userCount:0},r=null===(t=e._client)||void 0===t?void 0:t.getRTCStats();r&&(n.duration=r.Duration,n.rxKBitRate=r.RecvBitrate,n.rxBytes=r.RecvBytes,n.txKBitRate=r.SendBitrate,n.txBytes=r.SendBytes,n.userCount=r.UserCount,n.gatewayRtt=r.RTT),e._emitEvent("LeaveChannel",{stats:n})}))]}))}))},e.prototype.renewToken=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(void 0===this._client)throw"please create first";return[2,this._client.renewToken(e.token)]}))}))},e.prototype.joinChannelWithUserAccount=function(e){var t;return r(this,void 0,void 0,(function(){var n,o,s,a=this;return i(this,(function(c){if(void 0===this._context)throw"please create first";return n=e.channelId,o=e.token,s=e.userAccount,[2,null===(t=this._client)||void 0===t?void 0:t.join(this._context.appId,n,o,s).then((function(e){return r(a,void 0,void 0,(function(){var t,r;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,,5,6]),t=this._publish,[4,this.deviceManager.createMicrophoneAudioTrack(this._enableAudio&&this._enableLocalAudio,this._emitEvent.bind(this))];case 1:return[4,t.apply(this,[i.sent()])];case 2:return i.sent(),r=this._publish,[4,this.deviceManager.createCameraVideoTrack(this._enableVideo&&this._enableLocalVideo,this._emitEvent.bind(this))];case 3:return[4,r.apply(this,[i.sent()])];case 4:return i.sent(),[3,6];case 5:return this._emitEvent("JoinChannelSuccess",{channel:n,uid:e,elapsed:0}),[7];case 6:return[2]}}))}))}))]}))}))},e.prototype.enableVideo=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this._enableVideo=!0,[4,Promise.all([this.deviceManager.enableLocalVideo(this._enableVideo&&this._enableLocalAudio),this.deviceManager.enableRemoteVideo(this._enableVideo)])];case 1:return e.sent(),[2]}}))}))},e.prototype.disableVideo=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this._enableVideo=!1,[4,Promise.all([this.deviceManager.enableLocalVideo(this._enableVideo&&this._enableLocalAudio),this.deviceManager.enableRemoteVideo(this._enableVideo)])];case 1:return e.sent(),[2]}}))}))},e.prototype.setVideoEncoderConfiguration=function(e){var t,n;return r(this,void 0,void 0,(function(){return i(this,(function(r){return[2,this.deviceManager.setVideoEncoderConfiguration({width:null===(t=e.config.dimensions)||void 0===t?void 0:t.width,height:null===(n=e.config.dimensions)||void 0===n?void 0:n.height,frameRate:e.config.frameRate,bitrateMin:e.config.minBitrate,bitrateMax:e.config.bitrate})]}))}))},e.prototype.setupLocalVideo=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){return n=e.canvas,void 0!==t&&(n.view=t),void 0!==(r=this.channel.getChannel(n.channelId))?r.deviceManager.setupLocalVideo(n):this.deviceManager.setupLocalVideo(n),[2]}))}))},e.prototype.setupRemoteVideo=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return i(this,(function(i){return n=e.canvas,void 0!==t&&(n.view=t),void 0!==(r=this.channel.getChannel(n.channelId))?r.deviceManager.setupRemoteVideo(n.uid,n):this.deviceManager.setupRemoteVideo(n.uid,n),[2]}))}))},e.prototype.startPreview=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:if(void 0===this._client)throw"please create first";return void 0!==this._client.channelName?[2]:[4,this.deviceManager.createCameraVideoTrack(this._enableVideo&&this._enableLocalVideo,this._emitEvent.bind(this),!0)];case 1:return e.sent(),[2]}}))}))},e.prototype.stopPreview=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){if(void 0===this._client)throw"please create first";return void 0!==this._client.channelName?[2]:[2,this.deviceManager.stopCameraCapture()]}))}))},e.prototype.enableAudio=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this._enableAudio=!0,[4,Promise.all([this.deviceManager.enableLocalAudio(this._enableAudio&&this._enableLocalAudio),this.deviceManager.enableRemoteAudio(this._enableAudio)])];case 1:return e.sent(),[2]}}))}))},e.prototype.enableLocalAudio=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return this._enableLocalAudio=e.enabled,[2,this.deviceManager.enableLocalAudio(this._enableAudio&&this._enableLocalAudio)]}))}))},e.prototype.disableAudio=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){switch(e.label){case 0:return this._enableAudio=!1,[4,Promise.all([this.deviceManager.enableLocalAudio(this._enableAudio&&this._enableLocalAudio),this.deviceManager.enableRemoteAudio(this._enableAudio)])];case 1:return e.sent(),[2]}}))}))},e.prototype.setAudioProfile=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(t="music_standard",e.profile){case a.AUDIO_PROFILE_TYPE.AUDIO_PROFILE_DEFAULT:t="music_standard";break;case a.AUDIO_PROFILE_TYPE.AUDIO_PROFILE_SPEECH_STANDARD:t="speech_standard";break;case a.AUDIO_PROFILE_TYPE.AUDIO_PROFILE_MUSIC_STANDARD:t="music_standard";break;case a.AUDIO_PROFILE_TYPE.AUDIO_PROFILE_MUSIC_STANDARD_STEREO:t="standard_stereo";break;case a.AUDIO_PROFILE_TYPE.AUDIO_PROFILE_MUSIC_HIGH_QUALITY:t="high_quality";break;case a.AUDIO_PROFILE_TYPE.AUDIO_PROFILE_MUSIC_HIGH_QUALITY_STEREO:t="high_quality_stereo";break;case a.AUDIO_PROFILE_TYPE.AUDIO_PROFILE_IOT:t="speech_low_quality"}return this.deviceManager.setAudioEncoderConfiguration(t),[2]}))}))},e.prototype.muteLocalAudioStream=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(void 0===this._client)throw"please create first";return this._muteLocalAudio=e.mute,[2,this.deviceManager.muteLocalAudio(this._muteLocalAudio)]}))}))},e.prototype.muteAllRemoteAudioStreams=function(e){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){switch(n.label){case 0:if(void 0===this._client)throw"please create first";return[4,Promise.all(this._client.remoteUsers.map((function(n){return t.muteRemoteAudioStream({userId:n,mute:e.mute})})))];case 1:return n.sent(),[2]}}))}))},e.prototype.setDefaultMuteAllRemoteAudioStreams=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return this._defaultMuteAllRemoteAudioStreams=e.mute,[2]}))}))},e.prototype.adjustUserPlaybackSignalVolume=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.deviceManager.adjustUserPlaybackSignalVolume(e.uid,e.volume)];case 1:return t.sent(),[2]}}))}))},e.prototype.muteRemoteAudioStream=function(e){return r(this,void 0,void 0,(function(){var t,n=this;return i(this,(function(o){switch(o.label){case 0:if(void 0===this._client)throw"please create first";return t=function(t){return r(n,void 0,void 0,(function(){var n=this;return i(this,(function(r){if(void 0===this._client)throw"please create first";return e.mute?[2,this._client.unsubscribe(t,"audio").then((function(){n.deviceManager.removeRemoteAudioTrack(t.uid)}))]:[2,this._client.subscribe(t,"audio").then((function(e){e.on("first-frame-decoded",(function(){(0,c.printf)("first-frame-decoded","audio",e),n._emitEvent("RemoteAudioStateChanged",{uid:t.uid,state:a.REMOTE_AUDIO_STATE.REMOTE_AUDIO_STATE_STARTING,reason:a.REMOTE_AUDIO_STATE_REASON.REMOTE_AUDIO_REASON_REMOTE_UNMUTED,elapsed:0})})),n.deviceManager.addRemoteAudioTrack(e),e.play()}))]}))}))},"number"!=typeof e.userId?[3,2]:[4,Promise.all(this._client.remoteUsers.map((function(n){if(n.uid===e.userId)return t(n)})))];case 1:return o.sent(),[3,3];case 2:return[2,t(e.userId)];case 3:return[2]}}))}))},e.prototype.muteLocalVideoStream=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(void 0===this._client)throw"please create first";return this._muteLocalVideo=e.mute,[2,this.deviceManager.muteLocalVideo(this._muteLocalVideo)]}))}))},e.prototype.enableLocalVideo=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return this._enableLocalVideo=e.enabled,[2,this.deviceManager.enableLocalVideo(this._enableVideo&&this._enableLocalVideo)]}))}))},e.prototype.muteAllRemoteVideoStreams=function(e){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){switch(n.label){case 0:if(void 0===this._client)throw"please create first";return[4,Promise.all(this._client.remoteUsers.map((function(n){return t.muteRemoteVideoStream({userId:n,mute:e.mute})})))];case 1:return n.sent(),[2]}}))}))},e.prototype.setDefaultMuteAllRemoteVideoStreams=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return this._defaultMuteAllRemoteVideoStreams=e.mute,[2]}))}))},e.prototype.muteRemoteVideoStream=function(e){return r(this,void 0,void 0,(function(){var t,n=this;return i(this,(function(o){switch(o.label){case 0:if(void 0===this._client)throw"please create first";return t=function(t){return r(n,void 0,void 0,(function(){var n=this;return i(this,(function(r){if(void 0===this._client)throw"please create first";return e.mute?[2,this._client.unsubscribe(t,"video").then((function(){n.deviceManager.removeRemoteAudioTrack(t.uid)}))]:[2,this._client.subscribe(t,"video").then((function(e){e.on("first-frame-decoded",(function(){(0,c.printf)("first-frame-decoded","video",e),n._emitEvent("RemoteVideoStateChanged",{uid:t.uid,state:a.REMOTE_VIDEO_STATE.REMOTE_VIDEO_STATE_STARTING,reason:a.REMOTE_VIDEO_STATE_REASON.REMOTE_VIDEO_STATE_REASON_REMOTE_UNMUTED,elapsed:0})})),n.deviceManager.addRemoteVideoTrack(e),n.deviceManager.playRemoteVideo(t.uid)}))]}))}))},"number"!=typeof e.userId?[3,2]:[4,Promise.all(this._client.remoteUsers.map((function(n){if(n.uid===e.userId)return t(n)})))];case 1:return o.sent(),[3,3];case 2:return[2,t(e.userId)];case 3:return[2]}}))}))},e.prototype.setRemoteVideoStreamType=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(n.label){case 0:if(void 0===this._client)throw"please create first";switch(e.streamType){case a.REMOTE_VIDEO_STREAM_TYPE.REMOTE_VIDEO_STREAM_HIGH:t=o.RemoteStreamType.HIGH_STREAM;break;case a.REMOTE_VIDEO_STREAM_TYPE.REMOTE_VIDEO_STREAM_LOW:t=o.RemoteStreamType.LOW_STREAM}return[4,this._client.setRemoteVideoStreamType(e.userId,t)];case 1:return n.sent(),[2]}}))}))},e.prototype.setRemoteDefaultVideoStreamType=function(e){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){switch(n.label){case 0:if(void 0===this._client)throw"please create first";return[4,Promise.all(this._client.remoteUsers.map((function(n){return t.setRemoteVideoStreamType({userId:n.uid,streamType:e.streamType})})))];case 1:return n.sent(),[2]}}))}))},e.prototype.enableAudioVolumeIndication=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){if(void 0===this._client)throw"please create first";return[2,this._client.enableAudioVolumeIndicator()]}))}))},e.prototype.setLogFilter=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){switch(t=a.LOG_LEVEL.LOG_LEVEL_INFO,e.filter){case a.LOG_FILTER_TYPE.LOG_FILTER_OFF:t=a.LOG_LEVEL.LOG_LEVEL_NONE;break;case a.LOG_FILTER_TYPE.LOG_FILTER_DEBUG:case a.LOG_FILTER_TYPE.LOG_FILTER_INFO:case a.LOG_FILTER_TYPE.LOG_FILTER_MASK:t=a.LOG_LEVEL.LOG_LEVEL_INFO;break;case a.LOG_FILTER_TYPE.LOG_FILTER_WARN:t=a.LOG_LEVEL.LOG_LEVEL_WARN;break;case a.LOG_FILTER_TYPE.LOG_FILTER_ERROR:t=a.LOG_LEVEL.LOG_LEVEL_ERROR;break;case a.LOG_FILTER_TYPE.LOG_FILTER_CRITICAL:t=a.LOG_LEVEL.LOG_LEVEL_FATAL}return[2,l.setLogLevel(t)]}))}))},e.prototype.uploadLogFile=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){return l.enableLogUpload(),[2,""]}))}))},e.prototype.enableDualStreamMode=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(void 0===this._client)throw"please create first";return e.enabled?[2,this._client.enableDualStream()]:[2,this._client.disableDualStream()]}))}))},e.prototype.adjustRecordingSignalVolume=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,this.deviceManager.adjustRecordingSignalVolume(e.volume)]}))}))},e.prototype.adjustPlaybackSignalVolume=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,this.deviceManager.adjustPlaybackSignalVolume(e.volume)];case 1:return t.sent(),[2]}}))}))},e.prototype.startScreenCaptureByDisplayId=function(e){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){return[2,this.deviceManager.createScreenVideoTrack(this._enableVideo&&this._enableLocalVideo,this._emitEvent.bind(this),e.captureParams,!0).then((function(e){t._muteLocalVideo||t._publish(e)}))]}))}))},e.prototype.startScreenCaptureByScreenRect=function(e){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){return[2,this.deviceManager.createScreenVideoTrack(this._enableVideo&&this._enableLocalVideo,this._emitEvent.bind(this),e.captureParams,!0).then((function(e){t._muteLocalVideo||t._publish(e)}))]}))}))},e.prototype.startScreenCaptureByWindowId=function(e){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){return[2,this.deviceManager.createScreenVideoTrack(this._enableVideo&&this._enableLocalVideo,this._emitEvent.bind(this),e.captureParams,!0).then((function(e){t._muteLocalVideo||t._publish(e)}))]}))}))},e.prototype.stopScreenCapture=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){return[2,this.deviceManager.stopScreenCapture()]}))}))},e.prototype.startScreenCapture=function(e){return r(this,void 0,void 0,(function(){var t,n=this;return i(this,(function(r){return t=e.rect,[2,this.deviceManager.createScreenVideoTrack(this._enableVideo&&this._enableLocalVideo,this._emitEvent.bind(this),{dimensions:{width:t&&void 0!==t.right&&void 0!==t.left?t.right-t.left:void 0,height:t&&void 0!==t.bottom&&void 0!==t.top?t.bottom-t.top:void 0},frameRate:e.captureFreq,bitrate:e.bitrate},!0).then((function(e){n._muteLocalVideo||n._publish(e)}))]}))}))},e.prototype.setRemoteSubscribeFallbackOption=function(e){return r(this,void 0,void 0,(function(){var t=this;return i(this,(function(n){switch(n.label){case 0:if(void 0===this._client)throw"please create first";return[4,Promise.all(this._client.remoteUsers.map((function(n){var r,i;switch(e.option){case a.STREAM_FALLBACK_OPTIONS.STREAM_FALLBACK_OPTION_DISABLED:i=o.RemoteStreamFallbackType.DISABLE;break;case a.STREAM_FALLBACK_OPTIONS.STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW:i=o.RemoteStreamFallbackType.LOW_STREAM;break;case a.STREAM_FALLBACK_OPTIONS.STREAM_FALLBACK_OPTION_AUDIO_ONLY:i=o.RemoteStreamFallbackType.AUDIO_ONLY}return null===(r=t._client)||void 0===r?void 0:r.setStreamFallbackOption(n.uid,i)})))];case 1:return n.sent(),[2]}}))}))},e.prototype.getVersion=function(){return r(this,void 0,void 0,(function(){return i(this,(function(e){return[2,l.VERSION]}))}))},e.prototype.setEncryptionSecret=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(this._secret=e.secret,void 0===this._client)throw"please create first";return this._encryptionMode&&this._secret?[2,this._client.setEncryptionConfig(this._encryptionMode,this._secret)]:[2,this._client.setEncryptionConfig("none","")]}))}))},e.prototype.setEncryptionMode=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(this._encryptionMode=e.encryptionMode,void 0===this._client)throw"please create first";return this._encryptionMode&&this._secret?[2,this._client.setEncryptionConfig(this._encryptionMode,this._secret)]:[2,this._client.setEncryptionConfig("none","")]}))}))},e.prototype.enableEncryption=function(e){var t;return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){if(void 0===this._client)throw"please create first";if(n="aes-128-xts",e.enabled)switch(e.config.encryptionMode){case a.ENCRYPTION_MODE.AES_128_XTS:n="aes-128-xts";break;case a.ENCRYPTION_MODE.AES_128_ECB:n="aes-128-ecb";break;case a.ENCRYPTION_MODE.AES_256_XTS:n="aes-256-xts";break;case a.ENCRYPTION_MODE.SM4_128_ECB:n="sm4-128-ecb";break;case a.ENCRYPTION_MODE.AES_128_GCM:n="aes-128-gcm";break;case a.ENCRYPTION_MODE.AES_256_GCM:n="aes-256-gcm";break;case a.ENCRYPTION_MODE.MODE_END:n="none"}else n="none";return[2,this._client.setEncryptionConfig(n,null!==(t=e.config.encryptionKey)&&void 0!==t?t:"")]}))}))},e.prototype.addPublishStreamUrl=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(void 0===this._client)throw"please create first";return[2,this._client.startLiveStreaming(e.url,e.transcodingEnabled)]}))}))},e.prototype.removePublishStreamUrl=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(void 0===this._client)throw"please create first";return[2,this._client.stopLiveStreaming(e.url)]}))}))},e.prototype.setLiveTranscoding=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(void 0===this._client)throw"please create first";return[2,this._client.setLiveTranscoding({audioBitrate:e.transcoding.audioBitrate,audioChannels:e.transcoding.audioChannels,audioSampleRate:e.transcoding.audioSampleRate,backgroundColor:e.transcoding.backgroundColor,height:e.transcoding.height,width:e.transcoding.width,lowLatency:e.transcoding.lowLatency,videoBitrate:e.transcoding.videoBitrate,videoCodecProfile:e.transcoding.videoCodecProfile,videoFrameRate:e.transcoding.videoFramerate,videoGop:e.transcoding.videoGop,watermark:e.transcoding.watermark,backgroundImage:e.transcoding.backgroundImage,transcodingUsers:e.transcoding.transcodingUsers,userConfigExtraInfo:e.transcoding.transcodingExtraInfo})]}))}))},e.prototype.setBeautyEffectOptions=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,this.deviceManager.setBeautyEffect(e.enabled,{smoothnessLevel:e.options.smoothnessLevel,lighteningLevel:e.options.lighteningLevel,rednessLevel:e.options.rednessLevel,lighteningContrastLevel:e.options.lighteningContrastLevel})]}))}))},e.prototype.addInjectStreamUrl=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){if(void 0===this._client)throw"please create first";return[2,this._client.addInjectStreamUrl(e.url,{audioBitrate:e.config.audioBitrate,audioChannels:e.config.audioChannels,audioSampleRate:e.config.audioSampleRate,height:e.config.height,width:e.config.width,videoBitrate:e.config.videoBitrate,videoFramerate:e.config.videoFramerate,videoGop:e.config.videoGop})]}))}))},e.prototype.startChannelMediaRelay=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){if(void 0===this._client)throw"please create first";return null==(t=l.createChannelMediaRelayConfiguration())||t.setSrcChannelInfo(e.configuration.srcInfo),e.configuration.destInfos.map((function(e){null==t||t.addDestChannelInfo(e)})),[2,this._client.startChannelMediaRelay(t)]}))}))},e.prototype.updateChannelMediaRelay=function(e){return r(this,void 0,void 0,(function(){var t;return i(this,(function(n){if(void 0===this._client)throw"please create first";return null==(t=l.createChannelMediaRelayConfiguration())||t.setSrcChannelInfo(e.configuration.srcInfo),e.configuration.destInfos.map((function(e){null==t||t.addDestChannelInfo(e)})),[2,this._client.updateChannelMediaRelay(t)]}))}))},e.prototype.stopChannelMediaRelay=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){if(void 0===this._client)throw"please create first";return[2,this._client.stopChannelMediaRelay()]}))}))},e.prototype.removeInjectStreamUrl=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){if(void 0===this._client)throw"please create first";return[2,this._client.removeInjectStreamUrl()]}))}))},e.prototype.sendCustomReportMessage=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:if(void 0===this._client)throw"please create first";return[4,this._client.sendCustomReportMessage({category:e.id,event:e.category,label:e.event,reportId:e.label,value:e.value})];case 1:return t.sent(),[2]}}))}))},e.prototype.getConnectionState=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(e){if(void 0===this._client)throw"please create first";return[2,(0,c.ConnectionStateToNative)(this._client.connectionState)]}))}))},e.prototype.setParameters=function(e){return r(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){return t=JSON.parse(e.parameters),n=Object.keys(t)[0],[2,l.setParameter(n,t[n])]}))}))},e.prototype.setAppType=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,this.setParameters({parameters:'{"REPORT_APP_SCENARIO":'.concat(e.appType.toString(),"}")})]}))}))},e.prototype.setCloudProxy=function(e){var t;return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(n=0,e.proxyType){case a.CLOUD_PROXY_TYPE.NONE_PROXY:n=0;break;case a.CLOUD_PROXY_TYPE.UDP_PROXY:n=3;break;case a.CLOUD_PROXY_TYPE.TCP_PROXY:n=5}return[2,null===(t=this._client)||void 0===t?void 0:t.startProxyServer(n)]}))}))},e.prototype.customPublish=function(e){var t;return r(this,void 0,void 0,(function(){return i(this,(function(e){return this._iLocalAudioTrack&&this._iLocalVideoTrack?[2,null===(t=this._client)||void 0===t?void 0:t.publish([this._iLocalAudioTrack,this._iLocalVideoTrack])]:[2]}))}))},e.prototype.customUnPublish=function(e){var t;return r(this,void 0,void 0,(function(){return i(this,(function(e){return this._iLocalAudioTrack&&this._iLocalVideoTrack?[2,null===(t=this._client)||void 0===t?void 0:t.unpublish([this._iLocalAudioTrack,this._iLocalVideoTrack])]:[2]}))}))},e}();t.default=d},910:(e,t)=>{"use strict";var n,r,i,o,s,a,c,u,l,d,h,p,f,A,E,g,_,m,I,T,R,v,y,S,C,O,b,w,N,D,L,P,k,x,M,U,B,F,V,G,Q,j,H,W,Y,K,$,z,q,J,X,Z,ee,te,ne,re,ie,oe,se,ae,ce,ue,le,de,he,pe,fe,Ae,Ee,ge,_e,me,Ie,Te,Re,ve,ye,Se,Ce,Oe,be,we,Ne,De,Le,Pe,ke,xe,Me,Ue,Be;Object.defineProperty(t,"__esModule",{value:!0}),t.AUDIO_REVERB_PRESET=t.VOICE_CHANGER_PRESET=t.AUDIO_REVERB_TYPE=t.AUDIO_EQUALIZATION_BAND_FREQUENCY=t.VIDEO_CODEC_TYPE_FOR_STREAM=t.VIDEO_CODEC_TYPE=t.VIDEO_CODEC_PROFILE_TYPE=t.AUDIO_SAMPLE_RATE_TYPE=t.RAW_AUDIO_FRAME_OP_MODE_TYPE=t.CAPTURE_BRIGHTNESS_LEVEL_TYPE=t.REMOTE_VIDEO_STREAM_TYPE=t.INJECT_STREAM_STATUS=t.RTMP_STREAMING_EVENT=t.RTMP_STREAM_PUBLISH_ERROR=t.RTMP_STREAM_PUBLISH_STATE=t.USER_OFFLINE_REASON_TYPE=t.SUPER_RESOLUTION_STATE_REASON=t.AUDIENCE_LATENCY_LEVEL_TYPE=t.CLIENT_ROLE_TYPE=t.CHANNEL_PROFILE_TYPE=t.AUDIO_SCENARIO_TYPE=t.AUDIO_PROFILE_TYPE=t.VIDEO_PROFILE_TYPE=t.VIDEO_MIRROR_MODE_TYPE=t.RENDER_MODE_TYPE=t.QUALITY_TYPE=t.AUDIO_RECORDING_QUALITY_TYPE=t.LOCAL_AUDIO_STREAM_ERROR=t.LOCAL_AUDIO_STREAM_STATE=t.LOCAL_VIDEO_STREAM_ERROR=t.LOCAL_VIDEO_STREAM_STATE=t.MEDIA_DEVICE_TYPE=t.MEDIA_DEVICE_STATE_TYPE=t.AUDIO_MIXING_ERROR_TYPE=t.AUDIO_MIXING_STATE_TYPE=t.MEDIA_ENGINE_EVENT_CODE_TYPE=t.QUALITY_REPORT_FORMAT_TYPE=t.MAX_CHANNEL_ID_LENGTH_TYPE=t.MAX_USER_ACCOUNT_LENGTH_TYPE=t.MAX_DEVICE_ID_LENGTH_TYPE=t.LOG_LEVEL=t.LOG_FILTER_TYPE=t.ERROR_CODE_TYPE=t.WARN_CODE_TYPE=t.INTERFACE_ID_TYPE=t.ApiTypeRawDataPluginManager=t.ApiTypeVideoDeviceManager=t.ApiTypeAudioDeviceManager=t.ApiTypeChannel=t.ApiTypeEngine=void 0,t.ENCRYPTION_MODE=t.METADATA_TYPE=t.VIDEO_CAPTURE_TYPE=t.ENCRYPTION_CONFIG=t.AREA_CODE=t.LIGHTENING_CONTRAST_LEVEL=t.VideoContentHint=t.RTMP_STREAM_LIFE_CYCLE_TYPE=t.VEO=t.LBHQ=t.DEFAULT_MIN_BITRATE=t.COMPATIBLE_BITRATE=t.STANDARD_BITRATE=t.CHANNEL_MEDIA_RELAY_STATE=t.CHANNEL_MEDIA_RELAY_EVENT=t.CHANNEL_MEDIA_RELAY_ERROR=t.EXPERIENCE_POOR_REASON=t.EXPERIENCE_QUALITY_TYPE=t.QUALITY_ADAPT_INDICATION=t.CAMERA_DIRECTION=t.AUDIO_SESSION_OPERATION_RESTRICTION=t.CLOUD_PROXY_TYPE=t.AUDIO_ROUTE_TYPE=t.LASTMILE_PROBE_RESULT_STATE=t.UPLOAD_ERROR_REASON=t.NETWORK_TYPE=t.CONNECTION_CHANGED_REASON_TYPE=t.CONNECTION_STATE_TYPE=t.PRIORITY_TYPE=t.CAPTURER_OUTPUT_PREFERENCE=t.STREAM_FALLBACK_OPTIONS=t.DEGRADATION_PREFERENCE=t.ORIENTATION_MODE=t.FRAME_RATE=t.REMOTE_VIDEO_STATE_REASON=t.XLA_REMOTE_AUDIO_FROZEN_TYPE=t.XLA_REMOTE_VIDEO_FROZEN_TYPE=t.STREAM_SUBSCRIBE_STATE=t.STREAM_PUBLISH_STATE=t.REMOTE_VIDEO_STATE=t.REMOTE_AUDIO_STATE_REASON=t.REMOTE_AUDIO_STATE=t.AUDIO_CODEC_PROFILE_TYPE=t.VOICE_CONVERSION_PRESET=t.AUDIO_EFFECT_PRESET=t.VOICE_BEAUTIFIER_PRESET=void 0,(Be=t.ApiTypeEngine||(t.ApiTypeEngine={}))[Be.kEngineInitialize=0]="kEngineInitialize",Be[Be.kEngineRelease=1]="kEngineRelease",Be[Be.kEngineSetChannelProfile=2]="kEngineSetChannelProfile",Be[Be.kEngineSetClientRole=3]="kEngineSetClientRole",Be[Be.kEngineJoinChannel=4]="kEngineJoinChannel",Be[Be.kEngineSwitchChannel=5]="kEngineSwitchChannel",Be[Be.kEngineLeaveChannel=6]="kEngineLeaveChannel",Be[Be.kEngineRenewToken=7]="kEngineRenewToken",Be[Be.kEngineRegisterLocalUserAccount=8]="kEngineRegisterLocalUserAccount",Be[Be.kEngineJoinChannelWithUserAccount=9]="kEngineJoinChannelWithUserAccount",Be[Be.kEngineGetUserInfoByUserAccount=10]="kEngineGetUserInfoByUserAccount",Be[Be.kEngineGetUserInfoByUid=11]="kEngineGetUserInfoByUid",Be[Be.kEngineStartEchoTest=12]="kEngineStartEchoTest",Be[Be.kEngineStopEchoTest=13]="kEngineStopEchoTest",Be[Be.kEngineSetCloudProxy=14]="kEngineSetCloudProxy",Be[Be.kEngineEnableVideo=15]="kEngineEnableVideo",Be[Be.kEngineDisableVideo=16]="kEngineDisableVideo",Be[Be.kEngineSetVideoProfile=17]="kEngineSetVideoProfile",Be[Be.kEngineSetVideoEncoderConfiguration=18]="kEngineSetVideoEncoderConfiguration",Be[Be.kEngineSetCameraCapturerConfiguration=19]="kEngineSetCameraCapturerConfiguration",Be[Be.kEngineSetupLocalVideo=20]="kEngineSetupLocalVideo",Be[Be.kEngineSetupRemoteVideo=21]="kEngineSetupRemoteVideo",Be[Be.kEngineStartPreview=22]="kEngineStartPreview",Be[Be.kEngineSetRemoteUserPriority=23]="kEngineSetRemoteUserPriority",Be[Be.kEngineStopPreview=24]="kEngineStopPreview",Be[Be.kEngineEnableAudio=25]="kEngineEnableAudio",Be[Be.kEngineEnableLocalAudio=26]="kEngineEnableLocalAudio",Be[Be.kEngineDisableAudio=27]="kEngineDisableAudio",Be[Be.kEngineSetAudioProfile=28]="kEngineSetAudioProfile",Be[Be.kEngineMuteLocalAudioStream=29]="kEngineMuteLocalAudioStream",Be[Be.kEngineMuteAllRemoteAudioStreams=30]="kEngineMuteAllRemoteAudioStreams",Be[Be.kEngineSetDefaultMuteAllRemoteAudioStreams=31]="kEngineSetDefaultMuteAllRemoteAudioStreams",Be[Be.kEngineAdjustUserPlaybackSignalVolume=32]="kEngineAdjustUserPlaybackSignalVolume",Be[Be.kEngineMuteRemoteAudioStream=33]="kEngineMuteRemoteAudioStream",Be[Be.kEngineMuteLocalVideoStream=34]="kEngineMuteLocalVideoStream",Be[Be.kEngineEnableLocalVideo=35]="kEngineEnableLocalVideo",Be[Be.kEngineMuteAllRemoteVideoStreams=36]="kEngineMuteAllRemoteVideoStreams",Be[Be.kEngineSetDefaultMuteAllRemoteVideoStreams=37]="kEngineSetDefaultMuteAllRemoteVideoStreams",Be[Be.kEngineMuteRemoteVideoStream=38]="kEngineMuteRemoteVideoStream",Be[Be.kEngineSetRemoteVideoStreamType=39]="kEngineSetRemoteVideoStreamType",Be[Be.kEngineSetRemoteDefaultVideoStreamType=40]="kEngineSetRemoteDefaultVideoStreamType",Be[Be.kEngineEnableAudioVolumeIndication=41]="kEngineEnableAudioVolumeIndication",Be[Be.kEngineStartAudioRecording=42]="kEngineStartAudioRecording",Be[Be.kEngineStopAudioRecording=43]="kEngineStopAudioRecording",Be[Be.kEngineStartAudioMixing=44]="kEngineStartAudioMixing",Be[Be.kEngineStopAudioMixing=45]="kEngineStopAudioMixing",Be[Be.kEnginePauseAudioMixing=46]="kEnginePauseAudioMixing",Be[Be.kEngineResumeAudioMixing=47]="kEngineResumeAudioMixing",Be[Be.kEngineSetHighQualityAudioParameters=48]="kEngineSetHighQualityAudioParameters",Be[Be.kEngineAdjustAudioMixingVolume=49]="kEngineAdjustAudioMixingVolume",Be[Be.kEngineAdjustAudioMixingPlayoutVolume=50]="kEngineAdjustAudioMixingPlayoutVolume",Be[Be.kEngineGetAudioMixingPlayoutVolume=51]="kEngineGetAudioMixingPlayoutVolume",Be[Be.kEngineAdjustAudioMixingPublishVolume=52]="kEngineAdjustAudioMixingPublishVolume",Be[Be.kEngineGetAudioMixingPublishVolume=53]="kEngineGetAudioMixingPublishVolume",Be[Be.kEngineGetAudioMixingDuration=54]="kEngineGetAudioMixingDuration",Be[Be.kEngineGetAudioMixingCurrentPosition=55]="kEngineGetAudioMixingCurrentPosition",Be[Be.kEngineSetAudioMixingPosition=56]="kEngineSetAudioMixingPosition",Be[Be.kEngineSetAudioMixingPitch=57]="kEngineSetAudioMixingPitch",Be[Be.kEngineGetEffectsVolume=58]="kEngineGetEffectsVolume",Be[Be.kEngineSetEffectsVolume=59]="kEngineSetEffectsVolume",Be[Be.kEngineSetVolumeOfEffect=60]="kEngineSetVolumeOfEffect",Be[Be.kEngineEnableFaceDetection=61]="kEngineEnableFaceDetection",Be[Be.kEnginePlayEffect=62]="kEnginePlayEffect",Be[Be.kEngineStopEffect=63]="kEngineStopEffect",Be[Be.kEngineStopAllEffects=64]="kEngineStopAllEffects",Be[Be.kEnginePreloadEffect=65]="kEnginePreloadEffect",Be[Be.kEngineUnloadEffect=66]="kEngineUnloadEffect",Be[Be.kEnginePauseEffect=67]="kEnginePauseEffect",Be[Be.kEnginePauseAllEffects=68]="kEnginePauseAllEffects",Be[Be.kEngineResumeEffect=69]="kEngineResumeEffect",Be[Be.kEngineResumeAllEffects=70]="kEngineResumeAllEffects",Be[Be.kEngineGetEffectDuration=71]="kEngineGetEffectDuration",Be[Be.kEngineSetEffectPosition=72]="kEngineSetEffectPosition",Be[Be.kEngineGetEffectCurrentPosition=73]="kEngineGetEffectCurrentPosition",Be[Be.kEngineEnableDeepLearningDenoise=74]="kEngineEnableDeepLearningDenoise",Be[Be.kEngineEnableSoundPositionIndication=75]="kEngineEnableSoundPositionIndication",Be[Be.kEngineSetRemoteVoicePosition=76]="kEngineSetRemoteVoicePosition",Be[Be.kEngineSetLocalVoicePitch=77]="kEngineSetLocalVoicePitch",Be[Be.kEngineSetLocalVoiceEqualization=78]="kEngineSetLocalVoiceEqualization",Be[Be.kEngineSetLocalVoiceReverb=79]="kEngineSetLocalVoiceReverb",Be[Be.kEngineSetLocalVoiceChanger=80]="kEngineSetLocalVoiceChanger",Be[Be.kEngineSetLocalVoiceReverbPreset=81]="kEngineSetLocalVoiceReverbPreset",Be[Be.kEngineSetVoiceBeautifierPreset=82]="kEngineSetVoiceBeautifierPreset",Be[Be.kEngineSetAudioEffectPreset=83]="kEngineSetAudioEffectPreset",Be[Be.kEngineSetVoiceConversionPreset=84]="kEngineSetVoiceConversionPreset",Be[Be.kEngineSetAudioEffectParameters=85]="kEngineSetAudioEffectParameters",Be[Be.kEngineSetVoiceBeautifierParameters=86]="kEngineSetVoiceBeautifierParameters",Be[Be.kEngineSetLogFile=87]="kEngineSetLogFile",Be[Be.kEngineSetLogFilter=88]="kEngineSetLogFilter",Be[Be.kEngineSetLogFileSize=89]="kEngineSetLogFileSize",Be[Be.kEngineUploadLogFile=90]="kEngineUploadLogFile",Be[Be.kEngineSetLocalRenderMode=91]="kEngineSetLocalRenderMode",Be[Be.kEngineSetRemoteRenderMode=92]="kEngineSetRemoteRenderMode",Be[Be.kEngineSetLocalVideoMirrorMode=93]="kEngineSetLocalVideoMirrorMode",Be[Be.kEngineEnableDualStreamMode=94]="kEngineEnableDualStreamMode",Be[Be.kEngineSetExternalAudioSource=95]="kEngineSetExternalAudioSource",Be[Be.kEngineSetExternalAudioSink=96]="kEngineSetExternalAudioSink",Be[Be.kEngineSetRecordingAudioFrameParameters=97]="kEngineSetRecordingAudioFrameParameters",Be[Be.kEngineSetPlaybackAudioFrameParameters=98]="kEngineSetPlaybackAudioFrameParameters",Be[Be.kEngineSetMixedAudioFrameParameters=99]="kEngineSetMixedAudioFrameParameters",Be[Be.kEngineAdjustRecordingSignalVolume=100]="kEngineAdjustRecordingSignalVolume",Be[Be.kEngineAdjustPlaybackSignalVolume=101]="kEngineAdjustPlaybackSignalVolume",Be[Be.kEngineAdjustLoopBackRecordingSignalVolume=102]="kEngineAdjustLoopBackRecordingSignalVolume",Be[Be.kEngineEnableWebSdkInteroperability=103]="kEngineEnableWebSdkInteroperability",Be[Be.kEngineSetVideoQualityParameters=104]="kEngineSetVideoQualityParameters",Be[Be.kEngineSetLocalPublishFallbackOption=105]="kEngineSetLocalPublishFallbackOption",Be[Be.kEngineSetRemoteSubscribeFallbackOption=106]="kEngineSetRemoteSubscribeFallbackOption",Be[Be.kEngineSwitchCamera=107]="kEngineSwitchCamera",Be[Be.kEngineSetDefaultAudioRouteToSpeakerPhone=108]="kEngineSetDefaultAudioRouteToSpeakerPhone",Be[Be.kEngineSetEnableSpeakerPhone=109]="kEngineSetEnableSpeakerPhone",Be[Be.kEngineEnableInEarMonitoring=110]="kEngineEnableInEarMonitoring",Be[Be.kEngineSetInEarMonitoringVolume=111]="kEngineSetInEarMonitoringVolume",Be[Be.kEngineIsSpeakerPhoneEnabled=112]="kEngineIsSpeakerPhoneEnabled",Be[Be.kEngineSetAudioSessionOperationRestriction=113]="kEngineSetAudioSessionOperationRestriction",Be[Be.kEngineEnableLoopBackRecording=114]="kEngineEnableLoopBackRecording",Be[Be.kEngineStartScreenCaptureByDisplayId=115]="kEngineStartScreenCaptureByDisplayId",Be[Be.kEngineStartScreenCaptureByScreenRect=116]="kEngineStartScreenCaptureByScreenRect",Be[Be.kEngineStartScreenCaptureByWindowId=117]="kEngineStartScreenCaptureByWindowId",Be[Be.kEngineSetScreenCaptureContentHint=118]="kEngineSetScreenCaptureContentHint",Be[Be.kEngineUpdateScreenCaptureParameters=119]="kEngineUpdateScreenCaptureParameters",Be[Be.kEngineUpdateScreenCaptureRegion=120]="kEngineUpdateScreenCaptureRegion",Be[Be.kEngineStopScreenCapture=121]="kEngineStopScreenCapture",Be[Be.kEngineStartScreenCapture=122]="kEngineStartScreenCapture",Be[Be.kEngineSetVideoSource=123]="kEngineSetVideoSource",Be[Be.kEngineGetCallId=124]="kEngineGetCallId",Be[Be.kEngineRate=125]="kEngineRate",Be[Be.kEngineComplain=126]="kEngineComplain",Be[Be.kEngineGetVersion=127]="kEngineGetVersion",Be[Be.kEngineEnableLastMileTest=128]="kEngineEnableLastMileTest",Be[Be.kEngineDisableLastMileTest=129]="kEngineDisableLastMileTest",Be[Be.kEngineStartLastMileProbeTest=130]="kEngineStartLastMileProbeTest",Be[Be.kEngineStopLastMileProbeTest=131]="kEngineStopLastMileProbeTest",Be[Be.kEngineGetErrorDescription=132]="kEngineGetErrorDescription",Be[Be.kEngineSetEncryptionSecret=133]="kEngineSetEncryptionSecret",Be[Be.kEngineSetEncryptionMode=134]="kEngineSetEncryptionMode",Be[Be.kEngineEnableEncryption=135]="kEngineEnableEncryption",Be[Be.kEngineRegisterPacketObserver=136]="kEngineRegisterPacketObserver",Be[Be.kEngineCreateDataStream=137]="kEngineCreateDataStream",Be[Be.kEngineSendStreamMessage=138]="kEngineSendStreamMessage",Be[Be.kEngineAddPublishStreamUrl=139]="kEngineAddPublishStreamUrl",Be[Be.kEngineRemovePublishStreamUrl=140]="kEngineRemovePublishStreamUrl",Be[Be.kEngineSetLiveTranscoding=141]="kEngineSetLiveTranscoding",Be[Be.kEngineAddVideoWaterMark=142]="kEngineAddVideoWaterMark",Be[Be.kEngineClearVideoWaterMarks=143]="kEngineClearVideoWaterMarks",Be[Be.kEngineSetBeautyEffectOptions=144]="kEngineSetBeautyEffectOptions",Be[Be.kEngineEnableVirtualBackground=145]="kEngineEnableVirtualBackground",Be[Be.kEngineAddInjectStreamUrl=146]="kEngineAddInjectStreamUrl",Be[Be.kEngineStartChannelMediaRelay=147]="kEngineStartChannelMediaRelay",Be[Be.kEngineUpdateChannelMediaRelay=148]="kEngineUpdateChannelMediaRelay",Be[Be.kEnginePauseAllChannelMediaRelay=149]="kEnginePauseAllChannelMediaRelay",Be[Be.kEngineResumeAllChannelMediaRelay=150]="kEngineResumeAllChannelMediaRelay",Be[Be.kEngineStopChannelMediaRelay=151]="kEngineStopChannelMediaRelay",Be[Be.kEngineRemoveInjectStreamUrl=152]="kEngineRemoveInjectStreamUrl",Be[Be.kEngineSendCustomReportMessage=153]="kEngineSendCustomReportMessage",Be[Be.kEngineGetConnectionState=154]="kEngineGetConnectionState",Be[Be.kEngineEnableRemoteSuperResolution=155]="kEngineEnableRemoteSuperResolution",Be[Be.kEngineRegisterMediaMetadataObserver=156]="kEngineRegisterMediaMetadataObserver",Be[Be.kEngineSetParameters=157]="kEngineSetParameters",Be[Be.kEngineSetLocalAccessPoint=158]="kEngineSetLocalAccessPoint",Be[Be.kEngineUnRegisterMediaMetadataObserver=159]="kEngineUnRegisterMediaMetadataObserver",Be[Be.kEngineSetMaxMetadataSize=160]="kEngineSetMaxMetadataSize",Be[Be.kEngineSendMetadata=161]="kEngineSendMetadata",Be[Be.kEngineSetAppType=162]="kEngineSetAppType",Be[Be.kMediaPushAudioFrame=163]="kMediaPushAudioFrame",Be[Be.kMediaPullAudioFrame=164]="kMediaPullAudioFrame",Be[Be.kMediaSetExternalVideoSource=165]="kMediaSetExternalVideoSource",Be[Be.kMediaPushVideoFrame=166]="kMediaPushVideoFrame",Be[Be.kEngineCustomPublish=167]="kEngineCustomPublish",Be[Be.kEngineCustomUnPublish=168]="kEngineCustomUnPublish",(Ue=t.ApiTypeChannel||(t.ApiTypeChannel={}))[Ue.kChannelCreateChannel=0]="kChannelCreateChannel",Ue[Ue.kChannelRelease=1]="kChannelRelease",Ue[Ue.kChannelJoinChannel=2]="kChannelJoinChannel",Ue[Ue.kChannelJoinChannelWithUserAccount=3]="kChannelJoinChannelWithUserAccount",Ue[Ue.kChannelLeaveChannel=4]="kChannelLeaveChannel",Ue[Ue.kChannelPublish=5]="kChannelPublish",Ue[Ue.kChannelUnPublish=6]="kChannelUnPublish",Ue[Ue.kChannelChannelId=7]="kChannelChannelId",Ue[Ue.kChannelGetCallId=8]="kChannelGetCallId",Ue[Ue.kChannelRenewToken=9]="kChannelRenewToken",Ue[Ue.kChannelSetEncryptionSecret=10]="kChannelSetEncryptionSecret",Ue[Ue.kChannelSetEncryptionMode=11]="kChannelSetEncryptionMode",Ue[Ue.kChannelEnableEncryption=12]="kChannelEnableEncryption",Ue[Ue.kChannelRegisterPacketObserver=13]="kChannelRegisterPacketObserver",Ue[Ue.kChannelRegisterMediaMetadataObserver=14]="kChannelRegisterMediaMetadataObserver",Ue[Ue.kChannelUnRegisterMediaMetadataObserver=15]="kChannelUnRegisterMediaMetadataObserver",Ue[Ue.kChannelSetMaxMetadataSize=16]="kChannelSetMaxMetadataSize",Ue[Ue.kChannelSendMetadata=17]="kChannelSendMetadata",Ue[Ue.kChannelSetClientRole=18]="kChannelSetClientRole",Ue[Ue.kChannelSetRemoteUserPriority=19]="kChannelSetRemoteUserPriority",Ue[Ue.kChannelSetRemoteVoicePosition=20]="kChannelSetRemoteVoicePosition",Ue[Ue.kChannelSetRemoteRenderMode=21]="kChannelSetRemoteRenderMode",Ue[Ue.kChannelSetDefaultMuteAllRemoteAudioStreams=22]="kChannelSetDefaultMuteAllRemoteAudioStreams",Ue[Ue.kChannelSetDefaultMuteAllRemoteVideoStreams=23]="kChannelSetDefaultMuteAllRemoteVideoStreams",Ue[Ue.kChannelMuteLocalAudioStream=24]="kChannelMuteLocalAudioStream",Ue[Ue.kChannelMuteLocalVideoStream=25]="kChannelMuteLocalVideoStream",Ue[Ue.kChannelMuteAllRemoteAudioStreams=26]="kChannelMuteAllRemoteAudioStreams",Ue[Ue.kChannelAdjustUserPlaybackSignalVolume=27]="kChannelAdjustUserPlaybackSignalVolume",Ue[Ue.kChannelMuteRemoteAudioStream=28]="kChannelMuteRemoteAudioStream",Ue[Ue.kChannelMuteAllRemoteVideoStreams=29]="kChannelMuteAllRemoteVideoStreams",Ue[Ue.kChannelMuteRemoteVideoStream=30]="kChannelMuteRemoteVideoStream",Ue[Ue.kChannelSetRemoteVideoStreamType=31]="kChannelSetRemoteVideoStreamType",Ue[Ue.kChannelSetRemoteDefaultVideoStreamType=32]="kChannelSetRemoteDefaultVideoStreamType",Ue[Ue.kChannelCreateDataStream=33]="kChannelCreateDataStream",Ue[Ue.kChannelSendStreamMessage=34]="kChannelSendStreamMessage",Ue[Ue.kChannelAddPublishStreamUrl=35]="kChannelAddPublishStreamUrl",Ue[Ue.kChannelRemovePublishStreamUrl=36]="kChannelRemovePublishStreamUrl",Ue[Ue.kChannelSetLiveTranscoding=37]="kChannelSetLiveTranscoding",Ue[Ue.kChannelAddInjectStreamUrl=38]="kChannelAddInjectStreamUrl",Ue[Ue.kChannelRemoveInjectStreamUrl=39]="kChannelRemoveInjectStreamUrl",Ue[Ue.kChannelStartChannelMediaRelay=40]="kChannelStartChannelMediaRelay",Ue[Ue.kChannelUpdateChannelMediaRelay=41]="kChannelUpdateChannelMediaRelay",Ue[Ue.kChannelPauseAllChannelMediaRelay=42]="kChannelPauseAllChannelMediaRelay",Ue[Ue.kChannelResumeAllChannelMediaRelay=43]="kChannelResumeAllChannelMediaRelay",Ue[Ue.kChannelStopChannelMediaRelay=44]="kChannelStopChannelMediaRelay",Ue[Ue.kChannelGetConnectionState=45]="kChannelGetConnectionState",Ue[Ue.kChannelEnableRemoteSuperResolution=46]="kChannelEnableRemoteSuperResolution",(Me=t.ApiTypeAudioDeviceManager||(t.ApiTypeAudioDeviceManager={}))[Me.kADMEnumeratePlaybackDevices=0]="kADMEnumeratePlaybackDevices",Me[Me.kADMSetPlaybackDevice=1]="kADMSetPlaybackDevice",Me[Me.kADMGetPlaybackDevice=2]="kADMGetPlaybackDevice",Me[Me.kADMGetPlaybackDeviceInfo=3]="kADMGetPlaybackDeviceInfo",Me[Me.kADMSetPlaybackDeviceVolume=4]="kADMSetPlaybackDeviceVolume",Me[Me.kADMGetPlaybackDeviceVolume=5]="kADMGetPlaybackDeviceVolume",Me[Me.kADMSetPlaybackDeviceMute=6]="kADMSetPlaybackDeviceMute",Me[Me.kADMGetPlaybackDeviceMute=7]="kADMGetPlaybackDeviceMute",Me[Me.kADMStartPlaybackDeviceTest=8]="kADMStartPlaybackDeviceTest",Me[Me.kADMStopPlaybackDeviceTest=9]="kADMStopPlaybackDeviceTest",Me[Me.kADMEnumerateRecordingDevices=10]="kADMEnumerateRecordingDevices",Me[Me.kADMSetRecordingDevice=11]="kADMSetRecordingDevice",Me[Me.kADMGetRecordingDevice=12]="kADMGetRecordingDevice",Me[Me.kADMGetRecordingDeviceInfo=13]="kADMGetRecordingDeviceInfo",Me[Me.kADMSetRecordingDeviceVolume=14]="kADMSetRecordingDeviceVolume",Me[Me.kADMGetRecordingDeviceVolume=15]="kADMGetRecordingDeviceVolume",Me[Me.kADMSetRecordingDeviceMute=16]="kADMSetRecordingDeviceMute",Me[Me.kADMGetRecordingDeviceMute=17]="kADMGetRecordingDeviceMute",Me[Me.kADMStartRecordingDeviceTest=18]="kADMStartRecordingDeviceTest",Me[Me.kADMStopRecordingDeviceTest=19]="kADMStopRecordingDeviceTest",Me[Me.kADMStartAudioDeviceLoopbackTest=20]="kADMStartAudioDeviceLoopbackTest",Me[Me.kADMStopAudioDeviceLoopbackTest=21]="kADMStopAudioDeviceLoopbackTest",(xe=t.ApiTypeVideoDeviceManager||(t.ApiTypeVideoDeviceManager={}))[xe.kVDMEnumerateVideoDevices=0]="kVDMEnumerateVideoDevices",xe[xe.kVDMSetDevice=1]="kVDMSetDevice",xe[xe.kVDMGetDevice=2]="kVDMGetDevice",xe[xe.kVDMStartDeviceTest=3]="kVDMStartDeviceTest",xe[xe.kVDMStopDeviceTest=4]="kVDMStopDeviceTest",(ke=t.ApiTypeRawDataPluginManager||(t.ApiTypeRawDataPluginManager={}))[ke.kRDPMRegisterPlugin=0]="kRDPMRegisterPlugin",ke[ke.kRDPMUnregisterPlugin=1]="kRDPMUnregisterPlugin",ke[ke.kRDPMHasPlugin=2]="kRDPMHasPlugin",ke[ke.kRDPMEnablePlugin=3]="kRDPMEnablePlugin",ke[ke.kRDPMGetPlugins=4]="kRDPMGetPlugins",ke[ke.kRDPMSetPluginParameter=5]="kRDPMSetPluginParameter",ke[ke.kRDPMGetPluginParameter=6]="kRDPMGetPluginParameter",ke[ke.kRDPMRelease=7]="kRDPMRelease",(Pe=t.INTERFACE_ID_TYPE||(t.INTERFACE_ID_TYPE={}))[Pe.AGORA_IID_AUDIO_DEVICE_MANAGER=1]="AGORA_IID_AUDIO_DEVICE_MANAGER",Pe[Pe.AGORA_IID_VIDEO_DEVICE_MANAGER=2]="AGORA_IID_VIDEO_DEVICE_MANAGER",Pe[Pe.AGORA_IID_RTC_ENGINE_PARAMETER=3]="AGORA_IID_RTC_ENGINE_PARAMETER",Pe[Pe.AGORA_IID_MEDIA_ENGINE=4]="AGORA_IID_MEDIA_ENGINE",Pe[Pe.AGORA_IID_SIGNALING_ENGINE=8]="AGORA_IID_SIGNALING_ENGINE",(Le=t.WARN_CODE_TYPE||(t.WARN_CODE_TYPE={}))[Le.WARN_INVALID_VIEW=8]="WARN_INVALID_VIEW",Le[Le.WARN_INIT_VIDEO=16]="WARN_INIT_VIDEO",Le[Le.WARN_PENDING=20]="WARN_PENDING",Le[Le.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",Le[Le.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",Le[Le.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",Le[Le.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",Le[Le.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",Le[Le.WARN_SWITCH_LIVE_VIDEO_TIMEOUT=111]="WARN_SWITCH_LIVE_VIDEO_TIMEOUT",Le[Le.WARN_SET_CLIENT_ROLE_TIMEOUT=118]="WARN_SET_CLIENT_ROLE_TIMEOUT",Le[Le.WARN_OPEN_CHANNEL_INVALID_TICKET=121]="WARN_OPEN_CHANNEL_INVALID_TICKET",Le[Le.WARN_OPEN_CHANNEL_TRY_NEXT_VOS=122]="WARN_OPEN_CHANNEL_TRY_NEXT_VOS",Le[Le.WARN_CHANNEL_CONNECTION_UNRECOVERABLE=131]="WARN_CHANNEL_CONNECTION_UNRECOVERABLE",Le[Le.WARN_CHANNEL_CONNECTION_IP_CHANGED=132]="WARN_CHANNEL_CONNECTION_IP_CHANGED",Le[Le.WARN_CHANNEL_CONNECTION_PORT_CHANGED=133]="WARN_CHANNEL_CONNECTION_PORT_CHANGED",Le[Le.WARN_CHANNEL_SOCKET_ERROR=134]="WARN_CHANNEL_SOCKET_ERROR",Le[Le.WARN_AUDIO_MIXING_OPEN_ERROR=701]="WARN_AUDIO_MIXING_OPEN_ERROR",Le[Le.WARN_ADM_RUNTIME_PLAYOUT_WARNING=1014]="WARN_ADM_RUNTIME_PLAYOUT_WARNING",Le[Le.WARN_ADM_RUNTIME_RECORDING_WARNING=1016]="WARN_ADM_RUNTIME_RECORDING_WARNING",Le[Le.WARN_ADM_RECORD_AUDIO_SILENCE=1019]="WARN_ADM_RECORD_AUDIO_SILENCE",Le[Le.WARN_ADM_PLAYOUT_MALFUNCTION=1020]="WARN_ADM_PLAYOUT_MALFUNCTION",Le[Le.WARN_ADM_RECORD_MALFUNCTION=1021]="WARN_ADM_RECORD_MALFUNCTION",Le[Le.WARN_ADM_CALL_INTERRUPTION=1025]="WARN_ADM_CALL_INTERRUPTION",Le[Le.WARN_ADM_IOS_CATEGORY_NOT_PLAYANDRECORD=1029]="WARN_ADM_IOS_CATEGORY_NOT_PLAYANDRECORD",Le[Le.WARN_ADM_RECORD_AUDIO_LOWLEVEL=1031]="WARN_ADM_RECORD_AUDIO_LOWLEVEL",Le[Le.WARN_ADM_PLAYOUT_AUDIO_LOWLEVEL=1032]="WARN_ADM_PLAYOUT_AUDIO_LOWLEVEL",Le[Le.WARN_ADM_RECORD_AUDIO_IS_ACTIVE=1033]="WARN_ADM_RECORD_AUDIO_IS_ACTIVE",Le[Le.WARN_ADM_WINDOWS_NO_DATA_READY_EVENT=1040]="WARN_ADM_WINDOWS_NO_DATA_READY_EVENT",Le[Le.WARN_ADM_INCONSISTENT_AUDIO_DEVICE=1042]="WARN_ADM_INCONSISTENT_AUDIO_DEVICE",Le[Le.WARN_APM_HOWLING=1051]="WARN_APM_HOWLING",Le[Le.WARN_ADM_GLITCH_STATE=1052]="WARN_ADM_GLITCH_STATE",Le[Le.WARN_APM_RESIDUAL_ECHO=1053]="WARN_APM_RESIDUAL_ECHO",Le[Le.WARN_ADM_WIN_CORE_NO_RECORDING_DEVICE=1322]="WARN_ADM_WIN_CORE_NO_RECORDING_DEVICE",Le[Le.WARN_ADM_WIN_CORE_NO_PLAYOUT_DEVICE=1323]="WARN_ADM_WIN_CORE_NO_PLAYOUT_DEVICE",Le[Le.WARN_ADM_WIN_CORE_IMPROPER_CAPTURE_RELEASE=1324]="WARN_ADM_WIN_CORE_IMPROPER_CAPTURE_RELEASE",Le[Le.WARN_SUPER_RESOLUTION_STREAM_OVER_LIMITATION=1610]="WARN_SUPER_RESOLUTION_STREAM_OVER_LIMITATION",Le[Le.WARN_SUPER_RESOLUTION_USER_COUNT_OVER_LIMITATION=1611]="WARN_SUPER_RESOLUTION_USER_COUNT_OVER_LIMITATION",Le[Le.WARN_SUPER_RESOLUTION_DEVICE_NOT_SUPPORTED=1612]="WARN_SUPER_RESOLUTION_DEVICE_NOT_SUPPORTED",Le[Le.WARN_RTM_LOGIN_TIMEOUT=2005]="WARN_RTM_LOGIN_TIMEOUT",Le[Le.WARN_RTM_KEEP_ALIVE_TIMEOUT=2009]="WARN_RTM_KEEP_ALIVE_TIMEOUT",(De=t.ERROR_CODE_TYPE||(t.ERROR_CODE_TYPE={}))[De.ERR_OK=0]="ERR_OK",De[De.ERR_FAILED=1]="ERR_FAILED",De[De.ERR_INVALID_ARGUMENT=2]="ERR_INVALID_ARGUMENT",De[De.ERR_NOT_READY=3]="ERR_NOT_READY",De[De.ERR_NOT_SUPPORTED=4]="ERR_NOT_SUPPORTED",De[De.ERR_REFUSED=5]="ERR_REFUSED",De[De.ERR_BUFFER_TOO_SMALL=6]="ERR_BUFFER_TOO_SMALL",De[De.ERR_NOT_INITIALIZED=7]="ERR_NOT_INITIALIZED",De[De.ERR_NO_PERMISSION=9]="ERR_NO_PERMISSION",De[De.ERR_TIMEDOUT=10]="ERR_TIMEDOUT",De[De.ERR_CANCELED=11]="ERR_CANCELED",De[De.ERR_TOO_OFTEN=12]="ERR_TOO_OFTEN",De[De.ERR_BIND_SOCKET=13]="ERR_BIND_SOCKET",De[De.ERR_NET_DOWN=14]="ERR_NET_DOWN",De[De.ERR_NET_NOBUFS=15]="ERR_NET_NOBUFS",De[De.ERR_JOIN_CHANNEL_REJECTED=17]="ERR_JOIN_CHANNEL_REJECTED",De[De.ERR_LEAVE_CHANNEL_REJECTED=18]="ERR_LEAVE_CHANNEL_REJECTED",De[De.ERR_ALREADY_IN_USE=19]="ERR_ALREADY_IN_USE",De[De.ERR_ABORTED=20]="ERR_ABORTED",De[De.ERR_INIT_NET_ENGINE=21]="ERR_INIT_NET_ENGINE",De[De.ERR_RESOURCE_LIMITED=22]="ERR_RESOURCE_LIMITED",De[De.ERR_INVALID_APP_ID=101]="ERR_INVALID_APP_ID",De[De.ERR_INVALID_CHANNEL_NAME=102]="ERR_INVALID_CHANNEL_NAME",De[De.ERR_NO_SERVER_RESOURCES=103]="ERR_NO_SERVER_RESOURCES",De[De.ERR_TOKEN_EXPIRED=109]="ERR_TOKEN_EXPIRED",De[De.ERR_INVALID_TOKEN=110]="ERR_INVALID_TOKEN",De[De.ERR_CONNECTION_INTERRUPTED=111]="ERR_CONNECTION_INTERRUPTED",De[De.ERR_CONNECTION_LOST=112]="ERR_CONNECTION_LOST",De[De.ERR_NOT_IN_CHANNEL=113]="ERR_NOT_IN_CHANNEL",De[De.ERR_SIZE_TOO_LARGE=114]="ERR_SIZE_TOO_LARGE",De[De.ERR_BITRATE_LIMIT=115]="ERR_BITRATE_LIMIT",De[De.ERR_TOO_MANY_DATA_STREAMS=116]="ERR_TOO_MANY_DATA_STREAMS",De[De.ERR_STREAM_MESSAGE_TIMEOUT=117]="ERR_STREAM_MESSAGE_TIMEOUT",De[De.ERR_SET_CLIENT_ROLE_NOT_AUTHORIZED=119]="ERR_SET_CLIENT_ROLE_NOT_AUTHORIZED",De[De.ERR_DECRYPTION_FAILED=120]="ERR_DECRYPTION_FAILED",De[De.ERR_CLIENT_IS_BANNED_BY_SERVER=123]="ERR_CLIENT_IS_BANNED_BY_SERVER",De[De.ERR_WATERMARK_PARAM=124]="ERR_WATERMARK_PARAM",De[De.ERR_WATERMARK_PATH=125]="ERR_WATERMARK_PATH",De[De.ERR_WATERMARK_PNG=126]="ERR_WATERMARK_PNG",De[De.ERR_WATERMARKR_INFO=127]="ERR_WATERMARKR_INFO",De[De.ERR_WATERMARK_ARGB=128]="ERR_WATERMARK_ARGB",De[De.ERR_WATERMARK_READ=129]="ERR_WATERMARK_READ",De[De.ERR_ENCRYPTED_STREAM_NOT_ALLOWED_PUBLISH=130]="ERR_ENCRYPTED_STREAM_NOT_ALLOWED_PUBLISH",De[De.ERR_INVALID_USER_ACCOUNT=134]="ERR_INVALID_USER_ACCOUNT",De[De.ERR_PUBLISH_STREAM_CDN_ERROR=151]="ERR_PUBLISH_STREAM_CDN_ERROR",De[De.ERR_PUBLISH_STREAM_NUM_REACH_LIMIT=152]="ERR_PUBLISH_STREAM_NUM_REACH_LIMIT",De[De.ERR_PUBLISH_STREAM_NOT_AUTHORIZED=153]="ERR_PUBLISH_STREAM_NOT_AUTHORIZED",De[De.ERR_PUBLISH_STREAM_INTERNAL_SERVER_ERROR=154]="ERR_PUBLISH_STREAM_INTERNAL_SERVER_ERROR",De[De.ERR_PUBLISH_STREAM_NOT_FOUND=155]="ERR_PUBLISH_STREAM_NOT_FOUND",De[De.ERR_PUBLISH_STREAM_FORMAT_NOT_SUPPORTED=156]="ERR_PUBLISH_STREAM_FORMAT_NOT_SUPPORTED",De[De.ERR_MODULE_NOT_FOUND=157]="ERR_MODULE_NOT_FOUND",De[De.ERR_MODULE_SUPER_RESOLUTION_NOT_FOUND=158]="ERR_MODULE_SUPER_RESOLUTION_NOT_FOUND",De[De.ERR_LOGOUT_OTHER=400]="ERR_LOGOUT_OTHER",De[De.ERR_LOGOUT_USER=401]="ERR_LOGOUT_USER",De[De.ERR_LOGOUT_NET=402]="ERR_LOGOUT_NET",De[De.ERR_LOGOUT_KICKED=403]="ERR_LOGOUT_KICKED",De[De.ERR_LOGOUT_PACKET=404]="ERR_LOGOUT_PACKET",De[De.ERR_LOGOUT_TOKEN_EXPIRED=405]="ERR_LOGOUT_TOKEN_EXPIRED",De[De.ERR_LOGOUT_OLDVERSION=406]="ERR_LOGOUT_OLDVERSION",De[De.ERR_LOGOUT_TOKEN_WRONG=407]="ERR_LOGOUT_TOKEN_WRONG",De[De.ERR_LOGOUT_ALREADY_LOGOUT=408]="ERR_LOGOUT_ALREADY_LOGOUT",De[De.ERR_LOGIN_OTHER=420]="ERR_LOGIN_OTHER",De[De.ERR_LOGIN_NET=421]="ERR_LOGIN_NET",De[De.ERR_LOGIN_FAILED=422]="ERR_LOGIN_FAILED",De[De.ERR_LOGIN_CANCELED=423]="ERR_LOGIN_CANCELED",De[De.ERR_LOGIN_TOKEN_EXPIRED=424]="ERR_LOGIN_TOKEN_EXPIRED",De[De.ERR_LOGIN_OLD_VERSION=425]="ERR_LOGIN_OLD_VERSION",De[De.ERR_LOGIN_TOKEN_WRONG=426]="ERR_LOGIN_TOKEN_WRONG",De[De.ERR_LOGIN_TOKEN_KICKED=427]="ERR_LOGIN_TOKEN_KICKED",De[De.ERR_LOGIN_ALREADY_LOGIN=428]="ERR_LOGIN_ALREADY_LOGIN",De[De.ERR_JOIN_CHANNEL_OTHER=440]="ERR_JOIN_CHANNEL_OTHER",De[De.ERR_SEND_MESSAGE_OTHER=440]="ERR_SEND_MESSAGE_OTHER",De[De.ERR_SEND_MESSAGE_TIMEOUT=441]="ERR_SEND_MESSAGE_TIMEOUT",De[De.ERR_QUERY_USERNUM_OTHER=450]="ERR_QUERY_USERNUM_OTHER",De[De.ERR_QUERY_USERNUM_TIMEOUT=451]="ERR_QUERY_USERNUM_TIMEOUT",De[De.ERR_QUERY_USERNUM_BYUSER=452]="ERR_QUERY_USERNUM_BYUSER",De[De.ERR_LEAVE_CHANNEL_OTHER=460]="ERR_LEAVE_CHANNEL_OTHER",De[De.ERR_LEAVE_CHANNEL_KICKED=461]="ERR_LEAVE_CHANNEL_KICKED",De[De.ERR_LEAVE_CHANNEL_BYUSER=462]="ERR_LEAVE_CHANNEL_BYUSER",De[De.ERR_LEAVE_CHANNEL_LOGOUT=463]="ERR_LEAVE_CHANNEL_LOGOUT",De[De.ERR_LEAVE_CHANNEL_DISCONNECTED=464]="ERR_LEAVE_CHANNEL_DISCONNECTED",De[De.ERR_INVITE_OTHER=470]="ERR_INVITE_OTHER",De[De.ERR_INVITE_REINVITE=471]="ERR_INVITE_REINVITE",De[De.ERR_INVITE_NET=472]="ERR_INVITE_NET",De[De.ERR_INVITE_PEER_OFFLINE=473]="ERR_INVITE_PEER_OFFLINE",De[De.ERR_INVITE_TIMEOUT=474]="ERR_INVITE_TIMEOUT",De[De.ERR_INVITE_CANT_RECV=475]="ERR_INVITE_CANT_RECV",De[De.ERR_LOAD_MEDIA_ENGINE=1001]="ERR_LOAD_MEDIA_ENGINE",De[De.ERR_START_CALL=1002]="ERR_START_CALL",De[De.ERR_START_CAMERA=1003]="ERR_START_CAMERA",De[De.ERR_START_VIDEO_RENDER=1004]="ERR_START_VIDEO_RENDER",De[De.ERR_ADM_GENERAL_ERROR=1005]="ERR_ADM_GENERAL_ERROR",De[De.ERR_ADM_JAVA_RESOURCE=1006]="ERR_ADM_JAVA_RESOURCE",De[De.ERR_ADM_SAMPLE_RATE=1007]="ERR_ADM_SAMPLE_RATE",De[De.ERR_ADM_INIT_PLAYOUT=1008]="ERR_ADM_INIT_PLAYOUT",De[De.ERR_ADM_START_PLAYOUT=1009]="ERR_ADM_START_PLAYOUT",De[De.ERR_ADM_STOP_PLAYOUT=1010]="ERR_ADM_STOP_PLAYOUT",De[De.ERR_ADM_INIT_RECORDING=1011]="ERR_ADM_INIT_RECORDING",De[De.ERR_ADM_START_RECORDING=1012]="ERR_ADM_START_RECORDING",De[De.ERR_ADM_STOP_RECORDING=1013]="ERR_ADM_STOP_RECORDING",De[De.ERR_ADM_RUNTIME_PLAYOUT_ERROR=1015]="ERR_ADM_RUNTIME_PLAYOUT_ERROR",De[De.ERR_ADM_RUNTIME_RECORDING_ERROR=1017]="ERR_ADM_RUNTIME_RECORDING_ERROR",De[De.ERR_ADM_RECORD_AUDIO_FAILED=1018]="ERR_ADM_RECORD_AUDIO_FAILED",De[De.ERR_ADM_INIT_LOOPBACK=1022]="ERR_ADM_INIT_LOOPBACK",De[De.ERR_ADM_START_LOOPBACK=1023]="ERR_ADM_START_LOOPBACK",De[De.ERR_ADM_NO_PERMISSION=1027]="ERR_ADM_NO_PERMISSION",De[De.ERR_ADM_RECORD_AUDIO_IS_ACTIVE=1033]="ERR_ADM_RECORD_AUDIO_IS_ACTIVE",De[De.ERR_ADM_ANDROID_JNI_JAVA_RESOURCE=1101]="ERR_ADM_ANDROID_JNI_JAVA_RESOURCE",De[De.ERR_ADM_ANDROID_JNI_NO_RECORD_FREQUENCY=1108]="ERR_ADM_ANDROID_JNI_NO_RECORD_FREQUENCY",De[De.ERR_ADM_ANDROID_JNI_NO_PLAYBACK_FREQUENCY=1109]="ERR_ADM_ANDROID_JNI_NO_PLAYBACK_FREQUENCY",De[De.ERR_ADM_ANDROID_JNI_JAVA_START_RECORD=1111]="ERR_ADM_ANDROID_JNI_JAVA_START_RECORD",De[De.ERR_ADM_ANDROID_JNI_JAVA_START_PLAYBACK=1112]="ERR_ADM_ANDROID_JNI_JAVA_START_PLAYBACK",De[De.ERR_ADM_ANDROID_JNI_JAVA_RECORD_ERROR=1115]="ERR_ADM_ANDROID_JNI_JAVA_RECORD_ERROR",De[De.ERR_ADM_ANDROID_OPENSL_CREATE_ENGINE=1151]="ERR_ADM_ANDROID_OPENSL_CREATE_ENGINE",De[De.ERR_ADM_ANDROID_OPENSL_CREATE_AUDIO_RECORDER=1153]="ERR_ADM_ANDROID_OPENSL_CREATE_AUDIO_RECORDER",De[De.ERR_ADM_ANDROID_OPENSL_START_RECORDER_THREAD=1156]="ERR_ADM_ANDROID_OPENSL_START_RECORDER_THREAD",De[De.ERR_ADM_ANDROID_OPENSL_CREATE_AUDIO_PLAYER=1157]="ERR_ADM_ANDROID_OPENSL_CREATE_AUDIO_PLAYER",De[De.ERR_ADM_ANDROID_OPENSL_START_PLAYER_THREAD=1160]="ERR_ADM_ANDROID_OPENSL_START_PLAYER_THREAD",De[De.ERR_ADM_IOS_INPUT_NOT_AVAILABLE=1201]="ERR_ADM_IOS_INPUT_NOT_AVAILABLE",De[De.ERR_ADM_IOS_ACTIVATE_SESSION_FAIL=1206]="ERR_ADM_IOS_ACTIVATE_SESSION_FAIL",De[De.ERR_ADM_IOS_VPIO_INIT_FAIL=1210]="ERR_ADM_IOS_VPIO_INIT_FAIL",De[De.ERR_ADM_IOS_VPIO_REINIT_FAIL=1213]="ERR_ADM_IOS_VPIO_REINIT_FAIL",De[De.ERR_ADM_IOS_VPIO_RESTART_FAIL=1214]="ERR_ADM_IOS_VPIO_RESTART_FAIL",De[De.ERR_ADM_IOS_SET_RENDER_CALLBACK_FAIL=1219]="ERR_ADM_IOS_SET_RENDER_CALLBACK_FAIL",De[De.ERR_ADM_IOS_SESSION_SAMPLERATR_ZERO=1221]="ERR_ADM_IOS_SESSION_SAMPLERATR_ZERO",De[De.ERR_ADM_WIN_CORE_INIT=1301]="ERR_ADM_WIN_CORE_INIT",De[De.ERR_ADM_WIN_CORE_INIT_RECORDING=1303]="ERR_ADM_WIN_CORE_INIT_RECORDING",De[De.ERR_ADM_WIN_CORE_INIT_PLAYOUT=1306]="ERR_ADM_WIN_CORE_INIT_PLAYOUT",De[De.ERR_ADM_WIN_CORE_INIT_PLAYOUT_NULL=1307]="ERR_ADM_WIN_CORE_INIT_PLAYOUT_NULL",De[De.ERR_ADM_WIN_CORE_START_RECORDING=1309]="ERR_ADM_WIN_CORE_START_RECORDING",De[De.ERR_ADM_WIN_CORE_CREATE_REC_THREAD=1311]="ERR_ADM_WIN_CORE_CREATE_REC_THREAD",De[De.ERR_ADM_WIN_CORE_CAPTURE_NOT_STARTUP=1314]="ERR_ADM_WIN_CORE_CAPTURE_NOT_STARTUP",De[De.ERR_ADM_WIN_CORE_CREATE_RENDER_THREAD=1319]="ERR_ADM_WIN_CORE_CREATE_RENDER_THREAD",De[De.ERR_ADM_WIN_CORE_RENDER_NOT_STARTUP=1320]="ERR_ADM_WIN_CORE_RENDER_NOT_STARTUP",De[De.ERR_ADM_WIN_CORE_NO_RECORDING_DEVICE=1322]="ERR_ADM_WIN_CORE_NO_RECORDING_DEVICE",De[De.ERR_ADM_WIN_CORE_NO_PLAYOUT_DEVICE=1323]="ERR_ADM_WIN_CORE_NO_PLAYOUT_DEVICE",De[De.ERR_ADM_WIN_WAVE_INIT=1351]="ERR_ADM_WIN_WAVE_INIT",De[De.ERR_ADM_WIN_WAVE_INIT_RECORDING=1353]="ERR_ADM_WIN_WAVE_INIT_RECORDING",De[De.ERR_ADM_WIN_WAVE_INIT_MICROPHONE=1354]="ERR_ADM_WIN_WAVE_INIT_MICROPHONE",De[De.ERR_ADM_WIN_WAVE_INIT_PLAYOUT=1355]="ERR_ADM_WIN_WAVE_INIT_PLAYOUT",De[De.ERR_ADM_WIN_WAVE_INIT_SPEAKER=1356]="ERR_ADM_WIN_WAVE_INIT_SPEAKER",De[De.ERR_ADM_WIN_WAVE_START_RECORDING=1357]="ERR_ADM_WIN_WAVE_START_RECORDING",De[De.ERR_ADM_WIN_WAVE_START_PLAYOUT=1358]="ERR_ADM_WIN_WAVE_START_PLAYOUT",De[De.ERR_ADM_NO_RECORDING_DEVICE=1359]="ERR_ADM_NO_RECORDING_DEVICE",De[De.ERR_ADM_NO_PLAYOUT_DEVICE=1360]="ERR_ADM_NO_PLAYOUT_DEVICE",De[De.ERR_VDM_CAMERA_NOT_AUTHORIZED=1501]="ERR_VDM_CAMERA_NOT_AUTHORIZED",De[De.ERR_VDM_WIN_DEVICE_IN_USE=1502]="ERR_VDM_WIN_DEVICE_IN_USE",De[De.ERR_VCM_UNKNOWN_ERROR=1600]="ERR_VCM_UNKNOWN_ERROR",De[De.ERR_VCM_ENCODER_INIT_ERROR=1601]="ERR_VCM_ENCODER_INIT_ERROR",De[De.ERR_VCM_ENCODER_ENCODE_ERROR=1602]="ERR_VCM_ENCODER_ENCODE_ERROR",De[De.ERR_VCM_ENCODER_SET_ERROR=1603]="ERR_VCM_ENCODER_SET_ERROR",(Ne=t.LOG_FILTER_TYPE||(t.LOG_FILTER_TYPE={}))[Ne.LOG_FILTER_OFF=0]="LOG_FILTER_OFF",Ne[Ne.LOG_FILTER_DEBUG=2063]="LOG_FILTER_DEBUG",Ne[Ne.LOG_FILTER_INFO=15]="LOG_FILTER_INFO",Ne[Ne.LOG_FILTER_WARN=14]="LOG_FILTER_WARN",Ne[Ne.LOG_FILTER_ERROR=12]="LOG_FILTER_ERROR",Ne[Ne.LOG_FILTER_CRITICAL=8]="LOG_FILTER_CRITICAL",Ne[Ne.LOG_FILTER_MASK=2063]="LOG_FILTER_MASK",(we=t.LOG_LEVEL||(t.LOG_LEVEL={}))[we.LOG_LEVEL_NONE=0]="LOG_LEVEL_NONE",we[we.LOG_LEVEL_INFO=1]="LOG_LEVEL_INFO",we[we.LOG_LEVEL_WARN=2]="LOG_LEVEL_WARN",we[we.LOG_LEVEL_ERROR=4]="LOG_LEVEL_ERROR",we[we.LOG_LEVEL_FATAL=8]="LOG_LEVEL_FATAL",(be=t.MAX_DEVICE_ID_LENGTH_TYPE||(t.MAX_DEVICE_ID_LENGTH_TYPE={}))[be.MAX_DEVICE_ID_LENGTH=512]="MAX_DEVICE_ID_LENGTH",(Oe=t.MAX_USER_ACCOUNT_LENGTH_TYPE||(t.MAX_USER_ACCOUNT_LENGTH_TYPE={}))[Oe.MAX_USER_ACCOUNT_LENGTH=256]="MAX_USER_ACCOUNT_LENGTH",(Ce=t.MAX_CHANNEL_ID_LENGTH_TYPE||(t.MAX_CHANNEL_ID_LENGTH_TYPE={}))[Ce.MAX_CHANNEL_ID_LENGTH=65]="MAX_CHANNEL_ID_LENGTH",(Se=t.QUALITY_REPORT_FORMAT_TYPE||(t.QUALITY_REPORT_FORMAT_TYPE={}))[Se.QUALITY_REPORT_JSON=0]="QUALITY_REPORT_JSON",Se[Se.QUALITY_REPORT_HTML=1]="QUALITY_REPORT_HTML",(ye=t.MEDIA_ENGINE_EVENT_CODE_TYPE||(t.MEDIA_ENGINE_EVENT_CODE_TYPE={}))[ye.MEDIA_ENGINE_RECORDING_ERROR=0]="MEDIA_ENGINE_RECORDING_ERROR",ye[ye.MEDIA_ENGINE_PLAYOUT_ERROR=1]="MEDIA_ENGINE_PLAYOUT_ERROR",ye[ye.MEDIA_ENGINE_RECORDING_WARNING=2]="MEDIA_ENGINE_RECORDING_WARNING",ye[ye.MEDIA_ENGINE_PLAYOUT_WARNING=3]="MEDIA_ENGINE_PLAYOUT_WARNING",ye[ye.MEDIA_ENGINE_AUDIO_FILE_MIX_FINISH=10]="MEDIA_ENGINE_AUDIO_FILE_MIX_FINISH",ye[ye.MEDIA_ENGINE_AUDIO_FAREND_MUSIC_BEGINS=12]="MEDIA_ENGINE_AUDIO_FAREND_MUSIC_BEGINS",ye[ye.MEDIA_ENGINE_AUDIO_FAREND_MUSIC_ENDS=13]="MEDIA_ENGINE_AUDIO_FAREND_MUSIC_ENDS",ye[ye.MEDIA_ENGINE_LOCAL_AUDIO_RECORD_ENABLED=14]="MEDIA_ENGINE_LOCAL_AUDIO_RECORD_ENABLED",ye[ye.MEDIA_ENGINE_LOCAL_AUDIO_RECORD_DISABLED=15]="MEDIA_ENGINE_LOCAL_AUDIO_RECORD_DISABLED",ye[ye.MEDIA_ENGINE_ROLE_BROADCASTER_SOLO=20]="MEDIA_ENGINE_ROLE_BROADCASTER_SOLO",ye[ye.MEDIA_ENGINE_ROLE_BROADCASTER_INTERACTIVE=21]="MEDIA_ENGINE_ROLE_BROADCASTER_INTERACTIVE",ye[ye.MEDIA_ENGINE_ROLE_AUDIENCE=22]="MEDIA_ENGINE_ROLE_AUDIENCE",ye[ye.MEDIA_ENGINE_ROLE_COMM_PEER=23]="MEDIA_ENGINE_ROLE_COMM_PEER",ye[ye.MEDIA_ENGINE_ROLE_GAME_PEER=24]="MEDIA_ENGINE_ROLE_GAME_PEER",ye[ye.MEDIA_ENGINE_AUDIO_ADM_REQUIRE_RESTART=110]="MEDIA_ENGINE_AUDIO_ADM_REQUIRE_RESTART",ye[ye.MEDIA_ENGINE_AUDIO_ADM_SPECIAL_RESTART=111]="MEDIA_ENGINE_AUDIO_ADM_SPECIAL_RESTART",ye[ye.MEDIA_ENGINE_AUDIO_ADM_USING_COMM_PARAMS=112]="MEDIA_ENGINE_AUDIO_ADM_USING_COMM_PARAMS",ye[ye.MEDIA_ENGINE_AUDIO_ADM_USING_NORM_PARAMS=113]="MEDIA_ENGINE_AUDIO_ADM_USING_NORM_PARAMS",ye[ye.MEDIA_ENGINE_AUDIO_EVENT_MIXING_PLAY=710]="MEDIA_ENGINE_AUDIO_EVENT_MIXING_PLAY",ye[ye.MEDIA_ENGINE_AUDIO_EVENT_MIXING_PAUSED=711]="MEDIA_ENGINE_AUDIO_EVENT_MIXING_PAUSED",ye[ye.MEDIA_ENGINE_AUDIO_EVENT_MIXING_RESTART=712]="MEDIA_ENGINE_AUDIO_EVENT_MIXING_RESTART",ye[ye.MEDIA_ENGINE_AUDIO_EVENT_MIXING_STOPPED=713]="MEDIA_ENGINE_AUDIO_EVENT_MIXING_STOPPED",ye[ye.MEDIA_ENGINE_AUDIO_EVENT_MIXING_ERROR=714]="MEDIA_ENGINE_AUDIO_EVENT_MIXING_ERROR",ye[ye.MEDIA_ENGINE_AUDIO_ERROR_MIXING_OPEN=701]="MEDIA_ENGINE_AUDIO_ERROR_MIXING_OPEN",ye[ye.MEDIA_ENGINE_AUDIO_ERROR_MIXING_TOO_FREQUENT=702]="MEDIA_ENGINE_AUDIO_ERROR_MIXING_TOO_FREQUENT",ye[ye.MEDIA_ENGINE_AUDIO_ERROR_MIXING_INTERRUPTED_EOF=703]="MEDIA_ENGINE_AUDIO_ERROR_MIXING_INTERRUPTED_EOF",ye[ye.MEDIA_ENGINE_AUDIO_ERROR_MIXING_NO_ERROR=0]="MEDIA_ENGINE_AUDIO_ERROR_MIXING_NO_ERROR",(ve=t.AUDIO_MIXING_STATE_TYPE||(t.AUDIO_MIXING_STATE_TYPE={}))[ve.AUDIO_MIXING_STATE_PLAYING=710]="AUDIO_MIXING_STATE_PLAYING",ve[ve.AUDIO_MIXING_STATE_PAUSED=711]="AUDIO_MIXING_STATE_PAUSED",ve[ve.AUDIO_MIXING_STATE_STOPPED=713]="AUDIO_MIXING_STATE_STOPPED",ve[ve.AUDIO_MIXING_STATE_FAILED=714]="AUDIO_MIXING_STATE_FAILED",(Re=t.AUDIO_MIXING_ERROR_TYPE||(t.AUDIO_MIXING_ERROR_TYPE={}))[Re.AUDIO_MIXING_ERROR_CAN_NOT_OPEN=701]="AUDIO_MIXING_ERROR_CAN_NOT_OPEN",Re[Re.AUDIO_MIXING_ERROR_TOO_FREQUENT_CALL=702]="AUDIO_MIXING_ERROR_TOO_FREQUENT_CALL",Re[Re.AUDIO_MIXING_ERROR_INTERRUPTED_EOF=703]="AUDIO_MIXING_ERROR_INTERRUPTED_EOF",Re[Re.AUDIO_MIXING_ERROR_OK=0]="AUDIO_MIXING_ERROR_OK",(Te=t.MEDIA_DEVICE_STATE_TYPE||(t.MEDIA_DEVICE_STATE_TYPE={}))[Te.MEDIA_DEVICE_STATE_ACTIVE=1]="MEDIA_DEVICE_STATE_ACTIVE",Te[Te.MEDIA_DEVICE_STATE_DISABLED=2]="MEDIA_DEVICE_STATE_DISABLED",Te[Te.MEDIA_DEVICE_STATE_NOT_PRESENT=4]="MEDIA_DEVICE_STATE_NOT_PRESENT",Te[Te.MEDIA_DEVICE_STATE_UNPLUGGED=8]="MEDIA_DEVICE_STATE_UNPLUGGED",Te[Te.MEDIA_DEVICE_STATE_UNRECOMMENDED=16]="MEDIA_DEVICE_STATE_UNRECOMMENDED",(Ie=t.MEDIA_DEVICE_TYPE||(t.MEDIA_DEVICE_TYPE={}))[Ie.UNKNOWN_AUDIO_DEVICE=-1]="UNKNOWN_AUDIO_DEVICE",Ie[Ie.AUDIO_PLAYOUT_DEVICE=0]="AUDIO_PLAYOUT_DEVICE",Ie[Ie.AUDIO_RECORDING_DEVICE=1]="AUDIO_RECORDING_DEVICE",Ie[Ie.VIDEO_RENDER_DEVICE=2]="VIDEO_RENDER_DEVICE",Ie[Ie.VIDEO_CAPTURE_DEVICE=3]="VIDEO_CAPTURE_DEVICE",Ie[Ie.AUDIO_APPLICATION_PLAYOUT_DEVICE=4]="AUDIO_APPLICATION_PLAYOUT_DEVICE",(me=t.LOCAL_VIDEO_STREAM_STATE||(t.LOCAL_VIDEO_STREAM_STATE={}))[me.LOCAL_VIDEO_STREAM_STATE_STOPPED=0]="LOCAL_VIDEO_STREAM_STATE_STOPPED",me[me.LOCAL_VIDEO_STREAM_STATE_CAPTURING=1]="LOCAL_VIDEO_STREAM_STATE_CAPTURING",me[me.LOCAL_VIDEO_STREAM_STATE_ENCODING=2]="LOCAL_VIDEO_STREAM_STATE_ENCODING",me[me.LOCAL_VIDEO_STREAM_STATE_FAILED=3]="LOCAL_VIDEO_STREAM_STATE_FAILED",(_e=t.LOCAL_VIDEO_STREAM_ERROR||(t.LOCAL_VIDEO_STREAM_ERROR={}))[_e.LOCAL_VIDEO_STREAM_ERROR_OK=0]="LOCAL_VIDEO_STREAM_ERROR_OK",_e[_e.LOCAL_VIDEO_STREAM_ERROR_FAILURE=1]="LOCAL_VIDEO_STREAM_ERROR_FAILURE",_e[_e.LOCAL_VIDEO_STREAM_ERROR_DEVICE_NO_PERMISSION=2]="LOCAL_VIDEO_STREAM_ERROR_DEVICE_NO_PERMISSION",_e[_e.LOCAL_VIDEO_STREAM_ERROR_DEVICE_BUSY=3]="LOCAL_VIDEO_STREAM_ERROR_DEVICE_BUSY",_e[_e.LOCAL_VIDEO_STREAM_ERROR_CAPTURE_FAILURE=4]="LOCAL_VIDEO_STREAM_ERROR_CAPTURE_FAILURE",_e[_e.LOCAL_VIDEO_STREAM_ERROR_ENCODE_FAILURE=5]="LOCAL_VIDEO_STREAM_ERROR_ENCODE_FAILURE",_e[_e.LOCAL_VIDEO_STREAM_ERROR_CAPTURE_INBACKGROUND=6]="LOCAL_VIDEO_STREAM_ERROR_CAPTURE_INBACKGROUND",_e[_e.LOCAL_VIDEO_STREAM_ERROR_CAPTURE_MULTIPLE_FOREGROUND_APPS=7]="LOCAL_VIDEO_STREAM_ERROR_CAPTURE_MULTIPLE_FOREGROUND_APPS",_e[_e.LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_WINDOW_MINIMIZED=11]="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_WINDOW_MINIMIZED",_e[_e.LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_WINDOW_CLOSED=12]="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_WINDOW_CLOSED",(ge=t.LOCAL_AUDIO_STREAM_STATE||(t.LOCAL_AUDIO_STREAM_STATE={}))[ge.LOCAL_AUDIO_STREAM_STATE_STOPPED=0]="LOCAL_AUDIO_STREAM_STATE_STOPPED",ge[ge.LOCAL_AUDIO_STREAM_STATE_RECORDING=1]="LOCAL_AUDIO_STREAM_STATE_RECORDING",ge[ge.LOCAL_AUDIO_STREAM_STATE_ENCODING=2]="LOCAL_AUDIO_STREAM_STATE_ENCODING",ge[ge.LOCAL_AUDIO_STREAM_STATE_FAILED=3]="LOCAL_AUDIO_STREAM_STATE_FAILED",(Ee=t.LOCAL_AUDIO_STREAM_ERROR||(t.LOCAL_AUDIO_STREAM_ERROR={}))[Ee.LOCAL_AUDIO_STREAM_ERROR_OK=0]="LOCAL_AUDIO_STREAM_ERROR_OK",Ee[Ee.LOCAL_AUDIO_STREAM_ERROR_FAILURE=1]="LOCAL_AUDIO_STREAM_ERROR_FAILURE",Ee[Ee.LOCAL_AUDIO_STREAM_ERROR_DEVICE_NO_PERMISSION=2]="LOCAL_AUDIO_STREAM_ERROR_DEVICE_NO_PERMISSION",Ee[Ee.LOCAL_AUDIO_STREAM_ERROR_DEVICE_BUSY=3]="LOCAL_AUDIO_STREAM_ERROR_DEVICE_BUSY",Ee[Ee.LOCAL_AUDIO_STREAM_ERROR_RECORD_FAILURE=4]="LOCAL_AUDIO_STREAM_ERROR_RECORD_FAILURE",Ee[Ee.LOCAL_AUDIO_STREAM_ERROR_ENCODE_FAILURE=5]="LOCAL_AUDIO_STREAM_ERROR_ENCODE_FAILURE",(Ae=t.AUDIO_RECORDING_QUALITY_TYPE||(t.AUDIO_RECORDING_QUALITY_TYPE={}))[Ae.AUDIO_RECORDING_QUALITY_LOW=0]="AUDIO_RECORDING_QUALITY_LOW",Ae[Ae.AUDIO_RECORDING_QUALITY_MEDIUM=1]="AUDIO_RECORDING_QUALITY_MEDIUM",Ae[Ae.AUDIO_RECORDING_QUALITY_HIGH=2]="AUDIO_RECORDING_QUALITY_HIGH",(fe=t.QUALITY_TYPE||(t.QUALITY_TYPE={}))[fe.QUALITY_UNKNOWN=0]="QUALITY_UNKNOWN",fe[fe.QUALITY_EXCELLENT=1]="QUALITY_EXCELLENT",fe[fe.QUALITY_GOOD=2]="QUALITY_GOOD",fe[fe.QUALITY_POOR=3]="QUALITY_POOR",fe[fe.QUALITY_BAD=4]="QUALITY_BAD",fe[fe.QUALITY_VBAD=5]="QUALITY_VBAD",fe[fe.QUALITY_DOWN=6]="QUALITY_DOWN",fe[fe.QUALITY_UNSUPPORTED=7]="QUALITY_UNSUPPORTED",fe[fe.QUALITY_DETECTING=8]="QUALITY_DETECTING",(pe=t.RENDER_MODE_TYPE||(t.RENDER_MODE_TYPE={}))[pe.RENDER_MODE_HIDDEN=1]="RENDER_MODE_HIDDEN",pe[pe.RENDER_MODE_FIT=2]="RENDER_MODE_FIT",pe[pe.RENDER_MODE_ADAPTIVE=3]="RENDER_MODE_ADAPTIVE",pe[pe.RENDER_MODE_FILL=4]="RENDER_MODE_FILL",(he=t.VIDEO_MIRROR_MODE_TYPE||(t.VIDEO_MIRROR_MODE_TYPE={}))[he.VIDEO_MIRROR_MODE_AUTO=0]="VIDEO_MIRROR_MODE_AUTO",he[he.VIDEO_MIRROR_MODE_ENABLED=1]="VIDEO_MIRROR_MODE_ENABLED",he[he.VIDEO_MIRROR_MODE_DISABLED=2]="VIDEO_MIRROR_MODE_DISABLED",(de=t.VIDEO_PROFILE_TYPE||(t.VIDEO_PROFILE_TYPE={}))[de.VIDEO_PROFILE_LANDSCAPE_120P=0]="VIDEO_PROFILE_LANDSCAPE_120P",de[de.VIDEO_PROFILE_LANDSCAPE_120P_3=2]="VIDEO_PROFILE_LANDSCAPE_120P_3",de[de.VIDEO_PROFILE_LANDSCAPE_180P=10]="VIDEO_PROFILE_LANDSCAPE_180P",de[de.VIDEO_PROFILE_LANDSCAPE_180P_3=12]="VIDEO_PROFILE_LANDSCAPE_180P_3",de[de.VIDEO_PROFILE_LANDSCAPE_180P_4=13]="VIDEO_PROFILE_LANDSCAPE_180P_4",de[de.VIDEO_PROFILE_LANDSCAPE_240P=20]="VIDEO_PROFILE_LANDSCAPE_240P",de[de.VIDEO_PROFILE_LANDSCAPE_240P_3=22]="VIDEO_PROFILE_LANDSCAPE_240P_3",de[de.VIDEO_PROFILE_LANDSCAPE_240P_4=23]="VIDEO_PROFILE_LANDSCAPE_240P_4",de[de.VIDEO_PROFILE_LANDSCAPE_360P=30]="VIDEO_PROFILE_LANDSCAPE_360P",de[de.VIDEO_PROFILE_LANDSCAPE_360P_3=32]="VIDEO_PROFILE_LANDSCAPE_360P_3",de[de.VIDEO_PROFILE_LANDSCAPE_360P_4=33]="VIDEO_PROFILE_LANDSCAPE_360P_4",de[de.VIDEO_PROFILE_LANDSCAPE_360P_6=35]="VIDEO_PROFILE_LANDSCAPE_360P_6",de[de.VIDEO_PROFILE_LANDSCAPE_360P_7=36]="VIDEO_PROFILE_LANDSCAPE_360P_7",de[de.VIDEO_PROFILE_LANDSCAPE_360P_8=37]="VIDEO_PROFILE_LANDSCAPE_360P_8",de[de.VIDEO_PROFILE_LANDSCAPE_360P_9=38]="VIDEO_PROFILE_LANDSCAPE_360P_9",de[de.VIDEO_PROFILE_LANDSCAPE_360P_10=39]="VIDEO_PROFILE_LANDSCAPE_360P_10",de[de.VIDEO_PROFILE_LANDSCAPE_360P_11=100]="VIDEO_PROFILE_LANDSCAPE_360P_11",de[de.VIDEO_PROFILE_LANDSCAPE_480P=40]="VIDEO_PROFILE_LANDSCAPE_480P",de[de.VIDEO_PROFILE_LANDSCAPE_480P_3=42]="VIDEO_PROFILE_LANDSCAPE_480P_3",de[de.VIDEO_PROFILE_LANDSCAPE_480P_4=43]="VIDEO_PROFILE_LANDSCAPE_480P_4",de[de.VIDEO_PROFILE_LANDSCAPE_480P_6=45]="VIDEO_PROFILE_LANDSCAPE_480P_6",de[de.VIDEO_PROFILE_LANDSCAPE_480P_8=47]="VIDEO_PROFILE_LANDSCAPE_480P_8",de[de.VIDEO_PROFILE_LANDSCAPE_480P_9=48]="VIDEO_PROFILE_LANDSCAPE_480P_9",de[de.VIDEO_PROFILE_LANDSCAPE_480P_10=49]="VIDEO_PROFILE_LANDSCAPE_480P_10",de[de.VIDEO_PROFILE_LANDSCAPE_720P=50]="VIDEO_PROFILE_LANDSCAPE_720P",de[de.VIDEO_PROFILE_LANDSCAPE_720P_3=52]="VIDEO_PROFILE_LANDSCAPE_720P_3",de[de.VIDEO_PROFILE_LANDSCAPE_720P_5=54]="VIDEO_PROFILE_LANDSCAPE_720P_5",de[de.VIDEO_PROFILE_LANDSCAPE_720P_6=55]="VIDEO_PROFILE_LANDSCAPE_720P_6",de[de.VIDEO_PROFILE_LANDSCAPE_1080P=60]="VIDEO_PROFILE_LANDSCAPE_1080P",de[de.VIDEO_PROFILE_LANDSCAPE_1080P_3=62]="VIDEO_PROFILE_LANDSCAPE_1080P_3",de[de.VIDEO_PROFILE_LANDSCAPE_1080P_5=64]="VIDEO_PROFILE_LANDSCAPE_1080P_5",de[de.VIDEO_PROFILE_LANDSCAPE_1440P=66]="VIDEO_PROFILE_LANDSCAPE_1440P",de[de.VIDEO_PROFILE_LANDSCAPE_1440P_2=67]="VIDEO_PROFILE_LANDSCAPE_1440P_2",de[de.VIDEO_PROFILE_LANDSCAPE_4K=70]="VIDEO_PROFILE_LANDSCAPE_4K",de[de.VIDEO_PROFILE_LANDSCAPE_4K_3=72]="VIDEO_PROFILE_LANDSCAPE_4K_3",de[de.VIDEO_PROFILE_PORTRAIT_120P=1e3]="VIDEO_PROFILE_PORTRAIT_120P",de[de.VIDEO_PROFILE_PORTRAIT_120P_3=1002]="VIDEO_PROFILE_PORTRAIT_120P_3",de[de.VIDEO_PROFILE_PORTRAIT_180P=1010]="VIDEO_PROFILE_PORTRAIT_180P",de[de.VIDEO_PROFILE_PORTRAIT_180P_3=1012]="VIDEO_PROFILE_PORTRAIT_180P_3",de[de.VIDEO_PROFILE_PORTRAIT_180P_4=1013]="VIDEO_PROFILE_PORTRAIT_180P_4",de[de.VIDEO_PROFILE_PORTRAIT_240P=1020]="VIDEO_PROFILE_PORTRAIT_240P",de[de.VIDEO_PROFILE_PORTRAIT_240P_3=1022]="VIDEO_PROFILE_PORTRAIT_240P_3",de[de.VIDEO_PROFILE_PORTRAIT_240P_4=1023]="VIDEO_PROFILE_PORTRAIT_240P_4",de[de.VIDEO_PROFILE_PORTRAIT_360P=1030]="VIDEO_PROFILE_PORTRAIT_360P",de[de.VIDEO_PROFILE_PORTRAIT_360P_3=1032]="VIDEO_PROFILE_PORTRAIT_360P_3",de[de.VIDEO_PROFILE_PORTRAIT_360P_4=1033]="VIDEO_PROFILE_PORTRAIT_360P_4",de[de.VIDEO_PROFILE_PORTRAIT_360P_6=1035]="VIDEO_PROFILE_PORTRAIT_360P_6",de[de.VIDEO_PROFILE_PORTRAIT_360P_7=1036]="VIDEO_PROFILE_PORTRAIT_360P_7",de[de.VIDEO_PROFILE_PORTRAIT_360P_8=1037]="VIDEO_PROFILE_PORTRAIT_360P_8",de[de.VIDEO_PROFILE_PORTRAIT_360P_9=1038]="VIDEO_PROFILE_PORTRAIT_360P_9",de[de.VIDEO_PROFILE_PORTRAIT_360P_10=1039]="VIDEO_PROFILE_PORTRAIT_360P_10",de[de.VIDEO_PROFILE_PORTRAIT_360P_11=1100]="VIDEO_PROFILE_PORTRAIT_360P_11",de[de.VIDEO_PROFILE_PORTRAIT_480P=1040]="VIDEO_PROFILE_PORTRAIT_480P",de[de.VIDEO_PROFILE_PORTRAIT_480P_3=1042]="VIDEO_PROFILE_PORTRAIT_480P_3",de[de.VIDEO_PROFILE_PORTRAIT_480P_4=1043]="VIDEO_PROFILE_PORTRAIT_480P_4",de[de.VIDEO_PROFILE_PORTRAIT_480P_6=1045]="VIDEO_PROFILE_PORTRAIT_480P_6",de[de.VIDEO_PROFILE_PORTRAIT_480P_8=1047]="VIDEO_PROFILE_PORTRAIT_480P_8",de[de.VIDEO_PROFILE_PORTRAIT_480P_9=1048]="VIDEO_PROFILE_PORTRAIT_480P_9",de[de.VIDEO_PROFILE_PORTRAIT_480P_10=1049]="VIDEO_PROFILE_PORTRAIT_480P_10",de[de.VIDEO_PROFILE_PORTRAIT_720P=1050]="VIDEO_PROFILE_PORTRAIT_720P",de[de.VIDEO_PROFILE_PORTRAIT_720P_3=1052]="VIDEO_PROFILE_PORTRAIT_720P_3",de[de.VIDEO_PROFILE_PORTRAIT_720P_5=1054]="VIDEO_PROFILE_PORTRAIT_720P_5",de[de.VIDEO_PROFILE_PORTRAIT_720P_6=1055]="VIDEO_PROFILE_PORTRAIT_720P_6",de[de.VIDEO_PROFILE_PORTRAIT_1080P=1060]="VIDEO_PROFILE_PORTRAIT_1080P",de[de.VIDEO_PROFILE_PORTRAIT_1080P_3=1062]="VIDEO_PROFILE_PORTRAIT_1080P_3",de[de.VIDEO_PROFILE_PORTRAIT_1080P_5=1064]="VIDEO_PROFILE_PORTRAIT_1080P_5",de[de.VIDEO_PROFILE_PORTRAIT_1440P=1066]="VIDEO_PROFILE_PORTRAIT_1440P",de[de.VIDEO_PROFILE_PORTRAIT_1440P_2=1067]="VIDEO_PROFILE_PORTRAIT_1440P_2",de[de.VIDEO_PROFILE_PORTRAIT_4K=1070]="VIDEO_PROFILE_PORTRAIT_4K",de[de.VIDEO_PROFILE_PORTRAIT_4K_3=1072]="VIDEO_PROFILE_PORTRAIT_4K_3",de[de.VIDEO_PROFILE_DEFAULT=30]="VIDEO_PROFILE_DEFAULT",(le=t.AUDIO_PROFILE_TYPE||(t.AUDIO_PROFILE_TYPE={}))[le.AUDIO_PROFILE_DEFAULT=0]="AUDIO_PROFILE_DEFAULT",le[le.AUDIO_PROFILE_SPEECH_STANDARD=1]="AUDIO_PROFILE_SPEECH_STANDARD",le[le.AUDIO_PROFILE_MUSIC_STANDARD=2]="AUDIO_PROFILE_MUSIC_STANDARD",le[le.AUDIO_PROFILE_MUSIC_STANDARD_STEREO=3]="AUDIO_PROFILE_MUSIC_STANDARD_STEREO",le[le.AUDIO_PROFILE_MUSIC_HIGH_QUALITY=4]="AUDIO_PROFILE_MUSIC_HIGH_QUALITY",le[le.AUDIO_PROFILE_MUSIC_HIGH_QUALITY_STEREO=5]="AUDIO_PROFILE_MUSIC_HIGH_QUALITY_STEREO",le[le.AUDIO_PROFILE_IOT=6]="AUDIO_PROFILE_IOT",le[le.AUDIO_PROFILE_NUM=7]="AUDIO_PROFILE_NUM",(ue=t.AUDIO_SCENARIO_TYPE||(t.AUDIO_SCENARIO_TYPE={}))[ue.AUDIO_SCENARIO_DEFAULT=0]="AUDIO_SCENARIO_DEFAULT",ue[ue.AUDIO_SCENARIO_CHATROOM_ENTERTAINMENT=1]="AUDIO_SCENARIO_CHATROOM_ENTERTAINMENT",ue[ue.AUDIO_SCENARIO_EDUCATION=2]="AUDIO_SCENARIO_EDUCATION",ue[ue.AUDIO_SCENARIO_GAME_STREAMING=3]="AUDIO_SCENARIO_GAME_STREAMING",ue[ue.AUDIO_SCENARIO_SHOWROOM=4]="AUDIO_SCENARIO_SHOWROOM",ue[ue.AUDIO_SCENARIO_CHATROOM_GAMING=5]="AUDIO_SCENARIO_CHATROOM_GAMING",ue[ue.AUDIO_SCENARIO_IOT=6]="AUDIO_SCENARIO_IOT",ue[ue.AUDIO_SCENARIO_MEETING=8]="AUDIO_SCENARIO_MEETING",ue[ue.AUDIO_SCENARIO_NUM=9]="AUDIO_SCENARIO_NUM",(ce=t.CHANNEL_PROFILE_TYPE||(t.CHANNEL_PROFILE_TYPE={}))[ce.CHANNEL_PROFILE_COMMUNICATION=0]="CHANNEL_PROFILE_COMMUNICATION",ce[ce.CHANNEL_PROFILE_LIVE_BROADCASTING=1]="CHANNEL_PROFILE_LIVE_BROADCASTING",ce[ce.CHANNEL_PROFILE_GAME=2]="CHANNEL_PROFILE_GAME",(ae=t.CLIENT_ROLE_TYPE||(t.CLIENT_ROLE_TYPE={}))[ae.CLIENT_ROLE_BROADCASTER=1]="CLIENT_ROLE_BROADCASTER",ae[ae.CLIENT_ROLE_AUDIENCE=2]="CLIENT_ROLE_AUDIENCE",(se=t.AUDIENCE_LATENCY_LEVEL_TYPE||(t.AUDIENCE_LATENCY_LEVEL_TYPE={}))[se.AUDIENCE_LATENCY_LEVEL_LOW_LATENCY=1]="AUDIENCE_LATENCY_LEVEL_LOW_LATENCY",se[se.AUDIENCE_LATENCY_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LATENCY_LEVEL_ULTRA_LOW_LATENCY",(oe=t.SUPER_RESOLUTION_STATE_REASON||(t.SUPER_RESOLUTION_STATE_REASON={}))[oe.SR_STATE_REASON_SUCCESS=0]="SR_STATE_REASON_SUCCESS",oe[oe.SR_STATE_REASON_STREAM_OVER_LIMITATION=1]="SR_STATE_REASON_STREAM_OVER_LIMITATION",oe[oe.SR_STATE_REASON_USER_COUNT_OVER_LIMITATION=2]="SR_STATE_REASON_USER_COUNT_OVER_LIMITATION",oe[oe.SR_STATE_REASON_DEVICE_NOT_SUPPORTED=3]="SR_STATE_REASON_DEVICE_NOT_SUPPORTED",(ie=t.USER_OFFLINE_REASON_TYPE||(t.USER_OFFLINE_REASON_TYPE={}))[ie.USER_OFFLINE_QUIT=0]="USER_OFFLINE_QUIT",ie[ie.USER_OFFLINE_DROPPED=1]="USER_OFFLINE_DROPPED",ie[ie.USER_OFFLINE_BECOME_AUDIENCE=2]="USER_OFFLINE_BECOME_AUDIENCE",(re=t.RTMP_STREAM_PUBLISH_STATE||(t.RTMP_STREAM_PUBLISH_STATE={}))[re.RTMP_STREAM_PUBLISH_STATE_IDLE=0]="RTMP_STREAM_PUBLISH_STATE_IDLE",re[re.RTMP_STREAM_PUBLISH_STATE_CONNECTING=1]="RTMP_STREAM_PUBLISH_STATE_CONNECTING",re[re.RTMP_STREAM_PUBLISH_STATE_RUNNING=2]="RTMP_STREAM_PUBLISH_STATE_RUNNING",re[re.RTMP_STREAM_PUBLISH_STATE_RECOVERING=3]="RTMP_STREAM_PUBLISH_STATE_RECOVERING",re[re.RTMP_STREAM_PUBLISH_STATE_FAILURE=4]="RTMP_STREAM_PUBLISH_STATE_FAILURE",(ne=t.RTMP_STREAM_PUBLISH_ERROR||(t.RTMP_STREAM_PUBLISH_ERROR={}))[ne.RTMP_STREAM_PUBLISH_ERROR_OK=0]="RTMP_STREAM_PUBLISH_ERROR_OK",ne[ne.RTMP_STREAM_PUBLISH_ERROR_INVALID_ARGUMENT=1]="RTMP_STREAM_PUBLISH_ERROR_INVALID_ARGUMENT",ne[ne.RTMP_STREAM_PUBLISH_ERROR_ENCRYPTED_STREAM_NOT_ALLOWED=2]="RTMP_STREAM_PUBLISH_ERROR_ENCRYPTED_STREAM_NOT_ALLOWED",ne[ne.RTMP_STREAM_PUBLISH_ERROR_CONNECTION_TIMEOUT=3]="RTMP_STREAM_PUBLISH_ERROR_CONNECTION_TIMEOUT",ne[ne.RTMP_STREAM_PUBLISH_ERROR_INTERNAL_SERVER_ERROR=4]="RTMP_STREAM_PUBLISH_ERROR_INTERNAL_SERVER_ERROR",ne[ne.RTMP_STREAM_PUBLISH_ERROR_RTMP_SERVER_ERROR=5]="RTMP_STREAM_PUBLISH_ERROR_RTMP_SERVER_ERROR",ne[ne.RTMP_STREAM_PUBLISH_ERROR_TOO_OFTEN=6]="RTMP_STREAM_PUBLISH_ERROR_TOO_OFTEN",ne[ne.RTMP_STREAM_PUBLISH_ERROR_REACH_LIMIT=7]="RTMP_STREAM_PUBLISH_ERROR_REACH_LIMIT",ne[ne.RTMP_STREAM_PUBLISH_ERROR_NOT_AUTHORIZED=8]="RTMP_STREAM_PUBLISH_ERROR_NOT_AUTHORIZED",ne[ne.RTMP_STREAM_PUBLISH_ERROR_STREAM_NOT_FOUND=9]="RTMP_STREAM_PUBLISH_ERROR_STREAM_NOT_FOUND",ne[ne.RTMP_STREAM_PUBLISH_ERROR_FORMAT_NOT_SUPPORTED=10]="RTMP_STREAM_PUBLISH_ERROR_FORMAT_NOT_SUPPORTED",(te=t.RTMP_STREAMING_EVENT||(t.RTMP_STREAMING_EVENT={}))[te.RTMP_STREAMING_EVENT_FAILED_LOAD_IMAGE=1]="RTMP_STREAMING_EVENT_FAILED_LOAD_IMAGE",(ee=t.INJECT_STREAM_STATUS||(t.INJECT_STREAM_STATUS={}))[ee.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",ee[ee.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",ee[ee.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",ee[ee.INJECT_STREAM_STATUS_START_TIMEDOUT=3]="INJECT_STREAM_STATUS_START_TIMEDOUT",ee[ee.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",ee[ee.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",ee[ee.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",ee[ee.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",ee[ee.INJECT_STREAM_STATUS_STOP_TIMEDOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEDOUT",ee[ee.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",ee[ee.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN",(Z=t.REMOTE_VIDEO_STREAM_TYPE||(t.REMOTE_VIDEO_STREAM_TYPE={}))[Z.REMOTE_VIDEO_STREAM_HIGH=0]="REMOTE_VIDEO_STREAM_HIGH",Z[Z.REMOTE_VIDEO_STREAM_LOW=1]="REMOTE_VIDEO_STREAM_LOW",(X=t.CAPTURE_BRIGHTNESS_LEVEL_TYPE||(t.CAPTURE_BRIGHTNESS_LEVEL_TYPE={}))[X.CAPTURE_BRIGHTNESS_LEVEL_INVALID=-1]="CAPTURE_BRIGHTNESS_LEVEL_INVALID",X[X.CAPTURE_BRIGHTNESS_LEVEL_NORMAL=0]="CAPTURE_BRIGHTNESS_LEVEL_NORMAL",X[X.CAPTURE_BRIGHTNESS_LEVEL_BRIGHT=1]="CAPTURE_BRIGHTNESS_LEVEL_BRIGHT",X[X.CAPTURE_BRIGHTNESS_LEVEL_DARK=2]="CAPTURE_BRIGHTNESS_LEVEL_DARK",(J=t.RAW_AUDIO_FRAME_OP_MODE_TYPE||(t.RAW_AUDIO_FRAME_OP_MODE_TYPE={}))[J.RAW_AUDIO_FRAME_OP_MODE_READ_ONLY=0]="RAW_AUDIO_FRAME_OP_MODE_READ_ONLY",J[J.RAW_AUDIO_FRAME_OP_MODE_WRITE_ONLY=1]="RAW_AUDIO_FRAME_OP_MODE_WRITE_ONLY",J[J.RAW_AUDIO_FRAME_OP_MODE_READ_WRITE=2]="RAW_AUDIO_FRAME_OP_MODE_READ_WRITE",(q=t.AUDIO_SAMPLE_RATE_TYPE||(t.AUDIO_SAMPLE_RATE_TYPE={}))[q.AUDIO_SAMPLE_RATE_32000=32e3]="AUDIO_SAMPLE_RATE_32000",q[q.AUDIO_SAMPLE_RATE_44100=44100]="AUDIO_SAMPLE_RATE_44100",q[q.AUDIO_SAMPLE_RATE_48000=48e3]="AUDIO_SAMPLE_RATE_48000",(z=t.VIDEO_CODEC_PROFILE_TYPE||(t.VIDEO_CODEC_PROFILE_TYPE={}))[z.VIDEO_CODEC_PROFILE_BASELINE=66]="VIDEO_CODEC_PROFILE_BASELINE",z[z.VIDEO_CODEC_PROFILE_MAIN=77]="VIDEO_CODEC_PROFILE_MAIN",z[z.VIDEO_CODEC_PROFILE_HIGH=100]="VIDEO_CODEC_PROFILE_HIGH",($=t.VIDEO_CODEC_TYPE||(t.VIDEO_CODEC_TYPE={}))[$.VIDEO_CODEC_VP8=1]="VIDEO_CODEC_VP8",$[$.VIDEO_CODEC_H264=2]="VIDEO_CODEC_H264",$[$.VIDEO_CODEC_EVP=3]="VIDEO_CODEC_EVP",$[$.VIDEO_CODEC_E264=4]="VIDEO_CODEC_E264",(K=t.VIDEO_CODEC_TYPE_FOR_STREAM||(t.VIDEO_CODEC_TYPE_FOR_STREAM={}))[K.VIDEO_CODEC_H264_FOR_STREAM=1]="VIDEO_CODEC_H264_FOR_STREAM",K[K.VIDEO_CODEC_H265_FOR_STREAM=2]="VIDEO_CODEC_H265_FOR_STREAM",(Y=t.AUDIO_EQUALIZATION_BAND_FREQUENCY||(t.AUDIO_EQUALIZATION_BAND_FREQUENCY={}))[Y.AUDIO_EQUALIZATION_BAND_31=0]="AUDIO_EQUALIZATION_BAND_31",Y[Y.AUDIO_EQUALIZATION_BAND_62=1]="AUDIO_EQUALIZATION_BAND_62",Y[Y.AUDIO_EQUALIZATION_BAND_125=2]="AUDIO_EQUALIZATION_BAND_125",Y[Y.AUDIO_EQUALIZATION_BAND_250=3]="AUDIO_EQUALIZATION_BAND_250",Y[Y.AUDIO_EQUALIZATION_BAND_500=4]="AUDIO_EQUALIZATION_BAND_500",Y[Y.AUDIO_EQUALIZATION_BAND_1K=5]="AUDIO_EQUALIZATION_BAND_1K",Y[Y.AUDIO_EQUALIZATION_BAND_2K=6]="AUDIO_EQUALIZATION_BAND_2K",Y[Y.AUDIO_EQUALIZATION_BAND_4K=7]="AUDIO_EQUALIZATION_BAND_4K",Y[Y.AUDIO_EQUALIZATION_BAND_8K=8]="AUDIO_EQUALIZATION_BAND_8K",Y[Y.AUDIO_EQUALIZATION_BAND_16K=9]="AUDIO_EQUALIZATION_BAND_16K",(W=t.AUDIO_REVERB_TYPE||(t.AUDIO_REVERB_TYPE={}))[W.AUDIO_REVERB_DRY_LEVEL=0]="AUDIO_REVERB_DRY_LEVEL",W[W.AUDIO_REVERB_WET_LEVEL=1]="AUDIO_REVERB_WET_LEVEL",W[W.AUDIO_REVERB_ROOM_SIZE=2]="AUDIO_REVERB_ROOM_SIZE",W[W.AUDIO_REVERB_WET_DELAY=3]="AUDIO_REVERB_WET_DELAY",W[W.AUDIO_REVERB_STRENGTH=4]="AUDIO_REVERB_STRENGTH",(H=t.VOICE_CHANGER_PRESET||(t.VOICE_CHANGER_PRESET={}))[H.VOICE_CHANGER_OFF=0]="VOICE_CHANGER_OFF",H[H.VOICE_CHANGER_OLDMAN=1]="VOICE_CHANGER_OLDMAN",H[H.VOICE_CHANGER_BABYBOY=2]="VOICE_CHANGER_BABYBOY",H[H.VOICE_CHANGER_BABYGIRL=3]="VOICE_CHANGER_BABYGIRL",H[H.VOICE_CHANGER_ZHUBAJIE=4]="VOICE_CHANGER_ZHUBAJIE",H[H.VOICE_CHANGER_ETHEREAL=5]="VOICE_CHANGER_ETHEREAL",H[H.VOICE_CHANGER_HULK=6]="VOICE_CHANGER_HULK",H[H.VOICE_BEAUTY_VIGOROUS=1048577]="VOICE_BEAUTY_VIGOROUS",H[H.VOICE_BEAUTY_DEEP=1048578]="VOICE_BEAUTY_DEEP",H[H.VOICE_BEAUTY_MELLOW=1048579]="VOICE_BEAUTY_MELLOW",H[H.VOICE_BEAUTY_FALSETTO=1048580]="VOICE_BEAUTY_FALSETTO",H[H.VOICE_BEAUTY_FULL=1048581]="VOICE_BEAUTY_FULL",H[H.VOICE_BEAUTY_CLEAR=1048582]="VOICE_BEAUTY_CLEAR",H[H.VOICE_BEAUTY_RESOUNDING=1048583]="VOICE_BEAUTY_RESOUNDING",H[H.VOICE_BEAUTY_RINGING=1048584]="VOICE_BEAUTY_RINGING",H[H.VOICE_BEAUTY_SPACIAL=1048585]="VOICE_BEAUTY_SPACIAL",H[H.GENERAL_BEAUTY_VOICE_MALE_MAGNETIC=2097153]="GENERAL_BEAUTY_VOICE_MALE_MAGNETIC",H[H.GENERAL_BEAUTY_VOICE_FEMALE_FRESH=2097154]="GENERAL_BEAUTY_VOICE_FEMALE_FRESH",H[H.GENERAL_BEAUTY_VOICE_FEMALE_VITALITY=2097155]="GENERAL_BEAUTY_VOICE_FEMALE_VITALITY",(j=t.AUDIO_REVERB_PRESET||(t.AUDIO_REVERB_PRESET={}))[j.AUDIO_REVERB_OFF=0]="AUDIO_REVERB_OFF",j[j.AUDIO_REVERB_FX_KTV=1048577]="AUDIO_REVERB_FX_KTV",j[j.AUDIO_REVERB_FX_VOCAL_CONCERT=1048578]="AUDIO_REVERB_FX_VOCAL_CONCERT",j[j.AUDIO_REVERB_FX_UNCLE=1048579]="AUDIO_REVERB_FX_UNCLE",j[j.AUDIO_REVERB_FX_SISTER=1048580]="AUDIO_REVERB_FX_SISTER",j[j.AUDIO_REVERB_FX_STUDIO=1048581]="AUDIO_REVERB_FX_STUDIO",j[j.AUDIO_REVERB_FX_POPULAR=1048582]="AUDIO_REVERB_FX_POPULAR",j[j.AUDIO_REVERB_FX_RNB=1048583]="AUDIO_REVERB_FX_RNB",j[j.AUDIO_REVERB_FX_PHONOGRAPH=1048584]="AUDIO_REVERB_FX_PHONOGRAPH",j[j.AUDIO_REVERB_POPULAR=1]="AUDIO_REVERB_POPULAR",j[j.AUDIO_REVERB_RNB=2]="AUDIO_REVERB_RNB",j[j.AUDIO_REVERB_ROCK=3]="AUDIO_REVERB_ROCK",j[j.AUDIO_REVERB_HIPHOP=4]="AUDIO_REVERB_HIPHOP",j[j.AUDIO_REVERB_VOCAL_CONCERT=5]="AUDIO_REVERB_VOCAL_CONCERT",j[j.AUDIO_REVERB_KTV=6]="AUDIO_REVERB_KTV",j[j.AUDIO_REVERB_STUDIO=7]="AUDIO_REVERB_STUDIO",j[j.AUDIO_VIRTUAL_STEREO=2097153]="AUDIO_VIRTUAL_STEREO",j[j.AUDIO_ELECTRONIC_VOICE=3145729]="AUDIO_ELECTRONIC_VOICE",j[j.AUDIO_THREEDIM_VOICE=4194305]="AUDIO_THREEDIM_VOICE",(Q=t.VOICE_BEAUTIFIER_PRESET||(t.VOICE_BEAUTIFIER_PRESET={}))[Q.VOICE_BEAUTIFIER_OFF=0]="VOICE_BEAUTIFIER_OFF",Q[Q.CHAT_BEAUTIFIER_MAGNETIC=16843008]="CHAT_BEAUTIFIER_MAGNETIC",Q[Q.CHAT_BEAUTIFIER_FRESH=16843264]="CHAT_BEAUTIFIER_FRESH",Q[Q.CHAT_BEAUTIFIER_VITALITY=16843520]="CHAT_BEAUTIFIER_VITALITY",Q[Q.SINGING_BEAUTIFIER=16908544]="SINGING_BEAUTIFIER",Q[Q.TIMBRE_TRANSFORMATION_VIGOROUS=16974080]="TIMBRE_TRANSFORMATION_VIGOROUS",Q[Q.TIMBRE_TRANSFORMATION_DEEP=16974336]="TIMBRE_TRANSFORMATION_DEEP",Q[Q.TIMBRE_TRANSFORMATION_MELLOW=16974592]="TIMBRE_TRANSFORMATION_MELLOW",Q[Q.TIMBRE_TRANSFORMATION_FALSETTO=16974848]="TIMBRE_TRANSFORMATION_FALSETTO",Q[Q.TIMBRE_TRANSFORMATION_FULL=16975104]="TIMBRE_TRANSFORMATION_FULL",Q[Q.TIMBRE_TRANSFORMATION_CLEAR=16975360]="TIMBRE_TRANSFORMATION_CLEAR",Q[Q.TIMBRE_TRANSFORMATION_RESOUNDING=16975616]="TIMBRE_TRANSFORMATION_RESOUNDING",Q[Q.TIMBRE_TRANSFORMATION_RINGING=16975872]="TIMBRE_TRANSFORMATION_RINGING",(G=t.AUDIO_EFFECT_PRESET||(t.AUDIO_EFFECT_PRESET={}))[G.AUDIO_EFFECT_OFF=0]="AUDIO_EFFECT_OFF",G[G.ROOM_ACOUSTICS_KTV=33620224]="ROOM_ACOUSTICS_KTV",G[G.ROOM_ACOUSTICS_VOCAL_CONCERT=33620480]="ROOM_ACOUSTICS_VOCAL_CONCERT",G[G.ROOM_ACOUSTICS_STUDIO=33620736]="ROOM_ACOUSTICS_STUDIO",G[G.ROOM_ACOUSTICS_PHONOGRAPH=33620992]="ROOM_ACOUSTICS_PHONOGRAPH",G[G.ROOM_ACOUSTICS_VIRTUAL_STEREO=33621248]="ROOM_ACOUSTICS_VIRTUAL_STEREO",G[G.ROOM_ACOUSTICS_SPACIAL=33621504]="ROOM_ACOUSTICS_SPACIAL",G[G.ROOM_ACOUSTICS_ETHEREAL=33621760]="ROOM_ACOUSTICS_ETHEREAL",G[G.ROOM_ACOUSTICS_3D_VOICE=33622016]="ROOM_ACOUSTICS_3D_VOICE",G[G.VOICE_CHANGER_EFFECT_UNCLE=33685760]="VOICE_CHANGER_EFFECT_UNCLE",G[G.VOICE_CHANGER_EFFECT_OLDMAN=33686016]="VOICE_CHANGER_EFFECT_OLDMAN",G[G.VOICE_CHANGER_EFFECT_BOY=33686272]="VOICE_CHANGER_EFFECT_BOY",G[G.VOICE_CHANGER_EFFECT_SISTER=33686528]="VOICE_CHANGER_EFFECT_SISTER",G[G.VOICE_CHANGER_EFFECT_GIRL=33686784]="VOICE_CHANGER_EFFECT_GIRL",G[G.VOICE_CHANGER_EFFECT_PIGKING=33687040]="VOICE_CHANGER_EFFECT_PIGKING",G[G.VOICE_CHANGER_EFFECT_HULK=33687296]="VOICE_CHANGER_EFFECT_HULK",G[G.STYLE_TRANSFORMATION_RNB=33751296]="STYLE_TRANSFORMATION_RNB",G[G.STYLE_TRANSFORMATION_POPULAR=33751552]="STYLE_TRANSFORMATION_POPULAR",G[G.PITCH_CORRECTION=33816832]="PITCH_CORRECTION",(V=t.VOICE_CONVERSION_PRESET||(t.VOICE_CONVERSION_PRESET={}))[V.VOICE_CONVERSION_OFF=0]="VOICE_CONVERSION_OFF",V[V.VOICE_CHANGER_NEUTRAL=50397440]="VOICE_CHANGER_NEUTRAL",V[V.VOICE_CHANGER_SWEET=50397696]="VOICE_CHANGER_SWEET",V[V.VOICE_CHANGER_SOLID=50397952]="VOICE_CHANGER_SOLID",V[V.VOICE_CHANGER_BASS=50398208]="VOICE_CHANGER_BASS",(F=t.AUDIO_CODEC_PROFILE_TYPE||(t.AUDIO_CODEC_PROFILE_TYPE={}))[F.AUDIO_CODEC_PROFILE_LC_AAC=0]="AUDIO_CODEC_PROFILE_LC_AAC",F[F.AUDIO_CODEC_PROFILE_HE_AAC=1]="AUDIO_CODEC_PROFILE_HE_AAC",(B=t.REMOTE_AUDIO_STATE||(t.REMOTE_AUDIO_STATE={}))[B.REMOTE_AUDIO_STATE_STOPPED=0]="REMOTE_AUDIO_STATE_STOPPED",B[B.REMOTE_AUDIO_STATE_STARTING=1]="REMOTE_AUDIO_STATE_STARTING",B[B.REMOTE_AUDIO_STATE_DECODING=2]="REMOTE_AUDIO_STATE_DECODING",B[B.REMOTE_AUDIO_STATE_FROZEN=3]="REMOTE_AUDIO_STATE_FROZEN",B[B.REMOTE_AUDIO_STATE_FAILED=4]="REMOTE_AUDIO_STATE_FAILED",(U=t.REMOTE_AUDIO_STATE_REASON||(t.REMOTE_AUDIO_STATE_REASON={}))[U.REMOTE_AUDIO_REASON_INTERNAL=0]="REMOTE_AUDIO_REASON_INTERNAL",U[U.REMOTE_AUDIO_REASON_NETWORK_CONGESTION=1]="REMOTE_AUDIO_REASON_NETWORK_CONGESTION",U[U.REMOTE_AUDIO_REASON_NETWORK_RECOVERY=2]="REMOTE_AUDIO_REASON_NETWORK_RECOVERY",U[U.REMOTE_AUDIO_REASON_LOCAL_MUTED=3]="REMOTE_AUDIO_REASON_LOCAL_MUTED",U[U.REMOTE_AUDIO_REASON_LOCAL_UNMUTED=4]="REMOTE_AUDIO_REASON_LOCAL_UNMUTED",U[U.REMOTE_AUDIO_REASON_REMOTE_MUTED=5]="REMOTE_AUDIO_REASON_REMOTE_MUTED",U[U.REMOTE_AUDIO_REASON_REMOTE_UNMUTED=6]="REMOTE_AUDIO_REASON_REMOTE_UNMUTED",U[U.REMOTE_AUDIO_REASON_REMOTE_OFFLINE=7]="REMOTE_AUDIO_REASON_REMOTE_OFFLINE",(M=t.REMOTE_VIDEO_STATE||(t.REMOTE_VIDEO_STATE={}))[M.REMOTE_VIDEO_STATE_STOPPED=0]="REMOTE_VIDEO_STATE_STOPPED",M[M.REMOTE_VIDEO_STATE_STARTING=1]="REMOTE_VIDEO_STATE_STARTING",M[M.REMOTE_VIDEO_STATE_DECODING=2]="REMOTE_VIDEO_STATE_DECODING",M[M.REMOTE_VIDEO_STATE_FROZEN=3]="REMOTE_VIDEO_STATE_FROZEN",M[M.REMOTE_VIDEO_STATE_FAILED=4]="REMOTE_VIDEO_STATE_FAILED",(x=t.STREAM_PUBLISH_STATE||(t.STREAM_PUBLISH_STATE={}))[x.PUB_STATE_IDLE=0]="PUB_STATE_IDLE",x[x.PUB_STATE_NO_PUBLISHED=1]="PUB_STATE_NO_PUBLISHED",x[x.PUB_STATE_PUBLISHING=2]="PUB_STATE_PUBLISHING",x[x.PUB_STATE_PUBLISHED=3]="PUB_STATE_PUBLISHED",(k=t.STREAM_SUBSCRIBE_STATE||(t.STREAM_SUBSCRIBE_STATE={}))[k.SUB_STATE_IDLE=0]="SUB_STATE_IDLE",k[k.SUB_STATE_NO_SUBSCRIBED=1]="SUB_STATE_NO_SUBSCRIBED",k[k.SUB_STATE_SUBSCRIBING=2]="SUB_STATE_SUBSCRIBING",k[k.SUB_STATE_SUBSCRIBED=3]="SUB_STATE_SUBSCRIBED",(P=t.XLA_REMOTE_VIDEO_FROZEN_TYPE||(t.XLA_REMOTE_VIDEO_FROZEN_TYPE={}))[P.XLA_REMOTE_VIDEO_FROZEN_500MS=0]="XLA_REMOTE_VIDEO_FROZEN_500MS",P[P.XLA_REMOTE_VIDEO_FROZEN_200MS=1]="XLA_REMOTE_VIDEO_FROZEN_200MS",P[P.XLA_REMOTE_VIDEO_FROZEN_600MS=2]="XLA_REMOTE_VIDEO_FROZEN_600MS",P[P.XLA_REMOTE_VIDEO_FROZEN_TYPE_MAX=3]="XLA_REMOTE_VIDEO_FROZEN_TYPE_MAX",(L=t.XLA_REMOTE_AUDIO_FROZEN_TYPE||(t.XLA_REMOTE_AUDIO_FROZEN_TYPE={}))[L.XLA_REMOTE_AUDIO_FROZEN_80MS=0]="XLA_REMOTE_AUDIO_FROZEN_80MS",L[L.XLA_REMOTE_AUDIO_FROZEN_200MS=1]="XLA_REMOTE_AUDIO_FROZEN_200MS",L[L.XLA_REMOTE_AUDIO_FROZEN_TYPE_MAX=2]="XLA_REMOTE_AUDIO_FROZEN_TYPE_MAX",(D=t.REMOTE_VIDEO_STATE_REASON||(t.REMOTE_VIDEO_STATE_REASON={}))[D.REMOTE_VIDEO_STATE_REASON_INTERNAL=0]="REMOTE_VIDEO_STATE_REASON_INTERNAL",D[D.REMOTE_VIDEO_STATE_REASON_NETWORK_CONGESTION=1]="REMOTE_VIDEO_STATE_REASON_NETWORK_CONGESTION",D[D.REMOTE_VIDEO_STATE_REASON_NETWORK_RECOVERY=2]="REMOTE_VIDEO_STATE_REASON_NETWORK_RECOVERY",D[D.REMOTE_VIDEO_STATE_REASON_LOCAL_MUTED=3]="REMOTE_VIDEO_STATE_REASON_LOCAL_MUTED",D[D.REMOTE_VIDEO_STATE_REASON_LOCAL_UNMUTED=4]="REMOTE_VIDEO_STATE_REASON_LOCAL_UNMUTED",D[D.REMOTE_VIDEO_STATE_REASON_REMOTE_MUTED=5]="REMOTE_VIDEO_STATE_REASON_REMOTE_MUTED",D[D.REMOTE_VIDEO_STATE_REASON_REMOTE_UNMUTED=6]="REMOTE_VIDEO_STATE_REASON_REMOTE_UNMUTED",D[D.REMOTE_VIDEO_STATE_REASON_REMOTE_OFFLINE=7]="REMOTE_VIDEO_STATE_REASON_REMOTE_OFFLINE",D[D.REMOTE_VIDEO_STATE_REASON_AUDIO_FALLBACK=8]="REMOTE_VIDEO_STATE_REASON_AUDIO_FALLBACK",D[D.REMOTE_VIDEO_STATE_REASON_AUDIO_FALLBACK_RECOVERY=9]="REMOTE_VIDEO_STATE_REASON_AUDIO_FALLBACK_RECOVERY",(N=t.FRAME_RATE||(t.FRAME_RATE={}))[N.FRAME_RATE_FPS_1=1]="FRAME_RATE_FPS_1",N[N.FRAME_RATE_FPS_7=7]="FRAME_RATE_FPS_7",N[N.FRAME_RATE_FPS_10=10]="FRAME_RATE_FPS_10",N[N.FRAME_RATE_FPS_15=15]="FRAME_RATE_FPS_15",N[N.FRAME_RATE_FPS_24=24]="FRAME_RATE_FPS_24",N[N.FRAME_RATE_FPS_30=30]="FRAME_RATE_FPS_30",N[N.FRAME_RATE_FPS_60=60]="FRAME_RATE_FPS_60",(w=t.ORIENTATION_MODE||(t.ORIENTATION_MODE={}))[w.ORIENTATION_MODE_ADAPTIVE=0]="ORIENTATION_MODE_ADAPTIVE",w[w.ORIENTATION_MODE_FIXED_LANDSCAPE=1]="ORIENTATION_MODE_FIXED_LANDSCAPE",w[w.ORIENTATION_MODE_FIXED_PORTRAIT=2]="ORIENTATION_MODE_FIXED_PORTRAIT",(b=t.DEGRADATION_PREFERENCE||(t.DEGRADATION_PREFERENCE={}))[b.MAINTAIN_QUALITY=0]="MAINTAIN_QUALITY",b[b.MAINTAIN_FRAMERATE=1]="MAINTAIN_FRAMERATE",b[b.MAINTAIN_BALANCED=2]="MAINTAIN_BALANCED",(O=t.STREAM_FALLBACK_OPTIONS||(t.STREAM_FALLBACK_OPTIONS={}))[O.STREAM_FALLBACK_OPTION_DISABLED=0]="STREAM_FALLBACK_OPTION_DISABLED",O[O.STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW=1]="STREAM_FALLBACK_OPTION_VIDEO_STREAM_LOW",O[O.STREAM_FALLBACK_OPTION_AUDIO_ONLY=2]="STREAM_FALLBACK_OPTION_AUDIO_ONLY",(C=t.CAPTURER_OUTPUT_PREFERENCE||(t.CAPTURER_OUTPUT_PREFERENCE={}))[C.CAPTURER_OUTPUT_PREFERENCE_AUTO=0]="CAPTURER_OUTPUT_PREFERENCE_AUTO",C[C.CAPTURER_OUTPUT_PREFERENCE_PERFORMANCE=1]="CAPTURER_OUTPUT_PREFERENCE_PERFORMANCE",C[C.CAPTURER_OUTPUT_PREFERENCE_PREVIEW=2]="CAPTURER_OUTPUT_PREFERENCE_PREVIEW",C[C.CAPTURER_OUTPUT_PREFERENCE_MANUAL=3]="CAPTURER_OUTPUT_PREFERENCE_MANUAL",(S=t.PRIORITY_TYPE||(t.PRIORITY_TYPE={}))[S.PRIORITY_HIGH=50]="PRIORITY_HIGH",S[S.PRIORITY_NORMAL=100]="PRIORITY_NORMAL",(y=t.CONNECTION_STATE_TYPE||(t.CONNECTION_STATE_TYPE={}))[y.CONNECTION_STATE_DISCONNECTED=1]="CONNECTION_STATE_DISCONNECTED",y[y.CONNECTION_STATE_CONNECTING=2]="CONNECTION_STATE_CONNECTING",y[y.CONNECTION_STATE_CONNECTED=3]="CONNECTION_STATE_CONNECTED",y[y.CONNECTION_STATE_RECONNECTING=4]="CONNECTION_STATE_RECONNECTING",y[y.CONNECTION_STATE_FAILED=5]="CONNECTION_STATE_FAILED",(v=t.CONNECTION_CHANGED_REASON_TYPE||(t.CONNECTION_CHANGED_REASON_TYPE={}))[v.CONNECTION_CHANGED_CONNECTING=0]="CONNECTION_CHANGED_CONNECTING",v[v.CONNECTION_CHANGED_JOIN_SUCCESS=1]="CONNECTION_CHANGED_JOIN_SUCCESS",v[v.CONNECTION_CHANGED_INTERRUPTED=2]="CONNECTION_CHANGED_INTERRUPTED",v[v.CONNECTION_CHANGED_BANNED_BY_SERVER=3]="CONNECTION_CHANGED_BANNED_BY_SERVER",v[v.CONNECTION_CHANGED_JOIN_FAILED=4]="CONNECTION_CHANGED_JOIN_FAILED",v[v.CONNECTION_CHANGED_LEAVE_CHANNEL=5]="CONNECTION_CHANGED_LEAVE_CHANNEL",v[v.CONNECTION_CHANGED_INVALID_APP_ID=6]="CONNECTION_CHANGED_INVALID_APP_ID",v[v.CONNECTION_CHANGED_INVALID_CHANNEL_NAME=7]="CONNECTION_CHANGED_INVALID_CHANNEL_NAME",v[v.CONNECTION_CHANGED_INVALID_TOKEN=8]="CONNECTION_CHANGED_INVALID_TOKEN",v[v.CONNECTION_CHANGED_TOKEN_EXPIRED=9]="CONNECTION_CHANGED_TOKEN_EXPIRED",v[v.CONNECTION_CHANGED_REJECTED_BY_SERVER=10]="CONNECTION_CHANGED_REJECTED_BY_SERVER",v[v.CONNECTION_CHANGED_SETTING_PROXY_SERVER=11]="CONNECTION_CHANGED_SETTING_PROXY_SERVER",v[v.CONNECTION_CHANGED_RENEW_TOKEN=12]="CONNECTION_CHANGED_RENEW_TOKEN",v[v.CONNECTION_CHANGED_CLIENT_IP_ADDRESS_CHANGED=13]="CONNECTION_CHANGED_CLIENT_IP_ADDRESS_CHANGED",v[v.CONNECTION_CHANGED_KEEP_ALIVE_TIMEOUT=14]="CONNECTION_CHANGED_KEEP_ALIVE_TIMEOUT",v[v.CONNECTION_CHANGED_PROXY_SERVER_INTERRUPTED=15]="CONNECTION_CHANGED_PROXY_SERVER_INTERRUPTED",(R=t.NETWORK_TYPE||(t.NETWORK_TYPE={}))[R.NETWORK_TYPE_UNKNOWN=-1]="NETWORK_TYPE_UNKNOWN",R[R.NETWORK_TYPE_DISCONNECTED=0]="NETWORK_TYPE_DISCONNECTED",R[R.NETWORK_TYPE_LAN=1]="NETWORK_TYPE_LAN",R[R.NETWORK_TYPE_WIFI=2]="NETWORK_TYPE_WIFI",R[R.NETWORK_TYPE_MOBILE_2G=3]="NETWORK_TYPE_MOBILE_2G",R[R.NETWORK_TYPE_MOBILE_3G=4]="NETWORK_TYPE_MOBILE_3G",R[R.NETWORK_TYPE_MOBILE_4G=5]="NETWORK_TYPE_MOBILE_4G",(T=t.UPLOAD_ERROR_REASON||(t.UPLOAD_ERROR_REASON={}))[T.UPLOAD_SUCCESS=0]="UPLOAD_SUCCESS",T[T.UPLOAD_NET_ERROR=1]="UPLOAD_NET_ERROR",T[T.UPLOAD_SERVER_ERROR=2]="UPLOAD_SERVER_ERROR",(I=t.LASTMILE_PROBE_RESULT_STATE||(t.LASTMILE_PROBE_RESULT_STATE={}))[I.LASTMILE_PROBE_RESULT_COMPLETE=1]="LASTMILE_PROBE_RESULT_COMPLETE",I[I.LASTMILE_PROBE_RESULT_INCOMPLETE_NO_BWE=2]="LASTMILE_PROBE_RESULT_INCOMPLETE_NO_BWE",I[I.LASTMILE_PROBE_RESULT_UNAVAILABLE=3]="LASTMILE_PROBE_RESULT_UNAVAILABLE",(m=t.AUDIO_ROUTE_TYPE||(t.AUDIO_ROUTE_TYPE={}))[m.AUDIO_ROUTE_DEFAULT=-1]="AUDIO_ROUTE_DEFAULT",m[m.AUDIO_ROUTE_HEADSET=0]="AUDIO_ROUTE_HEADSET",m[m.AUDIO_ROUTE_EARPIECE=1]="AUDIO_ROUTE_EARPIECE",m[m.AUDIO_ROUTE_HEADSET_NO_MIC=2]="AUDIO_ROUTE_HEADSET_NO_MIC",m[m.AUDIO_ROUTE_SPEAKERPHONE=3]="AUDIO_ROUTE_SPEAKERPHONE",m[m.AUDIO_ROUTE_LOUDSPEAKER=4]="AUDIO_ROUTE_LOUDSPEAKER",m[m.AUDIO_ROUTE_BLUETOOTH=5]="AUDIO_ROUTE_BLUETOOTH",m[m.AUDIO_ROUTE_USB=6]="AUDIO_ROUTE_USB",m[m.AUDIO_ROUTE_HDMI=7]="AUDIO_ROUTE_HDMI",m[m.AUDIO_ROUTE_DISPLAYPORT=8]="AUDIO_ROUTE_DISPLAYPORT",m[m.AUDIO_ROUTE_AIRPLAY=9]="AUDIO_ROUTE_AIRPLAY",(_=t.CLOUD_PROXY_TYPE||(t.CLOUD_PROXY_TYPE={}))[_.NONE_PROXY=0]="NONE_PROXY",_[_.UDP_PROXY=1]="UDP_PROXY",_[_.TCP_PROXY=2]="TCP_PROXY",(g=t.AUDIO_SESSION_OPERATION_RESTRICTION||(t.AUDIO_SESSION_OPERATION_RESTRICTION={}))[g.AUDIO_SESSION_OPERATION_RESTRICTION_NONE=0]="AUDIO_SESSION_OPERATION_RESTRICTION_NONE",g[g.AUDIO_SESSION_OPERATION_RESTRICTION_SET_CATEGORY=1]="AUDIO_SESSION_OPERATION_RESTRICTION_SET_CATEGORY",g[g.AUDIO_SESSION_OPERATION_RESTRICTION_CONFIGURE_SESSION=2]="AUDIO_SESSION_OPERATION_RESTRICTION_CONFIGURE_SESSION",g[g.AUDIO_SESSION_OPERATION_RESTRICTION_DEACTIVATE_SESSION=4]="AUDIO_SESSION_OPERATION_RESTRICTION_DEACTIVATE_SESSION",g[g.AUDIO_SESSION_OPERATION_RESTRICTION_ALL=128]="AUDIO_SESSION_OPERATION_RESTRICTION_ALL",(E=t.CAMERA_DIRECTION||(t.CAMERA_DIRECTION={}))[E.CAMERA_REAR=0]="CAMERA_REAR",E[E.CAMERA_FRONT=1]="CAMERA_FRONT",(A=t.QUALITY_ADAPT_INDICATION||(t.QUALITY_ADAPT_INDICATION={}))[A.ADAPT_NONE=0]="ADAPT_NONE",A[A.ADAPT_UP_BANDWIDTH=1]="ADAPT_UP_BANDWIDTH",A[A.ADAPT_DOWN_BANDWIDTH=2]="ADAPT_DOWN_BANDWIDTH",(f=t.EXPERIENCE_QUALITY_TYPE||(t.EXPERIENCE_QUALITY_TYPE={}))[f.EXPERIENCE_QUALITY_GOOD=0]="EXPERIENCE_QUALITY_GOOD",f[f.EXPERIENCE_QUALITY_BAD=1]="EXPERIENCE_QUALITY_BAD",(p=t.EXPERIENCE_POOR_REASON||(t.EXPERIENCE_POOR_REASON={}))[p.EXPERIENCE_REASON_NONE=0]="EXPERIENCE_REASON_NONE",p[p.REMOTE_NETWORK_QUALITY_POOR=1]="REMOTE_NETWORK_QUALITY_POOR",p[p.LOCAL_NETWORK_QUALITY_POOR=2]="LOCAL_NETWORK_QUALITY_POOR",p[p.WIRELESS_SIGNAL_POOR=4]="WIRELESS_SIGNAL_POOR",p[p.WIFI_BLUETOOTH_COEXIST=8]="WIFI_BLUETOOTH_COEXIST",(h=t.CHANNEL_MEDIA_RELAY_ERROR||(t.CHANNEL_MEDIA_RELAY_ERROR={}))[h.RELAY_OK=0]="RELAY_OK",h[h.RELAY_ERROR_SERVER_ERROR_RESPONSE=1]="RELAY_ERROR_SERVER_ERROR_RESPONSE",h[h.RELAY_ERROR_SERVER_NO_RESPONSE=2]="RELAY_ERROR_SERVER_NO_RESPONSE",h[h.RELAY_ERROR_NO_RESOURCE_AVAILABLE=3]="RELAY_ERROR_NO_RESOURCE_AVAILABLE",h[h.RELAY_ERROR_FAILED_JOIN_SRC=4]="RELAY_ERROR_FAILED_JOIN_SRC",h[h.RELAY_ERROR_FAILED_JOIN_DEST=5]="RELAY_ERROR_FAILED_JOIN_DEST",h[h.RELAY_ERROR_FAILED_PACKET_RECEIVED_FROM_SRC=6]="RELAY_ERROR_FAILED_PACKET_RECEIVED_FROM_SRC",h[h.RELAY_ERROR_FAILED_PACKET_SENT_TO_DEST=7]="RELAY_ERROR_FAILED_PACKET_SENT_TO_DEST",h[h.RELAY_ERROR_SERVER_CONNECTION_LOST=8]="RELAY_ERROR_SERVER_CONNECTION_LOST",h[h.RELAY_ERROR_INTERNAL_ERROR=9]="RELAY_ERROR_INTERNAL_ERROR",h[h.RELAY_ERROR_SRC_TOKEN_EXPIRED=10]="RELAY_ERROR_SRC_TOKEN_EXPIRED",h[h.RELAY_ERROR_DEST_TOKEN_EXPIRED=11]="RELAY_ERROR_DEST_TOKEN_EXPIRED",(d=t.CHANNEL_MEDIA_RELAY_EVENT||(t.CHANNEL_MEDIA_RELAY_EVENT={}))[d.RELAY_EVENT_NETWORK_DISCONNECTED=0]="RELAY_EVENT_NETWORK_DISCONNECTED",d[d.RELAY_EVENT_NETWORK_CONNECTED=1]="RELAY_EVENT_NETWORK_CONNECTED",d[d.RELAY_EVENT_PACKET_JOINED_SRC_CHANNEL=2]="RELAY_EVENT_PACKET_JOINED_SRC_CHANNEL",d[d.RELAY_EVENT_PACKET_JOINED_DEST_CHANNEL=3]="RELAY_EVENT_PACKET_JOINED_DEST_CHANNEL",d[d.RELAY_EVENT_PACKET_SENT_TO_DEST_CHANNEL=4]="RELAY_EVENT_PACKET_SENT_TO_DEST_CHANNEL",d[d.RELAY_EVENT_PACKET_RECEIVED_VIDEO_FROM_SRC=5]="RELAY_EVENT_PACKET_RECEIVED_VIDEO_FROM_SRC",d[d.RELAY_EVENT_PACKET_RECEIVED_AUDIO_FROM_SRC=6]="RELAY_EVENT_PACKET_RECEIVED_AUDIO_FROM_SRC",d[d.RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL=7]="RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL",d[d.RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL_REFUSED=8]="RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL_REFUSED",d[d.RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE=9]="RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE",d[d.RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL_IS_NULL=10]="RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL_IS_NULL",d[d.RELAY_EVENT_VIDEO_PROFILE_UPDATE=11]="RELAY_EVENT_VIDEO_PROFILE_UPDATE",(l=t.CHANNEL_MEDIA_RELAY_STATE||(t.CHANNEL_MEDIA_RELAY_STATE={}))[l.RELAY_STATE_IDLE=0]="RELAY_STATE_IDLE",l[l.RELAY_STATE_CONNECTING=1]="RELAY_STATE_CONNECTING",l[l.RELAY_STATE_RUNNING=2]="RELAY_STATE_RUNNING",l[l.RELAY_STATE_FAILURE=3]="RELAY_STATE_FAILURE",t.STANDARD_BITRATE=0,t.COMPATIBLE_BITRATE=-1,t.DEFAULT_MIN_BITRATE=-1,t.LBHQ="lbhq",t.VEO="veo",(u=t.RTMP_STREAM_LIFE_CYCLE_TYPE||(t.RTMP_STREAM_LIFE_CYCLE_TYPE={}))[u.RTMP_STREAM_LIFE_CYCLE_BIND2CHANNEL=1]="RTMP_STREAM_LIFE_CYCLE_BIND2CHANNEL",u[u.RTMP_STREAM_LIFE_CYCLE_BIND2OWNER=2]="RTMP_STREAM_LIFE_CYCLE_BIND2OWNER",(c=t.VideoContentHint||(t.VideoContentHint={}))[c.CONTENT_HINT_NONE=0]="CONTENT_HINT_NONE",c[c.CONTENT_HINT_MOTION=1]="CONTENT_HINT_MOTION",c[c.CONTENT_HINT_DETAILS=2]="CONTENT_HINT_DETAILS",(a=t.LIGHTENING_CONTRAST_LEVEL||(t.LIGHTENING_CONTRAST_LEVEL={}))[a.LIGHTENING_CONTRAST_LOW=0]="LIGHTENING_CONTRAST_LOW",a[a.LIGHTENING_CONTRAST_NORMAL=1]="LIGHTENING_CONTRAST_NORMAL",a[a.LIGHTENING_CONTRAST_HIGH=2]="LIGHTENING_CONTRAST_HIGH",(s=t.AREA_CODE||(t.AREA_CODE={}))[s.AREA_CODE_CN=1]="AREA_CODE_CN",s[s.AREA_CODE_NA=2]="AREA_CODE_NA",s[s.AREA_CODE_EU=4]="AREA_CODE_EU",s[s.AREA_CODE_AS=8]="AREA_CODE_AS",s[s.AREA_CODE_JP=16]="AREA_CODE_JP",s[s.AREA_CODE_IN=32]="AREA_CODE_IN",s[s.AREA_CODE_GLOB=4294967295]="AREA_CODE_GLOB",(o=t.ENCRYPTION_CONFIG||(t.ENCRYPTION_CONFIG={}))[o.ENCRYPTION_FORCE_SETTING=1]="ENCRYPTION_FORCE_SETTING",o[o.ENCRYPTION_FORCE_DISABLE_PACKET=2]="ENCRYPTION_FORCE_DISABLE_PACKET",(i=t.VIDEO_CAPTURE_TYPE||(t.VIDEO_CAPTURE_TYPE={}))[i.VIDEO_CAPTURE_UNKNOWN=0]="VIDEO_CAPTURE_UNKNOWN",i[i.VIDEO_CAPTURE_CAMERA=1]="VIDEO_CAPTURE_CAMERA",i[i.VIDEO_CAPTURE_SCREEN=2]="VIDEO_CAPTURE_SCREEN",(r=t.METADATA_TYPE||(t.METADATA_TYPE={}))[r.UNKNOWN_METADATA=-1]="UNKNOWN_METADATA",r[r.VIDEO_METADATA=0]="VIDEO_METADATA",(n=t.ENCRYPTION_MODE||(t.ENCRYPTION_MODE={}))[n.AES_128_XTS=1]="AES_128_XTS",n[n.AES_128_ECB=2]="AES_128_ECB",n[n.AES_256_XTS=3]="AES_256_XTS",n[n.SM4_128_ECB=4]="SM4_128_ECB",n[n.AES_128_GCM=5]="AES_128_GCM",n[n.AES_256_GCM=6]="AES_256_GCM",n[n.MODE_END=7]="MODE_END"},593:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelMediaRelayEventToNative=t.ChannelMediaRelayErrorToNative=t.ChannelMediaRelayStateToNative=t.InjectStreamEventStatusToNative=t.RtmpStreamingErrorToNative=t.NetworkQualityToNative=t.UserLeftReasonToNative=t.ConnectionDisconnectedReasonToNative=t.ConnectionStateToNative=t.printf=void 0;var i=n(424),o=n(910);t.printf=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.log.apply(console,r(["agora-iris",e],t,!1))},t.ConnectionStateToNative=function(e){switch(e){case"DISCONNECTED":case"DISCONNECTING":default:return o.CONNECTION_STATE_TYPE.CONNECTION_STATE_DISCONNECTED;case"CONNECTING":return o.CONNECTION_STATE_TYPE.CONNECTION_STATE_CONNECTING;case"RECONNECTING":return o.CONNECTION_STATE_TYPE.CONNECTION_STATE_RECONNECTING;case"CONNECTED":return o.CONNECTION_STATE_TYPE.CONNECTION_STATE_CONNECTED}},t.ConnectionDisconnectedReasonToNative=function(e){switch(e){case i.ConnectionDisconnectedReason.LEAVE:return o.CONNECTION_CHANGED_REASON_TYPE.CONNECTION_CHANGED_LEAVE_CHANNEL;case i.ConnectionDisconnectedReason.NETWORK_ERROR:case i.ConnectionDisconnectedReason.SERVER_ERROR:return o.CONNECTION_CHANGED_REASON_TYPE.CONNECTION_CHANGED_INTERRUPTED;case i.ConnectionDisconnectedReason.UID_BANNED:return o.CONNECTION_CHANGED_REASON_TYPE.CONNECTION_CHANGED_REJECTED_BY_SERVER;case i.ConnectionDisconnectedReason.IP_BANNED:case i.ConnectionDisconnectedReason.CHANNEL_BANNED:return o.CONNECTION_CHANGED_REASON_TYPE.CONNECTION_CHANGED_BANNED_BY_SERVER;default:return o.CONNECTION_CHANGED_REASON_TYPE.CONNECTION_CHANGED_JOIN_SUCCESS}},t.UserLeftReasonToNative=function(e){switch(e){case"Quit":default:return o.USER_OFFLINE_REASON_TYPE.USER_OFFLINE_QUIT;case"ServerTimeOut":return o.USER_OFFLINE_REASON_TYPE.USER_OFFLINE_DROPPED;case"BecomeAudience":return o.USER_OFFLINE_REASON_TYPE.USER_OFFLINE_BECOME_AUDIENCE}},t.NetworkQualityToNative=function(e){switch(e){case 0:return o.QUALITY_TYPE.QUALITY_UNKNOWN;case 1:return o.QUALITY_TYPE.QUALITY_EXCELLENT;case 2:return o.QUALITY_TYPE.QUALITY_GOOD;case 3:return o.QUALITY_TYPE.QUALITY_POOR;case 4:return o.QUALITY_TYPE.QUALITY_BAD;case 5:return o.QUALITY_TYPE.QUALITY_VBAD;case 6:return o.QUALITY_TYPE.QUALITY_DOWN}},t.RtmpStreamingErrorToNative=function(e){switch(e){case"LIVE_STREAMING_INVALID_ARGUMENT":return o.RTMP_STREAM_PUBLISH_ERROR.RTMP_STREAM_PUBLISH_ERROR_INVALID_ARGUMENT;case"LIVE_STREAMING_INTERNAL_SERVER_ERROR":return o.RTMP_STREAM_PUBLISH_ERROR.RTMP_STREAM_PUBLISH_ERROR_INTERNAL_SERVER_ERROR;case"LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED":return o.RTMP_STREAM_PUBLISH_ERROR.RTMP_STREAM_PUBLISH_ERROR_NOT_AUTHORIZED;case"LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED":return o.RTMP_STREAM_PUBLISH_ERROR.RTMP_STREAM_PUBLISH_ERROR_FORMAT_NOT_SUPPORTED;case"LIVE_STREAMING_CDN_ERROR":return o.RTMP_STREAM_PUBLISH_ERROR.RTMP_STREAM_PUBLISH_ERROR_RTMP_SERVER_ERROR;case"LIVE_STREAMING_INVALID_RAW_STREAM":return o.RTMP_STREAM_PUBLISH_ERROR.RTMP_STREAM_PUBLISH_ERROR_CONNECTION_TIMEOUT;case"LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT":return o.RTMP_STREAM_PUBLISH_ERROR.RTMP_STREAM_PUBLISH_ERROR_REACH_LIMIT;case"LIVE_STREAMING_WARN_FREQUENT_REQUEST":return o.RTMP_STREAM_PUBLISH_ERROR.RTMP_STREAM_PUBLISH_ERROR_TOO_OFTEN;default:return o.RTMP_STREAM_PUBLISH_ERROR.RTMP_STREAM_PUBLISH_ERROR_OK}},t.InjectStreamEventStatusToNative=function(e){switch(e){case 0:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_SUCCESS;case 1:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_ALREADY_EXISTS;case 2:default:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_UNAUTHORIZED;case 3:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_TIMEDOUT;case 4:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_START_FAILED;case 5:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_SUCCESS;case 6:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_NOT_FOUND;case 7:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED;case 8:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_TIMEDOUT;case 9:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_STOP_FAILED;case 10:return o.INJECT_STREAM_STATUS.INJECT_STREAM_STATUS_BROKEN}},t.ChannelMediaRelayStateToNative=function(e){switch(e){case i.ChannelMediaRelayState.RELAY_STATE_IDLE:return o.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_IDLE;case i.ChannelMediaRelayState.RELAY_STATE_CONNECTING:return o.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_CONNECTING;case i.ChannelMediaRelayState.RELAY_STATE_RUNNING:return o.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_RUNNING;case i.ChannelMediaRelayState.RELAY_STATE_FAILURE:return o.CHANNEL_MEDIA_RELAY_STATE.RELAY_STATE_FAILURE}},t.ChannelMediaRelayErrorToNative=function(e){switch(e){case i.ChannelMediaRelayError.RELAY_OK:return o.CHANNEL_MEDIA_RELAY_ERROR.RELAY_OK;case i.ChannelMediaRelayError.SERVER_CONNECTION_LOST:return o.CHANNEL_MEDIA_RELAY_ERROR.RELAY_ERROR_SERVER_CONNECTION_LOST;case i.ChannelMediaRelayError.SRC_TOKEN_EXPIRED:return o.CHANNEL_MEDIA_RELAY_ERROR.RELAY_ERROR_SRC_TOKEN_EXPIRED;case i.ChannelMediaRelayError.DEST_TOKEN_EXPIRED:return o.CHANNEL_MEDIA_RELAY_ERROR.RELAY_ERROR_DEST_TOKEN_EXPIRED}},t.ChannelMediaRelayEventToNative=function(e){switch(e){case i.ChannelMediaRelayEvent.NETWORK_DISCONNECTED:return o.CHANNEL_MEDIA_RELAY_EVENT.RELAY_EVENT_NETWORK_DISCONNECTED;case i.ChannelMediaRelayEvent.NETWORK_CONNECTED:return o.CHANNEL_MEDIA_RELAY_EVENT.RELAY_EVENT_NETWORK_CONNECTED;case i.ChannelMediaRelayEvent.PACKET_JOINED_SRC_CHANNEL:return o.CHANNEL_MEDIA_RELAY_EVENT.RELAY_EVENT_PACKET_JOINED_SRC_CHANNEL;case i.ChannelMediaRelayEvent.PACKET_JOINED_DEST_CHANNEL:return o.CHANNEL_MEDIA_RELAY_EVENT.RELAY_EVENT_PACKET_JOINED_DEST_CHANNEL;case i.ChannelMediaRelayEvent.PACKET_SENT_TO_DEST_CHANNEL:return o.CHANNEL_MEDIA_RELAY_EVENT.RELAY_EVENT_PACKET_SENT_TO_DEST_CHANNEL;case i.ChannelMediaRelayEvent.PACKET_RECEIVED_VIDEO_FROM_SRC:return o.CHANNEL_MEDIA_RELAY_EVENT.RELAY_EVENT_PACKET_RECEIVED_VIDEO_FROM_SRC;case i.ChannelMediaRelayEvent.PACKET_RECEIVED_AUDIO_FROM_SRC:return o.CHANNEL_MEDIA_RELAY_EVENT.RELAY_EVENT_PACKET_RECEIVED_AUDIO_FROM_SRC;case i.ChannelMediaRelayEvent.PACKET_UPDATE_DEST_CHANNEL:return o.CHANNEL_MEDIA_RELAY_EVENT.RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL;case i.ChannelMediaRelayEvent.PACKET_UPDATE_DEST_CHANNEL_REFUSED:return o.CHANNEL_MEDIA_RELAY_EVENT.RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL_REFUSED;case i.ChannelMediaRelayEvent.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE:return o.CHANNEL_MEDIA_RELAY_EVENT.RELAY_EVENT_PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE}}},501:(e,t,n)=>{"use strict";e.exports=n.p+"a7965ae4891554079e7c.bin"},983:(e,t,n)=>{"use strict";e.exports=n.p+"9eaadaeb638047c7e764.bin"},106:(e,t,n)=>{"use strict";e.exports=n.p+"fec893c34598335dd4d4.wasm"}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})();var r=n(986);IrisRtcEngine=r.default})();